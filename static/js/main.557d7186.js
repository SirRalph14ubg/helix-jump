/*! For license information please see main.557d7186.js.LICENSE.txt */
!function(){var t={810:function(t){"use strict";var e=Object.prototype.hasOwnProperty,n="~";function i(){}function r(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function a(t,e,i,a,o){if("function"!==typeof i)throw new TypeError("The listener must be a function");var s=new r(i,a||t,o),l=n?n+e:e;return t._events[l]?t._events[l].fn?t._events[l]=[t._events[l],s]:t._events[l].push(s):(t._events[l]=s,t._eventsCount++),t}function o(t,e){0===--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),s.prototype.eventNames=function(){var t,i,r=[];if(0===this._eventsCount)return r;for(i in t=this._events)e.call(t,i)&&r.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=n?n+t:t,i=this._events[e];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,a=i.length,o=new Array(a);r<a;r++)o[r]=i[r].fn;return o},s.prototype.listenerCount=function(t){var e=n?n+t:t,i=this._events[e];return i?i.fn?1:i.length:0},s.prototype.emit=function(t,e,i,r,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var l,u,h=this._events[s],c=arguments.length;if(h.fn){switch(h.once&&this.removeListener(t,h.fn,void 0,!0),c){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,e),!0;case 3:return h.fn.call(h.context,e,i),!0;case 4:return h.fn.call(h.context,e,i,r),!0;case 5:return h.fn.call(h.context,e,i,r,a),!0;case 6:return h.fn.call(h.context,e,i,r,a,o),!0}for(u=1,l=new Array(c-1);u<c;u++)l[u-1]=arguments[u];h.fn.apply(h.context,l)}else{var d,f=h.length;for(u=0;u<f;u++)switch(h[u].once&&this.removeListener(t,h[u].fn,void 0,!0),c){case 1:h[u].fn.call(h[u].context);break;case 2:h[u].fn.call(h[u].context,e);break;case 3:h[u].fn.call(h[u].context,e,i);break;case 4:h[u].fn.call(h[u].context,e,i,r);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];h[u].fn.apply(h[u].context,l)}}return!0},s.prototype.on=function(t,e,n){return a(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return a(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,i,r){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==e||r&&!s.once||i&&s.context!==i||o(this,a);else{for(var l=0,u=[],h=s.length;l<h;l++)(s[l].fn!==e||r&&!s[l].once||i&&s[l].context!==i)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&o(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s},37:function(t,e,n){"use strict";var i=n(506),r=n(722),a=r(i("String.prototype.indexOf"));t.exports=function(t,e){var n=i(t,!!e);return"function"===typeof n&&a(t,".prototype.")>-1?r(n):n}},722:function(t,e,n){"use strict";var i=n(350),r=n(506),a=r("%Function.prototype.apply%"),o=r("%Function.prototype.call%"),s=r("%Reflect.apply%",!0)||i.call(o,a),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),h=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(d){u=null}t.exports=function(t){var e=s(i,o,arguments);if(l&&u){var n=l(e,"length");n.configurable&&u(e,"length",{value:1+h(0,t.length-(arguments.length-1))})}return e};var c=function(){return s(i,a,arguments)};u?u(t.exports,"apply",{value:c}):t.exports.apply=c},89:function(t){"use strict";function e(t,e,i){i=i||2;var a,o,s,l,c,d,p,v=e&&e.length,m=v?e[0]*i:t.length,g=n(t,0,m,i,!0),y=[];if(!g||g.next===g.prev)return y;if(v&&(g=function(t,e,i,r){var a,o,s,l=[];for(a=0,o=e.length;a<o;a++)(s=n(t,e[a]*r,a<o-1?e[a+1]*r:t.length,r,!1))===s.next&&(s.steiner=!0),l.push(f(s));for(l.sort(u),a=0;a<l.length;a++)i=h(l[a],i);return i}(t,e,g,i)),t.length>80*i){a=s=t[0],o=l=t[1];for(var _=i;_<m;_+=i)(c=t[_])<a&&(a=c),(d=t[_+1])<o&&(o=d),c>s&&(s=c),d>l&&(l=d);p=0!==(p=Math.max(s-a,l-o))?32767/p:0}return r(g,y,i,a,o,p,0),y}function n(t,e,n,i,r){var a,o;if(r===E(t,e,n,i)>0)for(a=e;a<n;a+=i)o=S(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=S(a,t[a],t[a+1],o);return o&&g(o,o.next)&&(T(o),o=o.next),o}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!g(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(T(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,u,h,c,f){if(t){!f&&c&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=d(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,o,s,l,u=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(t,u,h,c);for(var p,v,m=t;t.prev!==t.next;)if(p=t.prev,v=t.next,c?o(t,u,h,c):a(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(v.i/n|0),T(t),t=v.next,m=v.next;else if((t=v)===m){f?1===f?r(t=s(i(t),e,n),e,n,u,h,c,2):2===f&&l(t,e,n,u,h,c):r(i(t),e,n,u,h,c,1);break}}}function a(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=e.x,a=n.x,o=i.x,s=e.y,l=n.y,u=i.y,h=r<a?r<o?r:o:a<o?a:o,c=s<l?s<u?s:u:l<u?l:u,d=r>a?r>o?r:o:a>o?a:o,f=s>l?s>u?s:u:l>u?l:u,v=i.next;v!==e;){if(v.x>=h&&v.x<=d&&v.y>=c&&v.y<=f&&p(r,s,a,l,o,u,v.x,v.y)&&m(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function o(t,e,n,i){var r=t.prev,a=t,o=t.next;if(m(r,a,o)>=0)return!1;for(var s=r.x,l=a.x,u=o.x,h=r.y,c=a.y,f=o.y,v=s<l?s<u?s:u:l<u?l:u,g=h<c?h<f?h:f:c<f?c:f,y=s>l?s>u?s:u:l>u?l:u,_=h>c?h>f?h:f:c>f?c:f,x=d(v,g,e,n,i),b=d(y,_,e,n,i),w=t.prevZ,S=t.nextZ;w&&w.z>=x&&S&&S.z<=b;){if(w.x>=v&&w.x<=y&&w.y>=g&&w.y<=_&&w!==r&&w!==o&&p(s,h,l,c,u,f,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,S.x>=v&&S.x<=y&&S.y>=g&&S.y<=_&&S!==r&&S!==o&&p(s,h,l,c,u,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}for(;w&&w.z>=x;){if(w.x>=v&&w.x<=y&&w.y>=g&&w.y<=_&&w!==r&&w!==o&&p(s,h,l,c,u,f,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;S&&S.z<=b;){if(S.x>=v&&S.x<=y&&S.y>=g&&S.y<=_&&S!==r&&S!==o&&p(s,h,l,c,u,f,S.x,S.y)&&m(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function s(t,e,n){var r=t;do{var a=r.prev,o=r.next.next;!g(a,o)&&y(a,r,r.next,o)&&b(a,o)&&b(o,a)&&(e.push(a.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),T(r),T(r.next),r=t=o),r=r.next}while(r!==t);return i(r)}function l(t,e,n,a,o,s){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&v(l,u)){var h=w(l,u);return l=i(l,l.next),h=i(h,h.next),r(l,e,n,a,o,s,0),void r(h,e,n,a,o,s,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function h(t,e){var n=function(t,e){var n,i=e,r=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o&&(o=s,n=i.x<i.next.x?i:i.next,s===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,u=n,h=n.x,d=n.y,f=1/0;i=n;do{r>=i.x&&i.x>=h&&r!==i.x&&p(a<d?r:o,a,h,d,a<d?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),b(i,t)&&(l<f||l===f&&(i.x>n.x||i.x===n.x&&c(n,i)))&&(n=i,f=l)),i=i.next}while(i!==u);return n}(t,e);if(!n)return e;var r=w(n,t);return i(r,r.next),i(n,n.next)}function c(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function d(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function f(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,a,o,s){return(r-o)*(e-s)>=(t-o)*(a-s)&&(t-o)*(i-s)>=(n-o)*(e-s)&&(n-o)*(a-s)>=(r-o)*(i-s)}function v(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&y(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(b(t,e)&&b(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||g(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function g(t,e){return t.x===e.x&&t.y===e.y}function y(t,e,n,i){var r=x(m(t,e,n)),a=x(m(t,e,i)),o=x(m(n,i,t)),s=x(m(n,i,e));return r!==a&&o!==s||(!(0!==r||!_(t,n,e))||(!(0!==a||!_(t,i,e))||(!(0!==o||!_(n,t,i))||!(0!==s||!_(n,e,i)))))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function x(t){return t>0?1:t<0?-1:0}function b(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function w(t,e){var n=new M(t.i,t.x,t.y),i=new M(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function S(t,e,n,i){var r=new M(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function T(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function M(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function E(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,a=r?e[0]*n:t.length,o=Math.abs(E(t,0,a,n));if(r)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,h=s<l-1?e[s+1]*n:t.length;o-=Math.abs(E(t,u,h,n))}var c=0;for(s=0;s<i.length;s+=3){var d=i[s]*n,f=i[s+1]*n,p=i[s+2]*n;c+=Math.abs((t[d]-t[p])*(t[f+1]-t[d+1])-(t[d]-t[f])*(t[p+1]-t[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var a=0;a<t[r].length;a++)for(var o=0;o<e;o++)n.vertices.push(t[r][a][o]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},222:function(t){"use strict";var e="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,i=Object.prototype.toString,r="[object Function]";t.exports=function(t){var a=this;if("function"!==typeof a||i.call(a)!==r)throw new TypeError(e+a);for(var o,s=n.call(arguments,1),l=function(){if(this instanceof o){var e=a.apply(this,s.concat(n.call(arguments)));return Object(e)===e?e:this}return a.apply(t,s.concat(n.call(arguments)))},u=Math.max(0,a.length-s.length),h=[],c=0;c<u;c++)h.push("$"+c);if(o=Function("binder","return function ("+h.join(",")+"){ return binder.apply(this,arguments); }")(l),a.prototype){var d=function(){};d.prototype=a.prototype,o.prototype=new d,d.prototype=null}return o}},350:function(t,e,n){"use strict";var i=n(222);t.exports=Function.prototype.bind||i},506:function(t,e,n){"use strict";var i,r=SyntaxError,a=Function,o=TypeError,s=function(t){try{return a('"use strict"; return ('+t+").constructor;")()}catch(e){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(P){l=null}var u=function(){throw new o},h=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(e){return u}}}():u,c=n(697)(),d=Object.getPrototypeOf||function(t){return t.__proto__},f={},p="undefined"===typeof Uint8Array?i:d(Uint8Array),v={"%AggregateError%":"undefined"===typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"===typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":c?d([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"===typeof Atomics?i:Atomics,"%BigInt%":"undefined"===typeof BigInt?i:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"===typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"===typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"===typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"===typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":a,"%GeneratorFunction%":f,"%Int8Array%":"undefined"===typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"===typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"===typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c?d(d([][Symbol.iterator]())):i,"%JSON%":"object"===typeof JSON?JSON:i,"%Map%":"undefined"===typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!==typeof Map&&c?d((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"===typeof Promise?i:Promise,"%Proxy%":"undefined"===typeof Proxy?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"===typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"===typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!==typeof Set&&c?d((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"===typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c?d(""[Symbol.iterator]()):i,"%Symbol%":c?Symbol:i,"%SyntaxError%":r,"%ThrowTypeError%":h,"%TypedArray%":p,"%TypeError%":o,"%Uint8Array%":"undefined"===typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"===typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"===typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"===typeof Uint32Array?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"===typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"===typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"===typeof WeakSet?i:WeakSet},m=function t(e){var n;if("%AsyncFunction%"===e)n=s("async function () {}");else if("%GeneratorFunction%"===e)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=s("async function* () {}");else if("%AsyncGenerator%"===e){var i=t("%AsyncGeneratorFunction%");i&&(n=i.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&(n=d(r.prototype))}return v[e]=n,n},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=n(350),_=n(316),x=y.call(Function.call,Array.prototype.concat),b=y.call(Function.apply,Array.prototype.splice),w=y.call(Function.call,String.prototype.replace),S=y.call(Function.call,String.prototype.slice),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,M=/\\(\\)?/g,E=function(t){var e=S(t,0,1),n=S(t,-1);if("%"===e&&"%"!==n)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new r("invalid intrinsic syntax, expected opening `%`");var i=[];return w(t,T,(function(t,e,n,r){i[i.length]=n?w(r,M,"$1"):e||t})),i},A=function(t,e){var n,i=t;if(_(g,i)&&(i="%"+(n=g[i])[0]+"%"),_(v,i)){var a=v[i];if(a===f&&(a=m(i)),"undefined"===typeof a&&!e)throw new o("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:a}}throw new r("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!==typeof t||0===t.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!==typeof e)throw new o('"allowMissing" argument must be a boolean');var n=E(t),i=n.length>0?n[0]:"",a=A("%"+i+"%",e),s=a.name,u=a.value,h=!1,c=a.alias;c&&(i=c[0],b(n,x([0,1],c)));for(var d=1,f=!0;d<n.length;d+=1){var p=n[d],m=S(p,0,1),g=S(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===g||"'"===g||"`"===g)&&m!==g)throw new r("property names with quotes must have matching quotes");if("constructor"!==p&&f||(h=!0),_(v,s="%"+(i+="."+p)+"%"))u=v[s];else if(null!=u){if(!(p in u)){if(!e)throw new o("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&d+1>=n.length){var y=l(u,p);u=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:u[p]}else f=_(u,p),u=u[p];f&&!h&&(v[s]=u)}}return u}},697:function(t,e,n){"use strict";var i="undefined"!==typeof Symbol&&Symbol,r=n(297);t.exports=function(){return"function"===typeof i&&("function"===typeof Symbol&&("symbol"===typeof i("foo")&&("symbol"===typeof Symbol("bar")&&r())))}},297:function(t){"use strict";t.exports=function(){if("function"!==typeof Symbol||"function"!==typeof Object.getOwnPropertySymbols)return!1;if("symbol"===typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"===typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"===typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"===typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"===typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},316:function(t,e,n){"use strict";var i=n(350);t.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},845:function(t,e,n){var i;!function(){"use strict";var r=function(){this.init()};r.prototype={init:function(){var t=this||a;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!==typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var e=this||a;if(t=parseFloat(t),e.ctx||f(),"undefined"!==typeof t&&t>=0&&t<=1){if(e._volume=t,e._muted)return e;e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t,a.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var o=e._howls[n]._soundById(i[r]);o&&o._node&&(o._node.volume=o._volume*t)}return e}return e._volume},mute:function(t){var e=this||a;e.ctx||f(),e._muted=t,e.usingWebAudio&&e.masterGain.gain.setValueAtTime(t?0:e._volume,a.ctx.currentTime);for(var n=0;n<e._howls.length;n++)if(!e._howls[n]._webAudio)for(var i=e._howls[n]._getSoundIds(),r=0;r<i.length;r++){var o=e._howls[n]._soundById(i[r]);o&&o._node&&(o._node.muted=!!t||o._muted)}return e},stop:function(){for(var t=this||a,e=0;e<t._howls.length;e++)t._howls[e].stop();return t},unload:function(){for(var t=this||a,e=t._howls.length-1;e>=0;e--)t._howls[e].unload();return t.usingWebAudio&&t.ctx&&"undefined"!==typeof t.ctx.close&&(t.ctx.close(),t.ctx=null,f()),t},codecs:function(t){return(this||a)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||a;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!==typeof Audio)try{"undefined"===typeof(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(e){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(e){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||a,e=null;try{e="undefined"!==typeof Audio?new Audio:null}catch(h){return t}if(!e||"function"!==typeof e.canPlayType)return t;var n=e.canPlayType("audio/mpeg;").replace(/^no$/,""),i=t._navigator?t._navigator.userAgent:"",r=i.match(/OPR\/(\d+)/g),o=r&&parseInt(r[0].split("/")[1],10)<33,s=-1!==i.indexOf("Safari")&&-1===i.indexOf("Chrome"),l=i.match(/Version\/(.*?) /),u=s&&l&&parseInt(l[1],10)<15;return t._codecs={mp3:!(o||!n&&!e.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(e.canPlayType('audio/wav; codecs="1"')||e.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!e.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!e.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/m4a;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(e.canPlayType("audio/x-m4b;")||e.canPlayType("audio/m4b;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(e.canPlayType("audio/x-mp4;")||e.canPlayType("audio/mp4;")||e.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(u||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(u||!e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!e.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(e.canPlayType("audio/x-flac;")||e.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||a;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var e=function e(n){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var i=new Audio;i._unlocked=!0,t._releaseHtml5Audio(i)}catch(n){t.noAudio=!0;break}for(var r=0;r<t._howls.length;r++)if(!t._howls[r]._webAudio)for(var a=t._howls[r]._getSoundIds(),o=0;o<a.length;o++){var s=t._howls[r]._soundById(a[o]);s&&s._node&&!s._node._unlocked&&(s._node._unlocked=!0,s._node.load())}t._autoResume();var l=t.ctx.createBufferSource();l.buffer=t._scratchBuffer,l.connect(t.ctx.destination),"undefined"===typeof l.start?l.noteOn(0):l.start(0),"function"===typeof t.ctx.resume&&t.ctx.resume(),l.onended=function(){l.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("click",e,!0),document.removeEventListener("keydown",e,!0);for(var n=0;n<t._howls.length;n++)t._howls[n]._emit("unlock")}};return document.addEventListener("touchstart",e,!0),document.addEventListener("touchend",e,!0),document.addEventListener("click",e,!0),document.addEventListener("keydown",e,!0),t}},_obtainHtml5Audio:function(){var t=this||a;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var e=(new Audio).play();return e&&"undefined"!==typeof Promise&&(e instanceof Promise||"function"===typeof e.then)&&e.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var e=this||a;return t._unlocked&&e._html5AudioPool.push(t),e},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&"undefined"!==typeof t.ctx.suspend&&a.usingWebAudio){for(var e=0;e<t._howls.length;e++)if(t._howls[e]._webAudio)for(var n=0;n<t._howls[e]._sounds.length;n++)if(!t._howls[e]._sounds[n]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var e=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(e,e)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&"undefined"!==typeof t.ctx.resume&&a.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var a=new r,o=function(t){t.src&&0!==t.src.length?this.init(t):console.error("An array of source files must be passed with any new Howl.")};o.prototype={init:function(t){var e=this;return a.ctx||f(),e._autoplay=t.autoplay||!1,e._format="string"!==typeof t.format?t.format:[t.format],e._html5=t.html5||!1,e._muted=t.mute||!1,e._loop=t.loop||!1,e._pool=t.pool||5,e._preload="boolean"!==typeof t.preload&&"metadata"!==t.preload||t.preload,e._rate=t.rate||1,e._sprite=t.sprite||{},e._src="string"!==typeof t.src?t.src:[t.src],e._volume=void 0!==t.volume?t.volume:1,e._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},e._duration=0,e._state="unloaded",e._sounds=[],e._endTimers={},e._queue=[],e._playLock=!1,e._onend=t.onend?[{fn:t.onend}]:[],e._onfade=t.onfade?[{fn:t.onfade}]:[],e._onload=t.onload?[{fn:t.onload}]:[],e._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],e._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],e._onpause=t.onpause?[{fn:t.onpause}]:[],e._onplay=t.onplay?[{fn:t.onplay}]:[],e._onstop=t.onstop?[{fn:t.onstop}]:[],e._onmute=t.onmute?[{fn:t.onmute}]:[],e._onvolume=t.onvolume?[{fn:t.onvolume}]:[],e._onrate=t.onrate?[{fn:t.onrate}]:[],e._onseek=t.onseek?[{fn:t.onseek}]:[],e._onunlock=t.onunlock?[{fn:t.onunlock}]:[],e._onresume=[],e._webAudio=a.usingWebAudio&&!e._html5,"undefined"!==typeof a.ctx&&a.ctx&&a.autoUnlock&&a._unlockAudio(),a._howls.push(e),e._autoplay&&e._queue.push({event:"play",action:function(){e.play()}}),e._preload&&"none"!==e._preload&&e.load(),e},load:function(){var t=this,e=null;if(a.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"===typeof t._src&&(t._src=[t._src]);for(var n=0;n<t._src.length;n++){var i,r;if(t._format&&t._format[n])i=t._format[n];else{if("string"!==typeof(r=t._src[n])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(i=/^data:audio\/([^;,]+);/i.exec(r))||(i=/\.([^.]+)$/.exec(r.split("?",1)[0])),i&&(i=i[1].toLowerCase())}if(i||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),i&&a.codecs(i)){e=t._src[n];break}}if(e)return t._src=e,t._state="loading","https:"===window.location.protocol&&"http:"===e.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new s(t),t._webAudio&&u(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,e){var n=this,i=null;if("number"===typeof t)i=t,t=null;else{if("string"===typeof t&&"loaded"===n._state&&!n._sprite[t])return null;if("undefined"===typeof t&&(t="__default",!n._playLock)){for(var r=0,o=0;o<n._sounds.length;o++)n._sounds[o]._paused&&!n._sounds[o]._ended&&(r++,i=n._sounds[o]._id);1===r?t=null:i=null}}var s=i?n._soundById(i):n._inactiveSound();if(!s)return null;if(i&&!t&&(t=s._sprite||"__default"),"loaded"!==n._state){s._sprite=t,s._ended=!1;var l=s._id;return n._queue.push({event:"play",action:function(){n.play(l)}}),l}if(i&&!s._paused)return e||n._loadQueue("play"),s._id;n._webAudio&&a._autoResume();var u=Math.max(0,s._seek>0?s._seek:n._sprite[t][0]/1e3),h=Math.max(0,(n._sprite[t][0]+n._sprite[t][1])/1e3-u),c=1e3*h/Math.abs(s._rate),d=n._sprite[t][0]/1e3,f=(n._sprite[t][0]+n._sprite[t][1])/1e3;s._sprite=t,s._ended=!1;var p=function(){s._paused=!1,s._seek=u,s._start=d,s._stop=f,s._loop=!(!s._loop&&!n._sprite[t][2])};if(!(u>=f)){var v=s._node;if(n._webAudio){var m=function(){n._playLock=!1,p(),n._refreshBuffer(s);var t=s._muted||n._muted?0:s._volume;v.gain.setValueAtTime(t,a.ctx.currentTime),s._playStart=a.ctx.currentTime,"undefined"===typeof v.bufferSource.start?s._loop?v.bufferSource.noteGrainOn(0,u,86400):v.bufferSource.noteGrainOn(0,u,h):s._loop?v.bufferSource.start(0,u,86400):v.bufferSource.start(0,u,h),c!==1/0&&(n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),c)),e||setTimeout((function(){n._emit("play",s._id),n._loadQueue()}),0)};"running"===a.state&&"interrupted"!==a.ctx.state?m():(n._playLock=!0,n.once("resume",m),n._clearTimer(s._id))}else{var g=function(){v.currentTime=u,v.muted=s._muted||n._muted||a._muted||v.muted,v.volume=s._volume*a.volume(),v.playbackRate=s._rate;try{var i=v.play();if(i&&"undefined"!==typeof Promise&&(i instanceof Promise||"function"===typeof i.then)?(n._playLock=!0,p(),i.then((function(){n._playLock=!1,v._unlocked=!0,e?n._loadQueue():n._emit("play",s._id)})).catch((function(){n._playLock=!1,n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),s._ended=!0,s._paused=!0}))):e||(n._playLock=!1,p(),n._emit("play",s._id)),v.playbackRate=s._rate,v.paused)return void n._emit("playerror",s._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||s._loop?n._endTimers[s._id]=setTimeout(n._ended.bind(n,s),c):(n._endTimers[s._id]=function(){n._ended(s),v.removeEventListener("ended",n._endTimers[s._id],!1)},v.addEventListener("ended",n._endTimers[s._id],!1))}catch(r){n._emit("playerror",s._id,r)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===v.src&&(v.src=n._src,v.load());var y=window&&window.ejecta||!v.readyState&&a._navigator.isCocoonJS;if(v.readyState>=3||y)g();else{n._playLock=!0,n._state="loading";v.addEventListener(a._canPlayEvent,(function t(){n._state="loaded",g(),v.removeEventListener(a._canPlayEvent,t,!1)}),!1),n._clearTimer(s._id)}}return s._id}n._ended(s)},pause:function(t){var e=this;if("loaded"!==e._state||e._playLock)return e._queue.push({event:"pause",action:function(){e.pause(t)}}),e;for(var n=e._getSoundIds(t),i=0;i<n.length;i++){e._clearTimer(n[i]);var r=e._soundById(n[i]);if(r&&!r._paused&&(r._seek=e.seek(n[i]),r._rateSeek=0,r._paused=!0,e._stopFade(n[i]),r._node))if(e._webAudio){if(!r._node.bufferSource)continue;"undefined"===typeof r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),e._cleanBuffer(r._node)}else isNaN(r._node.duration)&&r._node.duration!==1/0||r._node.pause();arguments[1]||e._emit("pause",r?r._id:null)}return e},stop:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(t)}}),n;for(var i=n._getSoundIds(t),r=0;r<i.length;r++){n._clearTimer(i[r]);var a=n._soundById(i[r]);a&&(a._seek=a._start||0,a._rateSeek=0,a._paused=!0,a._ended=!0,n._stopFade(i[r]),a._node&&(n._webAudio?a._node.bufferSource&&("undefined"===typeof a._node.bufferSource.stop?a._node.bufferSource.noteOff(0):a._node.bufferSource.stop(0),n._cleanBuffer(a._node)):isNaN(a._node.duration)&&a._node.duration!==1/0||(a._node.currentTime=a._start||0,a._node.pause(),a._node.duration===1/0&&n._clearSound(a._node))),e||n._emit("stop",a._id))}return n},mute:function(t,e){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(t,e)}}),n;if("undefined"===typeof e){if("boolean"!==typeof t)return n._muted;n._muted=t}for(var i=n._getSoundIds(e),r=0;r<i.length;r++){var o=n._soundById(i[r]);o&&(o._muted=t,o._interval&&n._stopFade(o._id),n._webAudio&&o._node?o._node.gain.setValueAtTime(t?0:o._volume,a.ctx.currentTime):o._node&&(o._node.muted=!!a._muted||t),n._emit("mute",o._id))}return n},volume:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._volume;if(1===r.length||2===r.length&&"undefined"===typeof r[1]){var o=i._getSoundIds(),s=o.indexOf(r[0]);s>=0?e=parseInt(r[0],10):t=parseFloat(r[0])}else r.length>=2&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if(!("undefined"!==typeof t&&t>=0&&t<=1))return(n=e?i._soundById(e):i._sounds[0])?n._volume:0;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,r)}}),i;"undefined"===typeof e&&(i._volume=t),e=i._getSoundIds(e);for(var l=0;l<e.length;l++)(n=i._soundById(e[l]))&&(n._volume=t,r[2]||i._stopFade(e[l]),i._webAudio&&n._node&&!n._muted?n._node.gain.setValueAtTime(t,a.ctx.currentTime):n._node&&!n._muted&&(n._node.volume=t*a.volume()),i._emit("volume",n._id));return i},fade:function(t,e,n,i){var r=this;if("loaded"!==r._state||r._playLock)return r._queue.push({event:"fade",action:function(){r.fade(t,e,n,i)}}),r;t=Math.min(Math.max(0,parseFloat(t)),1),e=Math.min(Math.max(0,parseFloat(e)),1),n=parseFloat(n),r.volume(t,i);for(var o=r._getSoundIds(i),s=0;s<o.length;s++){var l=r._soundById(o[s]);if(l){if(i||r._stopFade(o[s]),r._webAudio&&!l._muted){var u=a.ctx.currentTime,h=u+n/1e3;l._volume=t,l._node.gain.setValueAtTime(t,u),l._node.gain.linearRampToValueAtTime(e,h)}r._startFadeInterval(l,t,e,n,o[s],"undefined"===typeof i)}}return r},_startFadeInterval:function(t,e,n,i,r,a){var o=this,s=e,l=n-e,u=Math.abs(l/.01),h=Math.max(4,u>0?i/u:i),c=Date.now();t._fadeTo=n,t._interval=setInterval((function(){var r=(Date.now()-c)/i;c=Date.now(),s+=l*r,s=Math.round(100*s)/100,s=l<0?Math.max(n,s):Math.min(n,s),o._webAudio?t._volume=s:o.volume(s,t._id,!0),a&&(o._volume=s),(n<e&&s<=n||n>e&&s>=n)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,o.volume(n,t._id),o._emit("fade",t._id))}),h)},_stopFade:function(t){var e=this,n=e._soundById(t);return n&&n._interval&&(e._webAudio&&n._node.gain.cancelScheduledValues(a.ctx.currentTime),clearInterval(n._interval),n._interval=null,e.volume(n._fadeTo,t),n._fadeTo=null,e._emit("fade",t)),e},loop:function(){var t,e,n,i=this,r=arguments;if(0===r.length)return i._loop;if(1===r.length){if("boolean"!==typeof r[0])return!!(n=i._soundById(parseInt(r[0],10)))&&n._loop;t=r[0],i._loop=t}else 2===r.length&&(t=r[0],e=parseInt(r[1],10));for(var a=i._getSoundIds(e),o=0;o<a.length;o++)(n=i._soundById(a[o]))&&(n._loop=t,i._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=t,t&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,i.playing(a[o])&&(i.pause(a[o],!0),i.play(a[o],!0)))));return i},rate:function(){var t,e,n,i=this,r=arguments;if(0===r.length)e=i._sounds[0]._id;else if(1===r.length){var o=i._getSoundIds(),s=o.indexOf(r[0]);s>=0?e=parseInt(r[0],10):t=parseFloat(r[0])}else 2===r.length&&(t=parseFloat(r[0]),e=parseInt(r[1],10));if("number"!==typeof t)return(n=i._soundById(e))?n._rate:i._rate;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,r)}}),i;"undefined"===typeof e&&(i._rate=t),e=i._getSoundIds(e);for(var l=0;l<e.length;l++)if(n=i._soundById(e[l])){i.playing(e[l])&&(n._rateSeek=i.seek(e[l]),n._playStart=i._webAudio?a.ctx.currentTime:n._playStart),n._rate=t,i._webAudio&&n._node&&n._node.bufferSource?n._node.bufferSource.playbackRate.setValueAtTime(t,a.ctx.currentTime):n._node&&(n._node.playbackRate=t);var u=i.seek(e[l]),h=(i._sprite[n._sprite][0]+i._sprite[n._sprite][1])/1e3-u,c=1e3*h/Math.abs(n._rate);!i._endTimers[e[l]]&&n._paused||(i._clearTimer(e[l]),i._endTimers[e[l]]=setTimeout(i._ended.bind(i,n),c)),i._emit("rate",n._id)}return i},seek:function(){var t,e,n=this,i=arguments;if(0===i.length)n._sounds.length&&(e=n._sounds[0]._id);else if(1===i.length){var r=n._getSoundIds(),o=r.indexOf(i[0]);o>=0?e=parseInt(i[0],10):n._sounds.length&&(e=n._sounds[0]._id,t=parseFloat(i[0]))}else 2===i.length&&(t=parseFloat(i[0]),e=parseInt(i[1],10));if("undefined"===typeof e)return 0;if("number"===typeof t&&("loaded"!==n._state||n._playLock))return n._queue.push({event:"seek",action:function(){n.seek.apply(n,i)}}),n;var s=n._soundById(e);if(s){if(!("number"===typeof t&&t>=0)){if(n._webAudio){var l=n.playing(e)?a.ctx.currentTime-s._playStart:0,u=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(u+l*Math.abs(s._rate))}return s._node.currentTime}var h=n.playing(e);h&&n.pause(e,!0),s._seek=t,s._ended=!1,n._clearTimer(e),n._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=t);var c=function(){h&&n.play(e,!0),n._emit("seek",e)};if(h&&!n._webAudio){var d=function t(){n._playLock?setTimeout(t,0):c()};setTimeout(d,0)}else c()}return n},playing:function(t){var e=this;if("number"===typeof t){var n=e._soundById(t);return!!n&&!n._paused}for(var i=0;i<e._sounds.length;i++)if(!e._sounds[i]._paused)return!0;return!1},duration:function(t){var e=this,n=e._duration,i=e._soundById(t);return i&&(n=e._sprite[i._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,e=t._sounds,n=0;n<e.length;n++)e[n]._paused||t.stop(e[n]._id),t._webAudio||(t._clearSound(e[n]._node),e[n]._node.removeEventListener("error",e[n]._errorFn,!1),e[n]._node.removeEventListener(a._canPlayEvent,e[n]._loadFn,!1),e[n]._node.removeEventListener("ended",e[n]._endFn,!1),a._releaseHtml5Audio(e[n]._node)),delete e[n]._node,t._clearTimer(e[n]._id);var i=a._howls.indexOf(t);i>=0&&a._howls.splice(i,1);var r=!0;for(n=0;n<a._howls.length;n++)if(a._howls[n]._src===t._src||t._src.indexOf(a._howls[n]._src)>=0){r=!1;break}return l&&r&&delete l[t._src],a.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,e,n,i){var r=this["_on"+t];return"function"===typeof e&&r.push(i?{id:n,fn:e,once:i}:{id:n,fn:e}),this},off:function(t,e,n){var i=this,r=i["_on"+t],a=0;if("number"===typeof e&&(n=e,e=null),e||n)for(a=0;a<r.length;a++){var o=n===r[a].id;if(e===r[a].fn&&o||!e&&o){r.splice(a,1);break}}else if(t)i["_on"+t]=[];else{var s=Object.keys(i);for(a=0;a<s.length;a++)0===s[a].indexOf("_on")&&Array.isArray(i[s[a]])&&(i[s[a]]=[])}return i},once:function(t,e,n){return this.on(t,e,n,1),this},_emit:function(t,e,n){for(var i=this,r=i["_on"+t],a=r.length-1;a>=0;a--)r[a].id&&r[a].id!==e&&"load"!==t||(setTimeout(function(t){t.call(this,e,n)}.bind(i,r[a].fn),0),r[a].once&&i.off(t,r[a].fn,r[a].id));return i._loadQueue(t),i},_loadQueue:function(t){var e=this;if(e._queue.length>0){var n=e._queue[0];n.event===t&&(e._queue.shift(),e._loadQueue()),t||n.action()}return e},_ended:function(t){var e=this,n=t._sprite;if(!e._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(e._ended.bind(e,t),100),e;var i=!(!t._loop&&!e._sprite[n][2]);if(e._emit("end",t._id),!e._webAudio&&i&&e.stop(t._id,!0).play(t._id),e._webAudio&&i){e._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=a.ctx.currentTime;var r=1e3*(t._stop-t._start)/Math.abs(t._rate);e._endTimers[t._id]=setTimeout(e._ended.bind(e,t),r)}return e._webAudio&&!i&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,e._clearTimer(t._id),e._cleanBuffer(t._node),a._autoSuspend()),e._webAudio||i||e.stop(t._id,!0),e},_clearTimer:function(t){var e=this;if(e._endTimers[t]){if("function"!==typeof e._endTimers[t])clearTimeout(e._endTimers[t]);else{var n=e._soundById(t);n&&n._node&&n._node.removeEventListener("ended",e._endTimers[t],!1)}delete e._endTimers[t]}return e},_soundById:function(t){for(var e=this,n=0;n<e._sounds.length;n++)if(t===e._sounds[n]._id)return e._sounds[n];return null},_inactiveSound:function(){var t=this;t._drain();for(var e=0;e<t._sounds.length;e++)if(t._sounds[e]._ended)return t._sounds[e].reset();return new s(t)},_drain:function(){var t=this,e=t._pool,n=0,i=0;if(!(t._sounds.length<e)){for(i=0;i<t._sounds.length;i++)t._sounds[i]._ended&&n++;for(i=t._sounds.length-1;i>=0;i--){if(n<=e)return;t._sounds[i]._ended&&(t._webAudio&&t._sounds[i]._node&&t._sounds[i]._node.disconnect(0),t._sounds.splice(i,1),n--)}}},_getSoundIds:function(t){if("undefined"===typeof t){for(var e=[],n=0;n<this._sounds.length;n++)e.push(this._sounds[n]._id);return e}return[t]},_refreshBuffer:function(t){return t._node.bufferSource=a.ctx.createBufferSource(),t._node.bufferSource.buffer=l[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,a.ctx.currentTime),this},_cleanBuffer:function(t){var e=a._navigator&&a._navigator.vendor.indexOf("Apple")>=0;if(!t.bufferSource)return this;if(a._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),e))try{t.bufferSource.buffer=a._scratchBuffer}catch(n){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(a._navigator&&a._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(t){this._parent=t,this.init()};s.prototype={init:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++a._counter,e._sounds.push(t),t.create(),t},create:function(){var t=this,e=t._parent,n=a._muted||t._muted||t._parent._muted?0:t._volume;return e._webAudio?(t._node="undefined"===typeof a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),t._node.gain.setValueAtTime(n,a.ctx.currentTime),t._node.paused=!0,t._node.connect(a.masterGain)):a.noAudio||(t._node=a._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(a._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=e._src,t._node.preload=!0===e._preload?"auto":e._preload,t._node.volume=n*a.volume(),t._node.load()),t},reset:function(){var t=this,e=t._parent;return t._muted=e._muted,t._loop=e._loop,t._volume=e._volume,t._rate=e._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++a._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,e=t._parent;e._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue()),t._node.removeEventListener(a._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,e=t._parent;e._duration===1/0&&(e._duration=Math.ceil(10*t._node.duration)/10,e._sprite.__default[1]===1/0&&(e._sprite.__default[1]=1e3*e._duration),e._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var l={},u=function(t){var e=t._src;if(l[e])return t._duration=l[e].duration,void d(t);if(/^data:[^;]+;base64,/.test(e)){for(var n=atob(e.split(",")[1]),i=new Uint8Array(n.length),r=0;r<n.length;++r)i[r]=n.charCodeAt(r);c(i.buffer,t)}else{var a=new XMLHttpRequest;a.open(t._xhr.method,e,!0),a.withCredentials=t._xhr.withCredentials,a.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach((function(e){a.setRequestHeader(e,t._xhr.headers[e])})),a.onload=function(){var e=(a.status+"")[0];"0"===e||"2"===e||"3"===e?c(a.response,t):t._emit("loaderror",null,"Failed loading audio file with status: "+a.status+".")},a.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete l[e],t.load())},h(a)}},h=function(t){try{t.send()}catch(e){t.onerror()}},c=function(t,e){var n=function(){e._emit("loaderror",null,"Decoding audio data failed.")},i=function(t){t&&e._sounds.length>0?(l[e._src]=t,d(e,t)):n()};"undefined"!==typeof Promise&&1===a.ctx.decodeAudioData.length?a.ctx.decodeAudioData(t).then(i).catch(n):a.ctx.decodeAudioData(t,i,n)},d=function(t,e){e&&!t._duration&&(t._duration=e.duration),0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue())},f=function(){if(a.usingWebAudio){try{"undefined"!==typeof AudioContext?a.ctx=new AudioContext:"undefined"!==typeof webkitAudioContext?a.ctx=new webkitAudioContext:a.usingWebAudio=!1}catch(r){a.usingWebAudio=!1}a.ctx||(a.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(a._navigator&&a._navigator.platform),e=a._navigator&&a._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=e?parseInt(e[1],10):null;if(t&&n&&n<9){var i=/safari/.test(a._navigator&&a._navigator.userAgent.toLowerCase());a._navigator&&!i&&(a.usingWebAudio=!1)}a.usingWebAudio&&(a.masterGain="undefined"===typeof a.ctx.createGain?a.ctx.createGainNode():a.ctx.createGain(),a.masterGain.gain.setValueAtTime(a._muted?0:a._volume,a.ctx.currentTime),a.masterGain.connect(a.ctx.destination)),a._setup()}};void 0===(i=function(){return{Howler:a,Howl:o}}.apply(e,[]))||(t.exports=i),e.Howler=a,e.Howl=o,"undefined"!==typeof n.g?(n.g.HowlerGlobal=r,n.g.Howler=a,n.g.Howl=o,n.g.Sound=s):"undefined"!==typeof window&&(window.HowlerGlobal=r,window.Howler=a,window.Howl=o,window.Sound=s)}(),function(){"use strict";var t;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var e=this;if(!e.ctx||!e.ctx.listener)return e;for(var n=e._howls.length-1;n>=0;n--)e._howls[n].stereo(t);return e},HowlerGlobal.prototype.pos=function(t,e,n){var i=this;return i.ctx&&i.ctx.listener?(e="number"!==typeof e?i._pos[1]:e,n="number"!==typeof n?i._pos[2]:n,"number"!==typeof t?i._pos:(i._pos=[t,e,n],"undefined"!==typeof i.ctx.listener.positionX?(i.ctx.listener.positionX.setTargetAtTime(i._pos[0],Howler.ctx.currentTime,.1),i.ctx.listener.positionY.setTargetAtTime(i._pos[1],Howler.ctx.currentTime,.1),i.ctx.listener.positionZ.setTargetAtTime(i._pos[2],Howler.ctx.currentTime,.1)):i.ctx.listener.setPosition(i._pos[0],i._pos[1],i._pos[2]),i)):i},HowlerGlobal.prototype.orientation=function(t,e,n,i,r,a){var o=this;if(!o.ctx||!o.ctx.listener)return o;var s=o._orientation;return e="number"!==typeof e?s[1]:e,n="number"!==typeof n?s[2]:n,i="number"!==typeof i?s[3]:i,r="number"!==typeof r?s[4]:r,a="number"!==typeof a?s[5]:a,"number"!==typeof t?s:(o._orientation=[t,e,n,i,r,a],"undefined"!==typeof o.ctx.listener.forwardX?(o.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),o.ctx.listener.forwardY.setTargetAtTime(e,Howler.ctx.currentTime,.1),o.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),o.ctx.listener.upX.setTargetAtTime(i,Howler.ctx.currentTime,.1),o.ctx.listener.upY.setTargetAtTime(r,Howler.ctx.currentTime,.1),o.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):o.ctx.listener.setOrientation(t,e,n,i,r,a),o)},Howl.prototype.init=(t=Howl.prototype.init,function(e){var n=this;return n._orientation=e.orientation||[1,0,0],n._stereo=e.stereo||null,n._pos=e.pos||null,n._pannerAttr={coneInnerAngle:"undefined"!==typeof e.coneInnerAngle?e.coneInnerAngle:360,coneOuterAngle:"undefined"!==typeof e.coneOuterAngle?e.coneOuterAngle:360,coneOuterGain:"undefined"!==typeof e.coneOuterGain?e.coneOuterGain:0,distanceModel:"undefined"!==typeof e.distanceModel?e.distanceModel:"inverse",maxDistance:"undefined"!==typeof e.maxDistance?e.maxDistance:1e4,panningModel:"undefined"!==typeof e.panningModel?e.panningModel:"HRTF",refDistance:"undefined"!==typeof e.refDistance?e.refDistance:1,rolloffFactor:"undefined"!==typeof e.rolloffFactor?e.rolloffFactor:1},n._onstereo=e.onstereo?[{fn:e.onstereo}]:[],n._onpos=e.onpos?[{fn:e.onpos}]:[],n._onorientation=e.onorientation?[{fn:e.onorientation}]:[],t.call(this,e)}),Howl.prototype.stereo=function(t,n){var i=this;if(!i._webAudio)return i;if("loaded"!==i._state)return i._queue.push({event:"stereo",action:function(){i.stereo(t,n)}}),i;var r="undefined"===typeof Howler.ctx.createStereoPanner?"spatial":"stereo";if("undefined"===typeof n){if("number"!==typeof t)return i._stereo;i._stereo=t,i._pos=[t,0,0]}for(var a=i._getSoundIds(n),o=0;o<a.length;o++){var s=i._soundById(a[o]);if(s){if("number"!==typeof t)return s._stereo;s._stereo=t,s._pos=[t,0,0],s._node&&(s._pannerAttr.panningModel="equalpower",s._panner&&s._panner.pan||e(s,r),"spatial"===r?"undefined"!==typeof s._panner.positionX?(s._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),s._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),s._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):s._panner.setPosition(t,0,0):s._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),i._emit("stereo",s._id)}}return i},Howl.prototype.pos=function(t,n,i,r){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"pos",action:function(){a.pos(t,n,i,r)}}),a;if(n="number"!==typeof n?0:n,i="number"!==typeof i?-.5:i,"undefined"===typeof r){if("number"!==typeof t)return a._pos;a._pos=[t,n,i]}for(var o=a._getSoundIds(r),s=0;s<o.length;s++){var l=a._soundById(o[s]);if(l){if("number"!==typeof t)return l._pos;l._pos=[t,n,i],l._node&&(l._panner&&!l._panner.pan||e(l,"spatial"),"undefined"!==typeof l._panner.positionX?(l._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setPosition(t,n,i)),a._emit("pos",l._id)}}return a},Howl.prototype.orientation=function(t,n,i,r){var a=this;if(!a._webAudio)return a;if("loaded"!==a._state)return a._queue.push({event:"orientation",action:function(){a.orientation(t,n,i,r)}}),a;if(n="number"!==typeof n?a._orientation[1]:n,i="number"!==typeof i?a._orientation[2]:i,"undefined"===typeof r){if("number"!==typeof t)return a._orientation;a._orientation=[t,n,i]}for(var o=a._getSoundIds(r),s=0;s<o.length;s++){var l=a._soundById(o[s]);if(l){if("number"!==typeof t)return l._orientation;l._orientation=[t,n,i],l._node&&(l._panner||(l._pos||(l._pos=a._pos||[0,0,-.5]),e(l,"spatial")),"undefined"!==typeof l._panner.orientationX?(l._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):l._panner.setOrientation(t,n,i)),a._emit("orientation",l._id)}}return a},Howl.prototype.pannerAttr=function(){var t,n,i,r=this,a=arguments;if(!r._webAudio)return r;if(0===a.length)return r._pannerAttr;if(1===a.length){if("object"!==typeof a[0])return(i=r._soundById(parseInt(a[0],10)))?i._pannerAttr:r._pannerAttr;t=a[0],"undefined"===typeof n&&(t.pannerAttr||(t.pannerAttr={coneInnerAngle:t.coneInnerAngle,coneOuterAngle:t.coneOuterAngle,coneOuterGain:t.coneOuterGain,distanceModel:t.distanceModel,maxDistance:t.maxDistance,refDistance:t.refDistance,rolloffFactor:t.rolloffFactor,panningModel:t.panningModel}),r._pannerAttr={coneInnerAngle:"undefined"!==typeof t.pannerAttr.coneInnerAngle?t.pannerAttr.coneInnerAngle:r._coneInnerAngle,coneOuterAngle:"undefined"!==typeof t.pannerAttr.coneOuterAngle?t.pannerAttr.coneOuterAngle:r._coneOuterAngle,coneOuterGain:"undefined"!==typeof t.pannerAttr.coneOuterGain?t.pannerAttr.coneOuterGain:r._coneOuterGain,distanceModel:"undefined"!==typeof t.pannerAttr.distanceModel?t.pannerAttr.distanceModel:r._distanceModel,maxDistance:"undefined"!==typeof t.pannerAttr.maxDistance?t.pannerAttr.maxDistance:r._maxDistance,refDistance:"undefined"!==typeof t.pannerAttr.refDistance?t.pannerAttr.refDistance:r._refDistance,rolloffFactor:"undefined"!==typeof t.pannerAttr.rolloffFactor?t.pannerAttr.rolloffFactor:r._rolloffFactor,panningModel:"undefined"!==typeof t.pannerAttr.panningModel?t.pannerAttr.panningModel:r._panningModel})}else 2===a.length&&(t=a[0],n=parseInt(a[1],10));for(var o=r._getSoundIds(n),s=0;s<o.length;s++)if(i=r._soundById(o[s])){var l=i._pannerAttr;l={coneInnerAngle:"undefined"!==typeof t.coneInnerAngle?t.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:"undefined"!==typeof t.coneOuterAngle?t.coneOuterAngle:l.coneOuterAngle,coneOuterGain:"undefined"!==typeof t.coneOuterGain?t.coneOuterGain:l.coneOuterGain,distanceModel:"undefined"!==typeof t.distanceModel?t.distanceModel:l.distanceModel,maxDistance:"undefined"!==typeof t.maxDistance?t.maxDistance:l.maxDistance,refDistance:"undefined"!==typeof t.refDistance?t.refDistance:l.refDistance,rolloffFactor:"undefined"!==typeof t.rolloffFactor?t.rolloffFactor:l.rolloffFactor,panningModel:"undefined"!==typeof t.panningModel?t.panningModel:l.panningModel};var u=i._panner;u||(i._pos||(i._pos=r._pos||[0,0,-.5]),e(i,"spatial"),u=i._panner),u.coneInnerAngle=l.coneInnerAngle,u.coneOuterAngle=l.coneOuterAngle,u.coneOuterGain=l.coneOuterGain,u.distanceModel=l.distanceModel,u.maxDistance=l.maxDistance,u.refDistance=l.refDistance,u.rolloffFactor=l.rolloffFactor,u.panningModel=l.panningModel}return r},Sound.prototype.init=function(t){return function(){var e=this,n=e._parent;e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,t.call(this),e._stereo?n.stereo(e._stereo):e._pos&&n.pos(e._pos[0],e._pos[1],e._pos[2],e._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var e=this,n=e._parent;return e._orientation=n._orientation,e._stereo=n._stereo,e._pos=n._pos,e._pannerAttr=n._pannerAttr,e._stereo?n.stereo(e._stereo):e._pos?n.pos(e._pos[0],e._pos[1],e._pos[2],e._id):e._panner&&(e._panner.disconnect(0),e._panner=void 0,n._refreshBuffer(e)),t.call(this)}}(Sound.prototype.reset);var e=function(t,e){"spatial"===(e=e||"spatial")?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,"undefined"!==typeof t._panner.positionX?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),"undefined"!==typeof t._panner.orientationX?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}}()},725:function(t){"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function r(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(r){return!1}}()?Object.assign:function(t,a){for(var o,s,l=r(t),u=1;u<arguments.length;u++){for(var h in o=Object(arguments[u]))n.call(o,h)&&(l[h]=o[h]);if(e){s=e(o);for(var c=0;c<s.length;c++)i.call(o,s[c])&&(l[s[c]]=o[s[c]])}}return l}},584:function(t,e,n){var i="function"===typeof Map&&Map.prototype,r=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,a=i&&r&&"function"===typeof r.get?r.get:null,o=i&&Map.prototype.forEach,s="function"===typeof Set&&Set.prototype,l=Object.getOwnPropertyDescriptor&&s?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=s&&l&&"function"===typeof l.get?l.get:null,h=s&&Set.prototype.forEach,c="function"===typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,d="function"===typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"===typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,v=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,y="function"===typeof BigInt?BigInt.prototype.valueOf:null,_=Object.getOwnPropertySymbols,x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?Symbol.prototype.toString:null,b="function"===typeof Symbol&&"object"===typeof Symbol.iterator,w=Object.prototype.propertyIsEnumerable,S=("function"===typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null),T=n(654).custom,M=T&&k(T)?T:null,E="function"===typeof Symbol&&"undefined"!==typeof Symbol.toStringTag?Symbol.toStringTag:null;function A(t,e,n){var i="double"===(n.quoteStyle||e)?'"':"'";return i+t+i}function P(t){return String(t).replace(/"/g,"&quot;")}function C(t){return"[object Array]"===D(t)&&(!E||!("object"===typeof t&&E in t))}function k(t){if(b)return t&&"object"===typeof t&&t instanceof Symbol;if("symbol"===typeof t)return!0;if(!t||"object"!==typeof t||!x)return!1;try{return x.call(t),!0}catch(e){}return!1}t.exports=function t(e,n,i,r){var s=n||{};if(I(s,"quoteStyle")&&"single"!==s.quoteStyle&&"double"!==s.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(I(s,"maxStringLength")&&("number"===typeof s.maxStringLength?s.maxStringLength<0&&s.maxStringLength!==1/0:null!==s.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var l=!I(s,"customInspect")||s.customInspect;if("boolean"!==typeof l&&"symbol"!==l)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(I(s,"indent")&&null!==s.indent&&"\t"!==s.indent&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`');if("undefined"===typeof e)return"undefined";if(null===e)return"null";if("boolean"===typeof e)return e?"true":"false";if("string"===typeof e)return L(e,s);if("number"===typeof e)return 0===e?1/0/e>0?"0":"-0":String(e);if("bigint"===typeof e)return String(e)+"n";var v="undefined"===typeof s.depth?5:s.depth;if("undefined"===typeof i&&(i=0),i>=v&&v>0&&"object"===typeof e)return C(e)?"[Array]":"[Object]";var _=function(t,e){var n;if("\t"===t.indent)n="\t";else{if(!("number"===typeof t.indent&&t.indent>0))return null;n=Array(t.indent+1).join(" ")}return{base:n,prev:Array(e+1).join(n)}}(s,i);if("undefined"===typeof r)r=[];else if(O(r,e)>=0)return"[Circular]";function w(e,n,a){if(n&&(r=r.slice()).push(n),a){var o={depth:s.depth};return I(s,"quoteStyle")&&(o.quoteStyle=s.quoteStyle),t(e,o,i+1,r)}return t(e,s,i+1,r)}if("function"===typeof e){var T=function(t){if(t.name)return t.name;var e=g.call(m.call(t),/^function\s*([\w$]+)/);if(e)return e[1];return null}(e),R=z(e,w);return"[Function"+(T?": "+T:" (anonymous)")+"]"+(R.length>0?" { "+R.join(", ")+" }":"")}if(k(e)){var N=b?String(e).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):x.call(e);return"object"!==typeof e||b?N:F(N)}if(function(t){if(!t||"object"!==typeof t)return!1;if("undefined"!==typeof HTMLElement&&t instanceof HTMLElement)return!0;return"string"===typeof t.nodeName&&"function"===typeof t.getAttribute}(e)){for(var H="<"+String(e.nodeName).toLowerCase(),V=e.attributes||[],j=0;j<V.length;j++)H+=" "+V[j].name+"="+A(P(V[j].value),"double",s);return H+=">",e.childNodes&&e.childNodes.length&&(H+="..."),H+="</"+String(e.nodeName).toLowerCase()+">"}if(C(e)){if(0===e.length)return"[]";var X=z(e,w);return _&&!function(t){for(var e=0;e<t.length;e++)if(O(t[e],"\n")>=0)return!1;return!0}(X)?"["+G(X,_)+"]":"[ "+X.join(", ")+" ]"}if(function(t){return"[object Error]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e)){var W=z(e,w);return 0===W.length?"["+String(e)+"]":"{ ["+String(e)+"] "+W.join(", ")+" }"}if("object"===typeof e&&l){if(M&&"function"===typeof e[M])return e[M]();if("symbol"!==l&&"function"===typeof e.inspect)return e.inspect()}if(function(t){if(!a||!t||"object"!==typeof t)return!1;try{a.call(t);try{u.call(t)}catch(H){return!0}return t instanceof Map}catch(e){}return!1}(e)){var q=[];return o.call(e,(function(t,n){q.push(w(n,e,!0)+" => "+w(t,e))})),U("Map",a.call(e),q,_)}if(function(t){if(!u||!t||"object"!==typeof t)return!1;try{u.call(t);try{a.call(t)}catch(e){return!0}return t instanceof Set}catch(n){}return!1}(e)){var Y=[];return h.call(e,(function(t){Y.push(w(t,e))})),U("Set",u.call(e),Y,_)}if(function(t){if(!c||!t||"object"!==typeof t)return!1;try{c.call(t,c);try{d.call(t,d)}catch(H){return!0}return t instanceof WeakMap}catch(e){}return!1}(e))return B("WeakMap");if(function(t){if(!d||!t||"object"!==typeof t)return!1;try{d.call(t,d);try{c.call(t,c)}catch(H){return!0}return t instanceof WeakSet}catch(e){}return!1}(e))return B("WeakSet");if(function(t){if(!f||!t||"object"!==typeof t)return!1;try{return f.call(t),!0}catch(e){}return!1}(e))return B("WeakRef");if(function(t){return"[object Number]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e))return F(w(Number(e)));if(function(t){if(!t||"object"!==typeof t||!y)return!1;try{return y.call(t),!0}catch(e){}return!1}(e))return F(w(y.call(e)));if(function(t){return"[object Boolean]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e))return F(p.call(e));if(function(t){return"[object String]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e))return F(w(String(e)));if(!function(t){return"[object Date]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e)&&!function(t){return"[object RegExp]"===D(t)&&(!E||!("object"===typeof t&&E in t))}(e)){var K=z(e,w),Z=S?S(e)===Object.prototype:e instanceof Object||e.constructor===Object,J=e instanceof Object?"":"null prototype",Q=!Z&&E&&Object(e)===e&&E in e?D(e).slice(8,-1):J?"Object":"",$=(Z||"function"!==typeof e.constructor?"":e.constructor.name?e.constructor.name+" ":"")+(Q||J?"["+[].concat(Q||[],J||[]).join(": ")+"] ":"");return 0===K.length?$+"{}":_?$+"{"+G(K,_)+"}":$+"{ "+K.join(", ")+" }"}return String(e)};var R=Object.prototype.hasOwnProperty||function(t){return t in this};function I(t,e){return R.call(t,e)}function D(t){return v.call(t)}function O(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function L(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,i="... "+n+" more character"+(n>1?"s":"");return L(t.slice(0,e.maxStringLength),e)+i}return A(t.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,N),"single",e)}function N(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+e.toString(16).toUpperCase()}function F(t){return"Object("+t+")"}function B(t){return t+" { ? }"}function U(t,e,n,i){return t+" ("+e+") {"+(i?G(n,i):n.join(", "))+"}"}function G(t,e){if(0===t.length)return"";var n="\n"+e.prev+e.base;return n+t.join(","+n)+"\n"+e.prev}function z(t,e){var n=C(t),i=[];if(n){i.length=t.length;for(var r=0;r<t.length;r++)i[r]=I(t,r)?e(t[r],t):""}var a,o="function"===typeof _?_(t):[];if(b){a={};for(var s=0;s<o.length;s++)a["$"+o[s]]=o[s]}for(var l in t)I(t,l)&&(n&&String(Number(l))===l&&l<t.length||b&&a["$"+l]instanceof Symbol||(/[^\w$]/.test(l)?i.push(e(l,t)+": "+e(t[l],t)):i.push(l+": "+e(t[l],t))));if("function"===typeof _)for(var u=0;u<o.length;u++)w.call(t,o[u])&&i.push("["+e(o[u])+"]: "+e(t[o[u]],t));return i}},581:function(t,e,n){"use strict";var i=n(506),r=n(37),a=n(584),o=i("%TypeError%"),s=i("%WeakMap%",!0),l=i("%Map%",!0),u=r("WeakMap.prototype.get",!0),h=r("WeakMap.prototype.set",!0),c=r("WeakMap.prototype.has",!0),d=r("Map.prototype.get",!0),f=r("Map.prototype.set",!0),p=r("Map.prototype.has",!0),v=function(t,e){for(var n,i=t;null!==(n=i.next);i=n)if(n.key===e)return i.next=n.next,n.next=t.next,t.next=n,n};t.exports=function(){var t,e,n,i={assert:function(t){if(!i.has(t))throw new o("Side channel does not contain "+a(t))},get:function(i){if(s&&i&&("object"===typeof i||"function"===typeof i)){if(t)return u(t,i)}else if(l){if(e)return d(e,i)}else if(n)return function(t,e){var n=v(t,e);return n&&n.value}(n,i)},has:function(i){if(s&&i&&("object"===typeof i||"function"===typeof i)){if(t)return c(t,i)}else if(l){if(e)return p(e,i)}else if(n)return function(t,e){return!!v(t,e)}(n,i);return!1},set:function(i,r){s&&i&&("object"===typeof i||"function"===typeof i)?(t||(t=new s),h(t,i,r)):l?(e||(e=new l),f(e,i,r)):(n||(n={key:{},next:null}),function(t,e,n){var i=v(t,e);i?i.value=n:t.next={key:e,next:t.next,value:n}}(n,i,r))}};return i}},369:function(t,e,n){var i;t=n.nmd(t),function(r){e&&e.nodeType,t&&t.nodeType;var a="object"==typeof n.g&&n.g;a.global!==a&&a.window!==a&&a.self;var o,s=2147483647,l=36,u=/^xn--/,h=/[^\x20-\x7E]/,c=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function v(t){throw new RangeError(d[t])}function m(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}function g(t,e){var n=t.split("@"),i="";return n.length>1&&(i=n[0]+"@",t=n[1]),i+m((t=t.replace(c,".")).split("."),e).join(".")}function y(t){for(var e,n,i=[],r=0,a=t.length;r<a;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<a?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}function _(t){return m(t,(function(t){var e="";return t>65535&&(e+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=p(t)})).join("")}function x(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function b(t,e,n){var i=0;for(t=n?f(t/700):t>>1,t+=f(t/e);t>455;i+=l)t=f(t/35);return f(i+36*t/(t+38))}function w(t){var e,n,i,r,a,o,u,h,c,d,p,m=[],g=t.length,y=0,x=128,w=72;for((n=t.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)t.charCodeAt(i)>=128&&v("not-basic"),m.push(t.charCodeAt(i));for(r=n>0?n+1:0;r<g;){for(a=y,o=1,u=l;r>=g&&v("invalid-input"),((h=(p=t.charCodeAt(r++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:l)>=l||h>f((s-y)/o))&&v("overflow"),y+=h*o,!(h<(c=u<=w?1:u>=w+26?26:u-w));u+=l)o>f(s/(d=l-c))&&v("overflow"),o*=d;w=b(y-a,e=m.length+1,0==a),f(y/e)>s-x&&v("overflow"),x+=f(y/e),y%=e,m.splice(y++,0,x)}return _(m)}function S(t){var e,n,i,r,a,o,u,h,c,d,m,g,_,w,S,T=[];for(g=(t=y(t)).length,e=128,n=0,a=72,o=0;o<g;++o)(m=t[o])<128&&T.push(p(m));for(i=r=T.length,r&&T.push("-");i<g;){for(u=s,o=0;o<g;++o)(m=t[o])>=e&&m<u&&(u=m);for(u-e>f((s-n)/(_=i+1))&&v("overflow"),n+=(u-e)*_,e=u,o=0;o<g;++o)if((m=t[o])<e&&++n>s&&v("overflow"),m==e){for(h=n,c=l;!(h<(d=c<=a?1:c>=a+26?26:c-a));c+=l)S=h-d,w=l-d,T.push(p(x(d+S%w,0))),h=f(S/w);T.push(p(x(h,0))),a=b(n,_,i==r),n=0,++i}++n,++e}return T.join("")}o={version:"1.4.1",ucs2:{decode:y,encode:_},decode:w,encode:S,toASCII:function(t){return g(t,(function(t){return h.test(t)?"xn--"+S(t):t}))},toUnicode:function(t){return g(t,(function(t){return u.test(t)?w(t.slice(4).toLowerCase()):t}))}},void 0===(i=function(){return o}.call(e,n,e,t))||(t.exports=i)}()},951:function(t){"use strict";var e=String.prototype.replace,n=/%20/g,i="RFC1738",r="RFC3986";t.exports={default:r,formatters:{RFC1738:function(t){return e.call(t,n,"+")},RFC3986:function(t){return String(t)}},RFC1738:i,RFC3986:r}},915:function(t,e,n){"use strict";var i=n(34),r=n(580),a=n(951);t.exports={formats:a,parse:r,stringify:i}},580:function(t,e,n){"use strict";var i=n(838),r=Object.prototype.hasOwnProperty,a=Array.isArray,o={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:i.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},s=function(t){return t.replace(/&#(\d+);/g,(function(t,e){return String.fromCharCode(parseInt(e,10))}))},l=function(t,e){return t&&"string"===typeof t&&e.comma&&t.indexOf(",")>-1?t.split(","):t},u=function(t,e,n,i){if(t){var a=n.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,o=/(\[[^[\]]*])/g,s=n.depth>0&&/(\[[^[\]]*])/.exec(a),u=s?a.slice(0,s.index):a,h=[];if(u){if(!n.plainObjects&&r.call(Object.prototype,u)&&!n.allowPrototypes)return;h.push(u)}for(var c=0;n.depth>0&&null!==(s=o.exec(a))&&c<n.depth;){if(c+=1,!n.plainObjects&&r.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;h.push(s[1])}return s&&h.push("["+a.slice(s.index)+"]"),function(t,e,n,i){for(var r=i?e:l(e,n),a=t.length-1;a>=0;--a){var o,s=t[a];if("[]"===s&&n.parseArrays)o=[].concat(r);else{o=n.plainObjects?Object.create(null):{};var u="["===s.charAt(0)&&"]"===s.charAt(s.length-1)?s.slice(1,-1):s,h=parseInt(u,10);n.parseArrays||""!==u?!isNaN(h)&&s!==u&&String(h)===u&&h>=0&&n.parseArrays&&h<=n.arrayLimit?(o=[])[h]=r:"__proto__"!==u&&(o[u]=r):o={0:r}}r=o}return r}(h,e,n,i)}};t.exports=function(t,e){var n=function(t){if(!t)return o;if(null!==t.decoder&&void 0!==t.decoder&&"function"!==typeof t.decoder)throw new TypeError("Decoder has to be a function.");if("undefined"!==typeof t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e="undefined"===typeof t.charset?o.charset:t.charset;return{allowDots:"undefined"===typeof t.allowDots?o.allowDots:!!t.allowDots,allowPrototypes:"boolean"===typeof t.allowPrototypes?t.allowPrototypes:o.allowPrototypes,allowSparse:"boolean"===typeof t.allowSparse?t.allowSparse:o.allowSparse,arrayLimit:"number"===typeof t.arrayLimit?t.arrayLimit:o.arrayLimit,charset:e,charsetSentinel:"boolean"===typeof t.charsetSentinel?t.charsetSentinel:o.charsetSentinel,comma:"boolean"===typeof t.comma?t.comma:o.comma,decoder:"function"===typeof t.decoder?t.decoder:o.decoder,delimiter:"string"===typeof t.delimiter||i.isRegExp(t.delimiter)?t.delimiter:o.delimiter,depth:"number"===typeof t.depth||!1===t.depth?+t.depth:o.depth,ignoreQueryPrefix:!0===t.ignoreQueryPrefix,interpretNumericEntities:"boolean"===typeof t.interpretNumericEntities?t.interpretNumericEntities:o.interpretNumericEntities,parameterLimit:"number"===typeof t.parameterLimit?t.parameterLimit:o.parameterLimit,parseArrays:!1!==t.parseArrays,plainObjects:"boolean"===typeof t.plainObjects?t.plainObjects:o.plainObjects,strictNullHandling:"boolean"===typeof t.strictNullHandling?t.strictNullHandling:o.strictNullHandling}}(e);if(""===t||null===t||"undefined"===typeof t)return n.plainObjects?Object.create(null):{};for(var h="string"===typeof t?function(t,e){var n,u={__proto__:null},h=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,c=e.parameterLimit===1/0?void 0:e.parameterLimit,d=h.split(e.delimiter,c),f=-1,p=e.charset;if(e.charsetSentinel)for(n=0;n<d.length;++n)0===d[n].indexOf("utf8=")&&("utf8=%E2%9C%93"===d[n]?p="utf-8":"utf8=%26%2310003%3B"===d[n]&&(p="iso-8859-1"),f=n,n=d.length);for(n=0;n<d.length;++n)if(n!==f){var v,m,g=d[n],y=g.indexOf("]="),_=-1===y?g.indexOf("="):y+1;-1===_?(v=e.decoder(g,o.decoder,p,"key"),m=e.strictNullHandling?null:""):(v=e.decoder(g.slice(0,_),o.decoder,p,"key"),m=i.maybeMap(l(g.slice(_+1),e),(function(t){return e.decoder(t,o.decoder,p,"value")}))),m&&e.interpretNumericEntities&&"iso-8859-1"===p&&(m=s(m)),g.indexOf("[]=")>-1&&(m=a(m)?[m]:m),r.call(u,v)?u[v]=i.combine(u[v],m):u[v]=m}return u}(t,n):t,c=n.plainObjects?Object.create(null):{},d=Object.keys(h),f=0;f<d.length;++f){var p=d[f],v=u(p,h[p],n,"string"===typeof t);c=i.merge(c,v,n)}return!0===n.allowSparse?c:i.compact(c)}},34:function(t,e,n){"use strict";var i=n(581),r=n(838),a=n(951),o=Object.prototype.hasOwnProperty,s={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},l=Array.isArray,u=Array.prototype.push,h=function(t,e){u.apply(t,l(e)?e:[e])},c=Date.prototype.toISOString,d=a.default,f={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,format:d,formatter:a.formatters[d],indices:!1,serializeDate:function(t){return c.call(t)},skipNulls:!1,strictNullHandling:!1},p={},v=function t(e,n,a,o,s,u,c,d,v,m,g,y,_,x,b,w){for(var S,T=e,M=w,E=0,A=!1;void 0!==(M=M.get(p))&&!A;){var P=M.get(e);if(E+=1,"undefined"!==typeof P){if(P===E)throw new RangeError("Cyclic object value");A=!0}"undefined"===typeof M.get(p)&&(E=0)}if("function"===typeof d?T=d(n,T):T instanceof Date?T=g(T):"comma"===a&&l(T)&&(T=r.maybeMap(T,(function(t){return t instanceof Date?g(t):t}))),null===T){if(s)return c&&!x?c(n,f.encoder,b,"key",y):n;T=""}if("string"===typeof(S=T)||"number"===typeof S||"boolean"===typeof S||"symbol"===typeof S||"bigint"===typeof S||r.isBuffer(T))return c?[_(x?n:c(n,f.encoder,b,"key",y))+"="+_(c(T,f.encoder,b,"value",y))]:[_(n)+"="+_(String(T))];var C,k=[];if("undefined"===typeof T)return k;if("comma"===a&&l(T))x&&c&&(T=r.maybeMap(T,c)),C=[{value:T.length>0?T.join(",")||null:void 0}];else if(l(d))C=d;else{var R=Object.keys(T);C=v?R.sort(v):R}for(var I=o&&l(T)&&1===T.length?n+"[]":n,D=0;D<C.length;++D){var O=C[D],L="object"===typeof O&&"undefined"!==typeof O.value?O.value:T[O];if(!u||null!==L){var N=l(T)?"function"===typeof a?a(I,O):I:I+(m?"."+O:"["+O+"]");w.set(e,E);var F=i();F.set(p,w),h(k,t(L,N,a,o,s,u,"comma"===a&&x&&l(T)?null:c,d,v,m,g,y,_,x,b,F))}}return k};t.exports=function(t,e){var n,r=t,u=function(t){if(!t)return f;if(null!==t.encoder&&"undefined"!==typeof t.encoder&&"function"!==typeof t.encoder)throw new TypeError("Encoder has to be a function.");var e=t.charset||f.charset;if("undefined"!==typeof t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=a.default;if("undefined"!==typeof t.format){if(!o.call(a.formatters,t.format))throw new TypeError("Unknown format option provided.");n=t.format}var i=a.formatters[n],r=f.filter;return("function"===typeof t.filter||l(t.filter))&&(r=t.filter),{addQueryPrefix:"boolean"===typeof t.addQueryPrefix?t.addQueryPrefix:f.addQueryPrefix,allowDots:"undefined"===typeof t.allowDots?f.allowDots:!!t.allowDots,charset:e,charsetSentinel:"boolean"===typeof t.charsetSentinel?t.charsetSentinel:f.charsetSentinel,delimiter:"undefined"===typeof t.delimiter?f.delimiter:t.delimiter,encode:"boolean"===typeof t.encode?t.encode:f.encode,encoder:"function"===typeof t.encoder?t.encoder:f.encoder,encodeValuesOnly:"boolean"===typeof t.encodeValuesOnly?t.encodeValuesOnly:f.encodeValuesOnly,filter:r,format:n,formatter:i,serializeDate:"function"===typeof t.serializeDate?t.serializeDate:f.serializeDate,skipNulls:"boolean"===typeof t.skipNulls?t.skipNulls:f.skipNulls,sort:"function"===typeof t.sort?t.sort:null,strictNullHandling:"boolean"===typeof t.strictNullHandling?t.strictNullHandling:f.strictNullHandling}}(e);"function"===typeof u.filter?r=(0,u.filter)("",r):l(u.filter)&&(n=u.filter);var c,d=[];if("object"!==typeof r||null===r)return"";c=e&&e.arrayFormat in s?e.arrayFormat:e&&"indices"in e?e.indices?"indices":"repeat":"indices";var p=s[c];if(e&&"commaRoundTrip"in e&&"boolean"!==typeof e.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var m="comma"===p&&e&&e.commaRoundTrip;n||(n=Object.keys(r)),u.sort&&n.sort(u.sort);for(var g=i(),y=0;y<n.length;++y){var _=n[y];u.skipNulls&&null===r[_]||h(d,v(r[_],_,p,m,u.strictNullHandling,u.skipNulls,u.encode?u.encoder:null,u.filter,u.sort,u.allowDots,u.serializeDate,u.format,u.formatter,u.encodeValuesOnly,u.charset,g))}var x=d.join(u.delimiter),b=!0===u.addQueryPrefix?"?":"";return u.charsetSentinel&&("iso-8859-1"===u.charset?b+="utf8=%26%2310003%3B&":b+="utf8=%E2%9C%93&"),x.length>0?b+x:""}},838:function(t,e,n){"use strict";var i=n(951),r=Object.prototype.hasOwnProperty,a=Array.isArray,o=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),s=function(t,e){for(var n=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)"undefined"!==typeof t[i]&&(n[i]=t[i]);return n};t.exports={arrayToObject:s,assign:function(t,e){return Object.keys(e).reduce((function(t,n){return t[n]=e[n],t}),t)},combine:function(t,e){return[].concat(t,e)},compact:function(t){for(var e=[{obj:{o:t},prop:"o"}],n=[],i=0;i<e.length;++i)for(var r=e[i],o=r.obj[r.prop],s=Object.keys(o),l=0;l<s.length;++l){var u=s[l],h=o[u];"object"===typeof h&&null!==h&&-1===n.indexOf(h)&&(e.push({obj:o,prop:u}),n.push(h))}return function(t){for(;t.length>1;){var e=t.pop(),n=e.obj[e.prop];if(a(n)){for(var i=[],r=0;r<n.length;++r)"undefined"!==typeof n[r]&&i.push(n[r]);e.obj[e.prop]=i}}}(e),t},decode:function(t,e,n){var i=t.replace(/\+/g," ");if("iso-8859-1"===n)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(r){return i}},encode:function(t,e,n,r,a){if(0===t.length)return t;var s=t;if("symbol"===typeof t?s=Symbol.prototype.toString.call(t):"string"!==typeof t&&(s=String(t)),"iso-8859-1"===n)return escape(s).replace(/%u[0-9a-f]{4}/gi,(function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"}));for(var l="",u=0;u<s.length;++u){var h=s.charCodeAt(u);45===h||46===h||95===h||126===h||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||a===i.RFC1738&&(40===h||41===h)?l+=s.charAt(u):h<128?l+=o[h]:h<2048?l+=o[192|h>>6]+o[128|63&h]:h<55296||h>=57344?l+=o[224|h>>12]+o[128|h>>6&63]+o[128|63&h]:(u+=1,h=65536+((1023&h)<<10|1023&s.charCodeAt(u)),l+=o[240|h>>18]+o[128|h>>12&63]+o[128|h>>6&63]+o[128|63&h])}return l},isBuffer:function(t){return!(!t||"object"!==typeof t)&&!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},isRegExp:function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},maybeMap:function(t,e){if(a(t)){for(var n=[],i=0;i<t.length;i+=1)n.push(e(t[i]));return n}return e(t)},merge:function t(e,n,i){if(!n)return e;if("object"!==typeof n){if(a(e))e.push(n);else{if(!e||"object"!==typeof e)return[e,n];(i&&(i.plainObjects||i.allowPrototypes)||!r.call(Object.prototype,n))&&(e[n]=!0)}return e}if(!e||"object"!==typeof e)return[e].concat(n);var o=e;return a(e)&&!a(n)&&(o=s(e,i)),a(e)&&a(n)?(n.forEach((function(n,a){if(r.call(e,a)){var o=e[a];o&&"object"===typeof o&&n&&"object"===typeof n?e[a]=t(o,n,i):e.push(n)}else e[a]=n})),e):Object.keys(n).reduce((function(e,a){var o=n[a];return r.call(e,a)?e[a]=t(e[a],o,i):e[a]=o,e}),o)}}},114:function(t,e,n){"use strict";var i=n(369);function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var a=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),h=["%","/","?",";","#"].concat(u),c=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(915);function y(t,e,n){if(t&&"object"===typeof t&&t instanceof r)return t;var i=new r;return i.parse(t,e,n),i}r.prototype.parse=function(t,e,n){if("string"!==typeof t)throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),o=-1!==r&&r<t.indexOf("#")?"?":"#",l=t.split(o);l[0]=l[0].replace(/\\/g,"/");var y=t=l.join(o);if(y=y.trim(),!n&&1===t.split("#").length){var _=s.exec(y);if(_)return this.path=y,this.href=y,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?g.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var x=a.exec(y);if(x){var b=(x=x[0]).toLowerCase();this.protocol=b,y=y.substr(x.length)}if(n||x||y.match(/^\/\/[^@/]+@[^@/]+/)){var w="//"===y.substr(0,2);!w||x&&v[x]||(y=y.substr(2),this.slashes=!0)}if(!v[x]&&(w||x&&!m[x])){for(var S,T,M=-1,E=0;E<c.length;E++){-1!==(A=y.indexOf(c[E]))&&(-1===M||A<M)&&(M=A)}-1!==(T=-1===M?y.lastIndexOf("@"):y.lastIndexOf("@",M))&&(S=y.slice(0,T),y=y.slice(T+1),this.auth=decodeURIComponent(S)),M=-1;for(E=0;E<h.length;E++){var A;-1!==(A=y.indexOf(h[E]))&&(-1===M||A<M)&&(M=A)}-1===M&&(M=y.length),this.host=y.slice(0,M),y=y.slice(M),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var C=this.hostname.split(/\./),k=(E=0,C.length);E<k;E++){var R=C[E];if(R&&!R.match(d)){for(var I="",D=0,O=R.length;D<O;D++)R.charCodeAt(D)>127?I+="x":I+=R[D];if(!I.match(d)){var L=C.slice(0,E),N=C.slice(E+1),F=R.match(f);F&&(L.push(F[1]),N.unshift(F[2])),N.length&&(y="/"+N.join(".")+y),this.hostname=L.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=i.toASCII(this.hostname));var B=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+B,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!p[b])for(E=0,k=u.length;E<k;E++){var G=u[E];if(-1!==y.indexOf(G)){var z=encodeURIComponent(G);z===G&&(z=escape(G)),y=y.split(G).join(z)}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var V=y.indexOf("?");if(-1!==V?(this.search=y.substr(V),this.query=y.substr(V+1),e&&(this.query=g.parse(this.query)),y=y.slice(0,V)):e&&(this.search="",this.query={}),y&&(this.pathname=y),m[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var j=this.search||"";this.path=B+j}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",i=this.hash||"",r=!1,a="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&"object"===typeof this.query&&Object.keys(this.query).length&&(a=g.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||a&&"?"+a||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||m[e])&&!1!==r?(r="//"+(r||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):r||(r=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),e+r+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(o=o.replace("#","%23"))+i},r.prototype.resolve=function(t){return this.resolveObject(y(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if("string"===typeof t){var e=new r;e.parse(t,!1,!0),t=e}for(var n=new r,i=Object.keys(this),a=0;a<i.length;a++){var o=i[a];n[o]=this[o]}if(n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var s=Object.keys(t),l=0;l<s.length;l++){var u=s[l];"protocol"!==u&&(n[u]=t[u])}return m[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!m[t.protocol]){for(var h=Object.keys(t),c=0;c<h.length;c++){var d=h[c];n[d]=t[d]}return n.href=n.format(),n}if(n.protocol=t.protocol,t.host||v[t.protocol])n.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var p=n.pathname||"",g=n.search||"";n.path=p+g}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var y=n.pathname&&"/"===n.pathname.charAt(0),_=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=_||y||n.host&&t.pathname,b=x,w=n.pathname&&n.pathname.split("/")||[],S=(f=t.pathname&&t.pathname.split("/")||[],n.protocol&&!m[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===w[0]?w[0]=n.host:w.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),x=x&&(""===f[0]||""===w[0])),_)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,w=f;else if(f.length)w||(w=[]),w.pop(),w=w.concat(f),n.search=t.search,n.query=t.query;else if(null!=t.search){if(S)n.host=w.shift(),n.hostname=n.host,(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.hostname=P.shift(),n.host=n.hostname);return n.search=t.search,n.query=t.query,null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!w.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var T=w.slice(-1)[0],M=(n.host||t.host||w.length>1)&&("."===T||".."===T)||""===T,E=0,A=w.length;A>=0;A--)"."===(T=w[A])?w.splice(A,1):".."===T?(w.splice(A,1),E++):E&&(w.splice(A,1),E--);if(!x&&!b)for(;E--;E)w.unshift("..");!x||""===w[0]||w[0]&&"/"===w[0].charAt(0)||w.unshift(""),M&&"/"!==w.join("/").substr(-1)&&w.push("");var P,C=""===w[0]||w[0]&&"/"===w[0].charAt(0);S&&(n.hostname=C?"":w.length?w.shift():"",n.host=n.hostname,(P=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=P.shift(),n.hostname=P.shift(),n.host=n.hostname));return(x=x||n.host&&w.length)&&!C&&w.unshift(""),w.length>0?n.pathname=w.join("/"):(n.pathname=null,n.path=null),null===n.pathname&&null===n.search||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=o.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},e.Qc=y,e.DB=function(t,e){return y(t,!1,!0).resolve(e)},e.WU=function(t){return"string"===typeof t&&(t=y(t)),t instanceof r?t.format():r.prototype.format.call(t)}},654:function(){}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return n};var n={},i=Object.prototype,r=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(P){u=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var r=e&&e.prototype instanceof f?e:f,a=Object.create(r.prototype),o=new M(i||[]);return a._invoke=function(t,e,n){var i="suspendedStart";return function(r,a){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw a;return A()}for(n.method=r,n.arg=a;;){var o=n.delegate;if(o){var s=w(o,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=c(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}(t,n,o),a}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(P){return{type:"throw",arg:P}}}n.wrap=h;var d={};function f(){}function p(){}function v(){}var m={};u(m,o,(function(){return this}));var g=Object.getPrototypeOf,y=g&&g(g(E([])));y&&y!==i&&r.call(y,o)&&(m=y);var _=v.prototype=f.prototype=Object.create(m);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function b(e,n){function i(a,o,s,l){var u=c(e[a],e,o);if("throw"!==u.type){var h=u.arg,d=h.value;return d&&"object"==t(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(t){i("next",t,s,l)}),(function(t){i("throw",t,s,l)})):n.resolve(d).then((function(t){h.value=t,s(h)}),(function(t){return i("throw",t,s,l)}))}l(u.arg)}var a;this._invoke=function(t,e){function r(){return new n((function(n,r){i(t,e,n,r)}))}return a=a?a.then(r,r):r()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var i=c(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,d;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function E(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:A}}function A(){return{value:void 0,done:!0}}return p.prototype=v,u(_,"constructor",v),u(v,"constructor",p),p.displayName=u(v,l,"GeneratorFunction"),n.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},n.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,l,"GeneratorFunction")),t.prototype=Object.create(_),t},n.awrap=function(t){return{__await:t}},x(b.prototype),u(b.prototype,s,(function(){return this})),n.AsyncIterator=b,n.async=function(t,e,i,r,a){void 0===a&&(a=Promise);var o=new b(h(t,e,i,r),a);return n.isGeneratorFunction(e)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(_),u(_,l,"Generator"),u(_,o,(function(){return this})),u(_,"toString",(function(){return"[object Generator]"})),n.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},n.values=E,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return o.type="throw",o.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),l=r.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,d):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;T(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:E(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},n}function i(t,e,n,i,r,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(i,r)}function r(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function s(t){i(o,r,a,s,l,"next",t)}function l(t){i(o,r,a,s,l,"throw",t)}s(void 0)}))}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var l,u=new(s((function t(){a(this,t),this.assets="assets",this.scoreHeaderCoef=8,this.playersNumber=5,this.cadreP1Color="#FFCA44",this.cadreP2Color="#62ddfc",this.currentleaderboard=[],this.leaderboardInfos=[],this.challengers=[],this.profilesScoreBarStep=1e3,this.view={x:608,y:1080},this.mouse={x:0,y:0},this.scoreRangeMin=500,this.scoreRangeMax=999,this.changeSkinReady=!0,this.beatenOpponent=""})));function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function d(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function v(e,n){if(n&&("object"===t(n)||"function"===typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}function m(t){var e=p();return function(){var n,i=f(t);if(e){var r=f(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return v(this,n)}}function g(t,e,n){return g=p()?Reflect.construct.bind():function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&c(r,n.prototype),r},g.apply(null,arguments)}function y(t){var e="function"===typeof Map?new Map:void 0;return y=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return g(t,arguments,f(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),c(i,t)},y(t)}function _(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function x(t,e){if(t){if("string"===typeof t)return _(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(t,e):void 0}}function b(t){return function(t){if(Array.isArray(t))return _(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||x(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=x(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function S(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);o=!0);}catch(l){s=!0,r=l}finally{try{o||null==n.return||n.return()}finally{if(s)throw r}}return a}}(t,e)||x(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}function M(){return M="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var i=T(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(arguments.length<3?t:n):r.value}},M.apply(this,arguments)}function E(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var A="145",P=100,C=301,k=302,R=303,I=304,D=306,O=1e3,L=1001,N=1002,F=1003,B=1004,U=1005,G=1006,z=1007,H=1008,V=1009,j=1012,X=1014,W=1015,q=1016,Y=1020,K=1022,Z=1023,J=1026,Q=1027,$=33776,tt=33777,et=33778,nt=33779,it=35840,rt=35841,at=35842,ot=35843,st=37492,lt=37496,ut=37808,ht=37809,ct=37810,dt=37811,ft=37812,pt=37813,vt=37814,mt=37815,gt=37816,yt=37817,_t=37818,xt=37819,bt=37820,wt=37821,St=36492,Tt=2300,Mt=2301,Et=2302,At=2400,Pt=2401,Ct=2402,kt=2500,Rt=3e3,It=3001,Dt="srgb",Ot="srgb-linear",Lt=7680,Nt=35044,Ft="300 es",Bt=1035,Ut=function(){function t(){a(this,t)}return s(t,[{key:"addEventListener",value:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}},{key:"hasEventListener",value:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}},{key:"removeEventListener",value:function(t,e){if(void 0!==this._listeners){var n=this._listeners[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}}},{key:"dispatchEvent",value:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=e.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,t);t.target=null}}}}]),t}(),Gt=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],zt=1234567,Ht=Math.PI/180,Vt=180/Math.PI;function jt(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(Gt[255&t]+Gt[t>>8&255]+Gt[t>>16&255]+Gt[t>>24&255]+"-"+Gt[255&e]+Gt[e>>8&255]+"-"+Gt[e>>16&15|64]+Gt[e>>24&255]+"-"+Gt[63&n|128]+Gt[n>>8&255]+"-"+Gt[n>>16&255]+Gt[n>>24&255]+Gt[255&i]+Gt[i>>8&255]+Gt[i>>16&255]+Gt[i>>24&255]).toLowerCase()}function Xt(t,e,n){return Math.max(e,Math.min(n,t))}function Wt(t,e){return(t%e+e)%e}function qt(t,e,n){return(1-n)*t+n*e}function Yt(t){return 0===(t&t-1)&&0!==t}function Kt(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Zt(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Jt(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function Qt(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}var $t=Object.freeze({__proto__:null,DEG2RAD:Ht,RAD2DEG:Vt,generateUUID:jt,clamp:Xt,euclideanModulo:Wt,mapLinear:function(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)},inverseLerp:function(t,e,n){return t!==e?(n-t)/(e-t):0},lerp:qt,damp:function(t,e,n,i){return qt(t,e,1-Math.exp(-n*i))},pingpong:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e-Math.abs(Wt(t,2*e)-e)},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){void 0!==t&&(zt=t);var e=zt+=1831565813;return e=Math.imul(e^e>>>15,1|e),(((e^=e+Math.imul(e^e>>>7,61|e))^e>>>14)>>>0)/4294967296},degToRad:function(t){return t*Ht},radToDeg:function(t){return t*Vt},isPowerOfTwo:Yt,ceilPowerOfTwo:Kt,floorPowerOfTwo:Zt,setQuaternionFromProperEuler:function(t,e,n,i,r){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),u=a((e+i)/2),h=o((e+i)/2),c=a((e-i)/2),d=o((e-i)/2),f=a((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(s*h,l*c,l*d,s*u);break;case"YZY":t.set(l*d,s*h,l*c,s*u);break;case"ZXZ":t.set(l*c,l*d,s*h,s*u);break;case"XZX":t.set(s*h,l*p,l*f,s*u);break;case"YXY":t.set(l*f,s*h,l*p,s*u);break;case"ZYZ":t.set(l*p,l*f,s*h,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}},normalize:Qt,denormalize:Jt}),te=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,n),n.prototype.isVector2=!0,this.x=t,this.y=e}return s(n,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"applyMatrix3",value:function(t){var e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var t=Math.atan2(-this.y,-this.x)+Math.PI;return t}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t}},{key:"fromBufferAttribute",value:function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}},{key:"rotateAround",value:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*n-a*i+t.x,this.y=r*i+a*n+t.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:case"end":return t.stop()}}),t,this)}))}]),n}(),ee=function(){function t(){a(this,t),t.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}return s(t,[{key:"set",value:function(t,e,n,i,r,a,o,s,l){var u=this.elements;return u[0]=t,u[1]=i,u[2]=o,u[3]=e,u[4]=r,u[5]=s,u[6]=n,u[7]=a,u[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}},{key:"extractBasis",value:function(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,e){var n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],u=n[4],h=n[7],c=n[2],d=n[5],f=n[8],p=i[0],v=i[3],m=i[6],g=i[1],y=i[4],_=i[7],x=i[2],b=i[5],w=i[8];return r[0]=a*p+o*g+s*x,r[3]=a*v+o*y+s*b,r[6]=a*m+o*_+s*w,r[1]=l*p+u*g+h*x,r[4]=l*v+u*y+h*b,r[7]=l*m+u*_+h*w,r[2]=c*p+d*g+f*x,r[5]=c*v+d*y+f*b,r[8]=c*m+d*_+f*w,this}},{key:"multiplyScalar",value:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}},{key:"determinant",value:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8];return e*a*u-e*o*l-n*r*u+n*o*s+i*r*l-i*a*s}},{key:"invert",value:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],h=u*a-o*l,c=o*s-u*r,d=l*r-a*s,f=e*h+n*c+i*d;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return t[0]=h*p,t[1]=(i*l-u*n)*p,t[2]=(o*n-i*a)*p,t[3]=c*p,t[4]=(u*e-i*s)*p,t[5]=(i*r-o*e)*p,t[6]=d*p,t[7]=(n*s-l*e)*p,t[8]=(a*e-n*r)*p,this}},{key:"transpose",value:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}},{key:"getNormalMatrix",value:function(t){return this.setFromMatrix4(t).invert().transpose()}},{key:"transposeIntoArray",value:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}},{key:"setUvTransform",value:function(t,e,n,i,r,a,o){var s=Math.cos(r),l=Math.sin(r);return this.set(n*s,n*l,-n*(s*a+l*o)+a+t,-i*l,i*s,-i*(-l*a+s*o)+o+e,0,0,1),this}},{key:"scale",value:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this}},{key:"rotate",value:function(t){var e=Math.cos(t),n=Math.sin(t),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],u=i[7];return i[0]=e*r+n*s,i[3]=e*a+n*l,i[6]=e*o+n*u,i[1]=-n*r+e*s,i[4]=-n*a+e*l,i[7]=-n*o+e*u,this}},{key:"translate",value:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this}},{key:"equals",value:function(t){for(var e=this.elements,n=t.elements,i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=t[n+e];return this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),t}();function ne(t){for(var e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function ie(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function re(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ae(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var oe=(E(l={},Dt,E({},Ot,re)),E(l,Ot,E({},Dt,ae)),l),se={legacyMode:!0,get workingColorSpace(){return Ot},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(oe[e]&&void 0!==oe[e][n]){var i=oe[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},le={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ue={r:0,g:0,b:0},he={h:0,s:0,l:0},ce={h:0,s:0,l:0};function de(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}function fe(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var pe,ve=function(t){function n(t,e,i){return a(this,n),this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}return s(n,[{key:"set",value:function(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this}},{key:"setScalar",value:function(t){return this.r=t,this.g=t,this.b=t,this}},{key:"setHex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dt;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,se.toWorkingColorSpace(this,e),this}},{key:"setRGB",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ot;return this.r=t,this.g=e,this.b=n,se.toWorkingColorSpace(this,i),this}},{key:"setHSL",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ot;if(t=Wt(t,1),e=Xt(e,0,1),n=Xt(n,0,1),0===e)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+e):n+e-n*e,a=2*n-r;this.r=de(a,r,t+1/3),this.g=de(a,r,t),this.b=de(a,r,t-1/3)}return se.toWorkingColorSpace(this,i),this}},{key:"setStyle",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dt;function i(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}if(e=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){var r,a=e[1],o=e[2];switch(a){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,se.toWorkingColorSpace(this,n),i(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,se.toWorkingColorSpace(this,n),i(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var s=parseFloat(r[1])/360,l=parseFloat(r[2])/100,u=parseFloat(r[3])/100;return i(r[4]),this.setHSL(s,l,u,n)}}}else if(e=/^\#([A-Fa-f\d]+)$/.exec(t)){var h=e[1],c=h.length;if(3===c)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,se.toWorkingColorSpace(this,n),this;if(6===c)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,se.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}},{key:"setColorName",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dt,n=le[t.toLowerCase()];return void 0!==n?this.setHex(n,e):console.warn("THREE.Color: Unknown color "+t),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}},{key:"copySRGBToLinear",value:function(t){return this.r=re(t.r),this.g=re(t.g),this.b=re(t.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.r=ae(t.r),this.g=ae(t.g),this.b=ae(t.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt;return se.fromWorkingColorSpace(fe(this,ue),t),Xt(255*ue.r,0,255)<<16^Xt(255*ue.g,0,255)<<8^Xt(255*ue.b,0,255)<<0}},{key:"getHexString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt;return("000000"+this.getHex(t).toString(16)).slice(-6)}},{key:"getHSL",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ot;se.fromWorkingColorSpace(fe(this,ue),e);var n,i,r=ue.r,a=ue.g,o=ue.b,s=Math.max(r,a,o),l=Math.min(r,a,o),u=(l+s)/2;if(l===s)n=0,i=0;else{var h=s-l;switch(i=u<=.5?h/(s+l):h/(2-s-l),s){case r:n=(a-o)/h+(a<o?6:0);break;case a:n=(o-r)/h+2;break;case o:n=(r-a)/h+4}n/=6}return t.h=n,t.s=i,t.l=u,t}},{key:"getRGB",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ot;return se.fromWorkingColorSpace(fe(this,ue),e),t.r=ue.r,t.g=ue.g,t.b=ue.b,t}},{key:"getStyle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dt;return se.fromWorkingColorSpace(fe(this,ue),t),t!==Dt?"color(".concat(t," ").concat(ue.r," ").concat(ue.g," ").concat(ue.b,")"):"rgb(".concat(255*ue.r|0,",").concat(255*ue.g|0,",").concat(255*ue.b|0,")")}},{key:"offsetHSL",value:function(t,e,n){return this.getHSL(he),he.h+=t,he.s+=e,he.l+=n,this.setHSL(he.h,he.s,he.l),this}},{key:"add",value:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}},{key:"addColors",value:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}},{key:"addScalar",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this}},{key:"sub",value:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}},{key:"multiply",value:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}},{key:"multiplyScalar",value:function(t){return this.r*=t,this.g*=t,this.b*=t,this}},{key:"lerp",value:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}},{key:"lerpColors",value:function(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}},{key:"lerpHSL",value:function(t,e){this.getHSL(he),t.getHSL(ce);var n=qt(he.h,ce.h,e),i=qt(he.s,ce.s,e),r=qt(he.l,ce.l,e);return this.setHSL(n,i,r),this}},{key:"equals",value:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}},{key:"fromBufferAttribute",value:function(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.r;case 2:return t.next=4,this.g;case 4:return t.next=6,this.b;case 6:case"end":return t.stop()}}),t,this)}))}]),n}();ve.NAMES=le;var me=function(){function t(){a(this,t)}return s(t,null,[{key:"getDataURL",value:function(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;var e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===pe&&(pe=ie("canvas")),pe.width=t.width,pe.height=t.height;var n=pe.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=pe}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}},{key:"sRGBToLinear",value:function(t){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){var e=ie("canvas");e.width=t.width,e.height=t.height;var n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);for(var i=n.getImageData(0,0,t.width,t.height),r=i.data,a=0;a<r.length;a++)r[a]=255*re(r[a]/255);return n.putImageData(i,0,0),e}if(t.data){for(var o=t.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*re(o[s]/255)):o[s]=re(o[s]);return{data:o,width:t.width,height:t.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}]),t}(),ge=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a(this,t),this.isSource=!0,this.uuid=jt(),this.data=e,this.version=0}return s(t,[{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"toJSON",value:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];var n={uuid:this.uuid,url:""},i=this.data;if(null!==i){var r;if(Array.isArray(i)){r=[];for(var a=0,o=i.length;a<o;a++)i[a].isDataTexture?r.push(ye(i[a].image)):r.push(ye(i[a]))}else r=ye(i);n.url=r}return e||(t.images[this.uuid]=n),n}}]),t}();function ye(t){return"undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap?me.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var _e=0,xe=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:L,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:G,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:H,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Z,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:V,f=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:Rt;return a(this,n),(t=e.call(this)).isTexture=!0,Object.defineProperty(h(t),"id",{value:_e++}),t.uuid=jt(),t.name="",t.source=new ge(i),t.mipmaps=[],t.mapping=r,t.wrapS=o,t.wrapT=s,t.magFilter=l,t.minFilter=u,t.anisotropy=f,t.format=c,t.internalFormat=null,t.type=d,t.offset=new te(0,0),t.repeat=new te(1,1),t.center=new te(0,0),t.rotation=0,t.matrixAutoUpdate=!0,t.matrix=new ee,t.generateMipmaps=!0,t.premultiplyAlpha=!1,t.flipY=!0,t.unpackAlignment=4,t.encoding=p,t.userData={},t.version=0,t.onUpdate=null,t.isRenderTargetTexture=!1,t.needsPMREMUpdate=!1,t}return s(n,[{key:"image",get:function(){return this.source.data},set:function(t){this.source.data=t}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case O:t.x=t.x-Math.floor(t.x);break;case L:t.x=t.x<0?0:1;break;case N:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case O:t.y=t.y-Math.floor(t.y);break;case L:t.y=t.y<0?0:1;break;case N:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}},{key:"needsUpdate",set:function(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}]),n}(Ut);xe.DEFAULT_IMAGE=null,xe.DEFAULT_MAPPING=300;var be=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,n),n.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=r}return s(n,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}},{key:"set",value:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setW",value:function(t){return this.w=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}},{key:"applyMatrix4",value:function(t){var e=this.x,n=this.y,i=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*e+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*e+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*e+a[7]*n+a[11]*i+a[15]*r,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"setAxisAngleFromQuaternion",value:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}},{key:"setAxisAngleFromRotationMatrix",value:function(t){var e,n,i,r,a=.01,o=.1,s=t.elements,l=s[0],u=s[4],h=s[8],c=s[1],d=s[5],f=s[9],p=s[2],v=s[6],m=s[10];if(Math.abs(u-c)<a&&Math.abs(h-p)<a&&Math.abs(f-v)<a){if(Math.abs(u+c)<o&&Math.abs(h+p)<o&&Math.abs(f+v)<o&&Math.abs(l+d+m-3)<o)return this.set(1,0,0,0),this;e=Math.PI;var g=(l+1)/2,y=(d+1)/2,_=(m+1)/2,x=(u+c)/4,b=(h+p)/4,w=(f+v)/4;return g>y&&g>_?g<a?(n=0,i=.707106781,r=.707106781):(i=x/(n=Math.sqrt(g)),r=b/n):y>_?y<a?(n=.707106781,i=0,r=.707106781):(n=x/(i=Math.sqrt(y)),r=w/i):_<a?(n=.707106781,i=.707106781,r=0):(n=b/(r=Math.sqrt(_)),i=w/r),this.set(n,i,r,e),this}var S=Math.sqrt((v-f)*(v-f)+(h-p)*(h-p)+(c-u)*(c-u));return Math.abs(S)<.001&&(S=1),this.x=(v-f)/S,this.y=(h-p)/S,this.z=(c-u)/S,this.w=Math.acos((l+d+m-1)/2),this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}},{key:"fromBufferAttribute",value:function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:return t.next=6,this.z;case 6:return t.next=8,this.w;case 8:case"end":return t.stop()}}),t,this)}))}]),n}(),we=function(t){d(n,t);var e=m(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a(this,n),(r=e.call(this)).isWebGLRenderTarget=!0,r.width=t,r.height=i,r.depth=1,r.scissor=new be(0,0,t,i),r.scissorTest=!1,r.viewport=new be(0,0,t,i);var s={width:t,height:i,depth:1};return r.texture=new xe(s,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),r.texture.isRenderTargetTexture=!0,r.texture.flipY=!1,r.texture.generateMipmaps=void 0!==o.generateMipmaps&&o.generateMipmaps,r.texture.internalFormat=void 0!==o.internalFormat?o.internalFormat:null,r.texture.minFilter=void 0!==o.minFilter?o.minFilter:G,r.depthBuffer=void 0===o.depthBuffer||o.depthBuffer,r.stencilBuffer=void 0!==o.stencilBuffer&&o.stencilBuffer,r.depthTexture=void 0!==o.depthTexture?o.depthTexture:null,r.samples=void 0!==o.samples?o.samples:0,r}return s(n,[{key:"setSize",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;var e=Object.assign({},t.texture.image);return this.texture.source=new ge(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Ut),Se=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a(this,n),(t=e.call(this,null)).isDataArrayTexture=!0,t.image={data:i,width:r,height:o,depth:s},t.magFilter=F,t.minFilter=F,t.wrapR=L,t.generateMipmaps=!1,t.flipY=!1,t.unpackAlignment=1,t}return s(n)}(xe),Te=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a(this,n),(t=e.call(this,null)).isData3DTexture=!0,t.image={data:i,width:r,height:o,depth:s},t.magFilter=F,t.minFilter=F,t.wrapR=L,t.generateMipmaps=!1,t.flipY=!1,t.unpackAlignment=1,t}return s(n)}(xe),Me=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,n),this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=r}return s(n,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}},{key:"set",value:function(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(t,e){var n=t._x,i=t._y,r=t._z,a=t._order,o=Math.cos,s=Math.sin,l=o(n/2),u=o(i/2),h=o(r/2),c=s(n/2),d=s(i/2),f=s(r/2);switch(a){case"XYZ":this._x=c*u*h+l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h-c*d*f;break;case"YXZ":this._x=c*u*h+l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h+c*d*f;break;case"ZXY":this._x=c*u*h-l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h-c*d*f;break;case"ZYX":this._x=c*u*h-l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h+c*d*f;break;case"YZX":this._x=c*u*h+l*d*f,this._y=l*d*h+c*u*f,this._z=l*u*f-c*d*h,this._w=l*u*h-c*d*f;break;case"XZY":this._x=c*u*h-l*d*f,this._y=l*d*h-c*u*f,this._z=l*u*f+c*d*h,this._w=l*u*h+c*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==e&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(t,e){var n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(t){var e=t.elements,n=e[0],i=e[4],r=e[8],a=e[1],o=e[5],s=e[9],l=e[2],u=e[6],h=e[10],c=n+o+h;if(c>0){var d=.5/Math.sqrt(c+1);this._w=.25/d,this._x=(u-s)*d,this._y=(r-l)*d,this._z=(a-i)*d}else if(n>o&&n>h){var f=2*Math.sqrt(1+n-o-h);this._w=(u-s)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(r+l)/f}else if(o>h){var p=2*Math.sqrt(1+o-n-h);this._w=(r-l)/p,this._x=(i+a)/p,this._y=.25*p,this._z=(s+u)/p}else{var v=2*Math.sqrt(1+h-n-o);this._w=(a-i)/v,this._x=(r+l)/v,this._y=(s+u)/v,this._z=.25*v}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(t,e){var n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(Xt(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,e){var n=this.angleTo(t);if(0===n)return this;var i=Math.min(1,e/n);return this.slerp(t,i),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}},{key:"multiply",value:function(t){return this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,e){var n=t._x,i=t._y,r=t._z,a=t._w,o=e._x,s=e._y,l=e._z,u=e._w;return this._x=n*u+a*o+i*l-r*s,this._y=i*u+a*s+r*o-n*l,this._z=r*u+a*l+n*s-i*o,this._w=a*u-n*o-i*s-r*l,this._onChangeCallback(),this}},{key:"slerp",value:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,i=this._y,r=this._z,a=this._w,o=a*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-e;return this._w=l*a+e*this._w,this._x=l*n+e*this._x,this._y=l*i+e*this._y,this._z=l*r+e*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),h=Math.atan2(u,o),c=Math.sin((1-e)*h)/u,d=Math.sin(e*h)/u;return this._w=a*c+this._w*d,this._x=n*c+this._x*d,this._y=i*c+this._y*d,this._z=r*c+this._z*d,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(t,e,n){return this.copy(t).slerp(e,n)}},{key:"random",value:function(){var t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}},{key:"equals",value:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}},{key:"fromBufferAttribute",value:function(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}},{key:"_onChange",value:function(t){return this._onChangeCallback=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._x;case 2:return t.next=4,this._y;case 4:return t.next=6,this._z;case 6:return t.next=8,this._w;case 8:case"end":return t.stop()}}),t,this)}))}],[{key:"slerpFlat",value:function(t,e,n,i,r,a,o){var s=n[i+0],l=n[i+1],u=n[i+2],h=n[i+3],c=r[a+0],d=r[a+1],f=r[a+2],p=r[a+3];if(0===o)return t[e+0]=s,t[e+1]=l,t[e+2]=u,void(t[e+3]=h);if(1===o)return t[e+0]=c,t[e+1]=d,t[e+2]=f,void(t[e+3]=p);if(h!==p||s!==c||l!==d||u!==f){var v=1-o,m=s*c+l*d+u*f+h*p,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){var _=Math.sqrt(y),x=Math.atan2(_,m*g);v=Math.sin(v*x)/_,o=Math.sin(o*x)/_}var b=o*g;if(s=s*v+c*b,l=l*v+d*b,u=u*v+f*b,h=h*v+p*b,v===1-o){var w=1/Math.sqrt(s*s+l*l+u*u+h*h);s*=w,l*=w,u*=w,h*=w}}t[e]=s,t[e+1]=l,t[e+2]=u,t[e+3]=h}},{key:"multiplyQuaternionsFlat",value:function(t,e,n,i,r,a){var o=n[i],s=n[i+1],l=n[i+2],u=n[i+3],h=r[a],c=r[a+1],d=r[a+2],f=r[a+3];return t[e]=o*f+u*h+s*d-l*c,t[e+1]=s*f+u*c+l*h-o*d,t[e+2]=l*f+u*d+o*c-s*h,t[e+3]=u*f-o*h-s*c-l*d,t}}]),n}(),Ee=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,n),n.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}return s(n,[{key:"set",value:function(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}},{key:"addScaledVector",value:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}},{key:"applyEuler",value:function(t){return this.applyQuaternion(Pe.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,e){return this.applyQuaternion(Pe.setFromAxisAngle(t,e))}},{key:"applyMatrix3",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements,a=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*a,this}},{key:"applyQuaternion",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z,s=t.w,l=s*e+a*i-o*n,u=s*n+o*e-r*i,h=s*i+r*n-a*e,c=-r*e-a*n-o*i;return this.x=l*s+c*-r+u*-o-h*-a,this.y=u*s+c*-a+h*-r-l*-o,this.z=h*s+c*-o+l*-a-u*-r,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}},{key:"clampScalar",value:function(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}},{key:"clampLength",value:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}},{key:"lerpVectors",value:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}},{key:"cross",value:function(t){return this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,e){var n=t.x,i=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this}},{key:"projectOnVector",value:function(t){var e=t.lengthSq();if(0===e)return this.set(0,0,0);var n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}},{key:"projectOnPlane",value:function(t){return Ae.copy(this).projectOnVector(t),this.sub(Ae)}},{key:"reflect",value:function(t){return this.sub(Ae.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;var n=this.dot(t)/e;return Math.acos(Xt(n,-1,1))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,e,n){var i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}},{key:"setFromMatrixPosition",value:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}},{key:"setFromMatrixScale",value:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}},{key:"setFromMatrixColumn",value:function(t,e){return this.fromArray(t.elements,4*e)}},{key:"setFromMatrix3Column",value:function(t,e){return this.fromArray(t.elements,3*e)}},{key:"setFromEuler",value:function(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var t=2*(Math.random()-.5),e=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(t,2));return this.x=n*Math.cos(e),this.y=n*Math.sin(e),this.z=t,this}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:return t.next=6,this.z;case 6:case"end":return t.stop()}}),t,this)}))}]),n}(),Ae=new Ee,Pe=new Me,Ce=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee(-1/0,-1/0,-1/0);a(this,t),this.isBox3=!0,this.min=e,this.max=n}return s(t,[{key:"set",value:function(t,e){return this.min.copy(t),this.max.copy(e),this}},{key:"setFromArray",value:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.length;s<l;s+=3){var u=t[s],h=t[s+1],c=t[s+2];u<e&&(e=u),h<n&&(n=h),c<i&&(i=c),u>r&&(r=u),h>a&&(a=h),c>o&&(o=c)}return this.min.set(e,n,i),this.max.set(r,a,o),this}},{key:"setFromBufferAttribute",value:function(t){for(var e=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=t.count;s<l;s++){var u=t.getX(s),h=t.getY(s),c=t.getZ(s);u<e&&(e=u),h<n&&(n=h),c<i&&(i=c),u>r&&(r=u),h>a&&(a=h),c>o&&(o=c)}return this.min.set(e,n,i),this.max.set(r,a,o),this}},{key:"setFromPoints",value:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}},{key:"setFromCenterAndSize",value:function(t,e){var n=Re.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}},{key:"setFromObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(t,e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.min.copy(t.min),this.max.copy(t.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(t){return this.min.min(t),this.max.max(t),this}},{key:"expandByVector",value:function(t){return this.min.sub(t),this.max.add(t),this}},{key:"expandByScalar",value:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this}},{key:"expandByObject",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.updateWorldMatrix(!1,!1);var n=t.geometry;if(void 0!==n)if(e&&void 0!=n.attributes&&void 0!==n.attributes.position)for(var i=n.attributes.position,r=0,a=i.count;r<a;r++)Re.fromBufferAttribute(i,r).applyMatrix4(t.matrixWorld),this.expandByPoint(Re);else null===n.boundingBox&&n.computeBoundingBox(),Ie.copy(n.boundingBox),Ie.applyMatrix4(t.matrixWorld),this.union(Ie);for(var o=t.children,s=0,l=o.length;s<l;s++)this.expandByObject(o[s],e);return this}},{key:"containsPoint",value:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}},{key:"containsBox",value:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}},{key:"getParameter",value:function(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}},{key:"intersectsSphere",value:function(t){return this.clampPoint(t.center,Re),Re.distanceToSquared(t.center)<=t.radius*t.radius}},{key:"intersectsPlane",value:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}},{key:"intersectsTriangle",value:function(t){if(this.isEmpty())return!1;this.getCenter(Ue),Ge.subVectors(this.max,Ue),De.subVectors(t.a,Ue),Oe.subVectors(t.b,Ue),Le.subVectors(t.c,Ue),Ne.subVectors(Oe,De),Fe.subVectors(Le,Oe),Be.subVectors(De,Le);var e=[0,-Ne.z,Ne.y,0,-Fe.z,Fe.y,0,-Be.z,Be.y,Ne.z,0,-Ne.x,Fe.z,0,-Fe.x,Be.z,0,-Be.x,-Ne.y,Ne.x,0,-Fe.y,Fe.x,0,-Be.y,Be.x,0];return!!Ve(e,De,Oe,Le,Ge)&&(!!Ve(e=[1,0,0,0,1,0,0,0,1],De,Oe,Le,Ge)&&(ze.crossVectors(Ne,Fe),Ve(e=[ze.x,ze.y,ze.z],De,Oe,Le,Ge)))}},{key:"clampPoint",value:function(t,e){return e.copy(t).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(t){return Re.copy(t).clamp(this.min,this.max).sub(t).length()}},{key:"getBoundingSphere",value:function(t){return this.getCenter(t.center),t.radius=.5*this.getSize(Re).length(),t}},{key:"intersect",value:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(t){return this.min.min(t.min),this.max.max(t.max),this}},{key:"applyMatrix4",value:function(t){return this.isEmpty()||(ke[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ke[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ke[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ke[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ke[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ke[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ke[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ke[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ke)),this}},{key:"translate",value:function(t){return this.min.add(t),this.max.add(t),this}},{key:"equals",value:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}]),t}(),ke=[new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee,new Ee],Re=new Ee,Ie=new Ce,De=new Ee,Oe=new Ee,Le=new Ee,Ne=new Ee,Fe=new Ee,Be=new Ee,Ue=new Ee,Ge=new Ee,ze=new Ee,He=new Ee;function Ve(t,e,n,i,r){for(var a=0,o=t.length-3;a<=o;a+=3){He.fromArray(t,a);var s=r.x*Math.abs(He.x)+r.y*Math.abs(He.y)+r.z*Math.abs(He.z),l=e.dot(He),u=n.dot(He),h=i.dot(He);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}var je=new Ce,Xe=new Ee,We=new Ee,qe=new Ee,Ye=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;a(this,t),this.center=e,this.radius=n}return s(t,[{key:"set",value:function(t,e){return this.center.copy(t),this.radius=e,this}},{key:"setFromPoints",value:function(t,e){var n=this.center;void 0!==e?n.copy(e):je.setFromPoints(t).getCenter(n);for(var i=0,r=0,a=t.length;r<a;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}},{key:"copy",value:function(t){return this.center.copy(t.center),this.radius=t.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(t){return t.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}},{key:"intersectsBox",value:function(t){return t.intersectsSphere(this)}},{key:"intersectsPlane",value:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(t,e){var n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}},{key:"getBoundingBox",value:function(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}},{key:"applyMatrix4",value:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}},{key:"translate",value:function(t){return this.center.add(t),this}},{key:"expandByPoint",value:function(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;qe.subVectors(t,this.center);var e=qe.lengthSq();if(e>this.radius*this.radius){var n=Math.sqrt(e),i=.5*(n-this.radius);this.center.add(qe.multiplyScalar(i/n)),this.radius+=i}return this}},{key:"union",value:function(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?We.set(0,0,1).multiplyScalar(t.radius):We.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(Xe.copy(t.center).add(We)),this.expandByPoint(Xe.copy(t.center).sub(We)),this)}},{key:"equals",value:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),Ke=new Ee,Ze=new Ee,Je=new Ee,Qe=new Ee,$e=new Ee,tn=new Ee,en=new Ee,nn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee(0,0,-1);a(this,t),this.origin=e,this.direction=n}return s(t,[{key:"set",value:function(t,e){return this.origin.copy(t),this.direction.copy(e),this}},{key:"copy",value:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}},{key:"at",value:function(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}},{key:"lookAt",value:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this}},{key:"recast",value:function(t){return this.origin.copy(this.at(t,Ke)),this}},{key:"closestPointToPoint",value:function(t,e){e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(t){return Math.sqrt(this.distanceSqToPoint(t))}},{key:"distanceSqToPoint",value:function(t){var e=Ke.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Ke.copy(this.direction).multiplyScalar(e).add(this.origin),Ke.distanceToSquared(t))}},{key:"distanceSqToSegment",value:function(t,e,n,i){Ze.copy(t).add(e).multiplyScalar(.5),Je.copy(e).sub(t).normalize(),Qe.copy(this.origin).sub(Ze);var r,a,o,s,l=.5*t.distanceTo(e),u=-this.direction.dot(Je),h=Qe.dot(this.direction),c=-Qe.dot(Je),d=Qe.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(a=u*h-c,s=l*f,(r=u*c-h)>=0)if(a>=-s)if(a<=s){var p=1/f;o=(r*=p)*(r+u*(a*=p)+2*h)+a*(u*r+a+2*c)+d}else a=l,o=-(r=Math.max(0,-(u*a+h)))*r+a*(a+2*c)+d;else a=-l,o=-(r=Math.max(0,-(u*a+h)))*r+a*(a+2*c)+d;else a<=-s?o=-(r=Math.max(0,-(-u*l+h)))*r+(a=r>0?-l:Math.min(Math.max(-l,-c),l))*(a+2*c)+d:a<=s?(r=0,o=(a=Math.min(Math.max(-l,-c),l))*(a+2*c)+d):o=-(r=Math.max(0,-(u*l+h)))*r+(a=r>0?l:Math.min(Math.max(-l,-c),l))*(a+2*c)+d;else a=u>0?-l:l,o=-(r=Math.max(0,-(u*a+h)))*r+a*(a+2*c)+d;return n&&n.copy(this.direction).multiplyScalar(r).add(this.origin),i&&i.copy(Je).multiplyScalar(a).add(Ze),o}},{key:"intersectSphere",value:function(t,e){Ke.subVectors(t.center,this.origin);var n=Ke.dot(this.direction),i=Ke.dot(Ke)-n*n,r=t.radius*t.radius;if(i>r)return null;var a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,e):this.at(o,e)}},{key:"intersectsSphere",value:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}},{key:"distanceToPlane",value:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}},{key:"intersectPlane",value:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}},{key:"intersectsPlane",value:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0}},{key:"intersectBox",value:function(t,e){var n,i,r,a,o,s,l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,c=this.origin;return l>=0?(n=(t.min.x-c.x)*l,i=(t.max.x-c.x)*l):(n=(t.max.x-c.x)*l,i=(t.min.x-c.x)*l),u>=0?(r=(t.min.y-c.y)*u,a=(t.max.y-c.y)*u):(r=(t.max.y-c.y)*u,a=(t.min.y-c.y)*u),n>a||r>i?null:((r>n||n!==n)&&(n=r),(a<i||i!==i)&&(i=a),h>=0?(o=(t.min.z-c.z)*h,s=(t.max.z-c.z)*h):(o=(t.max.z-c.z)*h,s=(t.min.z-c.z)*h),n>s||o>i?null:((o>n||n!==n)&&(n=o),(s<i||i!==i)&&(i=s),i<0?null:this.at(n>=0?n:i,e)))}},{key:"intersectsBox",value:function(t){return null!==this.intersectBox(t,Ke)}},{key:"intersectTriangle",value:function(t,e,n,i,r){$e.subVectors(e,t),tn.subVectors(n,t),en.crossVectors($e,tn);var a,o=this.direction.dot(en);if(o>0){if(i)return null;a=1}else{if(!(o<0))return null;a=-1,o=-o}Qe.subVectors(this.origin,t);var s=a*this.direction.dot(tn.crossVectors(Qe,tn));if(s<0)return null;var l=a*this.direction.dot($e.cross(Qe));if(l<0)return null;if(s+l>o)return null;var u=-a*Qe.dot(en);return u<0?null:this.at(u/o,r)}},{key:"applyMatrix4",value:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}},{key:"equals",value:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),rn=function(){function t(){a(this,t),t.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}return s(t,[{key:"set",value:function(t,e,n,i,r,a,o,s,l,u,h,c,d,f,p,v){var m=this.elements;return m[0]=t,m[4]=e,m[8]=n,m[12]=i,m[1]=r,m[5]=a,m[9]=o,m[13]=s,m[2]=l,m[6]=u,m[10]=h,m[14]=c,m[3]=d,m[7]=f,m[11]=p,m[15]=v,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new t).fromArray(this.elements)}},{key:"copy",value:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}},{key:"copyPosition",value:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}},{key:"setFromMatrix3",value:function(t){var e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(t){var e=this.elements,n=t.elements,i=1/an.setFromMatrixColumn(t,0).length(),r=1/an.setFromMatrixColumn(t,1).length(),a=1/an.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*a,e[9]=n[9]*a,e[10]=n[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},{key:"makeRotationFromEuler",value:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),u=Math.cos(r),h=Math.sin(r);if("XYZ"===t.order){var c=a*u,d=a*h,f=o*u,p=o*h;e[0]=s*u,e[4]=-s*h,e[8]=l,e[1]=d+f*l,e[5]=c-p*l,e[9]=-o*s,e[2]=p-c*l,e[6]=f+d*l,e[10]=a*s}else if("YXZ"===t.order){var v=s*u,m=s*h,g=l*u,y=l*h;e[0]=v+y*o,e[4]=g*o-m,e[8]=a*l,e[1]=a*h,e[5]=a*u,e[9]=-o,e[2]=m*o-g,e[6]=y+v*o,e[10]=a*s}else if("ZXY"===t.order){var _=s*u,x=s*h,b=l*u,w=l*h;e[0]=_-w*o,e[4]=-a*h,e[8]=b+x*o,e[1]=x+b*o,e[5]=a*u,e[9]=w-_*o,e[2]=-a*l,e[6]=o,e[10]=a*s}else if("ZYX"===t.order){var S=a*u,T=a*h,M=o*u,E=o*h;e[0]=s*u,e[4]=M*l-T,e[8]=S*l+E,e[1]=s*h,e[5]=E*l+S,e[9]=T*l-M,e[2]=-l,e[6]=o*s,e[10]=a*s}else if("YZX"===t.order){var A=a*s,P=a*l,C=o*s,k=o*l;e[0]=s*u,e[4]=k-A*h,e[8]=C*h+P,e[1]=h,e[5]=a*u,e[9]=-o*u,e[2]=-l*u,e[6]=P*h+C,e[10]=A-k*h}else if("XZY"===t.order){var R=a*s,I=a*l,D=o*s,O=o*l;e[0]=s*u,e[4]=-h,e[8]=l*u,e[1]=R*h+O,e[5]=a*u,e[9]=I*h-D,e[2]=D*h-I,e[6]=o*u,e[10]=O*h+R}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(t){return this.compose(sn,t,ln)}},{key:"lookAt",value:function(t,e,n){var i=this.elements;return cn.subVectors(t,e),0===cn.lengthSq()&&(cn.z=1),cn.normalize(),un.crossVectors(n,cn),0===un.lengthSq()&&(1===Math.abs(n.z)?cn.x+=1e-4:cn.z+=1e-4,cn.normalize(),un.crossVectors(n,cn)),un.normalize(),hn.crossVectors(cn,un),i[0]=un.x,i[4]=hn.x,i[8]=cn.x,i[1]=un.y,i[5]=hn.y,i[9]=cn.y,i[2]=un.z,i[6]=hn.z,i[10]=cn.z,this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,e){var n=t.elements,i=e.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],u=n[1],h=n[5],c=n[9],d=n[13],f=n[2],p=n[6],v=n[10],m=n[14],g=n[3],y=n[7],_=n[11],x=n[15],b=i[0],w=i[4],S=i[8],T=i[12],M=i[1],E=i[5],A=i[9],P=i[13],C=i[2],k=i[6],R=i[10],I=i[14],D=i[3],O=i[7],L=i[11],N=i[15];return r[0]=a*b+o*M+s*C+l*D,r[4]=a*w+o*E+s*k+l*O,r[8]=a*S+o*A+s*R+l*L,r[12]=a*T+o*P+s*I+l*N,r[1]=u*b+h*M+c*C+d*D,r[5]=u*w+h*E+c*k+d*O,r[9]=u*S+h*A+c*R+d*L,r[13]=u*T+h*P+c*I+d*N,r[2]=f*b+p*M+v*C+m*D,r[6]=f*w+p*E+v*k+m*O,r[10]=f*S+p*A+v*R+m*L,r[14]=f*T+p*P+v*I+m*N,r[3]=g*b+y*M+_*C+x*D,r[7]=g*w+y*E+_*k+x*O,r[11]=g*S+y*A+_*R+x*L,r[15]=g*T+y*P+_*I+x*N,this}},{key:"multiplyScalar",value:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}},{key:"determinant",value:function(){var t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],a=t[1],o=t[5],s=t[9],l=t[13],u=t[2],h=t[6],c=t[10],d=t[14];return t[3]*(+r*s*h-i*l*h-r*o*c+n*l*c+i*o*d-n*s*d)+t[7]*(+e*s*d-e*l*c+r*a*c-i*a*d+i*l*u-r*s*u)+t[11]*(+e*l*h-e*o*d-r*a*h+n*a*d+r*o*u-n*l*u)+t[15]*(-i*o*u-e*s*h+e*o*c+i*a*h-n*a*c+n*s*u)}},{key:"transpose",value:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}},{key:"setPosition",value:function(t,e,n){var i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}},{key:"invert",value:function(){var t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],h=t[9],c=t[10],d=t[11],f=t[12],p=t[13],v=t[14],m=t[15],g=h*v*l-p*c*l+p*s*d-o*v*d-h*s*m+o*c*m,y=f*c*l-u*v*l-f*s*d+a*v*d+u*s*m-a*c*m,_=u*p*l-f*h*l+f*o*d-a*p*d-u*o*m+a*h*m,x=f*h*s-u*p*s-f*o*c+a*p*c+u*o*v-a*h*v,b=e*g+n*y+i*_+r*x;if(0===b)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var w=1/b;return t[0]=g*w,t[1]=(p*c*r-h*v*r-p*i*d+n*v*d+h*i*m-n*c*m)*w,t[2]=(o*v*r-p*s*r+p*i*l-n*v*l-o*i*m+n*s*m)*w,t[3]=(h*s*r-o*c*r-h*i*l+n*c*l+o*i*d-n*s*d)*w,t[4]=y*w,t[5]=(u*v*r-f*c*r+f*i*d-e*v*d-u*i*m+e*c*m)*w,t[6]=(f*s*r-a*v*r-f*i*l+e*v*l+a*i*m-e*s*m)*w,t[7]=(a*c*r-u*s*r+u*i*l-e*c*l-a*i*d+e*s*d)*w,t[8]=_*w,t[9]=(f*h*r-u*p*r-f*n*d+e*p*d+u*n*m-e*h*m)*w,t[10]=(a*p*r-f*o*r+f*n*l-e*p*l-a*n*m+e*o*m)*w,t[11]=(u*o*r-a*h*r-u*n*l+e*h*l+a*n*d-e*o*d)*w,t[12]=x*w,t[13]=(u*p*i-f*h*i+f*n*c-e*p*c-u*n*v+e*h*v)*w,t[14]=(f*o*i-a*p*i-f*n*s+e*p*s+a*n*v-e*o*v)*w,t[15]=(a*h*i-u*o*i+u*n*s-e*h*s-a*n*c+e*o*c)*w,this}},{key:"scale",value:function(t){var e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}},{key:"getMaxScaleOnAxis",value:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}},{key:"makeTranslation",value:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}},{key:"makeRotationY",value:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(t,e){var n=Math.cos(e),i=Math.sin(e),r=1-n,a=t.x,o=t.y,s=t.z,l=r*a,u=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,u*o+n,u*s-i*a,0,l*s-i*o,u*s+i*a,r*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(t,e,n,i,r,a){return this.set(1,n,r,0,t,1,a,0,e,i,1,0,0,0,0,1),this}},{key:"compose",value:function(t,e,n){var i=this.elements,r=e._x,a=e._y,o=e._z,s=e._w,l=r+r,u=a+a,h=o+o,c=r*l,d=r*u,f=r*h,p=a*u,v=a*h,m=o*h,g=s*l,y=s*u,_=s*h,x=n.x,b=n.y,w=n.z;return i[0]=(1-(p+m))*x,i[1]=(d+_)*x,i[2]=(f-y)*x,i[3]=0,i[4]=(d-_)*b,i[5]=(1-(c+m))*b,i[6]=(v+g)*b,i[7]=0,i[8]=(f+y)*w,i[9]=(v-g)*w,i[10]=(1-(c+p))*w,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}},{key:"decompose",value:function(t,e,n){var i=this.elements,r=an.set(i[0],i[1],i[2]).length(),a=an.set(i[4],i[5],i[6]).length(),o=an.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],on.copy(this);var s=1/r,l=1/a,u=1/o;return on.elements[0]*=s,on.elements[1]*=s,on.elements[2]*=s,on.elements[4]*=l,on.elements[5]*=l,on.elements[6]*=l,on.elements[8]*=u,on.elements[9]*=u,on.elements[10]*=u,e.setFromRotationMatrix(on),n.x=r,n.y=a,n.z=o,this}},{key:"makePerspective",value:function(t,e,n,i,r,a){var o=this.elements,s=2*r/(e-t),l=2*r/(n-i),u=(e+t)/(e-t),h=(n+i)/(n-i),c=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=l,o[9]=h,o[13]=0,o[2]=0,o[6]=0,o[10]=c,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(t,e,n,i,r,a){var o=this.elements,s=1/(e-t),l=1/(n-i),u=1/(a-r),h=(e+t)*s,c=(n+i)*l,d=(a+r)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-h,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-c,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(t){for(var e=this.elements,n=t.elements,i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=t[n+e];return this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}]),t}(),an=new Ee,on=new rn,sn=new Ee(0,0,0),ln=new Ee(1,1,1),un=new Ee,hn=new Ee,cn=new Ee,dn=new rn,fn=new Me,pn=function(t){function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.DefaultOrder;a(this,n),this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=r}return s(n,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}},{key:"set",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=t.elements,r=i[0],a=i[4],o=i[8],s=i[1],l=i[5],u=i[9],h=i[2],c=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Xt(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-a,r)):(this._x=Math.atan2(c,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Xt(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Xt(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(s,r));break;case"ZYX":this._y=Math.asin(-Xt(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(c,d),this._z=Math.atan2(s,r)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Xt(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Xt(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(c,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-u,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(t,e,n){return dn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(dn,e,n)}},{key:"setFromVector3",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(t.x,t.y,t.z,e)}},{key:"reorder",value:function(t){return fn.setFromEuler(this),this.setFromQuaternion(fn,t)}},{key:"equals",value:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}},{key:"fromArray",value:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}},{key:"_onChange",value:function(t){return this._onChangeCallback=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._x;case 2:return t.next=4,this._y;case 4:return t.next=6,this._z;case 6:return t.next=8,this._order;case 8:case"end":return t.stop()}}),t,this)}))},{key:"toVector3",value:function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}]),n}();pn.DefaultOrder="XYZ",pn.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var vn=function(){function t(){a(this,t),this.mask=1}return s(t,[{key:"set",value:function(t){this.mask=(1<<t|0)>>>0}},{key:"enable",value:function(t){this.mask|=1<<t|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(t){this.mask^=1<<t|0}},{key:"disable",value:function(t){this.mask&=~(1<<t|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(t){return 0!==(this.mask&t.mask)}},{key:"isEnabled",value:function(t){return 0!==(this.mask&(1<<t|0))}}]),t}(),mn=0,gn=new Ee,yn=new Me,_n=new rn,xn=new Ee,bn=new Ee,wn=new Ee,Sn=new Me,Tn=new Ee(1,0,0),Mn=new Ee(0,1,0),En=new Ee(0,0,1),An={type:"added"},Pn={type:"removed"},Cn=function(t){d(n,t);var e=m(n);function n(){var t;a(this,n),(t=e.call(this)).isObject3D=!0,Object.defineProperty(h(t),"id",{value:mn++}),t.uuid=jt(),t.name="",t.type="Object3D",t.parent=null,t.children=[],t.up=n.DefaultUp.clone();var i=new Ee,r=new pn,o=new Me,s=new Ee(1,1,1);return r._onChange((function(){o.setFromEuler(r,!1)})),o._onChange((function(){r.setFromQuaternion(o,void 0,!1)})),Object.defineProperties(h(t),{position:{configurable:!0,enumerable:!0,value:i},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new rn},normalMatrix:{value:new ee}}),t.matrix=new rn,t.matrixWorld=new rn,t.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,t.matrixWorldNeedsUpdate=!1,t.matrixWorldAutoUpdate=n.DefaultMatrixWorldAutoUpdate,t.layers=new vn,t.visible=!0,t.castShadow=!1,t.receiveShadow=!1,t.frustumCulled=!0,t.renderOrder=0,t.animations=[],t.userData={},t}return s(n,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(t){return this.quaternion.premultiply(t),this}},{key:"setRotationFromAxisAngle",value:function(t,e){this.quaternion.setFromAxisAngle(t,e)}},{key:"setRotationFromEuler",value:function(t){this.quaternion.setFromEuler(t,!0)}},{key:"setRotationFromMatrix",value:function(t){this.quaternion.setFromRotationMatrix(t)}},{key:"setRotationFromQuaternion",value:function(t){this.quaternion.copy(t)}},{key:"rotateOnAxis",value:function(t,e){return yn.setFromAxisAngle(t,e),this.quaternion.multiply(yn),this}},{key:"rotateOnWorldAxis",value:function(t,e){return yn.setFromAxisAngle(t,e),this.quaternion.premultiply(yn),this}},{key:"rotateX",value:function(t){return this.rotateOnAxis(Tn,t)}},{key:"rotateY",value:function(t){return this.rotateOnAxis(Mn,t)}},{key:"rotateZ",value:function(t){return this.rotateOnAxis(En,t)}},{key:"translateOnAxis",value:function(t,e){return gn.copy(t).applyQuaternion(this.quaternion),this.position.add(gn.multiplyScalar(e)),this}},{key:"translateX",value:function(t){return this.translateOnAxis(Tn,t)}},{key:"translateY",value:function(t){return this.translateOnAxis(Mn,t)}},{key:"translateZ",value:function(t){return this.translateOnAxis(En,t)}},{key:"localToWorld",value:function(t){return t.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(t){return t.applyMatrix4(_n.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(t,e,n){t.isVector3?xn.copy(t):xn.set(t,e,n);var i=this.parent;this.updateWorldMatrix(!0,!1),bn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_n.lookAt(bn,xn,this.up):_n.lookAt(xn,bn,this.up),this.quaternion.setFromRotationMatrix(_n),i&&(_n.extractRotation(i.matrixWorld),yn.setFromRotationMatrix(_n),this.quaternion.premultiply(yn.invert()))}},{key:"add",value:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(An)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}},{key:"remove",value:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(Pn)),this}},{key:"removeFromParent",value:function(){var t=this.parent;return null!==t&&t.remove(this),this}},{key:"clear",value:function(){for(var t=0;t<this.children.length;t++){var e=this.children[t];e.parent=null,e.dispatchEvent(Pn)}return this.children.length=0,this}},{key:"attach",value:function(t){return this.updateWorldMatrix(!0,!1),_n.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),_n.multiply(t.parent.matrixWorld)),t.applyMatrix4(_n),this.add(t),t.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(t){return this.getObjectByProperty("id",t)}},{key:"getObjectByName",value:function(t){return this.getObjectByProperty("name",t)}},{key:"getObjectByProperty",value:function(t,e){if(this[t]===e)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n].getObjectByProperty(t,e);if(void 0!==r)return r}}},{key:"getWorldPosition",value:function(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bn,t,wn),t}},{key:"getWorldScale",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bn,Sn,t),t}},{key:"getWorldDirection",value:function(t){this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(t){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverse(t)}},{key:"traverseVisible",value:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}}},{key:"traverseAncestors",value:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,i=e.length;n<i;n++){var r=e[n];!0!==r.matrixWorldAutoUpdate&&!0!==t||r.updateMatrixWorld(t)}}},{key:"updateWorldMatrix",value:function(t,e){var n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e)for(var i=this.children,r=0,a=i.length;r<a;r++){var o=i[r];!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(t){var e=void 0===t||"string"===typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var u=o[s];r(t.shapes,u)}else r(t.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var h=[],c=0,d=this.material.length;c<d;c++)h.push(r(t.materials,this.material[c]));i.material=h}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(var f=0;f<this.children.length;f++)i.children.push(this.children[f].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(var p=0;p<this.animations.length;p++){var v=this.animations[p];i.animations.push(r(t.animations,v))}}if(e){var m=T(t.geometries),g=T(t.materials),y=T(t.textures),_=T(t.images),x=T(t.shapes),b=T(t.skeletons),w=T(t.animations),S=T(t.nodes);m.length>0&&(n.geometries=m),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),_.length>0&&(n.images=_),x.length>0&&(n.shapes=x),b.length>0&&(n.skeletons=b),w.length>0&&(n.animations=w),S.length>0&&(n.nodes=S)}return n.object=i,n;function T(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}}},{key:"clone",value:function(t){return(new this.constructor).copy(this,t)}},{key:"copy",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var i=t.children[n];this.add(i.clone())}return this}}]),n}(Ut);Cn.DefaultUp=new Ee(0,1,0),Cn.DefaultMatrixAutoUpdate=!0,Cn.DefaultMatrixWorldAutoUpdate=!0;var kn=new Ee,Rn=new Ee,In=new Ee,Dn=new Ee,On=new Ee,Ln=new Ee,Nn=new Ee,Fn=new Ee,Bn=new Ee,Un=new Ee,Gn=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ee;a(this,t),this.a=e,this.b=n,this.c=i}return s(t,[{key:"set",value:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}},{key:"setFromAttributeAndIndices",value:function(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}},{key:"getArea",value:function(){return kn.subVectors(this.c,this.b),Rn.subVectors(this.a,this.b),.5*kn.cross(Rn).length()}},{key:"getMidpoint",value:function(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(e){return t.getNormal(this.a,this.b,this.c,e)}},{key:"getPlane",value:function(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(e,n){return t.getBarycoord(e,this.a,this.b,this.c,n)}},{key:"getUV",value:function(e,n,i,r,a){return t.getUV(e,this.a,this.b,this.c,n,i,r,a)}},{key:"containsPoint",value:function(e){return t.containsPoint(e,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(e){return t.isFrontFacing(this.a,this.b,this.c,e)}},{key:"intersectsBox",value:function(t){return t.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(t,e){var n,i,r=this.a,a=this.b,o=this.c;On.subVectors(a,r),Ln.subVectors(o,r),Fn.subVectors(t,r);var s=On.dot(Fn),l=Ln.dot(Fn);if(s<=0&&l<=0)return e.copy(r);Bn.subVectors(t,a);var u=On.dot(Bn),h=Ln.dot(Bn);if(u>=0&&h<=u)return e.copy(a);var c=s*h-u*l;if(c<=0&&s>=0&&u<=0)return n=s/(s-u),e.copy(r).addScaledVector(On,n);Un.subVectors(t,o);var d=On.dot(Un),f=Ln.dot(Un);if(f>=0&&d<=f)return e.copy(o);var p=d*l-s*f;if(p<=0&&l>=0&&f<=0)return i=l/(l-f),e.copy(r).addScaledVector(Ln,i);var v=u*f-d*h;if(v<=0&&h-u>=0&&d-f>=0)return Nn.subVectors(o,a),i=(h-u)/(h-u+(d-f)),e.copy(a).addScaledVector(Nn,i);var m=1/(v+p+c);return n=p*m,i=c*m,e.copy(r).addScaledVector(On,n).addScaledVector(Ln,i)}},{key:"equals",value:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}],[{key:"getNormal",value:function(t,e,n,i){i.subVectors(n,e),kn.subVectors(t,e),i.cross(kn);var r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}},{key:"getBarycoord",value:function(t,e,n,i,r){kn.subVectors(i,e),Rn.subVectors(n,e),In.subVectors(t,e);var a=kn.dot(kn),o=kn.dot(Rn),s=kn.dot(In),l=Rn.dot(Rn),u=Rn.dot(In),h=a*l-o*o;if(0===h)return r.set(-2,-1,-1);var c=1/h,d=(l*s-o*u)*c,f=(a*u-o*s)*c;return r.set(1-d-f,f,d)}},{key:"containsPoint",value:function(t,e,n,i){return this.getBarycoord(t,e,n,i,Dn),Dn.x>=0&&Dn.y>=0&&Dn.x+Dn.y<=1}},{key:"getUV",value:function(t,e,n,i,r,a,o,s){return this.getBarycoord(t,e,n,i,Dn),s.set(0,0),s.addScaledVector(r,Dn.x),s.addScaledVector(a,Dn.y),s.addScaledVector(o,Dn.z),s}},{key:"isFrontFacing",value:function(t,e,n,i){return kn.subVectors(n,e),Rn.subVectors(t,e),kn.cross(Rn).dot(i)<0}}]),t}(),zn=0,Hn=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isMaterial=!0,Object.defineProperty(h(t),"id",{value:zn++}),t.uuid=jt(),t.name="",t.type="Material",t.blending=1,t.side=0,t.vertexColors=!1,t.opacity=1,t.transparent=!1,t.blendSrc=204,t.blendDst=205,t.blendEquation=P,t.blendSrcAlpha=null,t.blendDstAlpha=null,t.blendEquationAlpha=null,t.depthFunc=3,t.depthTest=!0,t.depthWrite=!0,t.stencilWriteMask=255,t.stencilFunc=519,t.stencilRef=0,t.stencilFuncMask=255,t.stencilFail=Lt,t.stencilZFail=Lt,t.stencilZPass=Lt,t.stencilWrite=!1,t.clippingPlanes=null,t.clipIntersection=!1,t.clipShadows=!1,t.shadowSide=null,t.colorWrite=!0,t.precision=null,t.polygonOffset=!1,t.polygonOffsetFactor=0,t.polygonOffsetUnits=0,t.dithering=!1,t.alphaToCoverage=!1,t.premultipliedAlpha=!1,t.visible=!0,t.toneMapped=!0,t.userData={},t.version=0,t._alphaTest=0,t}return s(n,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(t){this._alphaTest>0!==t>0&&this.version++,this._alphaTest=t}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n){var i=this[e];void 0!==i?i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}}},{key:"toJSON",value:function(t){var e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function i(t){var e=[];for(var n in t){var i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),e){var r=i(t.textures),a=i(t.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var e=t.clippingPlanes,n=null;if(null!==e){var i=e.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}}]),n}(Ut),Vn=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshBasicMaterial=!0,i.type="MeshBasicMaterial",i.color=new ve(16777215),i.map=null,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=null,i.aoMapIntensity=1,i.specularMap=null,i.alphaMap=null,i.envMap=null,i.combine=0,i.reflectivity=1,i.refractionRatio=.98,i.wireframe=!1,i.wireframeLinewidth=1,i.wireframeLinecap="round",i.wireframeLinejoin="round",i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}]),n}(Hn),jn=new Ee,Xn=new te,Wn=function(){function t(e,n,i){if(a(this,t),Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=void 0!==e?e.length/n:0,this.normalized=!0===i,this.usage=Nt,this.updateRange={offset:0,count:-1},this.version=0}return s(t,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"setUsage",value:function(t){return this.usage=t,this}},{key:"copy",value:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}},{key:"copyAt",value:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}},{key:"copyArray",value:function(t){return this.array.set(t),this}},{key:"applyMatrix3",value:function(t){if(2===this.itemSize)for(var e=0,n=this.count;e<n;e++)Xn.fromBufferAttribute(this,e),Xn.applyMatrix3(t),this.setXY(e,Xn.x,Xn.y);else if(3===this.itemSize)for(var i=0,r=this.count;i<r;i++)jn.fromBufferAttribute(this,i),jn.applyMatrix3(t),this.setXYZ(i,jn.x,jn.y,jn.z);return this}},{key:"applyMatrix4",value:function(t){for(var e=0,n=this.count;e<n;e++)jn.fromBufferAttribute(this,e),jn.applyMatrix4(t),this.setXYZ(e,jn.x,jn.y,jn.z);return this}},{key:"applyNormalMatrix",value:function(t){for(var e=0,n=this.count;e<n;e++)jn.fromBufferAttribute(this,e),jn.applyNormalMatrix(t),this.setXYZ(e,jn.x,jn.y,jn.z);return this}},{key:"transformDirection",value:function(t){for(var e=0,n=this.count;e<n;e++)jn.fromBufferAttribute(this,e),jn.transformDirection(t),this.setXYZ(e,jn.x,jn.y,jn.z);return this}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}},{key:"getX",value:function(t){var e=this.array[t*this.itemSize];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"setX",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.array[t*this.itemSize]=e,this}},{key:"getY",value:function(t){var e=this.array[t*this.itemSize+1];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"setY",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.array[t*this.itemSize+1]=e,this}},{key:"getZ",value:function(t){var e=this.array[t*this.itemSize+2];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"setZ",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.array[t*this.itemSize+2]=e,this}},{key:"getW",value:function(t){var e=this.array[t*this.itemSize+3];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"setW",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.array[t*this.itemSize+3]=e,this}},{key:"setXY",value:function(t,e,n){return t*=this.itemSize,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}},{key:"setXYZ",value:function(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array),i=Qt(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}},{key:"setXYZW",value:function(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}},{key:"onUpload",value:function(t){return this.onUploadCallback=t,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==Nt&&(t.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(t.updateRange=this.updateRange),t}},{key:"copyColorsArray",value:function(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}},{key:"copyVector2sArray",value:function(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}},{key:"copyVector3sArray",value:function(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}},{key:"copyVector4sArray",value:function(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}]),t}(),qn=function(t){d(n,t);var e=m(n);function n(t,i,r){return a(this,n),e.call(this,new Uint16Array(t),i,r)}return s(n)}(Wn),Yn=function(t){d(n,t);var e=m(n);function n(t,i,r){return a(this,n),e.call(this,new Uint32Array(t),i,r)}return s(n)}(Wn),Kn=function(t){d(n,t);var e=m(n);function n(t,i,r){return a(this,n),e.call(this,new Float32Array(t),i,r)}return s(n)}(Wn),Zn=0,Jn=new rn,Qn=new Cn,$n=new Ee,ti=new Ce,ei=new Ce,ni=new Ee,ii=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isBufferGeometry=!0,Object.defineProperty(h(t),"id",{value:Zn++}),t.uuid=jt(),t.name="",t.type="BufferGeometry",t.index=null,t.attributes={},t.morphAttributes={},t.morphTargetsRelative=!1,t.groups=[],t.boundingBox=null,t.boundingSphere=null,t.drawRange={start:0,count:1/0},t.userData={},t}return s(n,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(t){return Array.isArray(t)?this.index=new(ne(t)?Yn:qn)(t,1):this.index=t,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"setAttribute",value:function(t,e){return this.attributes[t]=e,this}},{key:"deleteAttribute",value:function(t){return delete this.attributes[t],this}},{key:"hasAttribute",value:function(t){return void 0!==this.attributes[t]}},{key:"addGroup",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:t,count:e,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(t,e){this.drawRange.start=t,this.drawRange.count=e}},{key:"applyMatrix4",value:function(t){var e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var i=(new ee).getNormalMatrix(t);n.applyNormalMatrix(i),n.needsUpdate=!0}var r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(t),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(t){return Jn.makeRotationFromQuaternion(t),this.applyMatrix4(Jn),this}},{key:"rotateX",value:function(t){return Jn.makeRotationX(t),this.applyMatrix4(Jn),this}},{key:"rotateY",value:function(t){return Jn.makeRotationY(t),this.applyMatrix4(Jn),this}},{key:"rotateZ",value:function(t){return Jn.makeRotationZ(t),this.applyMatrix4(Jn),this}},{key:"translate",value:function(t,e,n){return Jn.makeTranslation(t,e,n),this.applyMatrix4(Jn),this}},{key:"scale",value:function(t,e,n){return Jn.makeScale(t,e,n),this.applyMatrix4(Jn),this}},{key:"lookAt",value:function(t){return Qn.lookAt(t),Qn.updateMatrix(),this.applyMatrix4(Qn.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter($n).negate(),this.translate($n.x,$n.y,$n.z),this}},{key:"setFromPoints",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new Kn(e,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new Ce);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ee(-1/0,-1/0,-1/0),new Ee(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(var n=0,i=e.length;n<i;n++){var r=e[n];ti.setFromBufferAttribute(r),this.morphTargetsRelative?(ni.addVectors(this.boundingBox.min,ti.min),this.boundingBox.expandByPoint(ni),ni.addVectors(this.boundingBox.max,ti.max),this.boundingBox.expandByPoint(ni)):(this.boundingBox.expandByPoint(ti.min),this.boundingBox.expandByPoint(ti.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new Ye);var t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ee,1/0);if(t){var n=this.boundingSphere.center;if(ti.setFromBufferAttribute(t),e)for(var i=0,r=e.length;i<r;i++){var a=e[i];ei.setFromBufferAttribute(a),this.morphTargetsRelative?(ni.addVectors(ti.min,ei.min),ti.expandByPoint(ni),ni.addVectors(ti.max,ei.max),ti.expandByPoint(ni)):(ti.expandByPoint(ei.min),ti.expandByPoint(ei.max))}ti.getCenter(n);for(var o=0,s=0,l=t.count;s<l;s++)ni.fromBufferAttribute(t,s),o=Math.max(o,n.distanceToSquared(ni));if(e)for(var u=0,h=e.length;u<h;u++)for(var c=e[u],d=this.morphTargetsRelative,f=0,p=c.count;f<p;f++)ni.fromBufferAttribute(c,f),d&&($n.fromBufferAttribute(t,f),ni.add($n)),o=Math.max(o,n.distanceToSquared(ni));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var t=this.index,e=this.attributes;if(null!==t&&void 0!==e.position&&void 0!==e.normal&&void 0!==e.uv){var n=t.array,i=e.position.array,r=e.normal.array,a=e.uv.array,o=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Wn(new Float32Array(4*o),4));for(var s=this.getAttribute("tangent").array,l=[],u=[],h=0;h<o;h++)l[h]=new Ee,u[h]=new Ee;var c=new Ee,d=new Ee,f=new Ee,p=new te,v=new te,m=new te,g=new Ee,y=new Ee,_=this.groups;0===_.length&&(_=[{start:0,count:n.length}]);for(var x=0,b=_.length;x<b;++x)for(var w=_[x],S=w.start,T=S,M=S+w.count;T<M;T+=3)N(n[T+0],n[T+1],n[T+2]);for(var E=new Ee,A=new Ee,P=new Ee,C=new Ee,k=0,R=_.length;k<R;++k)for(var I=_[k],D=I.start,O=D,L=D+I.count;O<L;O+=3)F(n[O+0]),F(n[O+1]),F(n[O+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function N(t,e,n){c.fromArray(i,3*t),d.fromArray(i,3*e),f.fromArray(i,3*n),p.fromArray(a,2*t),v.fromArray(a,2*e),m.fromArray(a,2*n),d.sub(c),f.sub(c),v.sub(p),m.sub(p);var r=1/(v.x*m.y-m.x*v.y);isFinite(r)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(f,-v.y).multiplyScalar(r),y.copy(f).multiplyScalar(v.x).addScaledVector(d,-m.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),u[t].add(y),u[e].add(y),u[n].add(y))}function F(t){P.fromArray(r,3*t),C.copy(P);var e=l[t];E.copy(e),E.sub(P.multiplyScalar(P.dot(e))).normalize(),A.crossVectors(C,e);var n=A.dot(u[t])<0?-1:1;s[4*t]=E.x,s[4*t+1]=E.y,s[4*t+2]=E.z,s[4*t+3]=n}}},{key:"computeVertexNormals",value:function(){var t=this.index,e=this.getAttribute("position");if(void 0!==e){var n=this.getAttribute("normal");if(void 0===n)n=new Wn(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(var i=0,r=n.count;i<r;i++)n.setXYZ(i,0,0,0);var a=new Ee,o=new Ee,s=new Ee,l=new Ee,u=new Ee,h=new Ee,c=new Ee,d=new Ee;if(t)for(var f=0,p=t.count;f<p;f+=3){var v=t.getX(f+0),m=t.getX(f+1),g=t.getX(f+2);a.fromBufferAttribute(e,v),o.fromBufferAttribute(e,m),s.fromBufferAttribute(e,g),c.subVectors(s,o),d.subVectors(a,o),c.cross(d),l.fromBufferAttribute(n,v),u.fromBufferAttribute(n,m),h.fromBufferAttribute(n,g),l.add(c),u.add(c),h.add(c),n.setXYZ(v,l.x,l.y,l.z),n.setXYZ(m,u.x,u.y,u.z),n.setXYZ(g,h.x,h.y,h.z)}else for(var y=0,_=e.count;y<_;y+=3)a.fromBufferAttribute(e,y+0),o.fromBufferAttribute(e,y+1),s.fromBufferAttribute(e,y+2),c.subVectors(s,o),d.subVectors(a,o),c.cross(d),n.setXYZ(y+0,c.x,c.y,c.z),n.setXYZ(y+1,c.x,c.y,c.z),n.setXYZ(y+2,c.x,c.y,c.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"merge",value:function(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}},{key:"normalizeNormals",value:function(){for(var t=this.attributes.normal,e=0,n=t.count;e<n;e++)ni.fromBufferAttribute(t,e),ni.normalize(),t.setXYZ(e,ni.x,ni.y,ni.z)}},{key:"toNonIndexed",value:function(){function t(t,e){for(var n=t.array,i=t.itemSize,r=t.normalized,a=new n.constructor(e.length*i),o=0,s=0,l=0,u=e.length;l<u;l++){o=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(var h=0;h<i;h++)a[s++]=n[o++]}return new Wn(a,i,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var e=new n,i=this.index.array,r=this.attributes;for(var a in r){var o=t(r[a],i);e.setAttribute(a,o)}var s=this.morphAttributes;for(var l in s){for(var u=[],h=s[l],c=0,d=h.length;c<d;c++){var f=t(h[c],i);u.push(f)}e.morphAttributes[l]=u}e.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,v=0,m=p.length;v<m;v++){var g=p[v];e.addGroup(g.start,g.count,g.materialIndex)}return e}},{key:"toJSON",value:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var i=this.index;null!==i&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var r=this.attributes;for(var a in r){var o=r[a];t.data.attributes[a]=o.toJSON(t.data)}var s={},l=!1;for(var u in this.morphAttributes){for(var h=this.morphAttributes[u],c=[],d=0,f=h.length;d<f;d++){var p=h[d];c.push(p.toJSON(t.data))}c.length>0&&(s[u]=c,l=!0)}l&&(t.data.morphAttributes=s,t.data.morphTargetsRelative=this.morphTargetsRelative);var v=this.groups;v.length>0&&(t.data.groups=JSON.parse(JSON.stringify(v)));var m=this.boundingSphere;return null!==m&&(t.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),t}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var e={};this.name=t.name;var n=t.index;null!==n&&this.setIndex(n.clone(e));var i=t.attributes;for(var r in i){var a=i[r];this.setAttribute(r,a.clone(e))}var o=t.morphAttributes;for(var s in o){for(var l=[],u=o[s],h=0,c=u.length;h<c;h++)l.push(u[h].clone(e));this.morphAttributes[s]=l}this.morphTargetsRelative=t.morphTargetsRelative;for(var d=t.groups,f=0,p=d.length;f<p;f++){var v=d[f];this.addGroup(v.start,v.count,v.materialIndex)}var m=t.boundingBox;null!==m&&(this.boundingBox=m.clone());var g=t.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,void 0!==t.parameters&&(this.parameters=Object.assign({},t.parameters)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Ut),ri=new rn,ai=new nn,oi=new Ye,si=new Ee,li=new Ee,ui=new Ee,hi=new Ee,ci=new Ee,di=new Ee,fi=new Ee,pi=new Ee,vi=new Ee,mi=new te,gi=new te,yi=new te,_i=new Ee,xi=new Ee,bi=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ii,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Vn;return a(this,n),(t=e.call(this)).isMesh=!0,t.type="Mesh",t.geometry=i,t.material=r,t.updateMorphTargets(),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}},{key:"updateMorphTargets",value:function(){var t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){var n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,r=n.length;i<r;i++){var a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}},{key:"raycast",value:function(t,e){var n=this.geometry,i=this.material,r=this.matrixWorld;if(void 0!==i&&(null===n.boundingSphere&&n.computeBoundingSphere(),oi.copy(n.boundingSphere),oi.applyMatrix4(r),!1!==t.ray.intersectsSphere(oi)&&(ri.copy(r).invert(),ai.copy(t.ray).applyMatrix4(ri),null===n.boundingBox||!1!==ai.intersectsBox(n.boundingBox)))){var a,o=n.index,s=n.attributes.position,l=n.morphAttributes.position,u=n.morphTargetsRelative,h=n.attributes.uv,c=n.attributes.uv2,d=n.groups,f=n.drawRange;if(null!==o)if(Array.isArray(i))for(var p=0,v=d.length;p<v;p++)for(var m=d[p],g=i[m.materialIndex],y=Math.max(m.start,f.start),_=Math.min(o.count,Math.min(m.start+m.count,f.start+f.count));y<_;y+=3){var x=o.getX(y),b=o.getX(y+1),w=o.getX(y+2);(a=wi(this,g,t,ai,s,l,u,h,c,x,b,w))&&(a.faceIndex=Math.floor(y/3),a.face.materialIndex=m.materialIndex,e.push(a))}else for(var S=Math.max(0,f.start),T=Math.min(o.count,f.start+f.count);S<T;S+=3){var M=o.getX(S),E=o.getX(S+1),A=o.getX(S+2);(a=wi(this,i,t,ai,s,l,u,h,c,M,E,A))&&(a.faceIndex=Math.floor(S/3),e.push(a))}else if(void 0!==s)if(Array.isArray(i))for(var P=0,C=d.length;P<C;P++)for(var k=d[P],R=i[k.materialIndex],I=Math.max(k.start,f.start),D=Math.min(s.count,Math.min(k.start+k.count,f.start+f.count));I<D;I+=3){(a=wi(this,R,t,ai,s,l,u,h,c,I,I+1,I+2))&&(a.faceIndex=Math.floor(I/3),a.face.materialIndex=k.materialIndex,e.push(a))}else for(var O=Math.max(0,f.start),L=Math.min(s.count,f.start+f.count);O<L;O+=3){(a=wi(this,i,t,ai,s,l,u,h,c,O,O+1,O+2))&&(a.faceIndex=Math.floor(O/3),e.push(a))}}}}]),n}(Cn);function wi(t,e,n,i,r,a,o,s,l,u,h,c){si.fromBufferAttribute(r,u),li.fromBufferAttribute(r,h),ui.fromBufferAttribute(r,c);var d=t.morphTargetInfluences;if(a&&d){fi.set(0,0,0),pi.set(0,0,0),vi.set(0,0,0);for(var f=0,p=a.length;f<p;f++){var v=d[f],m=a[f];0!==v&&(hi.fromBufferAttribute(m,u),ci.fromBufferAttribute(m,h),di.fromBufferAttribute(m,c),o?(fi.addScaledVector(hi,v),pi.addScaledVector(ci,v),vi.addScaledVector(di,v)):(fi.addScaledVector(hi.sub(si),v),pi.addScaledVector(ci.sub(li),v),vi.addScaledVector(di.sub(ui),v)))}si.add(fi),li.add(pi),ui.add(vi)}t.isSkinnedMesh&&(t.boneTransform(u,si),t.boneTransform(h,li),t.boneTransform(c,ui));var g=function(t,e,n,i,r,a,o,s){if(null===(1===e.side?i.intersectTriangle(o,a,r,!0,s):i.intersectTriangle(r,a,o,2!==e.side,s)))return null;xi.copy(s),xi.applyMatrix4(t.matrixWorld);var l=n.ray.origin.distanceTo(xi);return l<n.near||l>n.far?null:{distance:l,point:xi.clone(),object:t}}(t,e,n,i,si,li,ui,_i);if(g){s&&(mi.fromBufferAttribute(s,u),gi.fromBufferAttribute(s,h),yi.fromBufferAttribute(s,c),g.uv=Gn.getUV(_i,si,li,ui,mi,gi,yi,new te)),l&&(mi.fromBufferAttribute(l,u),gi.fromBufferAttribute(l,h),yi.fromBufferAttribute(l,c),g.uv2=Gn.getUV(_i,si,li,ui,mi,gi,yi,new te));var y={a:u,b:h,c:c,normal:new Ee,materialIndex:0};Gn.getNormal(si,li,ui,y.normal),g.face=y}return g}var Si=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;a(this,n),(t=e.call(this)).type="BoxGeometry",t.parameters={width:i,height:r,depth:o,widthSegments:s,heightSegments:l,depthSegments:u};var c=h(t);s=Math.floor(s),l=Math.floor(l),u=Math.floor(u);var d=[],f=[],p=[],v=[],m=0,g=0;function y(t,e,n,i,r,a,o,s,l,u,h){for(var y=a/l,_=o/u,x=a/2,b=o/2,w=s/2,S=l+1,T=u+1,M=0,E=0,A=new Ee,P=0;P<T;P++)for(var C=P*_-b,k=0;k<S;k++){var R=k*y-x;A[t]=R*i,A[e]=C*r,A[n]=w,f.push(A.x,A.y,A.z),A[t]=0,A[e]=0,A[n]=s>0?1:-1,p.push(A.x,A.y,A.z),v.push(k/l),v.push(1-P/u),M+=1}for(var I=0;I<u;I++)for(var D=0;D<l;D++){var O=m+D+S*I,L=m+D+S*(I+1),N=m+(D+1)+S*(I+1),F=m+(D+1)+S*I;d.push(O,L,F),d.push(L,N,F),E+=6}c.addGroup(g,E,h),g+=E,m+=M}return y("z","y","x",-1,-1,o,r,i,u,l,0),y("z","y","x",1,-1,o,r,-i,u,l,1),y("x","z","y",1,1,i,o,r,s,u,2),y("x","z","y",1,-1,i,o,-r,s,u,3),y("x","y","z",1,-1,i,r,o,s,l,4),y("x","y","z",-1,-1,i,r,-o,s,l,5),t.setIndex(d),t.setAttribute("position",new Kn(f,3)),t.setAttribute("normal",new Kn(p,3)),t.setAttribute("uv",new Kn(v,2)),t}return s(n,null,[{key:"fromJSON",value:function(t){return new n(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}]),n}(ii);function Ti(t){var e={};for(var n in t)for(var i in e[n]={},t[n]){var r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}return e}function Mi(t){for(var e={},n=0;n<t.length;n++){var i=Ti(t[n]);for(var r in i)e[r]=i[r]}return e}var Ei={clone:Ti,merge:Mi},Ai=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isShaderMaterial=!0,i.type="ShaderMaterial",i.defines={},i.uniforms={},i.uniformsGroups=[],i.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",i.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",i.linewidth=1,i.wireframe=!1,i.wireframeLinewidth=1,i.fog=!1,i.lights=!1,i.clipping=!1,i.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},i.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},i.index0AttributeName=void 0,i.uniformsNeedUpdate=!1,i.glslVersion=null,void 0!==t&&i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ti(t.uniforms),this.uniformsGroups=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}},{key:"toJSON",value:function(t){var e=M(f(n.prototype),"toJSON",this).call(this,t);for(var i in e.glslVersion=this.glslVersion,e.uniforms={},this.uniforms){var r=this.uniforms[i].value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)!0===this.extensions[o]&&(a[o]=!0);return Object.keys(a).length>0&&(e.extensions=a),e}}]),n}(Hn),Pi=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isCamera=!0,t.type="Camera",t.matrixWorldInverse=new rn,t.projectionMatrix=new rn,t.projectionMatrixInverse=new rn,t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}},{key:"getWorldDirection",value:function(t){this.updateWorldMatrix(!0,!1);var e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}},{key:"updateMatrixWorld",value:function(t){M(f(n.prototype),"updateMatrixWorld",this).call(this,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(t,e){M(f(n.prototype),"updateWorldMatrix",this).call(this,t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),n}(Cn),Ci=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return a(this,n),(t=e.call(this)).isPerspectiveCamera=!0,t.type="PerspectiveCamera",t.fov=i,t.zoom=1,t.near=o,t.far=s,t.focus=10,t.aspect=r,t.view=null,t.filmGauge=35,t.filmOffset=0,t.updateProjectionMatrix(),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}},{key:"setFocalLength",value:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Vt*Math.atan(e),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var t=Math.tan(.5*Ht*this.fov);return.5*this.getFilmHeight()/t}},{key:"getEffectiveFOV",value:function(){return 2*Vt*Math.atan(Math.tan(.5*Ht*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(t,e,n,i,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var t=this.near,e=t*Math.tan(.5*Ht*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*i/o,e-=a.offsetY*n/s,i*=a.width/o,n*=a.height/s}var l=this.filmOffset;0!==l&&(r+=t*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(t){var e=M(f(n.prototype),"toJSON",this).call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}]),n}(Pi),ki=90,Ri=function(t){d(n,t);var e=m(n);function n(t,i,r){var o;a(this,n),(o=e.call(this)).type="CubeCamera",o.renderTarget=r;var s=new Ci(ki,1,t,i);s.layers=o.layers,s.up.set(0,-1,0),s.lookAt(new Ee(1,0,0)),o.add(s);var l=new Ci(ki,1,t,i);l.layers=o.layers,l.up.set(0,-1,0),l.lookAt(new Ee(-1,0,0)),o.add(l);var u=new Ci(ki,1,t,i);u.layers=o.layers,u.up.set(0,0,1),u.lookAt(new Ee(0,1,0)),o.add(u);var h=new Ci(ki,1,t,i);h.layers=o.layers,h.up.set(0,0,-1),h.lookAt(new Ee(0,-1,0)),o.add(h);var c=new Ci(ki,1,t,i);c.layers=o.layers,c.up.set(0,-1,0),c.lookAt(new Ee(0,0,1)),o.add(c);var d=new Ci(ki,1,t,i);return d.layers=o.layers,d.up.set(0,-1,0),d.lookAt(new Ee(0,0,-1)),o.add(d),o}return s(n,[{key:"update",value:function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,i=S(this.children,6),r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],u=i[5],h=t.getRenderTarget(),c=t.toneMapping,d=t.xr.enabled;t.toneMapping=0,t.xr.enabled=!1;var f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,r),t.setRenderTarget(n,1),t.render(e,a),t.setRenderTarget(n,2),t.render(e,o),t.setRenderTarget(n,3),t.render(e,s),t.setRenderTarget(n,4),t.render(e,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5),t.render(e,u),t.setRenderTarget(h),t.toneMapping=c,t.xr.enabled=d,n.texture.needsPMREMUpdate=!0}}]),n}(Cn),Ii=function(t){d(n,t);var e=m(n);function n(t,i,r,o,s,l,u,h,c,d){var f;return a(this,n),t=void 0!==t?t:[],i=void 0!==i?i:C,(f=e.call(this,t,i,r,o,s,l,u,h,c,d)).isCubeTexture=!0,f.flipY=!1,f}return s(n,[{key:"images",get:function(){return this.image},set:function(t){this.image=t}}]),n}(xe),Di=function(t){d(n,t);var e=m(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,n),(i=e.call(this,t,t,r)).isWebGLCubeRenderTarget=!0;var o={width:t,height:t,depth:1},s=[o,o,o,o,o,o];return i.texture=new Ii(s,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.isRenderTargetTexture=!0,i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:G,i}return s(n,[{key:"fromEquirectangularTexture",value:function(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;var n={tEquirect:{value:null}},i="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",r="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",a=new Si(5,5,5),o=new Ai({name:"CubemapFromEquirect",uniforms:Ti(n),vertexShader:i,fragmentShader:r,side:1,blending:0});o.uniforms.tEquirect.value=e;var s=new bi(a,o),l=e.minFilter;return e.minFilter===H&&(e.minFilter=G),new Ri(1,10,this).update(t,s),e.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(t,e,n,i){for(var r=t.getRenderTarget(),a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(e,n,i);t.setRenderTarget(r)}}]),n}(we),Oi=new Ee,Li=new Ee,Ni=new ee,Fi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,t),this.isPlane=!0,this.normal=e,this.constant=n}return s(t,[{key:"set",value:function(t,e){return this.normal.copy(t),this.constant=e,this}},{key:"setComponents",value:function(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}},{key:"setFromNormalAndCoplanarPoint",value:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(t,e,n){var i=Oi.subVectors(n,e).cross(Li.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}},{key:"copy",value:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this}},{key:"normalize",value:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(t){return this.normal.dot(t)+this.constant}},{key:"distanceToSphere",value:function(t){return this.distanceToPoint(t.center)-t.radius}},{key:"projectPoint",value:function(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}},{key:"intersectLine",value:function(t,e){var n=t.delta(Oi),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;var r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}},{key:"intersectsLine",value:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}},{key:"intersectsBox",value:function(t){return t.intersectsPlane(this)}},{key:"intersectsSphere",value:function(t){return t.intersectsPlane(this)}},{key:"coplanarPoint",value:function(t){return t.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(t,e){var n=e||Ni.getNormalMatrix(t),i=this.coplanarPoint(Oi).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}},{key:"translate",value:function(t){return this.constant-=t.dot(this.normal),this}},{key:"equals",value:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}(),Bi=new Ye,Ui=new Ee,Gi=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fi,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Fi,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Fi,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Fi,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Fi,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Fi;a(this,t),this.planes=[e,n,i,r,o,s]}return s(t,[{key:"set",value:function(t,e,n,i,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this}},{key:"copy",value:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(t){var e=this.planes,n=t.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],h=n[7],c=n[8],d=n[9],f=n[10],p=n[11],v=n[12],m=n[13],g=n[14],y=n[15];return e[0].setComponents(o-i,h-s,p-c,y-v).normalize(),e[1].setComponents(o+i,h+s,p+c,y+v).normalize(),e[2].setComponents(o+r,h+l,p+d,y+m).normalize(),e[3].setComponents(o-r,h-l,p-d,y-m).normalize(),e[4].setComponents(o-a,h-u,p-f,y-g).normalize(),e[5].setComponents(o+a,h+u,p+f,y+g).normalize(),this}},{key:"intersectsObject",value:function(t){var e=t.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),Bi.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Bi)}},{key:"intersectsSprite",value:function(t){return Bi.center.set(0,0,0),Bi.radius=.7071067811865476,Bi.applyMatrix4(t.matrixWorld),this.intersectsSphere(Bi)}},{key:"intersectsSphere",value:function(t){for(var e=this.planes,n=t.center,i=-t.radius,r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0}},{key:"intersectsBox",value:function(t){for(var e=this.planes,n=0;n<6;n++){var i=e[n];if(Ui.x=i.normal.x>0?t.max.x:t.min.x,Ui.y=i.normal.y>0?t.max.y:t.min.y,Ui.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Ui)<0)return!1}return!0}},{key:"containsPoint",value:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),t}();function zi(){var t=null,e=!1,n=null,i=null;function r(e,a){n(e,a),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Hi(t,e){var n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){var a=i.get(e);(!a||a.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version})}else{e.isInterleavedBufferAttribute&&(e=e.data);var o=i.get(e);void 0===o?i.set(e,function(e,i){var r,a=e.array,o=e.usage,s=t.createBuffer();if(t.bindBuffer(i,s),t.bufferData(i,a,o),e.onUploadCallback(),a instanceof Float32Array)r=5126;else if(a instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");r=5131}else r=5123;else if(a instanceof Int16Array)r=5122;else if(a instanceof Uint32Array)r=5125;else if(a instanceof Int32Array)r=5124;else if(a instanceof Int8Array)r=5120;else if(a instanceof Uint8Array)r=5121;else{if(!(a instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);r=5121}return{buffer:s,type:r,bytesPerElement:a.BYTES_PER_ELEMENT,version:e.version}}(e,r)):o.version<e.version&&(!function(e,i,r){var a=i.array,o=i.updateRange;t.bindBuffer(r,e),-1===o.count?t.bufferSubData(r,0,a):(n?t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a,o.offset,o.count):t.bufferSubData(r,o.offset*a.BYTES_PER_ELEMENT,a.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,e,r),o.version=e.version)}}}}var Vi=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,n),(t=e.call(this)).type="PlaneGeometry",t.parameters={width:i,height:r,widthSegments:o,heightSegments:s};for(var l=i/2,u=r/2,h=Math.floor(o),c=Math.floor(s),d=h+1,f=c+1,p=i/h,v=r/c,m=[],g=[],y=[],_=[],x=0;x<f;x++)for(var b=x*v-u,w=0;w<d;w++){var S=w*p-l;g.push(S,-b,0),y.push(0,0,1),_.push(w/h),_.push(1-x/c)}for(var T=0;T<c;T++)for(var M=0;M<h;M++){var E=M+d*T,A=M+d*(T+1),P=M+1+d*(T+1),C=M+1+d*T;m.push(E,A,C),m.push(A,P,C)}return t.setIndex(m),t.setAttribute("position",new Kn(g,3)),t.setAttribute("normal",new Kn(y,3)),t.setAttribute("uv",new Kn(_,2)),t}return s(n,null,[{key:"fromJSON",value:function(t){return new n(t.width,t.height,t.widthSegments,t.heightSegments)}}]),n}(ii),ji={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\n\tvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\t return vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat R21 = R12;\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert\n#define Material_LightProbeLOD( material )\t(0)",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Xi={common:{diffuse:{value:new ve(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ee},uv2Transform:{value:new ee},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new te(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ve(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ve(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ee}},sprite:{diffuse:{value:new ve(16777215)},opacity:{value:1},center:{value:new te(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ee}}},Wi={basic:{uniforms:Mi([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.fog]),vertexShader:ji.meshbasic_vert,fragmentShader:ji.meshbasic_frag},lambert:{uniforms:Mi([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,Xi.lights,{emissive:{value:new ve(0)}}]),vertexShader:ji.meshlambert_vert,fragmentShader:ji.meshlambert_frag},phong:{uniforms:Mi([Xi.common,Xi.specularmap,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,Xi.lights,{emissive:{value:new ve(0)},specular:{value:new ve(1118481)},shininess:{value:30}}]),vertexShader:ji.meshphong_vert,fragmentShader:ji.meshphong_frag},standard:{uniforms:Mi([Xi.common,Xi.envmap,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.roughnessmap,Xi.metalnessmap,Xi.fog,Xi.lights,{emissive:{value:new ve(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ji.meshphysical_vert,fragmentShader:ji.meshphysical_frag},toon:{uniforms:Mi([Xi.common,Xi.aomap,Xi.lightmap,Xi.emissivemap,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.gradientmap,Xi.fog,Xi.lights,{emissive:{value:new ve(0)}}]),vertexShader:ji.meshtoon_vert,fragmentShader:ji.meshtoon_frag},matcap:{uniforms:Mi([Xi.common,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,Xi.fog,{matcap:{value:null}}]),vertexShader:ji.meshmatcap_vert,fragmentShader:ji.meshmatcap_frag},points:{uniforms:Mi([Xi.points,Xi.fog]),vertexShader:ji.points_vert,fragmentShader:ji.points_frag},dashed:{uniforms:Mi([Xi.common,Xi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ji.linedashed_vert,fragmentShader:ji.linedashed_frag},depth:{uniforms:Mi([Xi.common,Xi.displacementmap]),vertexShader:ji.depth_vert,fragmentShader:ji.depth_frag},normal:{uniforms:Mi([Xi.common,Xi.bumpmap,Xi.normalmap,Xi.displacementmap,{opacity:{value:1}}]),vertexShader:ji.meshnormal_vert,fragmentShader:ji.meshnormal_frag},sprite:{uniforms:Mi([Xi.sprite,Xi.fog]),vertexShader:ji.sprite_vert,fragmentShader:ji.sprite_frag},background:{uniforms:{uvTransform:{value:new ee},t2D:{value:null}},vertexShader:ji.background_vert,fragmentShader:ji.background_frag},cube:{uniforms:Mi([Xi.envmap,{opacity:{value:1}}]),vertexShader:ji.cube_vert,fragmentShader:ji.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ji.equirect_vert,fragmentShader:ji.equirect_frag},distanceRGBA:{uniforms:Mi([Xi.common,Xi.displacementmap,{referencePosition:{value:new Ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ji.distanceRGBA_vert,fragmentShader:ji.distanceRGBA_frag},shadow:{uniforms:Mi([Xi.lights,Xi.fog,{color:{value:new ve(0)},opacity:{value:1}}]),vertexShader:ji.shadow_vert,fragmentShader:ji.shadow_frag}};function qi(t,e,n,i,r,a){var o,s,l=new ve(0),u=!0===r?0:1,h=null,c=0,d=null;function f(t,e){n.buffers.color.setClear(t.r,t.g,t.b,e,a)}return{getClearColor:function(){return l},setClearColor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l.set(t),f(l,u=e)},getClearAlpha:function(){return u},setClearAlpha:function(t){f(l,u=t)},render:function(n,r){var a=!1,p=!0===r.isScene?r.background:null;p&&p.isTexture&&(p=e.get(p));var v=t.xr,m=v.getSession&&v.getSession();m&&"additive"===m.environmentBlendMode&&(p=null),null===p?f(l,u):p&&p.isColor&&(f(p,1),a=!0),(t.autoClear||a)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),p&&(p.isCubeTexture||p.mapping===D)?(void 0===s&&((s=new bi(new Si(1,1,1),new Ai({name:"BackgroundCubeMaterial",uniforms:Ti(Wi.cube.uniforms),vertexShader:Wi.cube.vertexShader,fragmentShader:Wi.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(s)),s.material.uniforms.envMap.value=p,s.material.uniforms.flipEnvMap.value=p.isCubeTexture&&!1===p.isRenderTargetTexture?-1:1,h===p&&c===p.version&&d===t.toneMapping||(s.material.needsUpdate=!0,h=p,c=p.version,d=t.toneMapping),s.layers.enableAll(),n.unshift(s,s.geometry,s.material,0,0,null)):p&&p.isTexture&&(void 0===o&&((o=new bi(new Vi(2,2),new Ai({name:"BackgroundMaterial",uniforms:Ti(Wi.background.uniforms),vertexShader:Wi.background.vertexShader,fragmentShader:Wi.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(o)),o.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),o.material.uniforms.uvTransform.value.copy(p.matrix),h===p&&c===p.version&&d===t.toneMapping||(o.material.needsUpdate=!0,h=p,c=p.version,d=t.toneMapping),o.layers.enableAll(),n.unshift(o,o.geometry,o.material,0,0,null))}}}function Yi(t,e,n,i){var r=t.getParameter(34921),a=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||null!==a,s={},l=f(null),u=l,h=!1;function c(e){return i.isWebGL2?t.bindVertexArray(e):a.bindVertexArrayOES(e)}function d(e){return i.isWebGL2?t.deleteVertexArray(e):a.deleteVertexArrayOES(e)}function f(t){for(var e=[],n=[],i=[],a=0;a<r;a++)e[a]=0,n[a]=0,i[a]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function p(){for(var t=u.newAttributes,e=0,n=t.length;e<n;e++)t[e]=0}function v(t){m(t,0)}function m(n,r){var a=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;(a[n]=1,0===o[n]&&(t.enableVertexAttribArray(n),o[n]=1),s[n]!==r)&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),s[n]=r)}function g(){for(var e=u.newAttributes,n=u.enabledAttributes,i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function y(e,n,r,a,o,s){!0!==i.isWebGL2||5124!==r&&5125!==r?t.vertexAttribPointer(e,n,r,a,o,s):t.vertexAttribIPointer(e,n,r,o,s)}function _(){x(),h=!0,u!==l&&c((u=l).object)}function x(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,_,x){var b=!1;if(o){var w=function(e,n,r){var o=!0===r.wireframe,l=s[e.id];void 0===l&&(l={},s[e.id]=l);var u=l[n.id];void 0===u&&(u={},l[n.id]=u);var h=u[o];void 0===h&&(h=f(i.isWebGL2?t.createVertexArray():a.createVertexArrayOES()),u[o]=h);return h}(_,d,l);u!==w&&c((u=w).object),b=function(t,e,n,i){var r=u.attributes,a=e.attributes,o=0,s=n.getAttributes();for(var l in s){if(s[l].location>=0){var h=r[l],c=a[l];if(void 0===c&&("instanceMatrix"===l&&t.instanceMatrix&&(c=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(c=t.instanceColor)),void 0===h)return!0;if(h.attribute!==c)return!0;if(c&&h.data!==c.data)return!0;o++}}return u.attributesNum!==o||u.index!==i}(r,_,d,x),b&&function(t,e,n,i){var r={},a=e.attributes,o=0,s=n.getAttributes();for(var l in s){if(s[l].location>=0){var h=a[l];void 0===h&&("instanceMatrix"===l&&t.instanceMatrix&&(h=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(h=t.instanceColor));var c={};c.attribute=h,h&&h.data&&(c.data=h.data),r[l]=c,o++}}u.attributes=r,u.attributesNum=o,u.index=i}(r,_,d,x)}else{var S=!0===l.wireframe;u.geometry===_.id&&u.program===d.id&&u.wireframe===S||(u.geometry=_.id,u.program=d.id,u.wireframe=S,b=!0)}null!==x&&n.update(x,34963),(b||h)&&(h=!1,function(r,a,o,s){if(!1===i.isWebGL2&&(r.isInstancedMesh||s.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;p();var l=s.attributes,u=o.getAttributes(),h=a.defaultAttributeValues;for(var c in u){var d=u[c];if(d.location>=0){var f=l[c];if(void 0===f&&("instanceMatrix"===c&&r.instanceMatrix&&(f=r.instanceMatrix),"instanceColor"===c&&r.instanceColor&&(f=r.instanceColor)),void 0!==f){var _=f.normalized,x=f.itemSize,b=n.get(f);if(void 0===b)continue;var w=b.buffer,S=b.type,T=b.bytesPerElement;if(f.isInterleavedBufferAttribute){var M=f.data,E=M.stride,A=f.offset;if(M.isInstancedInterleavedBuffer){for(var P=0;P<d.locationSize;P++)m(d.location+P,M.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=M.meshPerAttribute*M.count)}else for(var C=0;C<d.locationSize;C++)v(d.location+C);t.bindBuffer(34962,w);for(var k=0;k<d.locationSize;k++)y(d.location+k,x/d.locationSize,S,_,E*T,(A+x/d.locationSize*k)*T)}else{if(f.isInstancedBufferAttribute){for(var R=0;R<d.locationSize;R++)m(d.location+R,f.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=f.meshPerAttribute*f.count)}else for(var I=0;I<d.locationSize;I++)v(d.location+I);t.bindBuffer(34962,w);for(var D=0;D<d.locationSize;D++)y(d.location+D,x/d.locationSize,S,_,x*T,x/d.locationSize*D*T)}}else if(void 0!==h){var O=h[c];if(void 0!==O)switch(O.length){case 2:t.vertexAttrib2fv(d.location,O);break;case 3:t.vertexAttrib3fv(d.location,O);break;case 4:t.vertexAttrib4fv(d.location,O);break;default:t.vertexAttrib1fv(d.location,O)}}}}g()}(r,l,d,_),null!==x&&t.bindBuffer(34963,n.get(x).buffer))},reset:_,resetDefaultState:x,dispose:function(){for(var t in _(),s){var e=s[t];for(var n in e){var i=e[n];for(var r in i)d(i[r].object),delete i[r];delete e[n]}delete s[t]}},releaseStatesOfGeometry:function(t){if(void 0!==s[t.id]){var e=s[t.id];for(var n in e){var i=e[n];for(var r in i)d(i[r].object),delete i[r];delete e[n]}delete s[t.id]}},releaseStatesOfProgram:function(t){for(var e in s){var n=s[e];if(void 0!==n[t.id]){var i=n[t.id];for(var r in i)d(i[r].object),delete i[r];delete n[t.id]}}},initAttributes:p,enableAttribute:v,disableUnusedAttributes:g}}function Ki(t,e,n,i){var r,a=i.isWebGL2;this.setMode=function(t){r=t},this.render=function(e,i){t.drawArrays(r,e,i),n.update(i,r,1)},this.renderInstances=function(i,o,s){if(0!==s){var l,u;if(a)l=t,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(l=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[u](r,i,o,s),n.update(o,r,s)}}}function Zi(t,e,n){var i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var a="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&t instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=r(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=a||e.has("WEBGL_draw_buffers"),u=!0===n.logarithmicDepthBuffer,h=t.getParameter(34930),c=t.getParameter(35660),d=t.getParameter(3379),f=t.getParameter(34076),p=t.getParameter(34921),v=t.getParameter(36347),m=t.getParameter(36348),g=t.getParameter(36349),y=c>0,_=a||e.has("OES_texture_float");return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){var n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:c,maxTextureSize:d,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:v,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:_,floatVertexTextures:y&&_,maxSamples:a?t.getParameter(36183):0}}function Ji(t){var e=this,n=null,i=0,r=!1,a=!1,o=new Fi,s=new ee,l={value:null,needsUpdate:!1};function u(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(t,n,i,r){var a=null!==t?t.length:0,u=null;if(0!==a){if(u=l.value,!0!==r||null===u){var h=i+4*a,c=n.matrixWorldInverse;s.getNormalMatrix(c),(null===u||u.length<h)&&(u=new Float32Array(h));for(var d=0,f=i;d!==a;++d,f+=4)o.copy(t[d]).applyMatrix4(c,s),o.normal.toArray(u,f),u[f+3]=o.constant}l.value=u,l.needsUpdate=!0}return e.numPlanes=a,e.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e,a){var o=0!==t.length||e||0!==i||r;return r=e,n=h(t,a,0),i=t.length,o},this.beginShadows=function(){a=!0,h(null)},this.endShadows=function(){a=!1,u()},this.setState=function(e,o,s){var c=e.clippingPlanes,d=e.clipIntersection,f=e.clipShadows,p=t.get(e);if(!r||null===c||0===c.length||a&&!f)a?h(null):u();else{var v=a?0:i,m=4*v,g=p.clippingState||null;l.value=g,g=h(c,o,m,s);for(var y=0;y!==m;++y)g[y]=n[y];p.clippingState=g,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=v}}}function Qi(t){var e=new WeakMap;function n(t,e){return e===R?t.mapping=C:e===I&&(t.mapping=k),t}function i(t){var n=t.target;n.removeEventListener("dispose",i);var r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture&&!1===r.isRenderTargetTexture){var a=r.mapping;if(a===R||a===I){if(e.has(r))return n(e.get(r).texture,r.mapping);var o=r.image;if(o&&o.height>0){var s=new Di(o.height/2);return s.fromEquirectangularTexture(t,r),e.set(r,s),r.addEventListener("dispose",i),n(s.texture,r.mapping)}return null}}return r},dispose:function(){e=new WeakMap}}}Wi.physical={uniforms:Mi([Wi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new te(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ve(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ve(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ve(1,1,1)},specularColorMap:{value:null}}]),vertexShader:ji.meshphysical_vert,fragmentShader:ji.meshphysical_frag};var $i=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return a(this,n),(t=e.call(this)).isOrthographicCamera=!0,t.type="OrthographicCamera",t.zoom=1,t.view=null,t.left=i,t.right=r,t.top=o,t.bottom=s,t.near=l,t.far=u,t.updateProjectionMatrix(),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}},{key:"setViewOffset",value:function(t,e,n,i,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,a=n+t,o=i+e,s=i-e;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a=(r+=l*this.view.offsetX)+l*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(t){var e=M(f(n.prototype),"toJSON",this).call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}]),n}(Pi),tr=[.125,.215,.35,.446,.526,.582],er=20,nr=new $i,ir=new ve,rr=null,ar=(1+Math.sqrt(5))/2,or=1/ar,sr=[new Ee(1,1,1),new Ee(-1,1,1),new Ee(1,1,-1),new Ee(-1,1,-1),new Ee(0,ar,or),new Ee(0,ar,-or),new Ee(or,0,ar),new Ee(-or,0,ar),new Ee(ar,or,0),new Ee(-ar,or,0)],lr=function(){function t(e){a(this,t),this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}return s(t,[{key:"fromScene",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;rr=this._renderer.getRenderTarget(),this._setSize(256);var r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}},{key:"fromEquirectangular",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}},{key:"fromCubemap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(t,e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=dr(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=cr(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}},{key:"_cleanup",value:function(t){this._renderer.setRenderTarget(rr),t.scissorTest=!1,hr(t,0,0,t.width,t.height)}},{key:"_fromTexture",value:function(t,e){t.mapping===C||t.mapping===k?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),rr=this._renderer.getRenderTarget();var n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:G,minFilter:G,generateMipmaps:!1,type:q,format:Z,encoding:Rt,depthBuffer:!1},i=ur(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=ur(t,e,n);var r=this._lodMax,a=function(t){for(var e=[],n=[],i=[],r=t,a=t-4+1+tr.length,o=0;o<a;o++){var s=Math.pow(2,r);n.push(s);var l=1/s;o>t-4?l=tr[o-t+4-1]:0===o&&(l=0),i.push(l);for(var u=1/(s-2),h=-u,c=1+u,d=[h,h,c,h,c,c,h,h,c,c,h,c],f=6,p=6,v=3,m=2,g=1,y=new Float32Array(v*p*f),_=new Float32Array(m*p*f),x=new Float32Array(g*p*f),b=0;b<f;b++){var w=b%3*2/3-1,S=b>2?0:-1,T=[w,S,0,w+2/3,S,0,w+2/3,S+1,0,w,S,0,w+2/3,S+1,0,w,S+1,0];y.set(T,v*p*b),_.set(d,m*p*b);var M=[b,b,b,b,b,b];x.set(M,g*p*b)}var E=new ii;E.setAttribute("position",new Wn(y,v)),E.setAttribute("uv",new Wn(_,m)),E.setAttribute("faceIndex",new Wn(x,g)),e.push(E),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(r);this._sizeLods=a.sizeLods,this._lodPlanes=a.lodPlanes,this._sigmas=a.sigmas,this._blurMaterial=function(t,e,n){var i=new Float32Array(er),r=new Ee(0,1,0);return new Ai({name:"SphericalGaussianBlur",defines:{n:er,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(t,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(r,t,e)}return i}},{key:"_compileMaterial",value:function(t){var e=new bi(this._lodPlanes[0],t);this._renderer.compile(e,nr)}},{key:"_sceneToCubeUV",value:function(t,e,n,i){var r=new Ci(90,1,e,n),a=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,u=s.toneMapping;s.getClearColor(ir),s.toneMapping=0,s.autoClear=!1;var h=new Vn({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),c=new bi(new Si,h),d=!1,f=t.background;f?f.isColor&&(h.color.copy(f),t.background=null,d=!0):(h.color.copy(ir),d=!0);for(var p=0;p<6;p++){var v=p%3;0===v?(r.up.set(0,a[p],0),r.lookAt(o[p],0,0)):1===v?(r.up.set(0,0,a[p]),r.lookAt(0,o[p],0)):(r.up.set(0,a[p],0),r.lookAt(0,0,o[p]));var m=this._cubeSize;hr(i,v*m,p>2?m:0,m,m),s.setRenderTarget(i),d&&s.render(c,r),s.render(t,r)}c.geometry.dispose(),c.material.dispose(),s.toneMapping=u,s.autoClear=l,t.background=f}},{key:"_textureToCubeUV",value:function(t,e){var n=this._renderer,i=t.mapping===C||t.mapping===k;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=dr()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=cr());var r=i?this._cubemapMaterial:this._equirectMaterial,a=new bi(this._lodPlanes[0],r);r.uniforms.envMap.value=t;var o=this._cubeSize;hr(e,0,0,3*o,2*o),n.setRenderTarget(e),n.render(a,nr)}},{key:"_applyPMREM",value:function(t){var e=this._renderer,n=e.autoClear;e.autoClear=!1;for(var i=1;i<this._lodPlanes.length;i++){var r=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=sr[(i-1)%sr.length];this._blur(t,i-1,i,r,a)}e.autoClear=n}},{key:"_blur",value:function(t,e,n,i,r){var a=this._pingPongRenderTarget;this._halfBlur(t,a,e,n,i,"latitudinal",r),this._halfBlur(a,t,n,n,i,"longitudinal",r)}},{key:"_halfBlur",value:function(t,e,n,i,r,a,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new bi(this._lodPlanes[i],l),h=l.uniforms,c=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*c):2*Math.PI/39,f=r/d,p=isFinite(r)?1+Math.floor(3*f):er;p>er&&console.warn("sigmaRadians, ".concat(r,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(er));for(var v=[],m=0,g=0;g<er;++g){var y=g/f,_=Math.exp(-y*y/2);v.push(_),0===g?m+=_:g<p&&(m+=2*_)}for(var x=0;x<v.length;x++)v[x]=v[x]/m;h.envMap.value=t.texture,h.samples.value=p,h.weights.value=v,h.latitudinal.value="latitudinal"===a,o&&(h.poleAxis.value=o);var b=this._lodMax;h.dTheta.value=d,h.mipInt.value=b-n;var w=this._sizeLods[i];hr(e,3*w*(i>b-4?i-b+4:0),4*(this._cubeSize-w),3*w,2*w),s.setRenderTarget(e),s.render(u,nr)}}]),t}();function ur(t,e,n){var i=new we(t,e,n);return i.texture.mapping=D,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function hr(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function cr(){return new Ai({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function dr(){return new Ai({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function fr(t){var e=new WeakMap,n=null;function i(t){var n=t.target;n.removeEventListener("dispose",i);var r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){var a=r.mapping,o=a===R||a===I,s=a===C||a===k;if(o||s){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;var l=e.get(r);return null===n&&(n=new lr(t)),l=o?n.fromEquirectangular(r,l):n.fromCubemap(r,l),e.set(r,l),l.texture}if(e.has(r))return e.get(r).texture;var u=r.image;if(o&&u&&u.height>0||s&&u&&function(t){for(var e=0,n=6,i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}(u)){null===n&&(n=new lr(t));var h=o?n.fromEquirectangular(r):n.fromCubemap(r);return e.set(r,h),r.addEventListener("dispose",i),h.texture}return null}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function pr(t){var e={};function n(n){if(void 0!==e[n])return e[n];var i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){var e=n(t);return null===e&&console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),e}}}function vr(t,e,n,i){var r={},a=new WeakMap;function o(t){var s=t.target;for(var l in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[l]);s.removeEventListener("dispose",o),delete r[s.id];var u=a.get(s);u&&(e.remove(u),a.delete(s)),i.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(t){var n=[],i=t.index,r=t.attributes.position,o=0;if(null!==i){var s=i.array;o=i.version;for(var l=0,u=s.length;l<u;l+=3){var h=s[l+0],c=s[l+1],d=s[l+2];n.push(h,c,c,d,d,h)}}else{var f=r.array;o=r.version;for(var p=0,v=f.length/3-1;p<v;p+=3){var m=p+0,g=p+1,y=p+2;n.push(m,g,g,y,y,m)}}var _=new(ne(n)?Yn:qn)(n,1);_.version=o;var x=a.get(t);x&&e.remove(x),a.set(t,_)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",o),r[e.id]=!0,n.memory.geometries++),e},update:function(t){var n=t.attributes;for(var i in n)e.update(n[i],34962);var r=t.morphAttributes;for(var a in r)for(var o=r[a],s=0,l=o.length;s<l;s++)e.update(o[s],34962)},getWireframeAttribute:function(t){var e=a.get(t);if(e){var n=t.index;null!==n&&e.version<n.version&&s(t)}else s(t);return a.get(t)}}}function mr(t,e,n,i){var r,a,o,s=i.isWebGL2;this.setMode=function(t){r=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,i){t.drawElements(r,i,a,e*o),n.update(i,r,1)},this.renderInstances=function(i,l,u){if(0!==u){var h,c;if(s)h=t,c="drawElementsInstanced";else if(c="drawElementsInstancedANGLE",null===(h=e.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[c](r,l,a,i*o,u),n.update(l,r,u)}}}function gr(t){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(t,n,i){switch(e.calls++,n){case 4:e.triangles+=i*(t/3);break;case 1:e.lines+=i*(t/2);break;case 3:e.lines+=i*(t-1);break;case 2:e.lines+=i*t;break;case 0:e.points+=i*t;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function yr(t,e){return t[0]-e[0]}function _r(t,e){return Math.abs(e[1])-Math.abs(t[1])}function xr(t,e,n){for(var i={},r=new Float32Array(8),a=new WeakMap,o=new be,s=[],l=0;l<8;l++)s[l]=[l,0];return{update:function(l,u,h,c){var d=l.morphTargetInfluences;if(!0===e.isWebGL2){var f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=void 0!==f?f.length:0,v=a.get(u);if(void 0===v||v.count!==p){void 0!==v&&v.texture.dispose();var m=void 0!==u.morphAttributes.position,g=void 0!==u.morphAttributes.normal,y=void 0!==u.morphAttributes.color,_=u.morphAttributes.position||[],x=u.morphAttributes.normal||[],b=u.morphAttributes.color||[],w=0;!0===m&&(w=1),!0===g&&(w=2),!0===y&&(w=3);var S=u.attributes.position.count*w,T=1;S>e.maxTextureSize&&(T=Math.ceil(S/e.maxTextureSize),S=e.maxTextureSize);var M=new Float32Array(S*T*4*p),E=new Se(M,S,T,p);E.type=W,E.needsUpdate=!0;for(var A=4*w,P=0;P<p;P++)for(var C=_[P],k=x[P],R=b[P],I=S*T*4*P,D=0;D<C.count;D++){var O=D*A;!0===m&&(o.fromBufferAttribute(C,D),M[I+O+0]=o.x,M[I+O+1]=o.y,M[I+O+2]=o.z,M[I+O+3]=0),!0===g&&(o.fromBufferAttribute(k,D),M[I+O+4]=o.x,M[I+O+5]=o.y,M[I+O+6]=o.z,M[I+O+7]=0),!0===y&&(o.fromBufferAttribute(R,D),M[I+O+8]=o.x,M[I+O+9]=o.y,M[I+O+10]=o.z,M[I+O+11]=4===R.itemSize?o.w:1)}v={count:p,texture:E,size:new te(S,T)},a.set(u,v),u.addEventListener("dispose",(function t(){E.dispose(),a.delete(u),u.removeEventListener("dispose",t)}))}for(var L=0,N=0;N<d.length;N++)L+=d[N];var F=u.morphTargetsRelative?1:1-L;c.getUniforms().setValue(t,"morphTargetBaseInfluence",F),c.getUniforms().setValue(t,"morphTargetInfluences",d),c.getUniforms().setValue(t,"morphTargetsTexture",v.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",v.size)}else{var B=void 0===d?0:d.length,U=i[u.id];if(void 0===U||U.length!==B){U=[];for(var G=0;G<B;G++)U[G]=[G,0];i[u.id]=U}for(var z=0;z<B;z++){var H=U[z];H[0]=z,H[1]=d[z]}U.sort(_r);for(var V=0;V<8;V++)V<B&&U[V][1]?(s[V][0]=U[V][0],s[V][1]=U[V][1]):(s[V][0]=Number.MAX_SAFE_INTEGER,s[V][1]=0);s.sort(yr);for(var j=u.morphAttributes.position,X=u.morphAttributes.normal,q=0,Y=0;Y<8;Y++){var K=s[Y],Z=K[0],J=K[1];Z!==Number.MAX_SAFE_INTEGER&&J?(j&&u.getAttribute("morphTarget"+Y)!==j[Z]&&u.setAttribute("morphTarget"+Y,j[Z]),X&&u.getAttribute("morphNormal"+Y)!==X[Z]&&u.setAttribute("morphNormal"+Y,X[Z]),r[Y]=J,q+=J):(j&&!0===u.hasAttribute("morphTarget"+Y)&&u.deleteAttribute("morphTarget"+Y),X&&!0===u.hasAttribute("morphNormal"+Y)&&u.deleteAttribute("morphNormal"+Y),r[Y]=0)}var Q=u.morphTargetsRelative?1:1-q;c.getUniforms().setValue(t,"morphTargetBaseInfluence",Q),c.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function br(t,e,n,i){var r=new WeakMap;function a(t){var e=t.target;e.removeEventListener("dispose",a),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(t){var o=i.render.frame,s=t.geometry,l=e.get(t,s);return r.get(l)!==o&&(e.update(l),r.set(l,o)),t.isInstancedMesh&&(!1===t.hasEventListener("dispose",a)&&t.addEventListener("dispose",a),n.update(t.instanceMatrix,34962),null!==t.instanceColor&&n.update(t.instanceColor,34962)),l},dispose:function(){r=new WeakMap}}}var wr=new xe,Sr=new Se,Tr=new Te,Mr=new Ii,Er=[],Ar=[],Pr=new Float32Array(16),Cr=new Float32Array(9),kr=new Float32Array(4);function Rr(t,e,n){var i=t[0];if(i<=0||i>0)return t;var r=e*n,a=Er[r];if(void 0===a&&(a=new Float32Array(r),Er[r]=a),0!==e){i.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=n,t[o].toArray(a,s)}return a}function Ir(t,e){if(t.length!==e.length)return!1;for(var n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Dr(t,e){for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}function Or(t,e){var n=Ar[e];void 0===n&&(n=new Int32Array(e),Ar[e]=n);for(var i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Lr(t,e){var n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Nr(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Ir(n,e))return;t.uniform2fv(this.addr,e),Dr(n,e)}}function Fr(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Ir(n,e))return;t.uniform3fv(this.addr,e),Dr(n,e)}}function Br(t,e){var n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Ir(n,e))return;t.uniform4fv(this.addr,e),Dr(n,e)}}function Ur(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(Ir(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),Dr(n,e)}else{if(Ir(n,i))return;kr.set(i),t.uniformMatrix2fv(this.addr,!1,kr),Dr(n,i)}}function Gr(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(Ir(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),Dr(n,e)}else{if(Ir(n,i))return;Cr.set(i),t.uniformMatrix3fv(this.addr,!1,Cr),Dr(n,i)}}function zr(t,e){var n=this.cache,i=e.elements;if(void 0===i){if(Ir(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),Dr(n,e)}else{if(Ir(n,i))return;Pr.set(i),t.uniformMatrix4fv(this.addr,!1,Pr),Dr(n,i)}}function Hr(t,e){var n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Vr(t,e){var n=this.cache;Ir(n,e)||(t.uniform2iv(this.addr,e),Dr(n,e))}function jr(t,e){var n=this.cache;Ir(n,e)||(t.uniform3iv(this.addr,e),Dr(n,e))}function Xr(t,e){var n=this.cache;Ir(n,e)||(t.uniform4iv(this.addr,e),Dr(n,e))}function Wr(t,e){var n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function qr(t,e){var n=this.cache;Ir(n,e)||(t.uniform2uiv(this.addr,e),Dr(n,e))}function Yr(t,e){var n=this.cache;Ir(n,e)||(t.uniform3uiv(this.addr,e),Dr(n,e))}function Kr(t,e){var n=this.cache;Ir(n,e)||(t.uniform4uiv(this.addr,e),Dr(n,e))}function Zr(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||wr,r)}function Jr(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||Tr,r)}function Qr(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||Mr,r)}function $r(t,e,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||Sr,r)}function ta(t,e){t.uniform1fv(this.addr,e)}function ea(t,e){var n=Rr(e,this.size,2);t.uniform2fv(this.addr,n)}function na(t,e){var n=Rr(e,this.size,3);t.uniform3fv(this.addr,n)}function ia(t,e){var n=Rr(e,this.size,4);t.uniform4fv(this.addr,n)}function ra(t,e){var n=Rr(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function aa(t,e){var n=Rr(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function oa(t,e){var n=Rr(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function sa(t,e){t.uniform1iv(this.addr,e)}function la(t,e){t.uniform2iv(this.addr,e)}function ua(t,e){t.uniform3iv(this.addr,e)}function ha(t,e){t.uniform4iv(this.addr,e)}function ca(t,e){t.uniform1uiv(this.addr,e)}function da(t,e){t.uniform2uiv(this.addr,e)}function fa(t,e){t.uniform3uiv(this.addr,e)}function pa(t,e){t.uniform4uiv(this.addr,e)}function va(t,e,n){var i=this.cache,r=e.length,a=Or(n,r);Ir(i,a)||(t.uniform1iv(this.addr,a),Dr(i,a));for(var o=0;o!==r;++o)n.setTexture2D(e[o]||wr,a[o])}function ma(t,e,n){var i=this.cache,r=e.length,a=Or(n,r);Ir(i,a)||(t.uniform1iv(this.addr,a),Dr(i,a));for(var o=0;o!==r;++o)n.setTexture3D(e[o]||Tr,a[o])}function ga(t,e,n){var i=this.cache,r=e.length,a=Or(n,r);Ir(i,a)||(t.uniform1iv(this.addr,a),Dr(i,a));for(var o=0;o!==r;++o)n.setTextureCube(e[o]||Mr,a[o])}function ya(t,e,n){var i=this.cache,r=e.length,a=Or(n,r);Ir(i,a)||(t.uniform1iv(this.addr,a),Dr(i,a));for(var o=0;o!==r;++o)n.setTexture2DArray(e[o]||Sr,a[o])}var _a=s((function t(e,n,i){a(this,t),this.id=e,this.addr=i,this.cache=[],this.setValue=function(t){switch(t){case 5126:return Lr;case 35664:return Nr;case 35665:return Fr;case 35666:return Br;case 35674:return Ur;case 35675:return Gr;case 35676:return zr;case 5124:case 35670:return Hr;case 35667:case 35671:return Vr;case 35668:case 35672:return jr;case 35669:case 35673:return Xr;case 5125:return Wr;case 36294:return qr;case 36295:return Yr;case 36296:return Kr;case 35678:case 36198:case 36298:case 36306:case 35682:return Zr;case 35679:case 36299:case 36307:return Jr;case 35680:case 36300:case 36308:case 36293:return Qr;case 36289:case 36303:case 36311:case 36292:return $r}}(n.type)})),xa=s((function t(e,n,i){a(this,t),this.id=e,this.addr=i,this.cache=[],this.size=n.size,this.setValue=function(t){switch(t){case 5126:return ta;case 35664:return ea;case 35665:return na;case 35666:return ia;case 35674:return ra;case 35675:return aa;case 35676:return oa;case 5124:case 35670:return sa;case 35667:case 35671:return la;case 35668:case 35672:return ua;case 35669:case 35673:return ha;case 5125:return ca;case 36294:return da;case 36295:return fa;case 36296:return pa;case 35678:case 36198:case 36298:case 36306:case 35682:return va;case 35679:case 36299:case 36307:return ma;case 35680:case 36300:case 36308:case 36293:return ga;case 36289:case 36303:case 36311:case 36292:return ya}}(n.type)})),ba=function(){function t(e){a(this,t),this.id=e,this.seq=[],this.map={}}return s(t,[{key:"setValue",value:function(t,e,n){for(var i=this.seq,r=0,a=i.length;r!==a;++r){var o=i[r];o.setValue(t,e[o.id],n)}}}]),t}(),wa=/(\w+)(\])?(\[|\.)?/g;function Sa(t,e){t.seq.push(e),t.map[e.id]=e}function Ta(t,e,n){var i=t.name,r=i.length;for(wa.lastIndex=0;;){var a=wa.exec(i),o=wa.lastIndex,s=a[1],l="]"===a[2],u=a[3];if(l&&(s|=0),void 0===u||"["===u&&o+2===r){Sa(n,void 0===u?new _a(s,t,e):new xa(s,t,e));break}var h=n.map[s];void 0===h&&Sa(n,h=new ba(s)),n=h}}var Ma=function(){function t(e,n){a(this,t),this.seq=[],this.map={};for(var i=e.getProgramParameter(n,35718),r=0;r<i;++r){var o=e.getActiveUniform(n,r);Ta(o,e.getUniformLocation(n,o.name),this)}}return s(t,[{key:"setValue",value:function(t,e,n,i){var r=this.map[e];void 0!==r&&r.setValue(t,n,i)}},{key:"setOptional",value:function(t,e,n){var i=e[n];void 0!==i&&this.setValue(t,n,i)}}],[{key:"upload",value:function(t,e,n,i){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=n[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,i)}}},{key:"seqWithValue",value:function(t,e){for(var n=[],i=0,r=t.length;i!==r;++i){var a=t[i];a.id in e&&n.push(a)}return n}}]),t}();function Ea(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}var Aa=0;function Pa(t,e,n){var i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&""===r)return"";var a=/ERROR: 0:(\d+)/.exec(r);if(a){var o=parseInt(a[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){for(var n=t.split("\n"),i=[],r=Math.max(e-6,0),a=Math.min(e+6,n.length),o=r;o<a;o++){var s=o+1;i.push("".concat(s===e?">":" "," ").concat(s,": ").concat(n[o]))}return i.join("\n")}(t.getShaderSource(e),o)}return r}function Ca(t,e){var n=function(t){switch(t){case Rt:return["Linear","( value )"];case It:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function ka(t,e){var n;switch(e){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ra(t){return""!==t}function Ia(t,e){var n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Da(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var Oa=/^[ \t]*#include +<([\w\d./]+)>/gm;function La(t){return t.replace(Oa,Na)}function Na(t,e){var n=ji[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return La(n)}var Fa=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ba(t){return t.replace(Fa,Ua)}function Ua(t,e,n,i){for(var r="",a=parseInt(e);a<parseInt(n);a++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Ga(t){var e="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function za(t,e,n,i){var r,a,o=t.getContext(),s=n.defines,l=n.vertexShader,u=n.fragmentShader,h=function(t){var e="SHADOWMAP_TYPE_BASIC";return 1===t.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===t.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===t.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(n),c=function(t){var e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case C:case k:e="ENVMAP_TYPE_CUBE";break;case D:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),d=function(t){var e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===k&&(e="ENVMAP_MODE_REFRACTION");return e}(n),f=function(t){var e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(n),p=function(t){var e=t.envMapCubeUVHeight;if(null===e)return null;var n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),v=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ra).join("\n")}(n),m=function(t){var e=[];for(var n in t){var i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),g=o.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((r=[m].filter(Ra).join("\n")).length>0&&(r+="\n"),(a=[v,m].filter(Ra).join("\n")).length>0&&(a+="\n")):(r=[Ga(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ra).join("\n"),a=[v,Ga(n),"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+d:"",n.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?ji.tonemapping_pars_fragment:"",0!==n.toneMapping?ka("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ji.encodings_pars_fragment,Ca("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ra).join("\n")),l=Da(l=Ia(l=La(l),n),n),u=Da(u=Ia(u=La(u),n),n),l=Ba(l),u=Ba(u),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",r=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,a=["#define varying in",n.glslVersion===Ft?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Ft?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);var _,x,b=y+a+u,w=Ea(o,35633,y+r+l),S=Ea(o,35632,b);if(o.attachShader(g,w),o.attachShader(g,S),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),t.debug.checkShaderErrors){var T=o.getProgramInfoLog(g).trim(),M=o.getShaderInfoLog(w).trim(),E=o.getShaderInfoLog(S).trim(),A=!0,P=!0;if(!1===o.getProgramParameter(g,35714)){A=!1;var R=Pa(o,w,"vertex"),I=Pa(o,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(g,35715)+"\n\nProgram Info Log: "+T+"\n"+R+"\n"+I)}else""!==T?console.warn("THREE.WebGLProgram: Program Info Log:",T):""!==M&&""!==E||(P=!1);P&&(this.diagnostics={runnable:A,programLog:T,vertexShader:{log:M,prefix:r},fragmentShader:{log:E,prefix:a}})}return o.deleteShader(w),o.deleteShader(S),this.getUniforms=function(){return void 0===_&&(_=new Ma(o,g)),_},this.getAttributes=function(){return void 0===x&&(x=function(t,e){for(var n={},i=t.getProgramParameter(e,35721),r=0;r<i;r++){var a=t.getActiveAttrib(e,r),o=a.name,s=1;35674===a.type&&(s=2),35675===a.type&&(s=3),35676===a.type&&(s=4),n[o]={type:a.type,location:t.getAttribLocation(e,o),locationSize:s}}return n}(o,g)),x},this.destroy=function(){i.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.name=n.shaderName,this.id=Aa++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=w,this.fragmentShader=S,this}var Ha=0,Va=function(){function t(){a(this,t),this.shaderCache=new Map,this.materialCache=new Map}return s(t,[{key:"update",value:function(t){var e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),a=this._getShaderCacheForMaterial(t);return!1===a.has(i)&&(a.add(i),i.usedTimes++),!1===a.has(r)&&(a.add(r),r.usedTimes++),this}},{key:"remove",value:function(t){var e,n=w(this.materialCache.get(t));try{for(n.s();!(e=n.n()).done;){var i=e.value;i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code)}}catch(r){n.e(r)}finally{n.f()}return this.materialCache.delete(t),this}},{key:"getVertexShaderID",value:function(t){return this._getShaderStage(t.vertexShader).id}},{key:"getFragmentShaderID",value:function(t){return this._getShaderStage(t.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(t){var e=this.materialCache,n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}},{key:"_getShaderStage",value:function(t){var e=this.shaderCache,n=e.get(t);return void 0===n&&(n=new ja(t),e.set(t,n)),n}}]),t}(),ja=s((function t(e){a(this,t),this.id=Ha++,this.code=e,this.usedTimes=0}));function Xa(t,e,n,i,r,a,o){var s=new vn,l=new Va,u=[],h=r.isWebGL2,c=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function(a,s,u,v,m){var g=v.fog,y=m.geometry,_=a.isMeshStandardMaterial?v.environment:null,x=(a.isMeshStandardMaterial?n:e).get(a.envMap||_),b=x&&x.mapping===D?x.image.height:null,w=p[a.type];null!==a.precision&&(f=r.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",f,"instead.");var S,T,M,E,A=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,P=void 0!==A?A.length:0,C=0;if(void 0!==y.morphAttributes.position&&(C=1),void 0!==y.morphAttributes.normal&&(C=2),void 0!==y.morphAttributes.color&&(C=3),w){var k=Wi[w];S=k.vertexShader,T=k.fragmentShader}else S=a.vertexShader,T=a.fragmentShader,l.update(a),M=l.getVertexShaderID(a),E=l.getFragmentShaderID(a);var R=t.getRenderTarget(),I=a.alphaTest>0,O=a.clearcoat>0,L=a.iridescence>0;return{isWebGL2:h,shaderID:w,shaderName:a.type,vertexShader:S,fragmentShader:T,defines:a.defines,customVertexShaderID:M,customFragmentShaderID:E,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:f,instancing:!0===m.isInstancedMesh,instancingColor:!0===m.isInstancedMesh&&null!==m.instanceColor,supportsVertexTextures:d,outputEncoding:null===R?t.outputEncoding:!0===R.isXRRenderTarget?R.texture.encoding:Rt,map:!!a.map,matcap:!!a.matcap,envMap:!!x,envMapMode:x&&x.mapping,envMapCubeUVHeight:b,lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:1===a.normalMapType,tangentSpaceNormalMap:0===a.normalMapType,decodeVideoTexture:!!a.map&&!0===a.map.isVideoTexture&&a.map.encoding===It,clearcoat:O,clearcoatMap:O&&!!a.clearcoatMap,clearcoatRoughnessMap:O&&!!a.clearcoatRoughnessMap,clearcoatNormalMap:O&&!!a.clearcoatNormalMap,iridescence:L,iridescenceMap:L&&!!a.iridescenceMap,iridescenceThicknessMap:L&&!!a.iridescenceThicknessMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,specularIntensityMap:!!a.specularIntensityMap,specularColorMap:!!a.specularColorMap,opaque:!1===a.transparent&&1===a.blending,alphaMap:!!a.alphaMap,alphaTest:I,gradientMap:!!a.gradientMap,sheen:a.sheen>0,sheenColorMap:!!a.sheenColorMap,sheenRoughnessMap:!!a.sheenRoughnessMap,transmission:a.transmission>0,transmissionMap:!!a.transmissionMap,thicknessMap:!!a.thicknessMap,combine:a.combine,vertexTangents:!!a.normalMap&&!!y.attributes.tangent,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.iridescenceMap||!!a.iridescenceThicknessMap||!!a.displacementMap||!!a.transmissionMap||!!a.thicknessMap||!!a.specularIntensityMap||!!a.specularColorMap||!!a.sheenColorMap||!!a.sheenRoughnessMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.iridescenceMap||a.iridescenceThicknessMap||a.transmission>0||a.transmissionMap||a.thicknessMap||a.specularIntensityMap||a.specularColorMap||a.sheen>0||a.sheenColorMap||a.sheenRoughnessMap)&&!!a.displacementMap,fog:!!g,useFog:!0===a.fog,fogExp2:g&&g.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:c,skinning:!0===m.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:P,morphTextureStride:C,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:a.dithering,shadowMapEnabled:t.shadowMap.enabled&&u.length>0,shadowMapType:t.shadowMap.type,toneMapping:a.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,doubleSided:2===a.side,flipSided:1===a.side,useDepthPacking:!!a.depthPacking,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(e){var n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputEncoding),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.combine),t.push(e.vertexUvs),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){s.disableAll(),e.isWebGL2&&s.enable(0);e.supportsVertexTextures&&s.enable(1);e.instancing&&s.enable(2);e.instancingColor&&s.enable(3);e.map&&s.enable(4);e.matcap&&s.enable(5);e.envMap&&s.enable(6);e.lightMap&&s.enable(7);e.aoMap&&s.enable(8);e.emissiveMap&&s.enable(9);e.bumpMap&&s.enable(10);e.normalMap&&s.enable(11);e.objectSpaceNormalMap&&s.enable(12);e.tangentSpaceNormalMap&&s.enable(13);e.clearcoat&&s.enable(14);e.clearcoatMap&&s.enable(15);e.clearcoatRoughnessMap&&s.enable(16);e.clearcoatNormalMap&&s.enable(17);e.iridescence&&s.enable(18);e.iridescenceMap&&s.enable(19);e.iridescenceThicknessMap&&s.enable(20);e.displacementMap&&s.enable(21);e.specularMap&&s.enable(22);e.roughnessMap&&s.enable(23);e.metalnessMap&&s.enable(24);e.gradientMap&&s.enable(25);e.alphaMap&&s.enable(26);e.alphaTest&&s.enable(27);e.vertexColors&&s.enable(28);e.vertexAlphas&&s.enable(29);e.vertexUvs&&s.enable(30);e.vertexTangents&&s.enable(31);e.uvsVertexOnly&&s.enable(32);t.push(s.mask),s.disableAll(),e.fog&&s.enable(0);e.useFog&&s.enable(1);e.flatShading&&s.enable(2);e.logarithmicDepthBuffer&&s.enable(3);e.skinning&&s.enable(4);e.morphTargets&&s.enable(5);e.morphNormals&&s.enable(6);e.morphColors&&s.enable(7);e.premultipliedAlpha&&s.enable(8);e.shadowMapEnabled&&s.enable(9);e.physicallyCorrectLights&&s.enable(10);e.doubleSided&&s.enable(11);e.flipSided&&s.enable(12);e.useDepthPacking&&s.enable(13);e.dithering&&s.enable(14);e.specularIntensityMap&&s.enable(15);e.specularColorMap&&s.enable(16);e.transmission&&s.enable(17);e.transmissionMap&&s.enable(18);e.thicknessMap&&s.enable(19);e.sheen&&s.enable(20);e.sheenColorMap&&s.enable(21);e.sheenRoughnessMap&&s.enable(22);e.decodeVideoTexture&&s.enable(23);e.opaque&&s.enable(24);t.push(s.mask)}(n,e),n.push(t.outputEncoding)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){var e,n=p[t.type];if(n){var i=Wi[n];e=Ei.clone(i.uniforms)}else e=t.uniforms;return e},acquireProgram:function(e,n){for(var i,r=0,o=u.length;r<o;r++){var s=u[r];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new za(t,n,e,a),u.push(i)),i},releaseProgram:function(t){if(0===--t.usedTimes){var e=u.indexOf(t);u[e]=u[u.length-1],u.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:u,dispose:function(){l.dispose()}}}function Wa(){var t=new WeakMap;return{get:function(e){var n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function qa(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Ya(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ka(){var t=[],e=0,n=[],i=[],r=[];function a(n,i,r,a,o,s){var l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:a,renderOrder:n.renderOrder,z:o,group:s},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=a,l.renderOrder=n.renderOrder,l.z=o,l.group=s),e++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){e=0,n.length=0,i.length=0,r.length=0},push:function(t,e,o,s,l,u){var h=a(t,e,o,s,l,u);o.transmission>0?i.push(h):!0===o.transparent?r.push(h):n.push(h)},unshift:function(t,e,o,s,l,u){var h=a(t,e,o,s,l,u);o.transmission>0?i.unshift(h):!0===o.transparent?r.unshift(h):n.unshift(h)},finish:function(){for(var n=e,i=t.length;n<i;n++){var r=t[n];if(null===r.id)break;r.id=null,r.object=null,r.geometry=null,r.material=null,r.group=null}},sort:function(t,e){n.length>1&&n.sort(t||qa),i.length>1&&i.sort(e||Ya),r.length>1&&r.sort(e||Ya)}}}function Za(){var t=new WeakMap;return{get:function(e,n){var i,r=t.get(e);return void 0===r?(i=new Ka,t.set(e,[i])):n>=r.length?(i=new Ka,r.push(i)):i=r[n],i},dispose:function(){t=new WeakMap}}}function Ja(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new Ee,color:new ve};break;case"SpotLight":n={position:new Ee,direction:new Ee,color:new ve,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ee,color:new ve,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ee,skyColor:new ve,groundColor:new ve};break;case"RectAreaLight":n={color:new ve,position:new Ee,halfWidth:new Ee,halfHeight:new Ee}}return t[e.id]=n,n}}}var Qa=0;function $a(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function to(t,e){for(var n=new Ja,i=function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0},a=0;a<9;a++)r.probe.push(new Ee);var o=new Ee,s=new rn,l=new rn;return{setup:function(a,o){for(var s=0,l=0,u=0,h=0;h<9;h++)r.probe[h].set(0,0,0);var c=0,d=0,f=0,p=0,v=0,m=0,g=0,y=0,_=0,x=0;a.sort($a);for(var b=!0!==o?Math.PI:1,w=0,S=a.length;w<S;w++){var T=a[w],M=T.color,E=T.intensity,A=T.distance,P=T.shadow&&T.shadow.map?T.shadow.map.texture:null;if(T.isAmbientLight)s+=M.r*E*b,l+=M.g*E*b,u+=M.b*E*b;else if(T.isLightProbe)for(var C=0;C<9;C++)r.probe[C].addScaledVector(T.sh.coefficients[C],E);else if(T.isDirectionalLight){var k=n.get(T);if(k.color.copy(T.color).multiplyScalar(T.intensity*b),T.castShadow){var R=T.shadow,I=i.get(T);I.shadowBias=R.bias,I.shadowNormalBias=R.normalBias,I.shadowRadius=R.radius,I.shadowMapSize=R.mapSize,r.directionalShadow[c]=I,r.directionalShadowMap[c]=P,r.directionalShadowMatrix[c]=T.shadow.matrix,m++}r.directional[c]=k,c++}else if(T.isSpotLight){var D=n.get(T);D.position.setFromMatrixPosition(T.matrixWorld),D.color.copy(M).multiplyScalar(E*b),D.distance=A,D.coneCos=Math.cos(T.angle),D.penumbraCos=Math.cos(T.angle*(1-T.penumbra)),D.decay=T.decay,r.spot[f]=D;var O=T.shadow;if(T.map&&(r.spotLightMap[_]=T.map,_++,O.updateMatrices(T),T.castShadow&&x++),r.spotLightMatrix[f]=O.matrix,T.castShadow){var L=i.get(T);L.shadowBias=O.bias,L.shadowNormalBias=O.normalBias,L.shadowRadius=O.radius,L.shadowMapSize=O.mapSize,r.spotShadow[f]=L,r.spotShadowMap[f]=P,y++}f++}else if(T.isRectAreaLight){var N=n.get(T);N.color.copy(M).multiplyScalar(E),N.halfWidth.set(.5*T.width,0,0),N.halfHeight.set(0,.5*T.height,0),r.rectArea[p]=N,p++}else if(T.isPointLight){var F=n.get(T);if(F.color.copy(T.color).multiplyScalar(T.intensity*b),F.distance=T.distance,F.decay=T.decay,T.castShadow){var B=T.shadow,U=i.get(T);U.shadowBias=B.bias,U.shadowNormalBias=B.normalBias,U.shadowRadius=B.radius,U.shadowMapSize=B.mapSize,U.shadowCameraNear=B.camera.near,U.shadowCameraFar=B.camera.far,r.pointShadow[d]=U,r.pointShadowMap[d]=P,r.pointShadowMatrix[d]=T.shadow.matrix,g++}r.point[d]=F,d++}else if(T.isHemisphereLight){var G=n.get(T);G.skyColor.copy(T.color).multiplyScalar(E*b),G.groundColor.copy(T.groundColor).multiplyScalar(E*b),r.hemi[v]=G,v++}}p>0&&(e.isWebGL2||!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=Xi.LTC_FLOAT_1,r.rectAreaLTC2=Xi.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=Xi.LTC_HALF_1,r.rectAreaLTC2=Xi.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=s,r.ambient[1]=l,r.ambient[2]=u;var z=r.hash;z.directionalLength===c&&z.pointLength===d&&z.spotLength===f&&z.rectAreaLength===p&&z.hemiLength===v&&z.numDirectionalShadows===m&&z.numPointShadows===g&&z.numSpotShadows===y&&z.numSpotMaps===_||(r.directional.length=c,r.spot.length=f,r.rectArea.length=p,r.point.length=d,r.hemi.length=v,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=y,r.spotShadowMap.length=y,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=y+_-x,r.spotLightMap.length=_,r.numSpotLightShadowsWithMaps=x,z.directionalLength=c,z.pointLength=d,z.spotLength=f,z.rectAreaLength=p,z.hemiLength=v,z.numDirectionalShadows=m,z.numPointShadows=g,z.numSpotShadows=y,z.numSpotMaps=_,r.version=Qa++)},setupView:function(t,e){for(var n=0,i=0,a=0,u=0,h=0,c=e.matrixWorldInverse,d=0,f=t.length;d<f;d++){var p=t[d];if(p.isDirectionalLight){var v=r.directional[n];v.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(c),n++}else if(p.isSpotLight){var m=r.spot[a];m.position.setFromMatrixPosition(p.matrixWorld),m.position.applyMatrix4(c),m.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(c),a++}else if(p.isRectAreaLight){var g=r.rectArea[u];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(c),l.identity(),s.copy(p.matrixWorld),s.premultiply(c),l.extractRotation(s),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(l),g.halfHeight.applyMatrix4(l),u++}else if(p.isPointLight){var y=r.point[i];y.position.setFromMatrixPosition(p.matrixWorld),y.position.applyMatrix4(c),i++}else if(p.isHemisphereLight){var _=r.hemi[h];_.direction.setFromMatrixPosition(p.matrixWorld),_.direction.transformDirection(c),h++}}},state:r}}function eo(t,e){var n=new to(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(t){n.setup(i,t)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function no(t,e){var n=new WeakMap;return{get:function(i){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=n.get(i);return void 0===o?(r=new eo(t,e),n.set(i,[r])):a>=o.length?(r=new eo(t,e),o.push(r)):r=o[a],r},dispose:function(){n=new WeakMap}}}var io=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshDepthMaterial=!0,i.type="MeshDepthMaterial",i.depthPacking=3200,i.map=null,i.alphaMap=null,i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.wireframe=!1,i.wireframeLinewidth=1,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}]),n}(Hn),ro=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshDistanceMaterial=!0,i.type="MeshDistanceMaterial",i.referencePosition=new Ee,i.nearDistance=1,i.farDistance=1e3,i.map=null,i.alphaMap=null,i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}]),n}(Hn);function ao(t,e,n){var i=new Gi,r=new te,a=new te,o=new be,s=new io({depthPacking:3201}),l=new ro,u={},h=n.maxTextureSize,c={0:1,1:0,2:2},d=new Ai({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new te},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=d.clone();f.defines.HORIZONTAL_PASS=1;var p=new ii;p.setAttribute("position",new Wn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new bi(p,d),m=this;function g(n,i){var a=e.update(v);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,f.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new we(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,a,d,v,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,a,f,v,null)}function y(e,n,i,r,a,o){var h=null,d=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(h=void 0!==d?d:!0===i.isPointLight?l:s,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0){var f=h.uuid,p=n.uuid,v=u[f];void 0===v&&(v={},u[f]=v);var m=v[p];void 0===m&&(m=h.clone(),v[p]=m),h=m}return h.visible=n.visible,h.wireframe=n.wireframe,h.side=3===o?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:c[n.side],h.alphaMap=n.alphaMap,h.alphaTest=n.alphaTest,h.clipShadows=n.clipShadows,h.clippingPlanes=n.clippingPlanes,h.clipIntersection=n.clipIntersection,h.displacementMap=n.displacementMap,h.displacementScale=n.displacementScale,h.displacementBias=n.displacementBias,h.wireframeLinewidth=n.wireframeLinewidth,h.linewidth=n.linewidth,!0===i.isPointLight&&!0===h.isMeshDistanceMaterial&&(h.referencePosition.setFromMatrixPosition(i.matrixWorld),h.nearDistance=r,h.farDistance=a),h}function _(n,r,a,o,s){if(!1!==n.visible){if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,n.matrixWorld);var l=e.update(n),u=n.material;if(Array.isArray(u))for(var h=l.groups,c=0,d=h.length;c<d;c++){var f=h[c],p=u[f.materialIndex];if(p&&p.visible){var v=y(n,p,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,v,n,f)}}else if(u.visible){var m=y(n,u,o,a.near,a.far,s);t.renderBufferDirect(a,null,l,m,n,null)}}for(var g=n.children,x=0,b=g.length;x<b;x++)_(g[x],r,a,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(e,n,s){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==e.length){var l=t.getRenderTarget(),u=t.getActiveCubeFace(),c=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var f=0,p=e.length;f<p;f++){var v=e[f],y=v.shadow;if(void 0!==y){if(!1!==y.autoUpdate||!1!==y.needsUpdate){r.copy(y.mapSize);var x=y.getFrameExtents();if(r.multiply(x),a.copy(y.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(a.x=Math.floor(h/x.x),r.x=a.x*x.x,y.mapSize.x=a.x),r.y>h&&(a.y=Math.floor(h/x.y),r.y=a.y*x.y,y.mapSize.y=a.y)),null===y.map){var b=3!==this.type?{minFilter:F,magFilter:F}:{};y.map=new we(r.x,r.y,b),y.map.texture.name=v.name+".shadowMap",y.camera.updateProjectionMatrix()}t.setRenderTarget(y.map),t.clear();for(var w=y.getViewportCount(),S=0;S<w;S++){var T=y.getViewport(S);o.set(a.x*T.x,a.y*T.y,a.x*T.z,a.y*T.w),d.viewport(o),y.updateMatrices(v,S),i=y.getFrustum(),_(n,s,y.camera,v,this.type)}!0!==y.isPointLightShadow&&3===this.type&&g(y,s),y.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}m.needsUpdate=!1,t.setRenderTarget(l,u,c)}}}function oo(t,e,n){var i,r,a=n.isWebGL2;var o=new function(){var e=!1,n=new be,i=null,r=new be(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,a,o,s){!0===s&&(e*=o,i*=o,a*=o),n.set(e,i,a,o),!1===r.equals(n)&&(t.clearColor(e,i,a,o),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){var e=!1,n=null,i=null,r=null;return{setTest:function(t){t?j(2929):X(2929)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){switch(e){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:default:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517)}i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},l=new function(){var e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null;return{setTest:function(t){e||(t?j(2960):X(2960))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,o){i===e&&r===n&&a===o||(t.stencilFunc(e,n,o),i=e,r=n,a=o)},setOp:function(e,n,i){o===e&&s===n&&l===i||(t.stencilOp(e,n,i),o=e,s=n,l=i)},setLocked:function(t){e=t},setClear:function(e){u!==e&&(t.clearStencil(e),u=e)},reset:function(){e=!1,n=null,i=null,r=null,a=null,o=null,s=null,l=null,u=null}}},u=new WeakMap,h=new WeakMap,c={},d={},f=new WeakMap,p=[],v=null,m=!1,g=null,y=null,_=null,x=null,b=null,w=null,S=null,T=!1,M=null,A=null,C=null,k=null,R=null,I=t.getParameter(35661),D=!1,O=0,L=t.getParameter(7938);-1!==L.indexOf("WebGL")?(O=parseFloat(/^WebGL (\d)/.exec(L)[1]),D=O>=1):-1!==L.indexOf("OpenGL ES")&&(O=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),D=O>=2);var N=null,F={},B=t.getParameter(3088),U=t.getParameter(2978),G=(new be).fromArray(B),z=(new be).fromArray(U);function H(e,n,i){var r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,10241,9728),t.texParameteri(e,10240,9728);for(var o=0;o<i;o++)t.texImage2D(n+o,0,6408,1,1,0,6408,5121,r);return a}var V={};function j(e){!0!==c[e]&&(t.enable(e),c[e]=!0)}function X(e){!1!==c[e]&&(t.disable(e),c[e]=!1)}V[3553]=H(3553,3553,1),V[34067]=H(34067,34069,6),o.setClear(0,0,0,1),s.setClear(1),l.setClear(0),j(2929),s.setFunc(3),Z(!1),J(1),j(2884),K(0);var W=(E(i={},P,32774),E(i,101,32778),E(i,102,32779),i);if(a)W[103]=32775,W[104]=32776;else{var q=e.get("EXT_blend_minmax");null!==q&&(W[103]=q.MIN_EXT,W[104]=q.MAX_EXT)}var Y=(E(r={},200,0),E(r,201,1),E(r,202,768),E(r,204,770),E(r,210,776),E(r,208,774),E(r,206,772),E(r,203,769),E(r,205,771),E(r,209,775),E(r,207,773),r);function K(e,n,i,r,a,o,s,l){if(0!==e){if(!1===m&&(j(3042),m=!0),5===e)a=a||n,o=o||i,s=s||r,n===y&&a===b||(t.blendEquationSeparate(W[n],W[a]),y=n,b=a),i===_&&r===x&&o===w&&s===S||(t.blendFuncSeparate(Y[i],Y[r],Y[o],Y[s]),_=i,x=r,w=o,S=s),g=e,T=null;else if(e!==g||l!==T){if(y===P&&b===P||(t.blendEquation(32774),y=P,b=P),l)switch(e){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}else switch(e){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFuncSeparate(0,769,0,1);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",e)}_=null,x=null,w=null,S=null,g=e,T=l}}else!0===m&&(X(3042),m=!1)}function Z(e){M!==e&&(e?t.frontFace(2304):t.frontFace(2305),M=e)}function J(e){0!==e?(j(2884),e!==A&&(1===e?t.cullFace(1029):2===e?t.cullFace(1028):t.cullFace(1032))):X(2884),A=e}function Q(e,n,i){e?(j(32823),k===n&&R===i||(t.polygonOffset(n,i),k=n,R=i)):X(32823)}return{buffers:{color:o,depth:s,stencil:l},enable:j,disable:X,bindFramebuffer:function(e,n){return d[e]!==n&&(t.bindFramebuffer(e,n),d[e]=n,a&&(36009===e&&(d[36160]=n),36160===e&&(d[36009]=n)),!0)},drawBuffers:function(i,r){var a=p,o=!1;if(i)if(void 0===(a=f.get(r))&&(a=[],f.set(r,a)),i.isWebGLMultipleRenderTargets){var s=i.texture;if(a.length!==s.length||36064!==a[0]){for(var l=0,u=s.length;l<u;l++)a[l]=36064+l;a.length=s.length,o=!0}}else 36064!==a[0]&&(a[0]=36064,o=!0);else 1029!==a[0]&&(a[0]=1029,o=!0);o&&(n.isWebGL2?t.drawBuffers(a):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(e){return v!==e&&(t.useProgram(e),v=e,!0)},setBlending:K,setMaterial:function(t,e){2===t.side?X(2884):j(2884);var n=1===t.side;e&&(n=!n),Z(n),1===t.blending&&!1===t.transparent?K(0):K(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),o.setMask(t.colorWrite);var i=t.stencilWrite;l.setTest(i),i&&(l.setMask(t.stencilWriteMask),l.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),l.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Q(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?j(32926):X(32926)},setFlipSided:Z,setCullFace:J,setLineWidth:function(e){e!==C&&(D&&t.lineWidth(e),C=e)},setPolygonOffset:Q,setScissorTest:function(t){t?j(3089):X(3089)},activeTexture:function(e){void 0===e&&(e=33984+I-1),N!==e&&(t.activeTexture(e),N=e)},bindTexture:function(e,n,i){void 0===i&&(i=null===N?33984+I-1:N);var r=F[i];void 0===r&&(r={type:void 0,texture:void 0},F[i]=r),r.type===e&&r.texture===n||(N!==i&&(t.activeTexture(i),N=i),t.bindTexture(e,n||V[e]),r.type=e,r.texture=n)},unbindTexture:function(){var e=F[N];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(e,n){var i=h.get(n);void 0===i&&(i=new WeakMap,h.set(n,i));var r=i.get(e);void 0===r&&(r=t.getUniformBlockIndex(n,e.name),i.set(e,r))},uniformBlockBinding:function(e,n){var i=h.get(n).get(e);u.get(e)!==i&&(t.uniformBlockBinding(n,i,e.__bindingPointIndex),u.set(e,i))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(e){!1===G.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),G.copy(e))},viewport:function(e){!1===z.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),z.copy(e))},reset:function(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),!0===a&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),c={},N=null,F={},d={},f=new WeakMap,p=[],v=null,m=!1,g=null,y=null,_=null,x=null,b=null,w=null,S=null,T=!1,M=null,A=null,C=null,k=null,R=null,G.set(0,0,t.canvas.width,t.canvas.height),z.set(0,0,t.canvas.width,t.canvas.height),o.reset(),s.reset(),l.reset()}}}function so(t,e,n,i,r,a,o){var s,l,u,h=r.isWebGL2,c=r.maxTextures,d=r.maxCubemapSize,f=r.maxTextureSize,p=r.maxSamples,v=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=/OculusBrowser/g.test(navigator.userAgent),g=new WeakMap,y=new WeakMap,_=!1;try{_="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(ut){}function x(t,e){return _?new OffscreenCanvas(t,e):ie("canvas")}function b(t,e,n,i){var r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!==typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap){var a=e?Zt:Math.floor,o=a(r*t.width),s=a(r*t.height);void 0===u&&(u=x(o,s));var l=n?x(o,s):u;return l.width=o,l.height=s,l.getContext("2d").drawImage(t,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+t.width+"x"+t.height+") to ("+o+"x"+s+")."),l}return"data"in t&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+t.width+"x"+t.height+")."),t}return t}function w(t){return Yt(t.width)&&Yt(t.height)}function S(t,e){return t.generateMipmaps&&e&&t.minFilter!==F&&t.minFilter!==G}function T(e){t.generateMipmap(e)}function M(n,i,r,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===h)return i;if(null!==n){if(void 0!==t[n])return t[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=i;return 6403===i&&(5126===r&&(s=33326),5131===r&&(s=33325),5121===r&&(s=33321)),33319===i&&(5126===r&&(s=33328),5131===r&&(s=33327),5121===r&&(s=33323)),6408===i&&(5126===r&&(s=34836),5131===r&&(s=34842),5121===r&&(s=a===It&&!1===o?35907:32856),32819===r&&(s=32854),32820===r&&(s=32855)),33325!==s&&33326!==s&&33327!==s&&33328!==s&&34842!==s&&34836!==s||e.get("EXT_color_buffer_float"),s}function A(t,e,n){return!0===S(t,n)||t.isFramebufferTexture&&t.minFilter!==F&&t.minFilter!==G?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function P(t){return t===F||t===B||t===U?9728:9729}function C(t){var e=t.target;e.removeEventListener("dispose",C),function(t){var e=i.get(t);if(void 0===e.__webglInit)return;var n=t.source,r=y.get(n);if(r){var a=r[e.__cacheKey];a.usedTimes--,0===a.usedTimes&&R(t),0===Object.keys(r).length&&y.delete(n)}i.remove(t)}(e),e.isVideoTexture&&g.delete(e)}function k(e){var n=e.target;n.removeEventListener("dispose",k),function(e){var n=e.texture,r=i.get(e),a=i.get(n);void 0!==a.__webglTexture&&(t.deleteTexture(a.__webglTexture),o.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(var s=0;s<6;s++)t.deleteFramebuffer(r.__webglFramebuffer[s]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[s]);else{if(t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(var l=0;l<r.__webglColorRenderbuffer.length;l++)r.__webglColorRenderbuffer[l]&&t.deleteRenderbuffer(r.__webglColorRenderbuffer[l]);r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(var u=0,h=n.length;u<h;u++){var c=i.get(n[u]);c.__webglTexture&&(t.deleteTexture(c.__webglTexture),o.memory.textures--),i.remove(n[u])}i.remove(n),i.remove(e)}(n)}function R(e){var n=i.get(e);t.deleteTexture(n.__webglTexture);var r=e.source;delete y.get(r)[n.__cacheKey],o.memory.textures--}var I=0;function D(t,e){var r=i.get(t);if(t.isVideoTexture&&function(t){var e=o.render.frame;g.get(t)!==e&&(g.set(t,e),t.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&r.__version!==t.version){var a=t.image;if(null===a)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==a.complete)return void nt(r,t,e);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(3553,r.__webglTexture,33984+e)}var K=(E(s={},O,10497),E(s,L,33071),E(s,N,33648),s),$=(E(l={},F,9728),E(l,B,9984),E(l,U,9986),E(l,G,9729),E(l,z,9985),E(l,H,9987),l);function tt(n,a,o){if(o?(t.texParameteri(n,10242,K[a.wrapS]),t.texParameteri(n,10243,K[a.wrapT]),32879!==n&&35866!==n||t.texParameteri(n,32882,K[a.wrapR]),t.texParameteri(n,10240,$[a.magFilter]),t.texParameteri(n,10241,$[a.minFilter])):(t.texParameteri(n,10242,33071),t.texParameteri(n,10243,33071),32879!==n&&35866!==n||t.texParameteri(n,32882,33071),a.wrapS===L&&a.wrapT===L||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(n,10240,P(a.magFilter)),t.texParameteri(n,10241,P(a.minFilter)),a.minFilter!==F&&a.minFilter!==G&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){var s=e.get("EXT_texture_filter_anisotropic");if(a.type===W&&!1===e.has("OES_texture_float_linear"))return;if(!1===h&&a.type===q&&!1===e.has("OES_texture_half_float_linear"))return;(a.anisotropy>1||i.get(a).__currentAnisotropy)&&(t.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,r.getMaxAnisotropy())),i.get(a).__currentAnisotropy=a.anisotropy)}}function et(e,n){var i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",C));var r=n.source,a=y.get(r);void 0===a&&(a={},y.set(r,a));var s=function(t){var e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.encoding),e.join()}(n);if(s!==e.__cacheKey){void 0===a[s]&&(a[s]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,i=!0),a[s].usedTimes++;var l=a[e.__cacheKey];void 0!==l&&(a[e.__cacheKey].usedTimes--,0===l.usedTimes&&R(n)),e.__cacheKey=s,e.__webglTexture=a[s].texture}return i}function nt(e,r,o){var s=3553;r.isDataArrayTexture&&(s=35866),r.isData3DTexture&&(s=32879);var l=et(e,r),u=r.source;n.bindTexture(s,e.__webglTexture,33984+o);var c=i.get(u);if(u.version!==c.__version||!0===l){n.activeTexture(33984+o),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);var d,p=function(t){return!h&&(t.wrapS!==L||t.wrapT!==L||t.minFilter!==F&&t.minFilter!==G)}(r)&&!1===w(r.image),v=b(r.image,p,!1,f),m=w(v=lt(r,v))||h,g=a.convert(r.format,r.encoding),y=a.convert(r.type),_=M(r.internalFormat,g,y,r.encoding,r.isVideoTexture);tt(s,r,m);var x=r.mipmaps,E=h&&!0!==r.isVideoTexture,P=void 0===c.__version||!0===l,C=A(r,v,m);if(r.isDepthTexture)_=6402,h?_=r.type===W?36012:r.type===X?33190:r.type===Y?35056:33189:r.type===W&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===J&&6402===_&&r.type!==j&&r.type!==X&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=X,y=a.convert(r.type)),r.format===Q&&6402===_&&(_=34041,r.type!==Y&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Y,y=a.convert(r.type))),P&&(E?n.texStorage2D(3553,1,_,v.width,v.height):n.texImage2D(3553,0,_,v.width,v.height,0,g,y,null));else if(r.isDataTexture)if(x.length>0&&m){E&&P&&n.texStorage2D(3553,C,_,x[0].width,x[0].height);for(var k=0,R=x.length;k<R;k++)d=x[k],E?n.texSubImage2D(3553,k,0,0,d.width,d.height,g,y,d.data):n.texImage2D(3553,k,_,d.width,d.height,0,g,y,d.data);r.generateMipmaps=!1}else E?(P&&n.texStorage2D(3553,C,_,v.width,v.height),n.texSubImage2D(3553,0,0,0,v.width,v.height,g,y,v.data)):n.texImage2D(3553,0,_,v.width,v.height,0,g,y,v.data);else if(r.isCompressedTexture){E&&P&&n.texStorage2D(3553,C,_,x[0].width,x[0].height);for(var I=0,D=x.length;I<D;I++)d=x[I],r.format!==Z?null!==g?E?n.compressedTexSubImage2D(3553,I,0,0,d.width,d.height,g,d.data):n.compressedTexImage2D(3553,I,_,d.width,d.height,0,d.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):E?n.texSubImage2D(3553,I,0,0,d.width,d.height,g,y,d.data):n.texImage2D(3553,I,_,d.width,d.height,0,g,y,d.data)}else if(r.isDataArrayTexture)E?(P&&n.texStorage3D(35866,C,_,v.width,v.height,v.depth),n.texSubImage3D(35866,0,0,0,0,v.width,v.height,v.depth,g,y,v.data)):n.texImage3D(35866,0,_,v.width,v.height,v.depth,0,g,y,v.data);else if(r.isData3DTexture)E?(P&&n.texStorage3D(32879,C,_,v.width,v.height,v.depth),n.texSubImage3D(32879,0,0,0,0,v.width,v.height,v.depth,g,y,v.data)):n.texImage3D(32879,0,_,v.width,v.height,v.depth,0,g,y,v.data);else if(r.isFramebufferTexture){if(P)if(E)n.texStorage2D(3553,C,_,v.width,v.height);else for(var O=v.width,N=v.height,B=0;B<C;B++)n.texImage2D(3553,B,_,O,N,0,g,y,null),O>>=1,N>>=1}else if(x.length>0&&m){E&&P&&n.texStorage2D(3553,C,_,x[0].width,x[0].height);for(var U=0,z=x.length;U<z;U++)d=x[U],E?n.texSubImage2D(3553,U,0,0,g,y,d):n.texImage2D(3553,U,_,g,y,d);r.generateMipmaps=!1}else E?(P&&n.texStorage2D(3553,C,_,v.width,v.height),n.texSubImage2D(3553,0,0,0,g,y,v)):n.texImage2D(3553,0,_,g,y,v);S(r,m)&&T(s),c.__version=u.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}function it(e,r,o,s,l){var u=a.convert(o.format,o.encoding),h=a.convert(o.type),c=M(o.internalFormat,u,h,o.encoding);i.get(r).__hasExternalTextures||(32879===l||35866===l?n.texImage3D(l,0,c,r.width,r.height,r.depth,0,u,h,null):n.texImage2D(l,0,c,r.width,r.height,0,u,h,null)),n.bindFramebuffer(36160,e),st(r)?v.framebufferTexture2DMultisampleEXT(36160,s,l,i.get(o).__webglTexture,0,ot(r)):t.framebufferTexture2D(36160,s,l,i.get(o).__webglTexture,0),n.bindFramebuffer(36160,null)}function rt(e,n,i){if(t.bindRenderbuffer(36161,e),n.depthBuffer&&!n.stencilBuffer){var r=33189;if(i||st(n)){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===W?r=36012:o.type===X&&(r=33190));var s=ot(n);st(n)?v.renderbufferStorageMultisampleEXT(36161,s,r,n.width,n.height):t.renderbufferStorageMultisample(36161,s,r,n.width,n.height)}else t.renderbufferStorage(36161,r,n.width,n.height);t.framebufferRenderbuffer(36160,36096,36161,e)}else if(n.depthBuffer&&n.stencilBuffer){var l=ot(n);i&&!1===st(n)?t.renderbufferStorageMultisample(36161,l,35056,n.width,n.height):st(n)?v.renderbufferStorageMultisampleEXT(36161,l,35056,n.width,n.height):t.renderbufferStorage(36161,34041,n.width,n.height),t.framebufferRenderbuffer(36160,33306,36161,e)}else for(var u=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture],h=0;h<u.length;h++){var c=u[h],d=a.convert(c.format,c.encoding),f=a.convert(c.type),p=M(c.internalFormat,d,f,c.encoding),m=ot(n);i&&!1===st(n)?t.renderbufferStorageMultisample(36161,m,p,n.width,n.height):st(n)?v.renderbufferStorageMultisampleEXT(36161,m,p,n.width,n.height):t.renderbufferStorage(36161,p,n.width,n.height)}t.bindRenderbuffer(36161,null)}function at(e){var r=i.get(e),a=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(a)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),D(r.depthTexture,0);var a=i.get(r.depthTexture).__webglTexture,o=ot(r);if(r.depthTexture.format===J)st(r)?v.framebufferTexture2DMultisampleEXT(36160,36096,3553,a,0,o):t.framebufferTexture2D(36160,36096,3553,a,0);else{if(r.depthTexture.format!==Q)throw new Error("Unknown depthTexture format");st(r)?v.framebufferTexture2DMultisampleEXT(36160,33306,3553,a,0,o):t.framebufferTexture2D(36160,33306,3553,a,0)}}(r.__webglFramebuffer,e)}else if(a){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(36160,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=t.createRenderbuffer(),rt(r.__webglDepthbuffer[o],e,!1)}else n.bindFramebuffer(36160,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),rt(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(36160,null)}function ot(t){return Math.min(p,t.samples)}function st(t){var n=i.get(t);return h&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function lt(t,n){var i=t.encoding,r=t.format,a=t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===Bt||i!==Rt&&(i===It?!1===h?!0===e.has("EXT_sRGB")&&r===Z?(t.format=Bt,t.minFilter=G,t.generateMipmaps=!1):n=me.sRGBToLinear(n):r===Z&&a===V||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",i)),n}this.allocateTextureUnit=function(){var t=I;return t>=c&&console.warn("THREE.WebGLTextures: Trying to use "+t+" texture units while this GPU supports only "+c),I+=1,t},this.resetTextureUnits=function(){I=0},this.setTexture2D=D,this.setTexture2DArray=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?nt(r,t,e):n.bindTexture(35866,r.__webglTexture,33984+e)},this.setTexture3D=function(t,e){var r=i.get(t);t.version>0&&r.__version!==t.version?nt(r,t,e):n.bindTexture(32879,r.__webglTexture,33984+e)},this.setTextureCube=function(e,r){var o=i.get(e);e.version>0&&o.__version!==e.version?function(e,r,o){if(6!==r.image.length)return;var s=et(e,r),l=r.source;n.bindTexture(34067,e.__webglTexture,33984+o);var u=i.get(l);if(l.version!==u.__version||!0===s){n.activeTexture(33984+o),t.pixelStorei(37440,r.flipY),t.pixelStorei(37441,r.premultiplyAlpha),t.pixelStorei(3317,r.unpackAlignment),t.pixelStorei(37443,0);for(var c=r.isCompressedTexture||r.image[0].isCompressedTexture,f=r.image[0]&&r.image[0].isDataTexture,p=[],v=0;v<6;v++)p[v]=c||f?f?r.image[v].image:r.image[v]:b(r.image[v],!1,!0,d),p[v]=lt(r,p[v]);var m,g=p[0],y=w(g)||h,_=a.convert(r.format,r.encoding),x=a.convert(r.type),E=M(r.internalFormat,_,x,r.encoding),P=h&&!0!==r.isVideoTexture,C=void 0===u.__version||!0===s,k=A(r,g,y);if(tt(34067,r,y),c){P&&C&&n.texStorage2D(34067,k,E,g.width,g.height);for(var R=0;R<6;R++){m=p[R].mipmaps;for(var I=0;I<m.length;I++){var D=m[I];r.format!==Z?null!==_?P?n.compressedTexSubImage2D(34069+R,I,0,0,D.width,D.height,_,D.data):n.compressedTexImage2D(34069+R,I,E,D.width,D.height,0,D.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):P?n.texSubImage2D(34069+R,I,0,0,D.width,D.height,_,x,D.data):n.texImage2D(34069+R,I,E,D.width,D.height,0,_,x,D.data)}}}else{m=r.mipmaps,P&&C&&(m.length>0&&k++,n.texStorage2D(34067,k,E,p[0].width,p[0].height));for(var O=0;O<6;O++)if(f){P?n.texSubImage2D(34069+O,0,0,0,p[O].width,p[O].height,_,x,p[O].data):n.texImage2D(34069+O,0,E,p[O].width,p[O].height,0,_,x,p[O].data);for(var L=0;L<m.length;L++){var N=m[L].image[O].image;P?n.texSubImage2D(34069+O,L+1,0,0,N.width,N.height,_,x,N.data):n.texImage2D(34069+O,L+1,E,N.width,N.height,0,_,x,N.data)}}else{P?n.texSubImage2D(34069+O,0,0,0,_,x,p[O]):n.texImage2D(34069+O,0,E,_,x,p[O]);for(var F=0;F<m.length;F++){var B=m[F];P?n.texSubImage2D(34069+O,F+1,0,0,_,x,B.image[O]):n.texImage2D(34069+O,F+1,E,_,x,B.image[O])}}}S(r,y)&&T(34067),u.__version=l.version,r.onUpdate&&r.onUpdate(r)}e.__version=r.version}(o,e,r):n.bindTexture(34067,o.__webglTexture,33984+r)},this.rebindTextures=function(t,e,n){var r=i.get(t);void 0!==e&&it(r.__webglFramebuffer,t,t.texture,36064,3553),void 0!==n&&at(t)},this.setupRenderTarget=function(e){var s=e.texture,l=i.get(e),u=i.get(s);e.addEventListener("dispose",k),!0!==e.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=t.createTexture()),u.__version=s.version,o.memory.textures++);var c=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,f=w(e)||h;if(c){l.__webglFramebuffer=[];for(var p=0;p<6;p++)l.__webglFramebuffer[p]=t.createFramebuffer()}else{if(l.__webglFramebuffer=t.createFramebuffer(),d)if(r.drawBuffers)for(var v=e.texture,m=0,g=v.length;m<g;m++){var y=i.get(v[m]);void 0===y.__webglTexture&&(y.__webglTexture=t.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&e.samples>0&&!1===st(e)){var _=d?s:[s];l.__webglMultisampledFramebuffer=t.createFramebuffer(),l.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,l.__webglMultisampledFramebuffer);for(var x=0;x<_.length;x++){var b=_[x];l.__webglColorRenderbuffer[x]=t.createRenderbuffer(),t.bindRenderbuffer(36161,l.__webglColorRenderbuffer[x]);var E=a.convert(b.format,b.encoding),A=a.convert(b.type),P=M(b.internalFormat,E,A,b.encoding,!0===e.isXRRenderTarget),C=ot(e);t.renderbufferStorageMultisample(36161,C,P,e.width,e.height),t.framebufferRenderbuffer(36160,36064+x,36161,l.__webglColorRenderbuffer[x])}t.bindRenderbuffer(36161,null),e.depthBuffer&&(l.__webglDepthRenderbuffer=t.createRenderbuffer(),rt(l.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(36160,null)}}if(c){n.bindTexture(34067,u.__webglTexture),tt(34067,s,f);for(var R=0;R<6;R++)it(l.__webglFramebuffer[R],e,s,36064,34069+R);S(s,f)&&T(34067),n.unbindTexture()}else if(d){for(var I=e.texture,D=0,O=I.length;D<O;D++){var L=I[D],N=i.get(L);n.bindTexture(3553,N.__webglTexture),tt(3553,L,f),it(l.__webglFramebuffer,e,L,36064+D,3553),S(L,f)&&T(3553)}n.unbindTexture()}else{var F=3553;(e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&(h?F=e.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(F,u.__webglTexture),tt(F,s,f),it(l.__webglFramebuffer,e,s,36064,F),S(s,f)&&T(F),n.unbindTexture()}e.depthBuffer&&at(e)},this.updateRenderTargetMipmap=function(t){for(var e=w(t)||h,r=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=0,o=r.length;a<o;a++){var s=r[a];if(S(s,e)){var l=t.isWebGLCubeRenderTarget?34067:3553,u=i.get(s).__webglTexture;n.bindTexture(l,u),T(l),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(h&&e.samples>0&&!1===st(e)){var r=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],a=e.width,o=e.height,s=16384,l=[],u=e.stencilBuffer?33306:36096,c=i.get(e),d=!0===e.isWebGLMultipleRenderTargets;if(d)for(var f=0;f<r.length;f++)n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+f,36161,null),n.bindFramebuffer(36160,c.__webglFramebuffer),t.framebufferTexture2D(36009,36064+f,3553,null,0);n.bindFramebuffer(36008,c.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,c.__webglFramebuffer);for(var p=0;p<r.length;p++){l.push(36064+p),e.depthBuffer&&l.push(u);var v=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===v&&(e.depthBuffer&&(s|=256),e.stencilBuffer&&(s|=1024)),d&&t.framebufferRenderbuffer(36008,36064,36161,c.__webglColorRenderbuffer[p]),!0===v&&(t.invalidateFramebuffer(36008,[u]),t.invalidateFramebuffer(36009,[u])),d){var g=i.get(r[p]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,g,0)}t.blitFramebuffer(0,0,a,o,0,0,a,o,s,9728),m&&t.invalidateFramebuffer(36008,l)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),d)for(var y=0;y<r.length;y++){n.bindFramebuffer(36160,c.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+y,36161,c.__webglColorRenderbuffer[y]);var _=i.get(r[y]).__webglTexture;n.bindFramebuffer(36160,c.__webglFramebuffer),t.framebufferTexture2D(36009,36064+y,3553,_,0)}n.bindFramebuffer(36009,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=at,this.setupFrameBufferTexture=it,this.useMultisampledRTT=st}function lo(t,e,n){var i=n.isWebGL2;return{convert:function(n){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(n===V)return 5121;if(1017===n)return 32819;if(1018===n)return 32820;if(1010===n)return 5120;if(1011===n)return 5122;if(n===j)return 5123;if(1013===n)return 5124;if(n===X)return 5125;if(n===W)return 5126;if(n===q)return i?5131:null!==(r=e.get("OES_texture_half_float"))?r.HALF_FLOAT_OES:null;if(1021===n)return 6406;if(n===Z)return 6408;if(1024===n)return 6409;if(1025===n)return 6410;if(n===J)return 6402;if(n===Q)return 34041;if(1028===n)return 6403;if(n===K)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(n===Bt)return null!==(r=e.get("EXT_sRGB"))?r.SRGB_ALPHA_EXT:null;if(1029===n)return 36244;if(1030===n)return 33319;if(1031===n)return 33320;if(1033===n)return 36249;if(n===$||n===tt||n===et||n===nt)if(a===It){if(null===(r=e.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(n===$)return r.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===tt)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===et)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===nt)return r.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(r=e.get("WEBGL_compressed_texture_s3tc")))return null;if(n===$)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===tt)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===et)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===nt)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(n===it||n===rt||n===at||n===ot){if(null===(r=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(n===it)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===rt)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===at)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===ot)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return null!==(r=e.get("WEBGL_compressed_texture_etc1"))?r.COMPRESSED_RGB_ETC1_WEBGL:null;if(n===st||n===lt){if(null===(r=e.get("WEBGL_compressed_texture_etc")))return null;if(n===st)return a===It?r.COMPRESSED_SRGB8_ETC2:r.COMPRESSED_RGB8_ETC2;if(n===lt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:r.COMPRESSED_RGBA8_ETC2_EAC}if(n===ut||n===ht||n===ct||n===dt||n===ft||n===pt||n===vt||n===mt||n===gt||n===yt||n===_t||n===xt||n===bt||n===wt){if(null===(r=e.get("WEBGL_compressed_texture_astc")))return null;if(n===ut)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:r.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===ht)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:r.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===ct)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:r.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===dt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:r.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===ft)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:r.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===pt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:r.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===vt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:r.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===mt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:r.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===gt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:r.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===yt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:r.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===_t)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:r.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===xt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:r.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===bt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:r.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===wt)return a===It?r.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:r.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===St){if(null===(r=e.get("EXT_texture_compression_bptc")))return null;if(n===St)return a===It?r.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:r.COMPRESSED_RGBA_BPTC_UNORM_EXT}return n===Y?i?34042:null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:null:void 0!==t[n]?t[n]:null}}}var uo=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a(this,n),(t=e.call(this)).isArrayCamera=!0,t.cameras=i,t}return s(n)}(Ci),ho=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isGroup=!0,t.type="Group",t}return s(n)}(Cn),co={type:"move"},fo=function(){function t(){a(this,t),this._targetRay=null,this._grip=null,this._hand=null}return s(t,[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new ho,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new ho,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ee,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ee),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new ho,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ee,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ee),this._grip}},{key:"dispatchEvent",value:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}},{key:"disconnect",value:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(t,e,n){var i=null,r=null,a=null,o=this._targetRay,s=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){a=!0;var u,h=w(t.hand.values());try{for(h.s();!(u=h.n()).done;){var c=u.value,d=e.getJointPose(c,n);if(void 0===l.joints[c.jointName]){var f=new ho;f.matrixAutoUpdate=!1,f.visible=!1,l.joints[c.jointName]=f,l.add(f)}var p=l.joints[c.jointName];null!==d&&(p.matrix.fromArray(d.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.jointRadius=d.radius),p.visible=null!==d}}catch(y){h.e(y)}finally{h.f()}var v=l.joints["index-finger-tip"],m=l.joints["thumb-tip"],g=v.position.distanceTo(m.position);l.inputState.pinching&&g>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&g<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==s&&t.gripSpace&&null!==(r=e.getPose(t.gripSpace,n))&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1);null!==o&&(null===(i=e.getPose(t.targetRaySpace,n))&&null!==r&&(i=r),null!==i&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(co)))}return null!==o&&(o.visible=null!==i),null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==a),this}}]),t}(),po=function(t){d(n,t);var e=m(n);function n(t,i,r,o,s,l,u,h,c,d){var f;if(a(this,n),(d=void 0!==d?d:J)!==J&&d!==Q)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===r&&d===J&&(r=X),void 0===r&&d===Q&&(r=Y),(f=e.call(this,null,o,s,l,u,h,d,r,c)).isDepthTexture=!0,f.image={width:t,height:i},f.magFilter=void 0!==u?u:F,f.minFilter=void 0!==h?h:F,f.flipY=!1,f.generateMipmaps=!1,f}return s(n)}(xe),vo=function(t){d(i,t);var n=m(i);function i(t,o){var s;a(this,i);var l=h(s=n.call(this)),u=null,c=1,d=null,f="local-floor",p=null,v=null,m=null,g=null,y=null,_=null,x=o.getContextAttributes(),b=null,w=null,S=[],T=[],M=new Ci;M.layers.enable(1),M.viewport=new be;var E=new Ci;E.layers.enable(2),E.viewport=new be;var A=[M,E],P=new uo;P.layers.enable(1),P.layers.enable(2);var C=null,k=null;function R(t){var e=T.indexOf(t.inputSource);if(-1!==e){var n=S[e];void 0!==n&&n.dispatchEvent({type:t.type,data:t.inputSource})}}function I(){u.removeEventListener("select",R),u.removeEventListener("selectstart",R),u.removeEventListener("selectend",R),u.removeEventListener("squeeze",R),u.removeEventListener("squeezestart",R),u.removeEventListener("squeezeend",R),u.removeEventListener("end",I),u.removeEventListener("inputsourceschange",D);for(var e=0;e<S.length;e++){var n=T[e];null!==n&&(T[e]=null,S[e].disconnect(n))}C=null,k=null,t.setRenderTarget(b),y=null,g=null,m=null,u=null,w=null,B.stop(),l.isPresenting=!1,l.dispatchEvent({type:"sessionend"})}function D(t){for(var e=0;e<t.removed.length;e++){var n=t.removed[e],i=T.indexOf(n);i>=0&&(T[i]=null,S[i].dispatchEvent({type:"disconnected",data:n}))}for(var r=0;r<t.added.length;r++){var a=t.added[r],o=T.indexOf(a);if(-1===o){for(var s=0;s<S.length;s++){if(s>=T.length){T.push(a),o=s;break}if(null===T[s]){T[s]=a,o=s;break}}if(-1===o)break}var l=S[o];l&&l.dispatchEvent({type:"connected",data:a})}}s.cameraAutoUpdate=!0,s.enabled=!1,s.isPresenting=!1,s.getController=function(t){var e=S[t];return void 0===e&&(e=new fo,S[t]=e),e.getTargetRaySpace()},s.getControllerGrip=function(t){var e=S[t];return void 0===e&&(e=new fo,S[t]=e),e.getGripSpace()},s.getHand=function(t){var e=S[t];return void 0===e&&(e=new fo,S[t]=e),e.getHandSpace()},s.setFramebufferScaleFactor=function(t){c=t,!0===l.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},s.setReferenceSpaceType=function(t){f=t,!0===l.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},s.getReferenceSpace=function(){return p||d},s.setReferenceSpace=function(t){p=t},s.getBaseLayer=function(){return null!==g?g:y},s.getBinding=function(){return m},s.getFrame=function(){return _},s.getSession=function(){return u},s.setSession=function(){var n=r(e().mark((function n(i){var r,a,s,h,v;return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(u=i)){e.next=25;break}if(b=t.getRenderTarget(),u.addEventListener("select",R),u.addEventListener("selectstart",R),u.addEventListener("selectend",R),u.addEventListener("squeeze",R),u.addEventListener("squeezestart",R),u.addEventListener("squeezeend",R),u.addEventListener("end",I),u.addEventListener("inputsourceschange",D),!0===x.xrCompatible){e.next=14;break}return e.next=14,o.makeXRCompatible();case 14:return void 0===u.renderState.layers||!1===t.capabilities.isWebGL2?(r={antialias:void 0!==u.renderState.layers||x.antialias,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:c},y=new XRWebGLLayer(u,o,r),u.updateRenderState({baseLayer:y}),w=new we(y.framebufferWidth,y.framebufferHeight,{format:Z,type:V,encoding:t.outputEncoding,stencilBuffer:x.stencil})):(a=null,s=null,h=null,x.depth&&(h=x.stencil?35056:33190,a=x.stencil?Q:J,s=x.stencil?Y:X),v={colorFormat:32856,depthFormat:h,scaleFactor:c},m=new XRWebGLBinding(u,o),g=m.createProjectionLayer(v),u.updateRenderState({layers:[g]}),w=new we(g.textureWidth,g.textureHeight,{format:Z,type:V,depthTexture:new po(g.textureWidth,g.textureHeight,s,void 0,void 0,void 0,void 0,void 0,void 0,a),stencilBuffer:x.stencil,encoding:t.outputEncoding,samples:x.antialias?4:0}),t.properties.get(w).__ignoreDepthValues=g.ignoreDepthValues),w.isXRRenderTarget=!0,this.setFoveation(1),p=null,e.next=20,u.requestReferenceSpace(f);case 20:d=e.sent,B.setContext(u),B.start(),l.isPresenting=!0,l.dispatchEvent({type:"sessionstart"});case 25:case"end":return e.stop()}}),n,this)})));return function(t){return n.apply(this,arguments)}}();var O=new Ee,L=new Ee;function N(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}s.updateCamera=function(t){if(null!==u){P.near=E.near=M.near=t.near,P.far=E.far=M.far=t.far,C===P.near&&k===P.far||(u.updateRenderState({depthNear:P.near,depthFar:P.far}),C=P.near,k=P.far);var e=t.parent,n=P.cameras;N(P,e);for(var i=0;i<n.length;i++)N(n[i],e);P.matrixWorld.decompose(P.position,P.quaternion,P.scale),t.matrix.copy(P.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale);for(var r=t.children,a=0,o=r.length;a<o;a++)r[a].updateMatrixWorld(!0);2===n.length?function(t,e,n){O.setFromMatrixPosition(e.matrixWorld),L.setFromMatrixPosition(n.matrixWorld);var i=O.distanceTo(L),r=e.projectionMatrix.elements,a=n.projectionMatrix.elements,o=r[14]/(r[10]-1),s=r[14]/(r[10]+1),l=(r[9]+1)/r[5],u=(r[9]-1)/r[5],h=(r[8]-1)/r[0],c=(a[8]+1)/a[0],d=o*h,f=o*c,p=i/(-h+c),v=p*-h;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(v),t.translateZ(p),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();var m=o+p,g=s+p,y=d-v,_=f+(i-v),x=l*s/g*m,b=u*s/g*m;t.projectionMatrix.makePerspective(y,_,x,b,m,g)}(P,M,E):P.projectionMatrix.copy(M.projectionMatrix)}},s.getCamera=function(){return P},s.getFoveation=function(){return null!==g?g.fixedFoveation:null!==y?y.fixedFoveation:void 0},s.setFoveation=function(t){null!==g&&(g.fixedFoveation=t),null!==y&&void 0!==y.fixedFoveation&&(y.fixedFoveation=t)};var F=null;var B=new zi;return B.setAnimationLoop((function(e,n){if(v=n.getViewerPose(p||d),_=n,null!==v){var i=v.views;null!==y&&(t.setRenderTargetFramebuffer(w,y.framebuffer),t.setRenderTarget(w));var r=!1;i.length!==P.cameras.length&&(P.cameras.length=0,r=!0);for(var a=0;a<i.length;a++){var o=i[a],s=null;if(null!==y)s=y.getViewport(o);else{var l=m.getViewSubImage(g,o);s=l.viewport,0===a&&(t.setRenderTargetTextures(w,l.colorTexture,g.ignoreDepthValues?void 0:l.depthStencilTexture),t.setRenderTarget(w))}var u=A[a];void 0===u&&((u=new Ci).layers.enable(a),u.viewport=new be,A[a]=u),u.matrix.fromArray(o.transform.matrix),u.projectionMatrix.fromArray(o.projectionMatrix),u.viewport.set(s.x,s.y,s.width,s.height),0===a&&P.matrix.copy(u.matrix),!0===r&&P.cameras.push(u)}}for(var h=0;h<S.length;h++){var c=T[h],f=S[h];null!==c&&void 0!==f&&f.update(c,n,p||d)}F&&F(e,n),_=null})),s.setAnimationLoop=function(t){F=t},s.dispose=function(){},s}return s(i)}(Ut);function mo(t,e){function n(n,i){n.opacity.value=i.opacity,i.color&&n.diffuse.value.copy(i.color),i.emissive&&n.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),i.map&&(n.map.value=i.map),i.alphaMap&&(n.alphaMap.value=i.alphaMap),i.bumpMap&&(n.bumpMap.value=i.bumpMap,n.bumpScale.value=i.bumpScale,1===i.side&&(n.bumpScale.value*=-1)),i.displacementMap&&(n.displacementMap.value=i.displacementMap,n.displacementScale.value=i.displacementScale,n.displacementBias.value=i.displacementBias),i.emissiveMap&&(n.emissiveMap.value=i.emissiveMap),i.normalMap&&(n.normalMap.value=i.normalMap,n.normalScale.value.copy(i.normalScale),1===i.side&&n.normalScale.value.negate()),i.specularMap&&(n.specularMap.value=i.specularMap),i.alphaTest>0&&(n.alphaTest.value=i.alphaTest);var r,a,o=e.get(i).envMap;if(o&&(n.envMap.value=o,n.flipEnvMap.value=o.isCubeTexture&&!1===o.isRenderTargetTexture?-1:1,n.reflectivity.value=i.reflectivity,n.ior.value=i.ior,n.refractionRatio.value=i.refractionRatio),i.lightMap){n.lightMap.value=i.lightMap;var s=!0!==t.physicallyCorrectLights?Math.PI:1;n.lightMapIntensity.value=i.lightMapIntensity*s}i.aoMap&&(n.aoMap.value=i.aoMap,n.aoMapIntensity.value=i.aoMapIntensity),i.map?r=i.map:i.specularMap?r=i.specularMap:i.displacementMap?r=i.displacementMap:i.normalMap?r=i.normalMap:i.bumpMap?r=i.bumpMap:i.roughnessMap?r=i.roughnessMap:i.metalnessMap?r=i.metalnessMap:i.alphaMap?r=i.alphaMap:i.emissiveMap?r=i.emissiveMap:i.clearcoatMap?r=i.clearcoatMap:i.clearcoatNormalMap?r=i.clearcoatNormalMap:i.clearcoatRoughnessMap?r=i.clearcoatRoughnessMap:i.iridescenceMap?r=i.iridescenceMap:i.iridescenceThicknessMap?r=i.iridescenceThicknessMap:i.specularIntensityMap?r=i.specularIntensityMap:i.specularColorMap?r=i.specularColorMap:i.transmissionMap?r=i.transmissionMap:i.thicknessMap?r=i.thicknessMap:i.sheenColorMap?r=i.sheenColorMap:i.sheenRoughnessMap&&(r=i.sheenRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),n.uvTransform.value.copy(r.matrix)),i.aoMap?a=i.aoMap:i.lightMap&&(a=i.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),n.uv2Transform.value.copy(a.matrix))}return{refreshFogUniforms:function(t,e){t.fogColor.value.copy(e.color),e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)},refreshMaterialUniforms:function(t,i,r,a,o){i.isMeshBasicMaterial||i.isMeshLambertMaterial?n(t,i):i.isMeshToonMaterial?(n(t,i),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,i)):i.isMeshPhongMaterial?(n(t,i),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,i)):i.isMeshStandardMaterial?(n(t,i),function(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap);n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap);e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}(t,i),i.isMeshPhysicalMaterial&&function(t,e,n){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap),e.clearcoatNormalMap&&(t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),t.clearcoatNormalMap.value=e.clearcoatNormalMap,1===e.side&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=n.texture,t.transmissionSamplerSize.value.set(n.width,n.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap);e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap)}(t,i,o)):i.isMeshMatcapMaterial?(n(t,i),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,i)):i.isMeshDepthMaterial?n(t,i):i.isMeshDistanceMaterial?(n(t,i),function(t,e){t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(t,i)):i.isMeshNormalMaterial?n(t,i):i.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity}(t,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,i)):i.isPointsMaterial?function(t,e,n,i){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*n,t.scale.value=.5*i,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);var r;e.map?r=e.map:e.alphaMap&&(r=e.alphaMap);void 0!==r&&(!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}(t,i,r,a):i.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map);e.alphaMap&&(t.alphaMap.value=e.alphaMap);e.alphaTest>0&&(t.alphaTest.value=e.alphaTest);var n;e.map?n=e.map:e.alphaMap&&(n=e.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}(t,i):i.isShadowMaterial?(t.color.value.copy(i.color),t.opacity.value=i.opacity):i.isShaderMaterial&&(i.uniformsNeedUpdate=!1)}}}function go(t,e,n,i){var r={},a={},o=[],s=n.isWebGL2?t.getParameter(35375):0;function l(t,e,n){var i=t.value;if(void 0===n[e])return n[e]="number"===typeof i?i:i.clone(),!0;if("number"===typeof i){if(n[e]!==i)return n[e]=i,!0}else{var r=n[e];if(!1===r.equals(i))return r.copy(i),!0}return!1}function u(t){var e=t.value,n={boundary:0,storage:0};return"number"===typeof e?(n.boundary=4,n.storage=4):e.isVector2?(n.boundary=8,n.storage=8):e.isVector3||e.isColor?(n.boundary=16,n.storage=12):e.isVector4?(n.boundary=16,n.storage=16):e.isMatrix3?(n.boundary=48,n.storage=48):e.isMatrix4?(n.boundary=64,n.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),n}function h(e){var n=e.target;n.removeEventListener("dispose",h);var i=o.indexOf(n.__bindingPointIndex);o.splice(i,1),t.deleteBuffer(r[n.id]),delete r[n.id],delete a[n.id]}return{bind:function(t,e){var n=e.program;i.uniformBlockBinding(t,n)},update:function(n,c){var d=r[n.id];void 0===d&&(!function(t){for(var e=t.uniforms,n=0,i=16,r=0,a=0,o=e.length;a<o;a++){var s=e[a],l=u(s);if(s.__data=new Float32Array(l.storage/Float32Array.BYTES_PER_ELEMENT),s.__offset=n,a>0)0!==(r=n%i)&&i-r-l.boundary<0&&(n+=i-r,s.__offset=n);n+=l.storage}(r=n%i)>0&&(n+=i-r);t.__size=n,t.__cache={}}(n),d=function(e){var n=function(){for(var t=0;t<s;t++)if(-1===o.indexOf(t))return o.push(t),t;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();e.__bindingPointIndex=n;var i=t.createBuffer(),r=e.__size,a=e.usage;return t.bindBuffer(35345,i),t.bufferData(35345,r,a),t.bindBuffer(35345,null),t.bindBufferBase(35345,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",h));var f=c.program;i.updateUBOMapping(n,f);var p=e.render.frame;a[n.id]!==p&&(!function(e){var n=r[e.id],i=e.uniforms,a=e.__cache;t.bindBuffer(35345,n);for(var o=0,s=i.length;o<s;o++){var u=i[o];if(!0===l(u,o,a)){var h=u.value,c=u.__offset;"number"===typeof h?(u.__data[0]=h,t.bufferSubData(35345,c,u.__data)):(u.value.isMatrix3?(u.__data[0]=u.value.elements[0],u.__data[1]=u.value.elements[1],u.__data[2]=u.value.elements[2],u.__data[3]=u.value.elements[0],u.__data[4]=u.value.elements[3],u.__data[5]=u.value.elements[4],u.__data[6]=u.value.elements[5],u.__data[7]=u.value.elements[0],u.__data[8]=u.value.elements[6],u.__data[9]=u.value.elements[7],u.__data[10]=u.value.elements[8],u.__data[11]=u.value.elements[0]):h.toArray(u.__data),t.bufferSubData(35345,c,u.__data))}}t.bindBuffer(35345,null)}(n),a[n.id]=p)},dispose:function(){for(var e in r)t.deleteBuffer(r[e]);o=[],r={},a={}}}}function yo(){var t=ie("canvas");return t.style.display="block",t}function _o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isWebGLRenderer=!0;var e,n=void 0!==t.canvas?t.canvas:yo(),i=void 0!==t.context?t.context:null,r=void 0===t.depth||t.depth,a=void 0===t.stencil||t.stencil,o=void 0!==t.antialias&&t.antialias,s=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,u=void 0!==t.powerPreference?t.powerPreference:"default",h=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;e=null!==i?i.getContextAttributes().alpha:void 0!==t.alpha&&t.alpha;var c=null,d=null,f=[],p=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Rt,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});var v=this,m=!1,g=0,y=0,_=null,x=-1,b=null,w=new be,S=new be,T=null,M=n.width,E=n.height,P=1,C=null,k=null,R=new be(0,0,M,E),I=new be(0,0,M,E),D=!1,O=new Gi,L=!1,N=!1,F=null,B=new rn,U=new te,G=new Ee,z={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function j(){return null===_?P:1}var X,Y,K,J,Q,$,tt,et,nt,it,rt,at,ot,st,lt,ut,ht,ct,dt,ft,pt,vt,mt,gt,yt=i;function _t(t,e){for(var i=0;i<t.length;i++){var r=t[i],a=n.getContext(r,e);if(null!==a)return a}return null}try{var xt={alpha:!0,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine","three.js r".concat(A)),n.addEventListener("webglcontextlost",Tt,!1),n.addEventListener("webglcontextrestored",Mt,!1),n.addEventListener("webglcontextcreationerror",Et,!1),null===yt){var bt=["webgl2","webgl","experimental-webgl"];if(!0===v.isWebGL1Renderer&&bt.shift(),null===(yt=_t(bt,xt)))throw _t(bt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===yt.getShaderPrecisionFormat&&(yt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Wt){throw console.error("THREE.WebGLRenderer: "+Wt.message),Wt}function wt(){X=new pr(yt),Y=new Zi(yt,X,t),X.init(Y),vt=new lo(yt,X,Y),K=new oo(yt,X,Y),J=new gr,Q=new Wa,$=new so(yt,X,K,Q,Y,vt,J),tt=new Qi(v),et=new fr(v),nt=new Hi(yt,Y),mt=new Yi(yt,X,nt,Y),it=new vr(yt,nt,J,mt),rt=new br(yt,it,nt,J),dt=new xr(yt,Y,$),ut=new Ji(Q),at=new Xa(v,tt,et,X,Y,mt,ut),ot=new mo(v,Q),st=new Za,lt=new no(X,Y),ct=new qi(v,tt,K,rt,e,s),ht=new ao(v,rt,Y),gt=new go(yt,J,Y,K),ft=new Ki(yt,X,J,Y),pt=new mr(yt,X,J,Y),J.programs=at.programs,v.capabilities=Y,v.extensions=X,v.properties=Q,v.renderLists=st,v.shadowMap=ht,v.state=K,v.info=J}wt();var St=new vo(v,yt);function Tt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Mt(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;var t=J.autoReset,e=ht.enabled,n=ht.autoUpdate,i=ht.needsUpdate,r=ht.type;wt(),J.autoReset=t,ht.enabled=e,ht.autoUpdate=n,ht.needsUpdate=i,ht.type=r}function Et(t){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",t.statusMessage)}function At(t){var e=t.target;e.removeEventListener("dispose",At),Pt(e)}function Pt(t){Ct(t),Q.remove(t)}function Ct(t){var e=Q.get(t).programs;void 0!==e&&(e.forEach((function(t){at.releaseProgram(t)})),t.isShaderMaterial&&at.releaseShaderCache(t))}this.xr=St,this.getContext=function(){return yt},this.getContextAttributes=function(){return yt.getContextAttributes()},this.forceContextLoss=function(){var t=X.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=X.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(t){void 0!==t&&(P=t,this.setSize(M,E,!1))},this.getSize=function(t){return t.set(M,E)},this.setSize=function(t,e,i){St.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(M=t,E=e,n.width=Math.floor(t*P),n.height=Math.floor(e*P),!1!==i&&(n.style.width=t+"px",n.style.height=e+"px"),this.setViewport(0,0,t,e))},this.getDrawingBufferSize=function(t){return t.set(M*P,E*P).floor()},this.setDrawingBufferSize=function(t,e,i){M=t,E=e,P=i,n.width=Math.floor(t*i),n.height=Math.floor(e*i),this.setViewport(0,0,t,e)},this.getCurrentViewport=function(t){return t.copy(w)},this.getViewport=function(t){return t.copy(R)},this.setViewport=function(t,e,n,i){t.isVector4?R.set(t.x,t.y,t.z,t.w):R.set(t,e,n,i),K.viewport(w.copy(R).multiplyScalar(P).floor())},this.getScissor=function(t){return t.copy(I)},this.setScissor=function(t,e,n,i){t.isVector4?I.set(t.x,t.y,t.z,t.w):I.set(t,e,n,i),K.scissor(S.copy(I).multiplyScalar(P).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(t){K.setScissorTest(D=t)},this.setOpaqueSort=function(t){C=t},this.setTransparentSort=function(t){k=t},this.getClearColor=function(t){return t.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=0;t&&(i|=16384),e&&(i|=256),n&&(i|=1024),yt.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Tt,!1),n.removeEventListener("webglcontextrestored",Mt,!1),n.removeEventListener("webglcontextcreationerror",Et,!1),st.dispose(),lt.dispose(),Q.dispose(),tt.dispose(),et.dispose(),rt.dispose(),mt.dispose(),gt.dispose(),at.dispose(),St.dispose(),St.removeEventListener("sessionstart",Dt),St.removeEventListener("sessionend",Ot),F&&(F.dispose(),F=null),Lt.stop()},this.renderBufferDirect=function(t,e,n,i,r,a){null===e&&(e=z);var o=r.isMesh&&r.matrixWorld.determinant()<0,s=Vt(t,e,n,i,r);K.setMaterial(i,o);var l=n.index,u=n.attributes.position;if(null===l){if(void 0===u||0===u.count)return}else if(0===l.count)return;var h,c=1;!0===i.wireframe&&(l=it.getWireframeAttribute(n),c=2),mt.setup(r,i,s,n,l);var d=ft;null!==l&&(h=nt.get(l),(d=pt).setIndex(h));var f=null!==l?l.count:u.count,p=n.drawRange.start*c,v=n.drawRange.count*c,m=null!==a?a.start*c:0,g=null!==a?a.count*c:1/0,y=Math.max(p,m),_=Math.min(f,p+v,m+g)-1,x=Math.max(0,_-y+1);if(0!==x){if(r.isMesh)!0===i.wireframe?(K.setLineWidth(i.wireframeLinewidth*j()),d.setMode(1)):d.setMode(4);else if(r.isLine){var b=i.linewidth;void 0===b&&(b=1),K.setLineWidth(b*j()),r.isLineSegments?d.setMode(1):r.isLineLoop?d.setMode(2):d.setMode(3)}else r.isPoints?d.setMode(0):r.isSprite&&d.setMode(4);if(r.isInstancedMesh)d.renderInstances(y,x,r.count);else if(n.isInstancedBufferGeometry){var w=Math.min(n.instanceCount,n._maxInstanceCount);d.renderInstances(y,x,w)}else d.render(y,x)}},this.compile=function(t,e){function n(t,e,n){!0===t.transparent&&2===t.side?(t.side=1,t.needsUpdate=!0,zt(t,e,n),t.side=0,t.needsUpdate=!0,zt(t,e,n),t.side=2):zt(t,e,n)}(d=lt.get(t)).init(),p.push(d),t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(v.physicallyCorrectLights),t.traverse((function(e){var i=e.material;if(i)if(Array.isArray(i))for(var r=0;r<i.length;r++){n(i[r],t,e)}else n(i,t,e)})),p.pop(),d=null};var kt=null;function It(t){kt&&kt(t)}function Dt(){Lt.stop()}function Ot(){Lt.start()}var Lt=new zi;function Nt(t,e,n,i){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||O.intersectsSprite(t)){i&&G.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);var r=rt.update(t),a=t.material;a.visible&&c.push(t,r,a,n,G.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==J.render.frame&&(t.skeleton.update(),t.skeleton.frame=J.render.frame),!t.frustumCulled||O.intersectsObject(t))){i&&G.setFromMatrixPosition(t.matrixWorld).applyMatrix4(B);var o=rt.update(t),s=t.material;if(Array.isArray(s))for(var l=o.groups,u=0,h=l.length;u<h;u++){var f=l[u],p=s[f.materialIndex];p&&p.visible&&c.push(t,o,p,n,G.z,f)}else s.visible&&c.push(t,o,s,n,G.z,null)}for(var v=t.children,m=0,g=v.length;m<g;m++)Nt(v[m],e,n,i)}}function Ft(t,e,n,i){var r=t.opaque,a=t.transmissive,o=t.transparent;d.setupLightsView(n),a.length>0&&Bt(r,e,n),i&&K.viewport(w.copy(i)),r.length>0&&Ut(r,e,n),a.length>0&&Ut(a,e,n),o.length>0&&Ut(o,e,n),K.buffers.depth.setTest(!0),K.buffers.depth.setMask(!0),K.buffers.color.setMask(!0),K.setPolygonOffset(!1)}function Bt(t,e,n){var i=Y.isWebGL2;null===F&&(F=new we(1,1,{generateMipmaps:!0,type:X.has("EXT_color_buffer_half_float")?q:V,minFilter:H,samples:i&&!0===o?4:0})),v.getDrawingBufferSize(U),i?F.setSize(U.x,U.y):F.setSize(Zt(U.x),Zt(U.y));var r=v.getRenderTarget();v.setRenderTarget(F),v.clear();var a=v.toneMapping;v.toneMapping=0,Ut(t,e,n),v.toneMapping=a,$.updateMultisampleRenderTarget(F),$.updateRenderTargetMipmap(F),v.setRenderTarget(r)}function Ut(t,e,n){for(var i=!0===e.isScene?e.overrideMaterial:null,r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,l=o.geometry,u=null===i?o.material:i,h=o.group;s.layers.test(n.layers)&&Gt(s,e,n,l,u,h)}}function Gt(t,e,n,i,r,a){t.onBeforeRender(v,e,n,i,r,a),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(v,e,n,i,t,a),!0===r.transparent&&2===r.side?(r.side=1,r.needsUpdate=!0,v.renderBufferDirect(n,e,i,r,t,a),r.side=0,r.needsUpdate=!0,v.renderBufferDirect(n,e,i,r,t,a),r.side=2):v.renderBufferDirect(n,e,i,r,t,a),t.onAfterRender(v,e,n,i,r,a)}function zt(t,e,n){!0!==e.isScene&&(e=z);var i=Q.get(t),r=d.state.lights,a=d.state.shadowsArray,o=r.state.version,s=at.getParameters(t,r.state,a,e,n),l=at.getProgramCacheKey(s),u=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?et:tt).get(t.envMap||i.environment),void 0===u&&(t.addEventListener("dispose",At),u=new Map,i.programs=u);var h=u.get(l);if(void 0!==h){if(i.currentProgram===h&&i.lightsStateVersion===o)return Ht(t,s),h}else s.uniforms=at.getUniforms(t),t.onBuild(n,s,v),t.onBeforeCompile(s,v),h=at.acquireProgram(s,l),u.set(l,h),i.uniforms=s.uniforms;var c=i.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(c.clippingPlanes=ut.uniform),Ht(t,s),i.needsLights=Xt(t),i.lightsStateVersion=o,i.needsLights&&(c.ambientLightColor.value=r.state.ambient,c.lightProbe.value=r.state.probe,c.directionalLights.value=r.state.directional,c.directionalLightShadows.value=r.state.directionalShadow,c.spotLights.value=r.state.spot,c.spotLightShadows.value=r.state.spotShadow,c.rectAreaLights.value=r.state.rectArea,c.ltc_1.value=r.state.rectAreaLTC1,c.ltc_2.value=r.state.rectAreaLTC2,c.pointLights.value=r.state.point,c.pointLightShadows.value=r.state.pointShadow,c.hemisphereLights.value=r.state.hemi,c.directionalShadowMap.value=r.state.directionalShadowMap,c.directionalShadowMatrix.value=r.state.directionalShadowMatrix,c.spotShadowMap.value=r.state.spotShadowMap,c.spotLightMatrix.value=r.state.spotLightMatrix,c.spotLightMap.value=r.state.spotLightMap,c.pointShadowMap.value=r.state.pointShadowMap,c.pointShadowMatrix.value=r.state.pointShadowMatrix);var f=h.getUniforms(),p=Ma.seqWithValue(f.seq,c);return i.currentProgram=h,i.uniformsList=p,h}function Ht(t,e){var n=Q.get(t);n.outputEncoding=e.outputEncoding,n.instancing=e.instancing,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}function Vt(t,e,n,i,r){!0!==e.isScene&&(e=z),$.resetTextureUnits();var a=e.fog,o=i.isMeshStandardMaterial?e.environment:null,s=null===_?v.outputEncoding:!0===_.isXRRenderTarget?_.texture.encoding:Rt,l=(i.isMeshStandardMaterial?et:tt).get(i.envMap||o),u=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,h=!!i.normalMap&&!!n.attributes.tangent,c=!!n.morphAttributes.position,f=!!n.morphAttributes.normal,p=!!n.morphAttributes.color,m=i.toneMapped?v.toneMapping:0,g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,y=void 0!==g?g.length:0,w=Q.get(i),S=d.state.lights;if(!0===L&&(!0===N||t!==b)){var T=t===b&&i.id===x;ut.setState(i,t,T)}var M=!1;i.version===w.__version?w.needsLights&&w.lightsStateVersion!==S.state.version||w.outputEncoding!==s||r.isInstancedMesh&&!1===w.instancing?M=!0:r.isInstancedMesh||!0!==w.instancing?r.isSkinnedMesh&&!1===w.skinning?M=!0:r.isSkinnedMesh||!0!==w.skinning?w.envMap!==l||!0===i.fog&&w.fog!==a?M=!0:void 0===w.numClippingPlanes||w.numClippingPlanes===ut.numPlanes&&w.numIntersection===ut.numIntersection?(w.vertexAlphas!==u||w.vertexTangents!==h||w.morphTargets!==c||w.morphNormals!==f||w.morphColors!==p||w.toneMapping!==m||!0===Y.isWebGL2&&w.morphTargetsCount!==y)&&(M=!0):M=!0:M=!0:M=!0:(M=!0,w.__version=i.version);var A=w.currentProgram;!0===M&&(A=zt(i,e,r));var C=!1,k=!1,R=!1,I=A.getUniforms(),D=w.uniforms;if(K.useProgram(A.program)&&(C=!0,k=!0,R=!0),i.id!==x&&(x=i.id,k=!0),C||b!==t){if(I.setValue(yt,"projectionMatrix",t.projectionMatrix),Y.logarithmicDepthBuffer&&I.setValue(yt,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),b!==t&&(b=t,k=!0,R=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshStandardMaterial||i.envMap){var O=I.map.cameraPosition;void 0!==O&&O.setValue(yt,G.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&I.setValue(yt,"isOrthographic",!0===t.isOrthographicCamera),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.isShadowMaterial||r.isSkinnedMesh)&&I.setValue(yt,"viewMatrix",t.matrixWorldInverse)}if(r.isSkinnedMesh){I.setOptional(yt,r,"bindMatrix"),I.setOptional(yt,r,"bindMatrixInverse");var B=r.skeleton;B&&(Y.floatVertexTextures?(null===B.boneTexture&&B.computeBoneTexture(),I.setValue(yt,"boneTexture",B.boneTexture,$),I.setValue(yt,"boneTextureSize",B.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}var U=n.morphAttributes;if((void 0!==U.position||void 0!==U.normal||void 0!==U.color&&!0===Y.isWebGL2)&&dt.update(r,n,i,A),(k||w.receiveShadow!==r.receiveShadow)&&(w.receiveShadow=r.receiveShadow,I.setValue(yt,"receiveShadow",r.receiveShadow)),i.isMeshGouraudMaterial&&null!==i.envMap&&(D.envMap.value=l,D.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),k&&(I.setValue(yt,"toneMappingExposure",v.toneMappingExposure),w.needsLights&&jt(D,R),a&&!0===i.fog&&ot.refreshFogUniforms(D,a),ot.refreshMaterialUniforms(D,i,P,E,F),Ma.upload(yt,w.uniformsList,D,$)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Ma.upload(yt,w.uniformsList,D,$),i.uniformsNeedUpdate=!1),i.isSpriteMaterial&&I.setValue(yt,"center",r.center),I.setValue(yt,"modelViewMatrix",r.modelViewMatrix),I.setValue(yt,"normalMatrix",r.normalMatrix),I.setValue(yt,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial)for(var H=i.uniformsGroups,V=0,j=H.length;V<j;V++)if(Y.isWebGL2){var X=H[V];gt.update(X,A),gt.bind(X,A)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return A}function jt(t,e){t.ambientLightColor.needsUpdate=e,t.lightProbe.needsUpdate=e,t.directionalLights.needsUpdate=e,t.directionalLightShadows.needsUpdate=e,t.pointLights.needsUpdate=e,t.pointLightShadows.needsUpdate=e,t.spotLights.needsUpdate=e,t.spotLightShadows.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function Xt(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}Lt.setAnimationLoop(It),"undefined"!==typeof self&&Lt.setContext(self),this.setAnimationLoop=function(t){kt=t,St.setAnimationLoop(t),null===t?Lt.stop():Lt.start()},St.addEventListener("sessionstart",Dt),St.addEventListener("sessionend",Ot),this.render=function(t,e){if(void 0===e||!0===e.isCamera){if(!0!==m){!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===St.enabled&&!0===St.isPresenting&&(!0===St.cameraAutoUpdate&&St.updateCamera(e),e=St.getCamera()),!0===t.isScene&&t.onBeforeRender(v,t,e,_),(d=lt.get(t,p.length)).init(),p.push(d),B.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),O.setFromProjectionMatrix(B),N=this.localClippingEnabled,L=ut.init(this.clippingPlanes,N,e),(c=st.get(t,f.length)).init(),f.push(c),Nt(t,e,0,v.sortObjects),c.finish(),!0===v.sortObjects&&c.sort(C,k),!0===L&&ut.beginShadows();var n=d.state.shadowsArray;if(ht.render(n,t,e),!0===L&&ut.endShadows(),!0===this.info.autoReset&&this.info.reset(),ct.render(c,t),d.setupLights(v.physicallyCorrectLights),e.isArrayCamera)for(var i=e.cameras,r=0,a=i.length;r<a;r++){var o=i[r];Ft(c,t,o,o.viewport)}else Ft(c,t,e);null!==_&&($.updateMultisampleRenderTarget(_),$.updateRenderTargetMipmap(_)),!0===t.isScene&&t.onAfterRender(v,t,e),mt.resetDefaultState(),x=-1,b=null,p.pop(),d=p.length>0?p[p.length-1]:null,f.pop(),c=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(t,e,n){Q.get(t.texture).__webglTexture=e,Q.get(t.depthTexture).__webglTexture=n;var i=Q.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===X.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){var n=Q.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;_=t,g=e,y=n;var i=!0;if(t){var r=Q.get(t);void 0!==r.__useDefaultFramebuffer?(K.bindFramebuffer(36160,null),i=!1):void 0===r.__webglFramebuffer?$.setupRenderTarget(t):r.__hasExternalTextures&&$.rebindTextures(t,Q.get(t.texture).__webglTexture,Q.get(t.depthTexture).__webglTexture)}var a=null,o=!1,s=!1;if(t){var l=t.texture;(l.isData3DTexture||l.isDataArrayTexture)&&(s=!0);var u=Q.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(a=u[e],o=!0):a=Y.isWebGL2&&t.samples>0&&!1===$.useMultisampledRTT(t)?Q.get(t).__webglMultisampledFramebuffer:u,w.copy(t.viewport),S.copy(t.scissor),T=t.scissorTest}else w.copy(R).multiplyScalar(P).floor(),S.copy(I).multiplyScalar(P).floor(),T=D;var h=K.bindFramebuffer(36160,a);if(h&&Y.drawBuffers&&i&&K.drawBuffers(t,a),K.viewport(w),K.scissor(S),K.setScissorTest(T),o){var c=Q.get(t.texture);yt.framebufferTexture2D(36160,36064,34069+e,c.__webglTexture,n)}else if(s){var d=Q.get(t.texture),f=e||0;yt.framebufferTextureLayer(36160,36064,d.__webglTexture,n||0,f)}x=-1},this.readRenderTargetPixels=function(t,e,n,i,r,a,o){if(t&&t.isWebGLRenderTarget){var s=Q.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){K.bindFramebuffer(36160,s);try{var l=t.texture,u=l.format,h=l.type;if(u!==Z&&vt.convert(u)!==yt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var c=h===q&&(X.has("EXT_color_buffer_half_float")||Y.isWebGL2&&X.has("EXT_color_buffer_float"));if(h!==V&&vt.convert(h)!==yt.getParameter(35738)&&(h!==W||!(Y.isWebGL2||X.has("OES_texture_float")||X.has("WEBGL_color_buffer_float")))&&!c)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&yt.readPixels(e,n,i,r,vt.convert(u),vt.convert(h),a)}finally{var d=null!==_?Q.get(_).__webglFramebuffer:null;K.bindFramebuffer(36160,d)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Math.pow(2,-n),r=Math.floor(e.image.width*i),a=Math.floor(e.image.height*i);$.setTexture2D(e,0),yt.copyTexSubImage2D(3553,n,0,0,t.x,t.y,r,a),K.unbindTexture()},this.copyTextureToTexture=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=e.image.width,a=e.image.height,o=vt.convert(n.format),s=vt.convert(n.type);$.setTexture2D(n,0),yt.pixelStorei(37440,n.flipY),yt.pixelStorei(37441,n.premultiplyAlpha),yt.pixelStorei(3317,n.unpackAlignment),e.isDataTexture?yt.texSubImage2D(3553,i,t.x,t.y,r,a,o,s,e.image.data):e.isCompressedTexture?yt.compressedTexSubImage2D(3553,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,o,e.mipmaps[0].data):yt.texSubImage2D(3553,i,t.x,t.y,o,s,e.image),0===i&&n.generateMipmaps&&yt.generateMipmap(3553),K.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(v.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var a,o=t.max.x-t.min.x+1,s=t.max.y-t.min.y+1,l=t.max.z-t.min.z+1,u=vt.convert(i.format),h=vt.convert(i.type);if(i.isData3DTexture)$.setTexture3D(i,0),a=32879;else{if(!i.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");$.setTexture2DArray(i,0),a=35866}yt.pixelStorei(37440,i.flipY),yt.pixelStorei(37441,i.premultiplyAlpha),yt.pixelStorei(3317,i.unpackAlignment);var c=yt.getParameter(3314),d=yt.getParameter(32878),f=yt.getParameter(3316),p=yt.getParameter(3315),m=yt.getParameter(32877),g=n.isCompressedTexture?n.mipmaps[0]:n.image;yt.pixelStorei(3314,g.width),yt.pixelStorei(32878,g.height),yt.pixelStorei(3316,t.min.x),yt.pixelStorei(3315,t.min.y),yt.pixelStorei(32877,t.min.z),n.isDataTexture||n.isData3DTexture?yt.texSubImage3D(a,r,e.x,e.y,e.z,o,s,l,u,h,g.data):n.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),yt.compressedTexSubImage3D(a,r,e.x,e.y,e.z,o,s,l,u,g.data)):yt.texSubImage3D(a,r,e.x,e.y,e.z,o,s,l,u,h,g),yt.pixelStorei(3314,c),yt.pixelStorei(32878,d),yt.pixelStorei(3316,f),yt.pixelStorei(3315,p),yt.pixelStorei(32877,m),0===r&&i.generateMipmaps&&yt.generateMipmap(a),K.unbindTexture()}},this.initTexture=function(t){t.isCubeTexture?$.setTextureCube(t,0):t.isData3DTexture?$.setTexture3D(t,0):t.isDataArrayTexture?$.setTexture2DArray(t,0):$.setTexture2D(t,0),K.unbindTexture()},this.resetState=function(){g=0,y=0,_=null,K.reset(),mt.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var xo=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(_o);xo.prototype.isWebGL1Renderer=!0;var bo=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isScene=!0,t.type="Scene",t.background=null,t.environment=null,t.fog=null,t.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:h(t)})),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}},{key:"toJSON",value:function(t){var e=M(f(n.prototype),"toJSON",this).call(this,t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}},{key:"autoUpdate",get:function(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate},set:function(t){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=t}}]),n}(Cn),wo=function(){function t(e,n){a(this,t),this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=void 0!==e?e.length/n:0,this.usage=Nt,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=jt()}return s(t,[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"setUsage",value:function(t){return this.usage=t,this}},{key:"copy",value:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}},{key:"copyAt",value:function(t,e,n){t*=this.stride,n*=e.stride;for(var i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}},{key:"set",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(t,e),this}},{key:"clone",value:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}},{key:"onUpload",value:function(t){return this.onUploadCallback=t,this}},{key:"toJSON",value:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=jt()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}]),t}(),So=new Ee,To=function(){function t(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];a(this,t),this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=!0===r}return s(t,[{key:"count",get:function(){return this.data.count}},{key:"array",get:function(){return this.data.array}},{key:"needsUpdate",set:function(t){this.data.needsUpdate=t}},{key:"applyMatrix4",value:function(t){for(var e=0,n=this.data.count;e<n;e++)So.fromBufferAttribute(this,e),So.applyMatrix4(t),this.setXYZ(e,So.x,So.y,So.z);return this}},{key:"applyNormalMatrix",value:function(t){for(var e=0,n=this.count;e<n;e++)So.fromBufferAttribute(this,e),So.applyNormalMatrix(t),this.setXYZ(e,So.x,So.y,So.z);return this}},{key:"transformDirection",value:function(t){for(var e=0,n=this.count;e<n;e++)So.fromBufferAttribute(this,e),So.transformDirection(t),this.setXYZ(e,So.x,So.y,So.z);return this}},{key:"setX",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}},{key:"setY",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}},{key:"setZ",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}},{key:"setW",value:function(t,e){return this.normalized&&(e=Qt(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}},{key:"getX",value:function(t){var e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"getY",value:function(t){var e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"getZ",value:function(t){var e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"getW",value:function(t){var e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Jt(e,this.array)),e}},{key:"setXY",value:function(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}},{key:"setXYZ",value:function(t,e,n,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array),i=Qt(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}},{key:"setXYZW",value:function(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=Qt(e,this.array),n=Qt(n,this.array),i=Qt(i,this.array),r=Qt(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}},{key:"clone",value:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will deinterleave buffer data.");for(var n=[],i=0;i<this.count;i++)for(var r=i*this.data.stride+this.offset,a=0;a<this.itemSize;a++)n.push(this.data.array[r+a]);return new Wn(new this.array.constructor(n),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new t(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}},{key:"toJSON",value:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will deinterleave buffer data.");for(var e=[],n=0;n<this.count;n++)for(var i=n*this.data.stride+this.offset,r=0;r<this.itemSize;r++)e.push(this.data.array[i+r]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}]),t}();var Mo=new Ee,Eo=new be,Ao=new be,Po=new Ee,Co=new rn,ko=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t,i)).isSkinnedMesh=!0,r.type="SkinnedMesh",r.bindMode="attached",r.bindMatrix=new rn,r.bindMatrixInverse=new rn,r}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}},{key:"bind",value:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()}},{key:"pose",value:function(){this.skeleton.pose()}},{key:"normalizeSkinWeights",value:function(){for(var t=new be,e=this.geometry.attributes.skinWeight,n=0,i=e.count;n<i;n++){t.fromBufferAttribute(e,n);var r=1/t.manhattanLength();r!==1/0?t.multiplyScalar(r):t.set(1,0,0,0),e.setXYZW(n,t.x,t.y,t.z,t.w)}}},{key:"updateMatrixWorld",value:function(t){M(f(n.prototype),"updateMatrixWorld",this).call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}},{key:"boneTransform",value:function(t,e){var n=this.skeleton,i=this.geometry;Eo.fromBufferAttribute(i.attributes.skinIndex,t),Ao.fromBufferAttribute(i.attributes.skinWeight,t),Mo.copy(e).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(var r=0;r<4;r++){var a=Ao.getComponent(r);if(0!==a){var o=Eo.getComponent(r);Co.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),e.addScaledVector(Po.copy(Mo).applyMatrix4(Co),a)}}return e.applyMatrix4(this.bindMatrixInverse)}}]),n}(bi),Ro=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).isBone=!0,t.type="Bone",t}return s(n)}(Cn),Io=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0,h=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:F,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:F,p=arguments.length>10?arguments[10]:void 0,v=arguments.length>11?arguments[11]:void 0;return a(this,n),(t=e.call(this,null,u,h,c,d,f,s,l,p,v)).isDataTexture=!0,t.image={data:i,width:r,height:o},t.generateMipmaps=!1,t.flipY=!1,t.unpackAlignment=1,t}return s(n)}(xe),Do=new rn,Oo=new rn,Lo=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,t),this.uuid=jt(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return s(t,[{key:"init",value:function(){var t=this.bones,e=this.boneInverses;if(this.boneMatrices=new Float32Array(16*t.length),0===e.length)this.calculateInverses();else if(t.length!==e.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new rn)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var t=0,e=this.bones.length;t<e;t++){var n=new rn;this.bones[t]&&n.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var t=0,e=this.bones.length;t<e;t++){var n=this.bones[t];n&&n.matrixWorld.copy(this.boneInverses[t]).invert()}for(var i=0,r=this.bones.length;i<r;i++){var a=this.bones[i];a&&(a.parent&&a.parent.isBone?(a.matrix.copy(a.parent.matrixWorld).invert(),a.matrix.multiply(a.matrixWorld)):a.matrix.copy(a.matrixWorld),a.matrix.decompose(a.position,a.quaternion,a.scale))}}},{key:"update",value:function(){for(var t=this.bones,e=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,a=t.length;r<a;r++){var o=t[r]?t[r].matrixWorld:Oo;Do.multiplyMatrices(o,e[r]),Do.toArray(n,16*r)}null!==i&&(i.needsUpdate=!0)}},{key:"clone",value:function(){return new t(this.bones,this.boneInverses)}},{key:"computeBoneTexture",value:function(){var t=Math.sqrt(4*this.bones.length);t=Kt(t),t=Math.max(t,4);var e=new Float32Array(t*t*4);e.set(this.boneMatrices);var n=new Io(e,t,t,Z,W);return n.needsUpdate=!0,this.boneMatrices=e,this.boneTexture=n,this.boneTextureSize=t,this}},{key:"getBoneByName",value:function(t){for(var e=0,n=this.bones.length;e<n;e++){var i=this.bones[e];if(i.name===t)return i}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(t,e){this.uuid=t.uuid;for(var n=0,i=t.bones.length;n<i;n++){var r=t.bones[n],a=e[r];void 0===a&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),a=new Ro),this.bones.push(a),this.boneInverses.push((new rn).fromArray(t.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;for(var e=this.bones,n=this.boneInverses,i=0,r=e.length;i<r;i++){var a=e[i];t.bones.push(a.uuid);var o=n[i];t.boneInverses.push(o.toArray())}return t}}]),t}(),No=function(t){d(n,t);var e=m(n);function n(t,i,r){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a(this,n),(o=e.call(this,t,i,r)).isInstancedBufferAttribute=!0,o.meshPerAttribute=s,o}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}]),n}(Wn),Fo=new rn,Bo=new rn,Uo=[],Go=new bi,zo=function(t){d(n,t);var e=m(n);function n(t,i,r){var o;return a(this,n),(o=e.call(this,t,i)).isInstancedMesh=!0,o.instanceMatrix=new No(new Float32Array(16*r),16),o.instanceColor=null,o.count=r,o.frustumCulled=!1,o}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.instanceMatrix.copy(t.instanceMatrix),null!==t.instanceColor&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}},{key:"getColorAt",value:function(t,e){e.fromArray(this.instanceColor.array,3*t)}},{key:"getMatrixAt",value:function(t,e){e.fromArray(this.instanceMatrix.array,16*t)}},{key:"raycast",value:function(t,e){var n=this.matrixWorld,i=this.count;if(Go.geometry=this.geometry,Go.material=this.material,void 0!==Go.material)for(var r=0;r<i;r++){this.getMatrixAt(r,Fo),Bo.multiplyMatrices(n,Fo),Go.matrixWorld=Bo,Go.raycast(t,Uo);for(var a=0,o=Uo.length;a<o;a++){var s=Uo[a];s.instanceId=r,s.object=this,e.push(s)}Uo.length=0}}},{key:"setColorAt",value:function(t,e){null===this.instanceColor&&(this.instanceColor=new No(new Float32Array(3*this.instanceMatrix.count),3)),e.toArray(this.instanceColor.array,3*t)}},{key:"setMatrixAt",value:function(t,e){e.toArray(this.instanceMatrix.array,16*t)}},{key:"updateMorphTargets",value:function(){}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(bi),Ho=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isLineBasicMaterial=!0,i.type="LineBasicMaterial",i.color=new ve(16777215),i.linewidth=1,i.linecap="round",i.linejoin="round",i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}]),n}(Hn),Vo=new Ee,jo=new Ee,Xo=new rn,Wo=new nn,qo=new Ye,Yo=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ii,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ho;return a(this,n),(t=e.call(this)).isLine=!0,t.type="Line",t.geometry=i,t.material=r,t.updateMorphTargets(),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.material=t.material,this.geometry=t.geometry,this}},{key:"computeLineDistances",value:function(){var t=this.geometry;if(null===t.index){for(var e=t.attributes.position,n=[0],i=1,r=e.count;i<r;i++)Vo.fromBufferAttribute(e,i-1),jo.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=Vo.distanceTo(jo);t.setAttribute("lineDistance",new Kn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),qo.copy(n.boundingSphere),qo.applyMatrix4(i),qo.radius+=r,!1!==t.ray.intersectsSphere(qo)){Xo.copy(i).invert(),Wo.copy(t.ray).applyMatrix4(Xo);var o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=new Ee,u=new Ee,h=new Ee,c=new Ee,d=this.isLineSegments?2:1,f=n.index,p=n.attributes.position;if(null!==f)for(var v=Math.max(0,a.start),m=Math.min(f.count,a.start+a.count)-1;v<m;v+=d){var g=f.getX(v),y=f.getX(v+1);if(l.fromBufferAttribute(p,g),u.fromBufferAttribute(p,y),!(Wo.distanceSqToSegment(l,u,c,h)>s)){c.applyMatrix4(this.matrixWorld);var _=t.ray.origin.distanceTo(c);_<t.near||_>t.far||e.push({distance:_,point:h.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,a.start),b=Math.min(p.count,a.start+a.count)-1;x<b;x+=d){if(l.fromBufferAttribute(p,x),u.fromBufferAttribute(p,x+1),!(Wo.distanceSqToSegment(l,u,c,h)>s)){c.applyMatrix4(this.matrixWorld);var w=t.ray.origin.distanceTo(c);w<t.near||w>t.far||e.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}}},{key:"updateMorphTargets",value:function(){var t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){var n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,r=n.length;i<r;i++){var a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}]),n}(Cn),Ko=new Ee,Zo=new Ee,Jo=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t,i)).isLineSegments=!0,r.type="LineSegments",r}return s(n,[{key:"computeLineDistances",value:function(){var t=this.geometry;if(null===t.index){for(var e=t.attributes.position,n=[],i=0,r=e.count;i<r;i+=2)Ko.fromBufferAttribute(e,i),Zo.fromBufferAttribute(e,i+1),n[i]=0===i?0:n[i-1],n[i+1]=n[i]+Ko.distanceTo(Zo);t.setAttribute("lineDistance",new Kn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}]),n}(Yo),Qo=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t,i)).isLineLoop=!0,r.type="LineLoop",r}return s(n)}(Yo),$o=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isPointsMaterial=!0,i.type="PointsMaterial",i.color=new ve(16777215),i.map=null,i.alphaMap=null,i.size=1,i.sizeAttenuation=!0,i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}]),n}(Hn),ts=new rn,es=new nn,ns=new Ye,is=new Ee,rs=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ii,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new $o;return a(this,n),(t=e.call(this)).isPoints=!0,t.type="Points",t.geometry=i,t.material=r,t.updateMorphTargets(),t}return s(n,[{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.material=t.material,this.geometry=t.geometry,this}},{key:"raycast",value:function(t,e){var n=this.geometry,i=this.matrixWorld,r=t.params.Points.threshold,a=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),ns.copy(n.boundingSphere),ns.applyMatrix4(i),ns.radius+=r,!1!==t.ray.intersectsSphere(ns)){ts.copy(i).invert(),es.copy(t.ray).applyMatrix4(ts);var o=r/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,l=n.index,u=n.attributes.position;if(null!==l)for(var h=Math.max(0,a.start),c=Math.min(l.count,a.start+a.count);h<c;h++){var d=l.getX(h);is.fromBufferAttribute(u,d),as(is,d,s,i,t,e,this)}else for(var f=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);f<p;f++)is.fromBufferAttribute(u,f),as(is,f,s,i,t,e,this)}}},{key:"updateMorphTargets",value:function(){var t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){var n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var i=0,r=n.length;i<r;i++){var a=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=i}}}}}]),n}(Cn);function as(t,e,n,i,r,a,o){var s=es.distanceSqToPoint(t);if(s<n){var l=new Ee;es.closestPointToPoint(t,l),l.applyMatrix4(i);var u=r.ray.origin.distanceTo(l);if(u<r.near||u>r.far)return;a.push({distance:u,distanceToRay:Math.sqrt(s),point:l,index:e,face:null,object:o})}}var os=function(){function t(){a(this,t),this.type="Curve",this.arcLengthDivisions=200}return s(t,[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)}},{key:"getPoints",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}},{key:"getSpacedPoints",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}},{key:"getLength",value:function(){var t=this.getLengths();return t[t.length-1]}},{key:"getLengths",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n=[],i=this.getPoint(0),r=0;n.push(0);for(var a=1;a<=t;a++)r+=(e=this.getPoint(a/t)).distanceTo(i),n.push(r),i=e;return this.cacheArcLengths=n,n}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(t,e){var n,i=this.getLengths(),r=0,a=i.length;n=e||t*i[a-1];for(var o,s=0,l=a-1;s<=l;)if((o=i[r=Math.floor(s+(l-s)/2)]-n)<0)s=r+1;else{if(!(o>0)){l=r;break}l=r-1}if(i[r=l]===n)return r/(a-1);var u=i[r];return(r+(n-u)/(i[r+1]-u))/(a-1)}},{key:"getTangent",value:function(t,e){var n=1e-4,i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);var a=this.getPoint(i),o=this.getPoint(r),s=e||(a.isVector2?new te:new Ee);return s.copy(o).sub(a).normalize(),s}},{key:"getTangentAt",value:function(t,e){var n=this.getUtoTmapping(t);return this.getTangent(n,e)}},{key:"computeFrenetFrames",value:function(t,e){for(var n=new Ee,i=[],r=[],a=[],o=new Ee,s=new rn,l=0;l<=t;l++){var u=l/t;i[l]=this.getTangentAt(u,new Ee)}r[0]=new Ee,a[0]=new Ee;var h=Number.MAX_VALUE,c=Math.abs(i[0].x),d=Math.abs(i[0].y),f=Math.abs(i[0].z);c<=h&&(h=c,n.set(1,0,0)),d<=h&&(h=d,n.set(0,1,0)),f<=h&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),a[0].crossVectors(i[0],r[0]);for(var p=1;p<=t;p++){if(r[p]=r[p-1].clone(),a[p]=a[p-1].clone(),o.crossVectors(i[p-1],i[p]),o.length()>Number.EPSILON){o.normalize();var v=Math.acos(Xt(i[p-1].dot(i[p]),-1,1));r[p].applyMatrix4(s.makeRotationAxis(o,v))}a[p].crossVectors(i[p],r[p])}if(!0===e){var m=Math.acos(Xt(r[0].dot(r[t]),-1,1));m/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(m=-m);for(var g=1;g<=t;g++)r[g].applyMatrix4(s.makeRotationAxis(i[g],m*g)),a[g].crossVectors(i[g],r[g])}return{tangents:i,normals:r,binormals:a}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},{key:"toJSON",value:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}},{key:"fromJSON",value:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}]),t}(),ss=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,h=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return a(this,n),(t=e.call(this)).isEllipseCurve=!0,t.type="EllipseCurve",t.aX=i,t.aY=r,t.xRadius=o,t.yRadius=s,t.aStartAngle=l,t.aEndAngle=u,t.aClockwise=h,t.aRotation=c,t}return s(n,[{key:"getPoint",value:function(t,e){for(var n=e||new te,i=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=a?0:i),!0!==this.aClockwise||a||(r===i?r=-i:r-=i);var o=this.aStartAngle+t*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),c=s-this.aX,d=l-this.aY;s=c*u-d*h+this.aX,l=c*h+d*u+this.aY}return n.set(s,l)}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}]),n}(os),ls=function(t){d(n,t);var e=m(n);function n(t,i,r,o,s,l){var u;return a(this,n),(u=e.call(this,t,i,r,r,o,s,l)).isArcCurve=!0,u.type="ArcCurve",u}return s(n)}(ss);function us(){var t=0,e=0,n=0,i=0;function r(r,a,o,s){t=r,e=o,n=-3*r+3*a-2*o-s,i=2*r-2*a+o+s}return{initCatmullRom:function(t,e,n,i,a){r(e,n,a*(n-t),a*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,a,o,s){var l=(e-t)/a-(n-t)/(a+o)+(n-e)/o,u=(n-e)/o-(i-e)/(o+s)+(i-n)/s;r(e,n,l*=o,u*=o)},calc:function(r){var a=r*r;return t+e*r+n*a+i*(a*r)}}}var hs=new Ee,cs=new us,ds=new us,fs=new us,ps=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return a(this,n),(t=e.call(this)).isCatmullRomCurve3=!0,t.type="CatmullRomCurve3",t.points=i,t.closed=r,t.curveType=o,t.tension=s,t}return s(n,[{key:"getPoint",value:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,r=i,a=this.points,o=a.length,s=(o-(this.closed?0:1))*t,l=Math.floor(s),u=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/o)+1)*o:0===u&&l===o-1&&(l=o-2,u=1),this.closed||l>0?e=a[(l-1)%o]:(hs.subVectors(a[0],a[1]).add(a[0]),e=hs);var h=a[l%o],c=a[(l+1)%o];if(this.closed||l+2<o?n=a[(l+2)%o]:(hs.subVectors(a[o-1],a[o-2]).add(a[o-1]),n=hs),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,f=Math.pow(e.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(c),d),v=Math.pow(c.distanceToSquared(n),d);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),cs.initNonuniformCatmullRom(e.x,h.x,c.x,n.x,f,p,v),ds.initNonuniformCatmullRom(e.y,h.y,c.y,n.y,f,p,v),fs.initNonuniformCatmullRom(e.z,h.z,c.z,n.z,f,p,v)}else"catmullrom"===this.curveType&&(cs.initCatmullRom(e.x,h.x,c.x,n.x,this.tension),ds.initCatmullRom(e.y,h.y,c.y,n.y,this.tension),fs.initCatmullRom(e.z,h.z,c.z,n.z,this.tension));return r.set(cs.calc(u),ds.calc(u),fs.calc(u)),r}},{key:"copy",value:function(t){M(f(n.prototype),"copy",this).call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}},{key:"fromJSON",value:function(t){M(f(n.prototype),"fromJSON",this).call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push((new Ee).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}]),n}(os);function vs(t,e,n,i,r){var a=.5*(i-e),o=.5*(r-n),s=t*t;return(2*n-2*i+a+o)*(t*s)+(-3*n+3*i-2*a-o)*s+a*t+n}function ms(t,e,n,i){return function(t,e){var n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function gs(t,e,n,i,r){return function(t,e){var n=1-t;return n*n*n*e}(t,e)+function(t,e){var n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}var ys=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new te,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new te,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new te;return a(this,n),(t=e.call(this)).isCubicBezierCurve=!0,t.type="CubicBezierCurve",t.v0=i,t.v1=r,t.v2=o,t.v3=s,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,n=e,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(gs(t,i.x,r.x,a.x,o.x),gs(t,i.y,r.y,a.y,o.y)),n}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}]),n}(os),_s=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ee,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ee;return a(this,n),(t=e.call(this)).isCubicBezierCurve3=!0,t.type="CubicBezierCurve3",t.v0=i,t.v1=r,t.v2=o,t.v3=s,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,n=e,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(gs(t,i.x,r.x,a.x,o.x),gs(t,i.y,r.y,a.y,o.y),gs(t,i.z,r.z,a.z,o.z)),n}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}]),n}(os),xs=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new te,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te;return a(this,n),(t=e.call(this)).isLineCurve=!0,t.type="LineCurve",t.v1=i,t.v2=r,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}},{key:"getPointAt",value:function(t,e){return this.getPoint(t,e)}},{key:"getTangent",value:function(t,e){var n=e||new te;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}]),n}(os),bs=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee;return a(this,n),(t=e.call(this)).isLineCurve3=!0,t.type="LineCurve3",t.v1=i,t.v2=r,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}},{key:"getPointAt",value:function(t,e){return this.getPoint(t,e)}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}]),n}(os),ws=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new te,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new te;return a(this,n),(t=e.call(this)).isQuadraticBezierCurve=!0,t.type="QuadraticBezierCurve",t.v0=i,t.v1=r,t.v2=o,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,n=e,i=this.v0,r=this.v1,a=this.v2;return n.set(ms(t,i.x,r.x,a.x),ms(t,i.y,r.y,a.y)),n}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}]),n}(os),Ss=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ee,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ee;return a(this,n),(t=e.call(this)).isQuadraticBezierCurve3=!0,t.type="QuadraticBezierCurve3",t.v0=i,t.v1=r,t.v2=o,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ee,n=e,i=this.v0,r=this.v1,a=this.v2;return n.set(ms(t,i.x,r.x,a.x),ms(t,i.y,r.y,a.y),ms(t,i.z,r.z,a.z)),n}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}]),n}(os),Ts=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return a(this,n),(t=e.call(this)).isSplineCurve=!0,t.type="SplineCurve",t.points=i,t}return s(n,[{key:"getPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new te,n=e,i=this.points,r=(i.length-1)*t,a=Math.floor(r),o=r-a,s=i[0===a?a:a-1],l=i[a],u=i[a>i.length-2?i.length-1:a+1],h=i[a>i.length-3?i.length-1:a+2];return n.set(vs(o,s.x,l.x,u.x,h.x),vs(o,s.y,l.y,u.y,h.y)),n}},{key:"copy",value:function(t){M(f(n.prototype),"copy",this).call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push(r.clone())}return this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var r=this.points[e];t.points.push(r.toArray())}return t}},{key:"fromJSON",value:function(t){M(f(n.prototype),"fromJSON",this).call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var r=t.points[e];this.points.push((new te).fromArray(r))}return this}}]),n}(os),Ms=Object.freeze({__proto__:null,ArcCurve:ls,CatmullRomCurve3:ps,CubicBezierCurve:ys,CubicBezierCurve3:_s,EllipseCurve:ss,LineCurve:xs,LineCurve3:bs,QuadraticBezierCurve:ws,QuadraticBezierCurve3:Ss,SplineCurve:Ts}),Es=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).type="CurvePath",t.curves=[],t.autoClose=!1,t}return s(n,[{key:"add",value:function(t){this.curves.push(t)}},{key:"closePath",value:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new xs(e,t))}},{key:"getPoint",value:function(t,e){for(var n=t*this.getLength(),i=this.getCurveLengths(),r=0;r<i.length;){if(i[r]>=n){var a=i[r]-n,o=this.curves[r],s=o.getLength(),l=0===s?0:1-a/s;return o.getPointAt(l,e)}r++}return null}},{key:"getLength",value:function(){var t=this.getCurveLengths();return t[t.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}},{key:"getSpacedPoints",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}},{key:"getPoints",value:function(){for(var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],i=0,r=this.curves;i<r.length;i++)for(var a=r[i],o=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var u=s[l];t&&t.equals(u)||(n.push(u),t=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(t){M(f(n.prototype),"copy",this).call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t}},{key:"fromJSON",value:function(t){M(f(n.prototype),"fromJSON",this).call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var r=t.curves[e];this.curves.push((new Ms[r.type]).fromJSON(r))}return this}}]),n}(os),As=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).type="Path",i.currentPoint=new te,t&&i.setFromPoints(t),i}return s(n,[{key:"setFromPoints",value:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}},{key:"moveTo",value:function(t,e){return this.currentPoint.set(t,e),this}},{key:"lineTo",value:function(t,e){var n=new xs(this.currentPoint.clone(),new te(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}},{key:"quadraticCurveTo",value:function(t,e,n,i){var r=new ws(this.currentPoint.clone(),new te(t,e),new te(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}},{key:"bezierCurveTo",value:function(t,e,n,i,r,a){var o=new ys(this.currentPoint.clone(),new te(t,e),new te(n,i),new te(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this}},{key:"splineThru",value:function(t){var e=[this.currentPoint.clone()].concat(t),n=new Ts(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}},{key:"arc",value:function(t,e,n,i,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(t+o,e+s,n,i,r,a),this}},{key:"absarc",value:function(t,e,n,i,r,a){return this.absellipse(t,e,n,n,i,r,a),this}},{key:"ellipse",value:function(t,e,n,i,r,a,o,s){var l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(t+l,e+u,n,i,r,a,o,s),this}},{key:"absellipse",value:function(t,e,n,i,r,a,o,s){var l=new ss(t,e,n,i,r,a,o,s);if(this.curves.length>0){var u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);var h=l.getPoint(1);return this.currentPoint.copy(h),this}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.currentPoint.copy(t.currentPoint),this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return t.currentPoint=this.currentPoint.toArray(),t}},{key:"fromJSON",value:function(t){return M(f(n.prototype),"fromJSON",this).call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}]),n}(Es),Ps=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;a(this,n),(t=e.call(this)).type="CylinderGeometry",t.parameters={radiusTop:i,radiusBottom:r,height:o,radialSegments:s,heightSegments:l,openEnded:u,thetaStart:c,thetaLength:d};var f=h(t);s=Math.floor(s),l=Math.floor(l);var p=[],v=[],m=[],g=[],y=0,_=[],x=o/2,b=0;function w(){for(var t=new Ee,e=new Ee,n=0,a=(r-i)/o,u=0;u<=l;u++){for(var h=[],w=u/l,S=w*(r-i)+i,T=0;T<=s;T++){var M=T/s,E=M*d+c,A=Math.sin(E),P=Math.cos(E);e.x=S*A,e.y=-w*o+x,e.z=S*P,v.push(e.x,e.y,e.z),t.set(A,a,P).normalize(),m.push(t.x,t.y,t.z),g.push(M,1-w),h.push(y++)}_.push(h)}for(var C=0;C<s;C++)for(var k=0;k<l;k++){var R=_[k][C],I=_[k+1][C],D=_[k+1][C+1],O=_[k][C+1];p.push(R,I,O),p.push(I,D,O),n+=6}f.addGroup(b,n,0),b+=n}function S(t){for(var e=y,n=new te,a=new Ee,o=0,l=!0===t?i:r,u=!0===t?1:-1,h=1;h<=s;h++)v.push(0,x*u,0),m.push(0,u,0),g.push(.5,.5),y++;for(var _=y,w=0;w<=s;w++){var S=w/s*d+c,T=Math.cos(S),M=Math.sin(S);a.x=l*M,a.y=x*u,a.z=l*T,v.push(a.x,a.y,a.z),m.push(0,u,0),n.x=.5*T+.5,n.y=.5*M*u+.5,g.push(n.x,n.y),y++}for(var E=0;E<s;E++){var A=e+E,P=_+E;!0===t?p.push(P,P+1,A):p.push(P+1,P,A),o+=3}f.addGroup(b,o,!0===t?1:2),b+=o}return w(),!1===u&&(i>0&&S(!0),r>0&&S(!1)),t.setIndex(p),t.setAttribute("position",new Kn(v,3)),t.setAttribute("normal",new Kn(m,3)),t.setAttribute("uv",new Kn(g,2)),t}return s(n,null,[{key:"fromJSON",value:function(t){return new n(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}]),n}(ii),Cs=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this,t)).uuid=jt(),i.type="Shape",i.holes=[],i}return s(n,[{key:"getPointsHoles",value:function(t){for(var e=[],n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}},{key:"extractPoints",value:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}},{key:"copy",value:function(t){M(f(n.prototype),"copy",this).call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var r=t.holes[e];this.holes.push(r.clone())}return this}},{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t}},{key:"fromJSON",value:function(t){M(f(n.prototype),"fromJSON",this).call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var r=t.holes[e];this.holes.push((new As).fromJSON(r))}return this}}]),n}(As),ks=function(t,e){var n,i,r,a,o,s,l,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,h=e&&e.length,c=h?e[0]*u:t.length,d=Rs(t,0,c,u,!0),f=[];if(!d||d.next===d.prev)return f;if(h&&(d=Bs(t,e,d,u)),t.length>80*u){n=r=t[0],i=a=t[1];for(var p=u;p<c;p+=u)(o=t[p])<n&&(n=o),(s=t[p+1])<i&&(i=s),o>r&&(r=o),s>a&&(a=s);l=0!==(l=Math.max(r-n,a-i))?1/l:0}return Ds(d,f,u,n,i,l),f};function Rs(t,e,n,i,r){var a,o;if(r===function(t,e,n,i){for(var r=0,a=e,o=n-i;a<n;a+=i)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}(t,e,n,i)>0)for(a=e;a<n;a+=i)o=$s(a,t[a],t[a+1],o);else for(a=n-i;a>=e;a-=i)o=$s(a,t[a],t[a+1],o);return o&&qs(o,o.next)&&(tl(o),o=o.next),o}function Is(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!qs(i,i.next)&&0!==Ws(i.prev,i,i.next))i=i.next;else{if(tl(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function Ds(t,e,n,i,r,a,o){if(t){!o&&a&&function(t,e,n,i){var r=t;do{null===r.z&&(r.z=Hs(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,a,o,s,l,u=1;do{for(n=t,t=null,a=null,o=0;n;){for(o++,i=n,s=0,e=0;e<u&&(s++,i=i.nextZ);e++);for(l=u;s>0||l>0&&i;)0!==s&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;n=i}a.nextZ=null,u*=2}while(o>1)}(r)}(t,i,r,a);for(var s,l,u=t;t.prev!==t.next;)if(s=t.prev,l=t.next,a?Ls(t,i,r,a):Os(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),tl(t),t=l.next,u=l.next;else if((t=l)===u){o?1===o?Ds(t=Ns(Is(t),e,n),e,n,i,r,a,2):2===o&&Fs(t,e,n,i,r,a):Ds(Is(t),e,n,i,r,a,1);break}}}function Os(t){var e=t.prev,n=t,i=t.next;if(Ws(e,n,i)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(js(e.x,e.y,n.x,n.y,i.x,i.y,r.x,r.y)&&Ws(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ls(t,e,n,i){var r=t.prev,a=t,o=t.next;if(Ws(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,u=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,h=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,c=Hs(s,l,e,n,i),d=Hs(u,h,e,n,i),f=t.prevZ,p=t.nextZ;f&&f.z>=c&&p&&p.z<=d;){if(f!==t.prev&&f!==t.next&&js(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Ws(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==t.prev&&p!==t.next&&js(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ws(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==t.prev&&f!==t.next&&js(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Ws(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&js(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Ws(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Ns(t,e,n){var i=t;do{var r=i.prev,a=i.next.next;!qs(r,a)&&Ys(r,i,i.next,a)&&Js(r,a)&&Js(a,r)&&(e.push(r.i/n),e.push(i.i/n),e.push(a.i/n),tl(i),tl(i.next),i=t=a),i=i.next}while(i!==t);return Is(i)}function Fs(t,e,n,i,r,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Xs(o,s)){var l=Qs(o,s);return o=Is(o,o.next),l=Is(l,l.next),Ds(o,e,n,i,r,a),void Ds(l,e,n,i,r,a)}s=s.next}o=o.next}while(o!==t)}function Bs(t,e,n,i){var r,a,o,s=[];for(r=0,a=e.length;r<a;r++)(o=Rs(t,e[r]*i,r<a-1?e[r+1]*i:t.length,i,!1))===o.next&&(o.steiner=!0),s.push(Vs(o));for(s.sort(Us),r=0;r<s.length;r++)Gs(s[r],n),n=Is(n,n.next);return n}function Us(t,e){return t.x-e.x}function Gs(t,e){if(e=function(t,e){var n,i=e,r=t.x,a=t.y,o=-1/0;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=r&&s>o){if(o=s,s===r){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(r===o)return n;var l,u=n,h=n.x,c=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=h&&r!==i.x&&js(a<c?r:o,a,h,c,a<c?o:r,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(r-i.x),Js(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&zs(n,i)))&&(n=i,d=l)),i=i.next}while(i!==u);return n}(t,e),e){var n=Qs(e,t);Is(e,e.next),Is(n,n.next)}}function zs(t,e){return Ws(t.prev,t,e.prev)<0&&Ws(e.next,t,t.next)<0}function Hs(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Vs(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function js(t,e,n,i,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(i-s)-(n-o)*(e-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function Xs(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Ys(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(Js(t,e)&&Js(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!==n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Ws(t.prev,t,e.prev)||Ws(t,e.prev,e))||qs(t,e)&&Ws(t.prev,t,t.next)>0&&Ws(e.prev,e,e.next)>0)}function Ws(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function qs(t,e){return t.x===e.x&&t.y===e.y}function Ys(t,e,n,i){var r=Zs(Ws(t,e,n)),a=Zs(Ws(t,e,i)),o=Zs(Ws(n,i,t)),s=Zs(Ws(n,i,e));return r!==a&&o!==s||(!(0!==r||!Ks(t,n,e))||(!(0!==a||!Ks(t,i,e))||(!(0!==o||!Ks(n,t,i))||!(0!==s||!Ks(n,e,i)))))}function Ks(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Zs(t){return t>0?1:t<0?-1:0}function Js(t,e){return Ws(t.prev,t,t.next)<0?Ws(t,e,t.next)>=0&&Ws(t,t.prev,e)>=0:Ws(t,e,t.prev)<0||Ws(t,t.next,e)<0}function Qs(t,e){var n=new el(t.i,t.x,t.y),i=new el(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function $s(t,e,n,i){var r=new el(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function tl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function el(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var nl=function(){function t(){a(this,t)}return s(t,null,[{key:"area",value:function(t){for(var e=t.length,n=0,i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}},{key:"isClockWise",value:function(e){return t.area(e)<0}},{key:"triangulateShape",value:function(t,e){var n=[],i=[],r=[];il(t),rl(n,t);var a=t.length;e.forEach(il);for(var o=0;o<e.length;o++)i.push(a),a+=e[o].length,rl(n,e[o]);for(var s=ks(n,i),l=0;l<s.length;l+=3)r.push(s.slice(l,l+3));return r}}]),t}();function il(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function rl(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var al=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Cs([new te(0,.5),new te(-.5,-.5),new te(.5,-.5)]),r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;a(this,n),(t=e.call(this)).type="ShapeGeometry",t.parameters={shapes:i,curveSegments:r};var o=[],s=[],l=[],u=[],h=0,c=0;if(!1===Array.isArray(i))f(i);else for(var d=0;d<i.length;d++)f(i[d]),t.addGroup(h,c,d),h+=c,c=0;function f(t){var e=s.length/3,n=t.extractPoints(r),i=n.shape,a=n.holes;!1===nl.isClockWise(i)&&(i=i.reverse());for(var h=0,d=a.length;h<d;h++){var f=a[h];!0===nl.isClockWise(f)&&(a[h]=f.reverse())}for(var p=nl.triangulateShape(i,a),v=0,m=a.length;v<m;v++){var g=a[v];i=i.concat(g)}for(var y=0,_=i.length;y<_;y++){var x=i[y];s.push(x.x,x.y,0),l.push(0,0,1),u.push(x.x,x.y)}for(var b=0,w=p.length;b<w;b++){var S=p[b],T=S[0]+e,M=S[1]+e,E=S[2]+e;o.push(T,M,E),c+=3}}return t.setIndex(o),t.setAttribute("position",new Kn(s,3)),t.setAttribute("normal",new Kn(l,3)),t.setAttribute("uv",new Kn(u,2)),t}return s(n,[{key:"toJSON",value:function(){var t=M(f(n.prototype),"toJSON",this).call(this);return function(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,i=t.length;n<i;n++){var r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}(this.parameters.shapes,t)}}],[{key:"fromJSON",value:function(t,e){for(var i=[],r=0,a=t.shapes.length;r<a;r++){var o=e[t.shapes[r]];i.push(o)}return new n(i,t.curveSegments)}}]),n}(ii);var ol=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;a(this,n),(t=e.call(this)).type="SphereGeometry",t.parameters={radius:i,widthSegments:r,heightSegments:o,phiStart:s,phiLength:l,thetaStart:u,thetaLength:h},r=Math.max(3,Math.floor(r)),o=Math.max(2,Math.floor(o));for(var c=Math.min(u+h,Math.PI),d=0,f=[],p=new Ee,v=new Ee,m=[],g=[],y=[],_=[],x=0;x<=o;x++){var b=[],w=x/o,S=0;0==x&&0==u?S=.5/r:x==o&&c==Math.PI&&(S=-.5/r);for(var T=0;T<=r;T++){var M=T/r;p.x=-i*Math.cos(s+M*l)*Math.sin(u+w*h),p.y=i*Math.cos(u+w*h),p.z=i*Math.sin(s+M*l)*Math.sin(u+w*h),g.push(p.x,p.y,p.z),v.copy(p).normalize(),y.push(v.x,v.y,v.z),_.push(M+S,1-w),b.push(d++)}f.push(b)}for(var E=0;E<o;E++)for(var A=0;A<r;A++){var P=f[E][A+1],C=f[E][A],k=f[E+1][A],R=f[E+1][A+1];(0!==E||u>0)&&m.push(P,C,R),(E!==o-1||c<Math.PI)&&m.push(C,k,R)}return t.setIndex(m),t.setAttribute("position",new Kn(g,3)),t.setAttribute("normal",new Kn(y,3)),t.setAttribute("uv",new Kn(_,2)),t}return s(n,null,[{key:"fromJSON",value:function(t){return new n(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}]),n}(ii),sl=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;a(this,n),(t=e.call(this)).type="TorusGeometry",t.parameters={radius:i,tube:r,radialSegments:o,tubularSegments:s,arc:l},o=Math.floor(o),s=Math.floor(s);for(var u=[],h=[],c=[],d=[],f=new Ee,p=new Ee,v=new Ee,m=0;m<=o;m++)for(var g=0;g<=s;g++){var y=g/s*l,_=m/o*Math.PI*2;p.x=(i+r*Math.cos(_))*Math.cos(y),p.y=(i+r*Math.cos(_))*Math.sin(y),p.z=r*Math.sin(_),h.push(p.x,p.y,p.z),f.x=i*Math.cos(y),f.y=i*Math.sin(y),v.subVectors(p,f).normalize(),c.push(v.x,v.y,v.z),d.push(g/s),d.push(m/o)}for(var x=1;x<=o;x++)for(var b=1;b<=s;b++){var w=(s+1)*x+b-1,S=(s+1)*(x-1)+b-1,T=(s+1)*(x-1)+b,M=(s+1)*x+b;u.push(w,S,M),u.push(S,T,M)}return t.setIndex(u),t.setAttribute("position",new Kn(h,3)),t.setAttribute("normal",new Kn(c,3)),t.setAttribute("uv",new Kn(d,2)),t}return s(n,null,[{key:"fromJSON",value:function(t){return new n(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}]),n}(ii);var ll=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshStandardMaterial=!0,i.defines={STANDARD:""},i.type="MeshStandardMaterial",i.color=new ve(16777215),i.roughness=1,i.metalness=0,i.map=null,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=null,i.aoMapIntensity=1,i.emissive=new ve(0),i.emissiveIntensity=1,i.emissiveMap=null,i.bumpMap=null,i.bumpScale=1,i.normalMap=null,i.normalMapType=0,i.normalScale=new te(1,1),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.roughnessMap=null,i.metalnessMap=null,i.alphaMap=null,i.envMap=null,i.envMapIntensity=1,i.wireframe=!1,i.wireframeLinewidth=1,i.wireframeLinecap="round",i.wireframeLinejoin="round",i.flatShading=!1,i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}]),n}(Hn),ul=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshPhysicalMaterial=!0,i.defines={STANDARD:"",PHYSICAL:""},i.type="MeshPhysicalMaterial",i.clearcoatMap=null,i.clearcoatRoughness=0,i.clearcoatRoughnessMap=null,i.clearcoatNormalScale=new te(1,1),i.clearcoatNormalMap=null,i.ior=1.5,Object.defineProperty(h(i),"reflectivity",{get:function(){return Xt(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),i.iridescenceMap=null,i.iridescenceIOR=1.3,i.iridescenceThicknessRange=[100,400],i.iridescenceThicknessMap=null,i.sheenColor=new ve(0),i.sheenColorMap=null,i.sheenRoughness=1,i.sheenRoughnessMap=null,i.transmissionMap=null,i.thickness=0,i.thicknessMap=null,i.attenuationDistance=1/0,i.attenuationColor=new ve(1,1,1),i.specularIntensity=1,i.specularIntensityMap=null,i.specularColor=new ve(1,1,1),i.specularColorMap=null,i._sheen=0,i._clearcoat=0,i._iridescence=0,i._transmission=0,i.setValues(t),i}return s(n,[{key:"sheen",get:function(){return this._sheen},set:function(t){this._sheen>0!==t>0&&this.version++,this._sheen=t}},{key:"clearcoat",get:function(){return this._clearcoat},set:function(t){this._clearcoat>0!==t>0&&this.version++,this._clearcoat=t}},{key:"iridescence",get:function(){return this._iridescence},set:function(t){this._iridescence>0!==t>0&&this.version++,this._iridescence=t}},{key:"transmission",get:function(){return this._transmission},set:function(t){this._transmission>0!==t>0&&this.version++,this._transmission=t}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=b(t.iridescenceThicknessRange),this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}]),n}(ll),hl=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshPhongMaterial=!0,i.type="MeshPhongMaterial",i.color=new ve(16777215),i.specular=new ve(1118481),i.shininess=30,i.map=null,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=null,i.aoMapIntensity=1,i.emissive=new ve(0),i.emissiveIntensity=1,i.emissiveMap=null,i.bumpMap=null,i.bumpScale=1,i.normalMap=null,i.normalMapType=0,i.normalScale=new te(1,1),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.specularMap=null,i.alphaMap=null,i.envMap=null,i.combine=0,i.reflectivity=1,i.refractionRatio=.98,i.wireframe=!1,i.wireframeLinewidth=1,i.wireframeLinecap="round",i.wireframeLinejoin="round",i.flatShading=!1,i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}]),n}(Hn),cl=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this)).isMeshLambertMaterial=!0,i.type="MeshLambertMaterial",i.color=new ve(16777215),i.map=null,i.lightMap=null,i.lightMapIntensity=1,i.aoMap=null,i.aoMapIntensity=1,i.emissive=new ve(0),i.emissiveIntensity=1,i.emissiveMap=null,i.bumpMap=null,i.bumpScale=1,i.normalMap=null,i.normalMapType=0,i.normalScale=new te(1,1),i.displacementMap=null,i.displacementScale=1,i.displacementBias=0,i.specularMap=null,i.alphaMap=null,i.envMap=null,i.combine=0,i.reflectivity=1,i.refractionRatio=.98,i.wireframe=!1,i.wireframeLinewidth=1,i.wireframeLinecap="round",i.wireframeLinejoin="round",i.flatShading=!1,i.fog=!0,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}]),n}(Hn);function dl(t,e,n){return pl(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)}function fl(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)}function pl(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function vl(t){for(var e=t.length,n=new Array(e),i=0;i!==e;++i)n[i]=i;return n.sort((function(e,n){return t[e]-t[n]})),n}function ml(t,e,n){for(var i=t.length,r=new t.constructor(i),a=0,o=0;o!==i;++a)for(var s=n[a]*e,l=0;l!==e;++l)r[o++]=t[s+l];return r}function gl(t,e,n,i){for(var r=1,a=t[0];void 0!==a&&void 0===a[i];)a=t[r++];if(void 0!==a){var o=a[i];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[i])&&(e.push(a.time),n.push.apply(n,o)),a=t[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[i])&&(e.push(a.time),o.toArray(n,n.length)),a=t[r++]}while(void 0!==a);else do{void 0!==(o=a[i])&&(e.push(a.time),n.push(o)),a=t[r++]}while(void 0!==a)}}var yl=function(){function t(e,n,i,r){a(this,t),this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}return s(t,[{key:"evaluate",value:function(t){var e=this.parameterPositions,n=this._cachedIndex,i=e[n],r=e[n-1];t:{e:{var a;n:{i:if(!(t<i)){for(var o=n+2;;){if(void 0===i){if(t<r)break i;return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(r=i,t<(i=e[++n]))break e}a=e.length;break n}if(t>=r)break t;var s=e[1];t<s&&(n=2,r=s);for(var l=n-2;;){if(void 0===r)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(i=r,t>=(r=e[--n-1]))break e}a=n,n=0}for(;n<a;){var u=n+a>>>1;t<e[u]?a=u:n=u+1}if(i=e[n],void 0===(r=e[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===i)return n=e.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,t,i)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i,a=0;a!==i;++a)e[a]=n[r+a];return e}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}]),t}(),_l=function(t){d(n,t);var e=m(n);function n(t,i,r,o){var s;return a(this,n),(s=e.call(this,t,i,r,o))._weightPrev=-0,s._offsetPrev=-0,s._weightNext=-0,s._offsetNext=-0,s.DefaultSettings_={endingStart:At,endingEnd:At},s}return s(n,[{key:"intervalChanged_",value:function(t,e,n){var i=this.parameterPositions,r=t-2,a=t+1,o=i[r],s=i[a];if(void 0===o)switch(this.getSettings_().endingStart){case Pt:r=t,o=2*e-n;break;case Ct:o=e+i[r=i.length-2]-i[r+1];break;default:r=t,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case Pt:a=t,s=2*n-e;break;case Ct:a=1,s=n+i[1]-i[0];break;default:a=t-1,s=e}var l=.5*(n-e),u=this.valueSize;this._weightPrev=l/(e-o),this._weightNext=l/(s-n),this._offsetPrev=r*u,this._offsetNext=a*u}},{key:"interpolate_",value:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=this._offsetPrev,h=this._offsetNext,c=this._weightPrev,d=this._weightNext,f=(n-e)/(i-e),p=f*f,v=p*f,m=-c*v+2*c*p-c*f,g=(1+c)*v+(-1.5-2*c)*p+(-.5+c)*f+1,y=(-1-d)*v+(1.5+d)*p+.5*f,_=d*v-d*p,x=0;x!==o;++x)r[x]=m*a[u+x]+g*a[l+x]+y*a[s+x]+_*a[h+x];return r}}]),n}(yl),xl=function(t){d(n,t);var e=m(n);function n(t,i,r,o){return a(this,n),e.call(this,t,i,r,o)}return s(n,[{key:"interpolate_",value:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,l=s-o,u=(n-e)/(i-e),h=1-u,c=0;c!==o;++c)r[c]=a[l+c]*h+a[s+c]*u;return r}}]),n}(yl),bl=function(t){d(n,t);var e=m(n);function n(t,i,r,o){return a(this,n),e.call(this,t,i,r,o)}return s(n,[{key:"interpolate_",value:function(t){return this.copySampleValue_(t-1)}}]),n}(yl),wl=function(){function t(e,n,i,r){if(a(this,t),void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fl(n,this.TimeBufferType),this.values=fl(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}return s(t,[{key:"InterpolantFactoryMethodDiscrete",value:function(t){return new bl(this.times,this.values,this.getValueSize(),t)}},{key:"InterpolantFactoryMethodLinear",value:function(t){return new xl(this.times,this.values,this.getValueSize(),t)}},{key:"InterpolantFactoryMethodSmooth",value:function(t){return new _l(this.times,this.values,this.getValueSize(),t)}},{key:"setInterpolation",value:function(t){var e;switch(t){case Tt:e=this.InterpolantFactoryMethodDiscrete;break;case Mt:e=this.InterpolantFactoryMethodLinear;break;case Et:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=e,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Tt;case this.InterpolantFactoryMethodLinear:return Mt;case this.InterpolantFactoryMethodSmooth:return Et}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(t){if(0!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]+=t;return this}},{key:"scale",value:function(t){if(1!==t)for(var e=this.times,n=0,i=e.length;n!==i;++n)e[n]*=t;return this}},{key:"trim",value:function(t,e){for(var n=this.times,i=n.length,r=0,a=i-1;r!==i&&n[r]<t;)++r;for(;-1!==a&&n[a]>e;)--a;if(++a,0!==r||a!==i){r>=a&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=dl(n,r,a),this.values=dl(this.values,r*o,a*o)}return this}},{key:"validate",value:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,i=this.values,r=n.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==i&&pl(i))for(var l=0,u=i.length;l!==u;++l){var h=i[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),t=!1;break}}return t}},{key:"optimize",value:function(){for(var t=dl(this.times),e=dl(this.values),n=this.getValueSize(),i=this.getInterpolation()===Et,r=t.length-1,a=1,o=1;o<r;++o){var s=!1,l=t[o];if(l!==t[o+1]&&(1!==o||l!==t[0]))if(i)s=!0;else for(var u=o*n,h=u-n,c=u+n,d=0;d!==n;++d){var f=e[u+d];if(f!==e[h+d]||f!==e[c+d]){s=!0;break}}if(s){if(o!==a){t[a]=t[o];for(var p=o*n,v=a*n,m=0;m!==n;++m)e[v+m]=e[p+m]}++a}}if(r>0){t[a]=t[r];for(var g=r*n,y=a*n,_=0;_!==n;++_)e[y+_]=e[g+_];++a}return a!==t.length?(this.times=dl(t,0,a),this.values=dl(e,0,a*n)):(this.times=t,this.values=e),this}},{key:"clone",value:function(){var t=dl(this.times,0),e=dl(this.values,0),n=new(0,this.constructor)(this.name,t,e);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(t){var e,n=t.constructor;if(n.toJSON!==this.toJSON)e=n.toJSON(t);else{e={name:t.name,times:fl(t.times,Array),values:fl(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(e.interpolation=i)}return e.type=t.ValueTypeName,e}}]),t}();wl.prototype.TimeBufferType=Float32Array,wl.prototype.ValueBufferType=Float32Array,wl.prototype.DefaultInterpolation=Mt;var Sl=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(wl);Sl.prototype.ValueTypeName="bool",Sl.prototype.ValueBufferType=Array,Sl.prototype.DefaultInterpolation=Tt,Sl.prototype.InterpolantFactoryMethodLinear=void 0,Sl.prototype.InterpolantFactoryMethodSmooth=void 0;var Tl=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(wl);Tl.prototype.ValueTypeName="color";var Ml=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(wl);Ml.prototype.ValueTypeName="number";var El=function(t){d(n,t);var e=m(n);function n(t,i,r,o){return a(this,n),e.call(this,t,i,r,o)}return s(n,[{key:"interpolate_",value:function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=(n-e)/(i-e),l=t*o,u=l+o;l!==u;l+=4)Me.slerpFlat(r,0,a,l-o,a,l,s);return r}}]),n}(yl),Al=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n,[{key:"InterpolantFactoryMethodLinear",value:function(t){return new El(this.times,this.values,this.getValueSize(),t)}}]),n}(wl);Al.prototype.ValueTypeName="quaternion",Al.prototype.DefaultInterpolation=Mt,Al.prototype.InterpolantFactoryMethodSmooth=void 0;var Pl=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(wl);Pl.prototype.ValueTypeName="string",Pl.prototype.ValueBufferType=Array,Pl.prototype.DefaultInterpolation=Tt,Pl.prototype.InterpolantFactoryMethodLinear=void 0,Pl.prototype.InterpolantFactoryMethodSmooth=void 0;var Cl=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n)}(wl);Cl.prototype.ValueTypeName="vector";var kl=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:kt;a(this,t),this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=jt(),this.duration<0&&this.resetDuration()}return s(t,[{key:"resetDuration",value:function(){for(var t=0,e=0,n=this.tracks.length;e!==n;++e){var i=this.tracks[e];t=Math.max(t,i.times[i.times.length-1])}return this.duration=t,this}},{key:"trim",value:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var t=!0,e=0;e<this.tracks.length;e++)t=t&&this.tracks[e].validate();return t}},{key:"optimize",value:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}},{key:"clone",value:function(){for(var t=[],e=0;e<this.tracks.length;e++)t.push(this.tracks[e].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(t){for(var e=[],n=t.tracks,i=1/(t.fps||1),r=0,a=n.length;r!==a;++r)e.push(Rl(n[r]).scale(i));var o=new this(t.name,t.duration,e,t.blendMode);return o.uuid=t.uuid,o}},{key:"toJSON",value:function(t){for(var e=[],n=t.tracks,i={name:t.name,duration:t.duration,tracks:e,uuid:t.uuid,blendMode:t.blendMode},r=0,a=n.length;r!==a;++r)e.push(wl.toJSON(n[r]));return i}},{key:"CreateFromMorphTargetSequence",value:function(t,e,n,i){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var u=vl(s);s=ml(s,1,u),l=ml(l,1,u),i||0!==s[0]||(s.push(r),l.push(l[0])),a.push(new Ml(".morphTargetInfluences["+e[o].name+"]",s,l).scale(1/n))}return new this(t,-1,a)}},{key:"findByName",value:function(t,e){var n=t;if(!Array.isArray(t)){var i=t;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===e)return n[r];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(t,e,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],l=s.name.match(r);if(l&&l.length>1){var u=l[1],h=i[u];h||(i[u]=h=[]),h.push(s)}}var c=[];for(var d in i)c.push(this.CreateFromMorphTargetSequence(d,i[d],e,n));return c}},{key:"parseAnimation",value:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,i,r){if(0!==n.length){var a=[],o=[];gl(n,a,o,i),0!==a.length&&r.push(new t(e,a,o))}},i=[],r=t.name||"default",a=t.fps||30,o=t.blendMode,s=t.length||-1,l=t.hierarchy||[],u=0;u<l.length;u++){var h=l[u].keys;if(h&&0!==h.length)if(h[0].morphTargets){var c={},d=void 0;for(d=0;d<h.length;d++)if(h[d].morphTargets)for(var f=0;f<h[d].morphTargets.length;f++)c[h[d].morphTargets[f]]=-1;for(var p in c){for(var v=[],m=[],g=0;g!==h[d].morphTargets.length;++g){var y=h[d];v.push(y.time),m.push(y.morphTarget===p?1:0)}i.push(new Ml(".morphTargetInfluence["+p+"]",v,m))}s=c.length*a}else{var _=".bones["+e[u].name+"]";n(Cl,_+".position",h,"pos",i),n(Al,_+".quaternion",h,"rot",i),n(Cl,_+".scale",h,"scl",i)}}return 0===i.length?null:new this(r,s,i,o)}}]),t}();function Rl(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ml;case"vector":case"vector2":case"vector3":case"vector4":return Cl;case"color":return Tl;case"quaternion":return Al;case"bool":case"boolean":return Sl;case"string":return Pl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(t.type);if(void 0===t.times){var n=[],i=[];gl(t.keys,n,i,"value"),t.times=n,t.values=i}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}var Il={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},Dl=s((function t(e,n,i){a(this,t);var r=this,o=!1,s=0,l=0,u=void 0,h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(t){l++,!1===o&&void 0!==r.onStart&&r.onStart(t,s,l),o=!0},this.itemEnd=function(t){s++,void 0!==r.onProgress&&r.onProgress(t,s,l),s===l&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return u?u(t):t},this.setURLModifier=function(t){return u=t,this},this.addHandler=function(t,e){return h.push(t,e),this},this.removeHandler=function(t){var e=h.indexOf(t);return-1!==e&&h.splice(e,2),this},this.getHandler=function(t){for(var e=0,n=h.length;e<n;e+=2){var i=h[e],r=h[e+1];if(i.global&&(i.lastIndex=0),i.test(t))return r}return null}})),Ol=new Dl,Ll=function(){function t(e){a(this,t),this.manager=void 0!==e?e:Ol,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}return s(t,[{key:"load",value:function(){}},{key:"loadAsync",value:function(t,e){var n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(t){return this.crossOrigin=t,this}},{key:"setWithCredentials",value:function(t){return this.withCredentials=t,this}},{key:"setPath",value:function(t){return this.path=t,this}},{key:"setResourcePath",value:function(t){return this.resourcePath=t,this}},{key:"setRequestHeader",value:function(t){return this.requestHeader=t,this}}]),t}(),Nl={},Fl=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t)).response=i,r}return s(n)}(y(Error)),Bl=function(t){d(n,t);var e=m(n);function n(t){return a(this,n),e.call(this,t)}return s(n,[{key:"load",value:function(t,e,n,i){var r=this;void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var a=Il.get(t);if(void 0!==a)return this.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;if(void 0===Nl[t]){Nl[t]=[],Nl[t].push({onLoad:e,onProgress:n,onError:i});var o=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,l=this.responseType;fetch(o).then((function(e){if(200===e.status||0===e.status){if(0===e.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"===typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;var n=Nl[t],i=e.body.getReader(),r=e.headers.get("Content-Length"),a=r?parseInt(r):0,o=0!==a,s=0,l=new ReadableStream({start:function(t){!function e(){i.read().then((function(i){var r=i.done,l=i.value;if(r)t.close();else{s+=l.byteLength;for(var u=new ProgressEvent("progress",{lengthComputable:o,loaded:s,total:a}),h=0,c=n.length;h<c;h++){var d=n[h];d.onProgress&&d.onProgress(u)}t.enqueue(l),e()}}))}()}});return new Response(l)}throw new Fl('fetch for "'.concat(e.url,'" responded with ').concat(e.status,": ").concat(e.statusText),e)})).then((function(t){switch(l){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((function(t){return(new DOMParser).parseFromString(t,s)}));case"json":return t.json();default:if(void 0===s)return t.text();var e=/charset="?([^;"\s]*)"?/i.exec(s),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then((function(t){return i.decode(t)}))}})).then((function(e){Il.add(t,e);var n=Nl[t];delete Nl[t];for(var i=0,r=n.length;i<r;i++){var a=n[i];a.onLoad&&a.onLoad(e)}})).catch((function(e){var n=Nl[t];if(void 0===n)throw r.manager.itemError(t),e;delete Nl[t];for(var i=0,a=n.length;i<a;i++){var o=n[i];o.onError&&o.onError(e)}r.manager.itemError(t)})).finally((function(){r.manager.itemEnd(t)})),this.manager.itemStart(t)}else Nl[t].push({onLoad:e,onProgress:n,onError:i})}},{key:"setResponseType",value:function(t){return this.responseType=t,this}},{key:"setMimeType",value:function(t){return this.mimeType=t,this}}]),n}(Ll),Ul=function(t){d(n,t);var e=m(n);function n(t){return a(this,n),e.call(this,t)}return s(n,[{key:"load",value:function(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Il.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;var o=ie("img");function s(){u(),Il.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){u(),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}function u(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o}}]),n}(Ll),Gl=function(t){d(n,t);var e=m(n);function n(t){return a(this,n),e.call(this,t)}return s(n,[{key:"load",value:function(t,e,n,i){var r=new xe,a=new Ul(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}]),n}(Ll),zl=function(t){d(n,t);var e=m(n);function n(t){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return a(this,n),(i=e.call(this)).isLight=!0,i.type="Light",i.color=new ve(t),i.intensity=r,i}return s(n,[{key:"dispose",value:function(){}},{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.color.copy(t.color),this.intensity=t.intensity,this}},{key:"toJSON",value:function(t){var e=M(f(n.prototype),"toJSON",this).call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}]),n}(Cn),Hl=new rn,Vl=new Ee,jl=new Ee,Xl=function(){function t(e){a(this,t),this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new te(512,512),this.map=null,this.mapPass=null,this.matrix=new rn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Gi,this._frameExtents=new te(1,1),this._viewportCount=1,this._viewports=[new be(0,0,1,1)]}return s(t,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(t){var e=this.camera,n=this.matrix;Vl.setFromMatrixPosition(t.matrixWorld),e.position.copy(Vl),jl.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(jl),e.updateMatrixWorld(),Hl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Hl),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Hl)}},{key:"getViewport",value:function(t){return this._viewports[t]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"dispose",value:function(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}},{key:"copy",value:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}]),t}(),Wl=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this,new Ci(50,1,.5,500))).isSpotLightShadow=!0,t.focus=1,t}return s(n,[{key:"updateMatrices",value:function(t){var e=this.camera,i=2*Vt*t.angle*this.focus,r=this.mapSize.width/this.mapSize.height,a=t.distance||e.far;i===e.fov&&r===e.aspect&&a===e.far||(e.fov=i,e.aspect=r,e.far=a,e.updateProjectionMatrix()),M(f(n.prototype),"updateMatrices",this).call(this,t)}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.focus=t.focus,this}}]),n}(Xl),ql=function(t){d(n,t);var e=m(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return a(this,n),(r=e.call(this,t,i)).isSpotLight=!0,r.type="SpotLight",r.position.copy(Cn.DefaultUp),r.updateMatrix(),r.target=new Cn,r.distance=o,r.angle=s,r.penumbra=l,r.decay=u,r.map=null,r.shadow=new Wl,r}return s(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}]),n}(zl),Yl=new rn,Kl=new Ee,Zl=new Ee,Jl=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this,new Ci(90,1,.5,500))).isPointLightShadow=!0,t._frameExtents=new te(4,2),t._viewportCount=6,t._viewports=[new be(2,1,1,1),new be(0,1,1,1),new be(3,1,1,1),new be(1,1,1,1),new be(3,0,1,1),new be(1,0,1,1)],t._cubeDirections=[new Ee(1,0,0),new Ee(-1,0,0),new Ee(0,0,1),new Ee(0,0,-1),new Ee(0,1,0),new Ee(0,-1,0)],t._cubeUps=[new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,1,0),new Ee(0,0,1),new Ee(0,0,-1)],t}return s(n,[{key:"updateMatrices",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Kl.setFromMatrixPosition(t.matrixWorld),n.position.copy(Kl),Zl.copy(n.position),Zl.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(Zl),n.updateMatrixWorld(),i.makeTranslation(-Kl.x,-Kl.y,-Kl.z),Yl.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Yl)}}]),n}(Xl),Ql=function(t){d(n,t);var e=m(n);function n(t,i){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return a(this,n),(r=e.call(this,t,i)).isPointLight=!0,r.type="PointLight",r.distance=o,r.decay=s,r.shadow=new Jl,r}return s(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}},{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(t,e){return M(f(n.prototype),"copy",this).call(this,t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}]),n}(zl),$l=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this,new $i(-5,5,5,-5,.5,500))).isDirectionalLightShadow=!0,t}return s(n)}(Xl),tu=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t,i)).isDirectionalLight=!0,r.type="DirectionalLight",r.position.copy(Cn.DefaultUp),r.updateMatrix(),r.target=new Cn,r.shadow=new $l,r}return s(n,[{key:"dispose",value:function(){this.shadow.dispose()}},{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}]),n}(zl),eu=function(t){d(n,t);var e=m(n);function n(t,i){var r;return a(this,n),(r=e.call(this,t,i)).isAmbientLight=!0,r.type="AmbientLight",r}return s(n)}(zl),nu=function(){function t(){a(this,t)}return s(t,null,[{key:"decodeText",value:function(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,i=t.length;n<i;n++)e+=String.fromCharCode(t[n]);try{return decodeURIComponent(escape(e))}catch(r){return e}}},{key:"extractUrlBase",value:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.slice(0,e+1)}},{key:"resolveURL",value:function(t,e){return"string"!==typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}}]),t}(),iu=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this,t)).isImageBitmapLoader=!0,"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),i.options={premultiplyAlpha:"none"},i}return s(n,[{key:"setOptions",value:function(t){return this.options=t,this}},{key:"load",value:function(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Il.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout((function(){e&&e(a),r.manager.itemEnd(t)}),0),a;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(t,o).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,Object.assign(r.options,{colorSpaceConversion:"none"}))})).then((function(n){Il.add(t,n),e&&e(n),r.manager.itemEnd(t)})).catch((function(e){i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)})),r.manager.itemStart(t)}}]),n}(Ll),ru=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];a(this,t),this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return s(t,[{key:"start",value:function(){this.startTime=au(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=au();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}]),t}();function au(){return("undefined"===typeof performance?Date:performance).now()}var ou="\\[\\]\\.:\\/",su=new RegExp("[\\[\\]\\.:\\/]","g"),lu="[^\\[\\]\\.:\\/]",uu="[^"+ou.replace("\\.","")+"]",hu=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",lu)+/(WCOD+)?/.source.replace("WCOD",uu)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lu)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lu)+"$"),cu=["material","materials","bones","map"],du=function(){function t(e,n,i){a(this,t);var r=i||fu.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}return s(t,[{key:"getValue",value:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];void 0!==i&&i.getValue(t,e)}},{key:"setValue",value:function(t,e){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(t,e)}},{key:"bind",value:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()}},{key:"unbind",value:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}]),t}(),fu=function(){function t(e,n,i){a(this,t),this.path=n,this.parsedPath=i||t.parseTrackName(n),this.node=t.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return s(t,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(t,e){t[e]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)t[e++]=n[i]}},{key:"_getValue_arrayElement",value:function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(t,e){this.resolvedProperty.toArray(t,e)}},{key:"_setValue_direct",value:function(t,e){this.targetObject[this.propertyName]=t[e]}},{key:"_setValue_direct_setNeedsUpdate",value:function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++]}},{key:"_setValue_array_setNeedsUpdate",value:function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(t,e){for(var n=this.resolvedProperty,i=0,r=n.length;i!==r;++i)n[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(t,e){this.resolvedProperty.fromArray(t,e)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(t,e){this.bind(),this.getValue(t,e)}},{key:"_setValue_unbound",value:function(t,e){this.bind(),this.setValue(t,e)}},{key:"bind",value:function(){var e=this.node,n=this.parsedPath,i=n.objectName,r=n.propertyName,a=n.propertyIndex;if(e||(e=t.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(i){var o=n.objectIndex;switch(i){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var s=0;s<e.length;s++)if(e[s].name===o){o=s;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);e=e.material.map;break;default:if(void 0===e[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[i]}if(void 0!==o){if(void 0===e[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[o]}}var l=e[r];if(void 0!==l){var u=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?u=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate);var h=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}h=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=a}else void 0!==l.fromArray&&void 0!==l.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(h=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=r;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}else{var c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(e,n,i){return e&&e.isAnimationObjectGroup?new t.Composite(e,n,i):new t(e,n,i)}},{key:"sanitizeNodeName",value:function(t){return t.replace(/\s/g,"_").replace(su,"")}},{key:"parseTrackName",value:function(t){var e=hu.exec(t);if(null===e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==i&&-1!==i){var r=n.nodeName.substring(i+1);-1!==cu.indexOf(r)&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}},{key:"findNode",value:function(t,e){if(void 0===e||""===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var i=function t(n){for(var i=0;i<n.length;i++){var r=n[i];if(r.name===e||r.uuid===e)return r;var a=t(r.children);if(a)return a}return null}(t.children);if(i)return i}return null}}]),t}();fu.Composite=du,fu.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},fu.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},fu.prototype.GetterByBindingType=[fu.prototype._getValue_direct,fu.prototype._getValue_array,fu.prototype._getValue_arrayElement,fu.prototype._getValue_toArray],fu.prototype.SetterByBindingTypeAndVersioning=[[fu.prototype._setValue_direct,fu.prototype._setValue_direct_setNeedsUpdate,fu.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fu.prototype._setValue_array,fu.prototype._setValue_array_setNeedsUpdate,fu.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fu.prototype._setValue_arrayElement,fu.prototype._setValue_arrayElement_setNeedsUpdate,fu.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fu.prototype._setValue_fromArray,fu.prototype._setValue_fromArray_setNeedsUpdate,fu.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);var pu=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;a(this,t),this.ray=new nn(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new vn,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}return s(t,[{key:"set",value:function(t,e){this.ray.set(t,e)}},{key:"setFromCamera",value:function(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}},{key:"intersectObject",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return mu(t,this,n,e),n.sort(vu),n}},{key:"intersectObjects",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=0,r=t.length;i<r;i++)mu(t[i],this,n,e);return n.sort(vu),n}}]),t}();function vu(t,e){return t.distance-e.distance}function mu(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),!0===i)for(var r=t.children,a=0,o=r.length;a<o;a++)mu(r[a],e,n,!0)}var gu=function(t){d(n,t);var e=m(n);function n(t,i){return a(this,n),console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),e.call(this,t,i)}return s(n)}(al);function yu(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function _u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yu(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yu(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:A}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=A);var xu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0,0,0,0,0,0];a(this,t),this.elements=void 0,this.elements=e}return s(t,[{key:"identity",value:function(){var t=this.elements;t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1}},{key:"setZero",value:function(){var t=this.elements;t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0}},{key:"setTrace",value:function(t){var e=this.elements;e[0]=t.x,e[4]=t.y,e[8]=t.z}},{key:"getTrace",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wu,e=this.elements;return t.x=e[0],t.y=e[4],t.z=e[8],t}},{key:"vmult",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu,n=this.elements,i=t.x,r=t.y,a=t.z;return e.x=n[0]*i+n[1]*r+n[2]*a,e.y=n[3]*i+n[4]*r+n[5]*a,e.z=n[6]*i+n[7]*r+n[8]*a,e}},{key:"smult",value:function(t){for(var e=0;e<this.elements.length;e++)this.elements[e]*=t}},{key:"mmult",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=this.elements,r=e.elements,a=n.elements,o=i[0],s=i[1],l=i[2],u=i[3],h=i[4],c=i[5],d=i[6],f=i[7],p=i[8],v=r[0],m=r[1],g=r[2],y=r[3],_=r[4],x=r[5],b=r[6],w=r[7],S=r[8];return a[0]=o*v+s*y+l*b,a[1]=o*m+s*_+l*w,a[2]=o*g+s*x+l*S,a[3]=u*v+h*y+c*b,a[4]=u*m+h*_+c*w,a[5]=u*g+h*x+c*S,a[6]=d*v+f*y+p*b,a[7]=d*m+f*_+p*w,a[8]=d*g+f*x+p*S,n}},{key:"scale",value:function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=this.elements,r=n.elements,a=0;3!==a;a++)r[3*a+0]=e.x*i[3*a+0],r[3*a+1]=e.y*i[3*a+1],r[3*a+2]=e.z*i[3*a+2];return n}},{key:"solve",value:function(t){var e,n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu,r=3,a=4,o=[];for(e=0;e<r*a;e++)o.push(0);for(e=0;e<3;e++)for(n=0;n<3;n++)o[e+a*n]=this.elements[e+3*n];o[3]=t.x,o[7]=t.y,o[11]=t.z;var s,l,u=3,h=u,c=4;do{if(0===o[(e=h-u)+a*e])for(n=e+1;n<h;n++)if(0!==o[e+a*n]){s=c;do{o[(l=c-s)+a*e]+=o[l+a*n]}while(--s);break}if(0!==o[e+a*e])for(n=e+1;n<h;n++){var d=o[e+a*n]/o[e+a*e];s=c;do{o[(l=c-s)+a*n]=l<=e?0:o[l+a*n]-o[l+a*e]*d}while(--s)}}while(--u);if(i.z=o[2*a+3]/o[2*a+2],i.y=(o[1*a+3]-o[1*a+2]*i.z)/o[1*a+1],i.x=(o[0*a+3]-o[0*a+2]*i.z-o[0*a+1]*i.y)/o[0*a+0],isNaN(i.x)||isNaN(i.y)||isNaN(i.z)||i.x===1/0||i.y===1/0||i.z===1/0)throw"Could not solve equation! Got x=["+i.toString()+"], b=["+t.toString()+"], A=["+this.toString()+"]";return i}},{key:"e",value:function(t,e,n){if(void 0===n)return this.elements[e+3*t];this.elements[e+3*t]=n}},{key:"copy",value:function(t){for(var e=0;e<t.elements.length;e++)this.elements[e]=t.elements[e];return this}},{key:"toString",value:function(){for(var t="",e=0;e<9;e++)t+=this.elements[e]+",";return t}},{key:"reverse",value:function(){var e,n,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,r=3,a=6,o=bu;for(e=0;e<3;e++)for(n=0;n<3;n++)o[e+a*n]=this.elements[e+3*n];o[3]=1,o[9]=0,o[15]=0,o[4]=0,o[10]=1,o[16]=0,o[5]=0,o[11]=0,o[17]=1;var s,l,u=3,h=u,c=a;do{if(0===o[(e=h-u)+a*e])for(n=e+1;n<h;n++)if(0!==o[e+a*n]){s=c;do{o[(l=c-s)+a*e]+=o[l+a*n]}while(--s);break}if(0!==o[e+a*e])for(n=e+1;n<h;n++){var d=o[e+a*n]/o[e+a*e];s=c;do{o[(l=c-s)+a*n]=l<=e?0:o[l+a*n]-o[l+a*e]*d}while(--s)}}while(--u);e=2;do{n=e-1;do{var f=o[e+a*n]/o[e+a*e];s=a;do{o[(l=a-s)+a*n]=o[l+a*n]-o[l+a*e]*f}while(--s)}while(n--)}while(--e);e=2;do{var p=1/o[e+a*e];s=a;do{o[(l=a-s)+a*e]=o[l+a*e]*p}while(--s)}while(e--);e=2;do{n=2;do{if(l=o[r+n+a*e],isNaN(l)||l===1/0)throw"Could not reverse! A=["+this.toString()+"]";i.e(e,n,l)}while(n--)}while(e--);return i}},{key:"setRotationFromQuaternion",value:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,a=e+e,o=n+n,s=i+i,l=e*a,u=e*o,h=e*s,c=n*o,d=n*s,f=i*s,p=r*a,v=r*o,m=r*s,g=this.elements;return g[0]=1-(c+f),g[1]=u-m,g[2]=h+v,g[3]=u+m,g[4]=1-(l+f),g[5]=d-p,g[6]=h-v,g[7]=d+p,g[8]=1-(l+c),this}},{key:"transpose",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,i=this.elements,r=n.elements;return r[0]=i[0],r[4]=i[4],r[8]=i[8],e=i[1],r[1]=i[3],r[3]=e,e=i[2],r[2]=i[6],r[6]=e,e=i[5],r[5]=i[7],r[7]=e,n}}]),t}(),bu=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],wu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;a(this,t),this.x=void 0,this.y=void 0,this.z=void 0,this.x=e,this.y=n,this.z=i}return s(t,[{key:"cross",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=e.x,r=e.y,a=e.z,o=this.x,s=this.y,l=this.z;return n.x=s*a-l*r,n.y=l*i-o*a,n.z=o*r-s*i,n}},{key:"set",value:function(t,e,n){return this.x=t,this.y=e,this.z=n,this}},{key:"setZero",value:function(){this.x=this.y=this.z=0}},{key:"vadd",value:function(e,n){if(!n)return new t(this.x+e.x,this.y+e.y,this.z+e.z);n.x=e.x+this.x,n.y=e.y+this.y,n.z=e.z+this.z}},{key:"vsub",value:function(e,n){if(!n)return new t(this.x-e.x,this.y-e.y,this.z-e.z);n.x=this.x-e.x,n.y=this.y-e.y,n.z=this.z-e.z}},{key:"crossmat",value:function(){return new xu([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}},{key:"normalize",value:function(){var t=this.x,e=this.y,n=this.z,i=Math.sqrt(t*t+e*e+n*n);if(i>0){var r=1/i;this.x*=r,this.y*=r,this.z*=r}else this.x=0,this.y=0,this.z=0;return i}},{key:"unit",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,n=this.x,i=this.y,r=this.z,a=Math.sqrt(n*n+i*i+r*r);return a>0?(a=1/a,e.x=n*a,e.y=i*a,e.z=r*a):(e.x=1,e.y=0,e.z=0),e}},{key:"length",value:function(){var t=this.x,e=this.y,n=this.z;return Math.sqrt(t*t+e*e+n*n)}},{key:"lengthSquared",value:function(){return this.dot(this)}},{key:"distanceTo",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z;return Math.sqrt((r-e)*(r-e)+(a-n)*(a-n)+(o-i)*(o-i))}},{key:"distanceSquared",value:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,a=t.y,o=t.z;return(r-e)*(r-e)+(a-n)*(a-n)+(o-i)*(o-i)}},{key:"scale",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=this.x,r=this.y,a=this.z;return n.x=e*i,n.y=e*r,n.z=e*a,n}},{key:"vmul",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t;return n.x=e.x*this.x,n.y=e.y*this.y,n.z=e.z*this.z,n}},{key:"addScaledVector",value:function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t;return i.x=this.x+e*n.x,i.y=this.y+e*n.y,i.z=this.z+e*n.z,i}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"isZero",value:function(){return 0===this.x&&0===this.y&&0===this.z}},{key:"negate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.x=-this.x,e.y=-this.y,e.z=-this.z,e}},{key:"tangents",value:function(t,e){var n=this.length();if(n>0){var i=Su,r=1/n;i.set(this.x*r,this.y*r,this.z*r);var a=Tu;Math.abs(i.x)<.9?(a.set(1,0,0),i.cross(a,t)):(a.set(0,1,0),i.cross(a,t)),i.cross(t,e)}else t.set(1,0,0),e.set(0,1,0)}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z}},{key:"toArray",value:function(){return[this.x,this.y,this.z]}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"lerp",value:function(t,e,n){var i=this.x,r=this.y,a=this.z;n.x=i+(t.x-i)*e,n.y=r+(t.y-r)*e,n.z=a+(t.z-a)*e}},{key:"almostEquals",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-6;return!(Math.abs(this.x-t.x)>e||Math.abs(this.y-t.y)>e||Math.abs(this.z-t.z)>e)}},{key:"almostZero",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e-6;return!(Math.abs(this.x)>t||Math.abs(this.y)>t||Math.abs(this.z)>t)}},{key:"isAntiparallelTo",value:function(t,e){return this.negate(Mu),Mu.almostEquals(t,e)}},{key:"clone",value:function(){return new t(this.x,this.y,this.z)}}]),t}();wu.ZERO=void 0,wu.UNIT_X=void 0,wu.UNIT_Y=void 0,wu.UNIT_Z=void 0,wu.ZERO=new wu(0,0,0),wu.UNIT_X=new wu(1,0,0),wu.UNIT_Y=new wu(0,1,0),wu.UNIT_Z=new wu(0,0,1);var Su=new wu,Tu=new wu,Mu=new wu,Eu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.lowerBound=void 0,this.upperBound=void 0,this.lowerBound=new wu,this.upperBound=new wu,e.lowerBound&&this.lowerBound.copy(e.lowerBound),e.upperBound&&this.upperBound.copy(e.upperBound)}return s(t,[{key:"setFromPoints",value:function(t,e,n,i){var r=this.lowerBound,a=this.upperBound,o=n;r.copy(t[0]),o&&o.vmult(r,r),a.copy(r);for(var s=1;s<t.length;s++){var l=t[s];o&&(o.vmult(l,Au),l=Au),l.x>a.x&&(a.x=l.x),l.x<r.x&&(r.x=l.x),l.y>a.y&&(a.y=l.y),l.y<r.y&&(r.y=l.y),l.z>a.z&&(a.z=l.z),l.z<r.z&&(r.z=l.z)}return e&&(e.vadd(r,r),e.vadd(a,a)),i&&(r.x-=i,r.y-=i,r.z-=i,a.x+=i,a.y+=i,a.z+=i),this}},{key:"copy",value:function(t){return this.lowerBound.copy(t.lowerBound),this.upperBound.copy(t.upperBound),this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"extend",value:function(t){this.lowerBound.x=Math.min(this.lowerBound.x,t.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,t.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,t.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,t.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,t.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,t.upperBound.z)}},{key:"overlaps",value:function(t){var e=this.lowerBound,n=this.upperBound,i=t.lowerBound,r=t.upperBound,a=i.x<=n.x&&n.x<=r.x||e.x<=r.x&&r.x<=n.x,o=i.y<=n.y&&n.y<=r.y||e.y<=r.y&&r.y<=n.y,s=i.z<=n.z&&n.z<=r.z||e.z<=r.z&&r.z<=n.z;return a&&o&&s}},{key:"volume",value:function(){var t=this.lowerBound,e=this.upperBound;return(e.x-t.x)*(e.y-t.y)*(e.z-t.z)}},{key:"contains",value:function(t){var e=this.lowerBound,n=this.upperBound,i=t.lowerBound,r=t.upperBound;return e.x<=i.x&&n.x>=r.x&&e.y<=i.y&&n.y>=r.y&&e.z<=i.z&&n.z>=r.z}},{key:"getCorners",value:function(t,e,n,i,r,a,o,s){var l=this.lowerBound,u=this.upperBound;t.copy(l),e.set(u.x,l.y,l.z),n.set(u.x,u.y,l.z),i.set(l.x,u.y,u.z),r.set(u.x,l.y,u.z),a.set(l.x,u.y,l.z),o.set(l.x,l.y,u.z),s.copy(u)}},{key:"toLocalFrame",value:function(t,e){var n=Pu,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],h=n[7];this.getCorners(i,r,a,o,s,l,u,h);for(var c=0;8!==c;c++){var d=n[c];t.pointToLocal(d,d)}return e.setFromPoints(n)}},{key:"toWorldFrame",value:function(t,e){var n=Pu,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],u=n[6],h=n[7];this.getCorners(i,r,a,o,s,l,u,h);for(var c=0;8!==c;c++){var d=n[c];t.pointToWorld(d,d)}return e.setFromPoints(n)}},{key:"overlapsRay",value:function(t){var e=t.direction,n=t.from,i=1/e.x,r=1/e.y,a=1/e.z,o=(this.lowerBound.x-n.x)*i,s=(this.upperBound.x-n.x)*i,l=(this.lowerBound.y-n.y)*r,u=(this.upperBound.y-n.y)*r,h=(this.lowerBound.z-n.z)*a,c=(this.upperBound.z-n.z)*a,d=Math.max(Math.max(Math.min(o,s),Math.min(l,u)),Math.min(h,c)),f=Math.min(Math.min(Math.max(o,s),Math.max(l,u)),Math.max(h,c));return!(f<0)&&!(d>f)}}]),t}(),Au=new wu,Pu=[new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu],Cu=function(){function t(){a(this,t),this._listeners=void 0}return s(t,[{key:"addEventListener",value:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[t]&&(n[t]=[]),n[t].includes(e)||n[t].push(e),this}},{key:"hasEventListener",value:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return!(void 0===n[t]||!n[t].includes(e))}},{key:"hasAnyEventListener",value:function(t){return void 0!==this._listeners&&void 0!==this._listeners[t]}},{key:"removeEventListener",value:function(t,e){if(void 0===this._listeners)return this;var n=this._listeners;if(void 0===n[t])return this;var i=n[t].indexOf(e);return-1!==i&&n[t].splice(i,1),this}},{key:"dispatchEvent",value:function(t){if(void 0===this._listeners)return this;var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var n=0,i=e.length;n<i;n++)e[n].call(this,t)}return this}}]),t}(),ku=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;a(this,t),this.x=void 0,this.y=void 0,this.z=void 0,this.w=void 0,this.x=e,this.y=n,this.z=i,this.w=r}return s(t,[{key:"set",value:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}},{key:"toString",value:function(){return this.x+","+this.y+","+this.z+","+this.w}},{key:"toArray",value:function(){return[this.x,this.y,this.z,this.w]}},{key:"setFromAxisAngle",value:function(t,e){var n=Math.sin(.5*e);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Math.cos(.5*e),this}},{key:"toAxisAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wu;this.normalize();var e=2*Math.acos(this.w),n=Math.sqrt(1-this.w*this.w);return n<.001?(t.x=this.x,t.y=this.y,t.z=this.z):(t.x=this.x/n,t.y=this.y/n,t.z=this.z/n),[t,e]}},{key:"setFromVectors",value:function(t,e){if(t.isAntiparallelTo(e)){var n=Ru,i=Iu;t.tangents(n,i),this.setFromAxisAngle(n,Math.PI)}else{var r=t.cross(e);this.x=r.x,this.y=r.y,this.z=r.z,this.w=Math.sqrt(Math.pow(t.length(),2)*Math.pow(e.length(),2))+t.dot(e),this.normalize()}return this}},{key:"mult",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new t,i=this.x,r=this.y,a=this.z,o=this.w,s=e.x,l=e.y,u=e.z,h=e.w;return n.x=i*h+o*s+r*u-a*l,n.y=r*h+o*l+a*s-i*u,n.z=a*h+o*u+i*l-r*s,n.w=o*h-i*s-r*l-a*u,n}},{key:"inverse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t,n=this.x,i=this.y,r=this.z,a=this.w;this.conjugate(e);var o=1/(n*n+i*i+r*r+a*a);return e.x*=o,e.y*=o,e.z*=o,e.w*=o,e}},{key:"conjugate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new t;return e.x=-this.x,e.y=-this.y,e.z=-this.z,e.w=this.w,e}},{key:"normalize",value:function(){var t=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}},{key:"normalizeFast",value:function(){var t=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===t?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=t,this.y*=t,this.z*=t,this.w*=t),this}},{key:"vmult",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu,n=t.x,i=t.y,r=t.z,a=this.x,o=this.y,s=this.z,l=this.w,u=l*n+o*r-s*i,h=l*i+s*n-a*r,c=l*r+a*i-o*n,d=-a*n-o*i-s*r;return e.x=u*l+d*-a+h*-s-c*-o,e.y=h*l+d*-o+c*-a-u*-s,e.z=c*l+d*-s+u*-o-h*-a,e}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this}},{key:"toEuler",value:function(t){var e,n,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YZX",a=this.x,o=this.y,s=this.z,l=this.w;if("YZX"!==r)throw new Error("Euler order "+r+" not supported yet.");var u=a*o+s*l;if(u>.499&&(e=2*Math.atan2(a,l),n=Math.PI/2,i=0),u<-.499&&(e=-2*Math.atan2(a,l),n=-Math.PI/2,i=0),void 0===e){var h=a*a,c=o*o,d=s*s;e=Math.atan2(2*o*l-2*a*s,1-2*c-2*d),n=Math.asin(2*u),i=Math.atan2(2*a*l-2*o*s,1-2*h-2*d)}t.y=e,t.z=n,t.x=i}},{key:"setFromEuler",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"XYZ",r=Math.cos(t/2),a=Math.cos(e/2),o=Math.cos(n/2),s=Math.sin(t/2),l=Math.sin(e/2),u=Math.sin(n/2);return"XYZ"===i?(this.x=s*a*o+r*l*u,this.y=r*l*o-s*a*u,this.z=r*a*u+s*l*o,this.w=r*a*o-s*l*u):"YXZ"===i?(this.x=s*a*o+r*l*u,this.y=r*l*o-s*a*u,this.z=r*a*u-s*l*o,this.w=r*a*o+s*l*u):"ZXY"===i?(this.x=s*a*o-r*l*u,this.y=r*l*o+s*a*u,this.z=r*a*u+s*l*o,this.w=r*a*o-s*l*u):"ZYX"===i?(this.x=s*a*o-r*l*u,this.y=r*l*o+s*a*u,this.z=r*a*u-s*l*o,this.w=r*a*o+s*l*u):"YZX"===i?(this.x=s*a*o+r*l*u,this.y=r*l*o+s*a*u,this.z=r*a*u-s*l*o,this.w=r*a*o-s*l*u):"XZY"===i&&(this.x=s*a*o-r*l*u,this.y=r*l*o-s*a*u,this.z=r*a*u+s*l*o,this.w=r*a*o+s*l*u),this}},{key:"clone",value:function(){return new t(this.x,this.y,this.z,this.w)}},{key:"slerp",value:function(e,n){var i,r,a,o,s,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new t,u=this.x,h=this.y,c=this.z,d=this.w,f=e.x,p=e.y,v=e.z,m=e.w;return(r=u*f+h*p+c*v+d*m)<0&&(r=-r,f=-f,p=-p,v=-v,m=-m),1-r>1e-6?(i=Math.acos(r),a=Math.sin(i),o=Math.sin((1-n)*i)/a,s=Math.sin(n*i)/a):(o=1-n,s=n),l.x=o*u+s*f,l.y=o*h+s*p,l.z=o*c+s*v,l.w=o*d+s*m,l}},{key:"integrate",value:function(e,n,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new t,a=e.x*i.x,o=e.y*i.y,s=e.z*i.z,l=this.x,u=this.y,h=this.z,c=this.w,d=.5*n;return r.x+=d*(a*c+o*h-s*u),r.y+=d*(o*c+s*l-a*h),r.z+=d*(s*c+a*u-o*l),r.w+=d*(-a*l-o*u-s*h),r}}]),t}(),Ru=new wu,Iu=new wu,Du=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.id=void 0,this.type=void 0,this.boundingSphereRadius=void 0,this.collisionResponse=void 0,this.collisionFilterGroup=void 0,this.collisionFilterMask=void 0,this.material=void 0,this.body=void 0,this.id=t.idCounter++,this.type=e.type||0,this.boundingSphereRadius=0,this.collisionResponse=!e.collisionResponse||e.collisionResponse,this.collisionFilterGroup=void 0!==e.collisionFilterGroup?e.collisionFilterGroup:1,this.collisionFilterMask=void 0!==e.collisionFilterMask?e.collisionFilterMask:-1,this.material=e.material?e.material:null,this.body=null}return s(t,[{key:"updateBoundingSphereRadius",value:function(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}},{key:"volume",value:function(){throw"volume() not implemented for shape type "+this.type}},{key:"calculateLocalInertia",value:function(t,e){throw"calculateLocalInertia() not implemented for shape type "+this.type}},{key:"calculateWorldAABB",value:function(t,e,n,i){throw"calculateWorldAABB() not implemented for shape type "+this.type}}]),t}();Du.idCounter=0,Du.types={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};var Ou=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.position=void 0,this.quaternion=void 0,this.position=new wu,this.quaternion=new ku,e.position&&this.position.copy(e.position),e.quaternion&&this.quaternion.copy(e.quaternion)}return s(t,[{key:"pointToLocal",value:function(e,n){return t.pointToLocalFrame(this.position,this.quaternion,e,n)}},{key:"pointToWorld",value:function(e,n){return t.pointToWorldFrame(this.position,this.quaternion,e,n)}},{key:"vectorToWorldFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return this.quaternion.vmult(t,e),e}}],[{key:"pointToLocalFrame",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new wu;return n.vsub(t,i),e.conjugate(Lu),Lu.vmult(i,i),i}},{key:"pointToWorldFrame",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new wu;return e.vmult(n,i),i.vadd(t,i),i}},{key:"vectorToWorldFrame",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new wu;return t.vmult(e,n),n}},{key:"vectorToLocalFrame",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new wu;return e.w*=-1,e.vmult(n,i),e.w*=-1,i}}]),t}(),Lu=new ku,Nu=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,n);var r=i.vertices,o=void 0===r?[]:r,s=i.faces,l=void 0===s?[]:s,u=i.normals,h=void 0===u?[]:u,c=i.axes,d=i.boundingSphereRadius;return(t=e.call(this,{type:Du.types.CONVEXPOLYHEDRON})).vertices=void 0,t.faces=void 0,t.faceNormals=void 0,t.worldVertices=void 0,t.worldVerticesNeedsUpdate=void 0,t.worldFaceNormals=void 0,t.worldFaceNormalsNeedsUpdate=void 0,t.uniqueAxes=void 0,t.uniqueEdges=void 0,t.vertices=o,t.faces=l,t.faceNormals=h,0===t.faceNormals.length&&t.computeNormals(),d?t.boundingSphereRadius=d:t.updateBoundingSphereRadius(),t.worldVertices=[],t.worldVerticesNeedsUpdate=!0,t.worldFaceNormals=[],t.worldFaceNormalsNeedsUpdate=!0,t.uniqueAxes=c?c.slice():null,t.uniqueEdges=[],t.computeEdges(),t}return s(n,[{key:"computeEdges",value:function(){var t=this.faces,e=this.vertices,n=this.uniqueEdges;n.length=0;for(var i=new wu,r=0;r!==t.length;r++)for(var a=t[r],o=a.length,s=0;s!==o;s++){var l=(s+1)%o;e[a[s]].vsub(e[a[l]],i),i.normalize();for(var u=!1,h=0;h!==n.length;h++)if(n[h].almostEquals(i)||n[h].almostEquals(i)){u=!0;break}u||n.push(i.clone())}}},{key:"computeNormals",value:function(){this.faceNormals.length=this.faces.length;for(var t=0;t<this.faces.length;t++){for(var e=0;e<this.faces[t].length;e++)if(!this.vertices[this.faces[t][e]])throw new Error("Vertex "+this.faces[t][e]+" not found!");var n=this.faceNormals[t]||new wu;this.getFaceNormal(t,n),n.negate(n),this.faceNormals[t]=n;var i=this.vertices[this.faces[t][0]];if(n.dot(i)<0){console.error(".faceNormals["+t+"] = Vec3("+n.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(var r=0;r<this.faces[t].length;r++)console.warn(".vertices["+this.faces[t][r]+"] = Vec3("+this.vertices[this.faces[t][r]].toString()+")")}}}},{key:"getFaceNormal",value:function(t,e){var i=this.faces[t],r=this.vertices[i[0]],a=this.vertices[i[1]],o=this.vertices[i[2]];n.computeNormal(r,a,o,e)}},{key:"clipAgainstHull",value:function(t,e,n,i,r,a,o,s,l){for(var u=new wu,h=-1,c=-Number.MAX_VALUE,d=0;d<n.faces.length;d++){u.copy(n.faceNormals[d]),r.vmult(u,u);var f=u.dot(a);f>c&&(c=f,h=d)}for(var p=[],v=0;v<n.faces[h].length;v++){var m=n.vertices[n.faces[h][v]],g=new wu;g.copy(m),r.vmult(g,g),i.vadd(g,g),p.push(g)}h>=0&&this.clipFaceAgainstHull(a,t,e,p,o,s,l)}},{key:"findSeparatingAxis",value:function(t,e,n,i,r,a,o,s){var l=new wu,u=new wu,h=new wu,c=new wu,d=new wu,f=new wu,p=Number.MAX_VALUE,v=this;if(v.uniqueAxes)for(var m=0;m!==v.uniqueAxes.length;m++){n.vmult(v.uniqueAxes[m],l);var g=v.testSepAxis(l,t,e,n,i,r);if(!1===g)return!1;g<p&&(p=g,a.copy(l))}else for(var y=o?o.length:v.faces.length,_=0;_<y;_++){var x=o?o[_]:_;l.copy(v.faceNormals[x]),n.vmult(l,l);var b=v.testSepAxis(l,t,e,n,i,r);if(!1===b)return!1;b<p&&(p=b,a.copy(l))}if(t.uniqueAxes)for(var w=0;w!==t.uniqueAxes.length;w++){r.vmult(t.uniqueAxes[w],u);var S=v.testSepAxis(u,t,e,n,i,r);if(!1===S)return!1;S<p&&(p=S,a.copy(u))}else for(var T=s?s.length:t.faces.length,M=0;M<T;M++){var E=s?s[M]:M;u.copy(t.faceNormals[E]),r.vmult(u,u);var A=v.testSepAxis(u,t,e,n,i,r);if(!1===A)return!1;A<p&&(p=A,a.copy(u))}for(var P=0;P!==v.uniqueEdges.length;P++){n.vmult(v.uniqueEdges[P],c);for(var C=0;C!==t.uniqueEdges.length;C++)if(r.vmult(t.uniqueEdges[C],d),c.cross(d,f),!f.almostZero()){f.normalize();var k=v.testSepAxis(f,t,e,n,i,r);if(!1===k)return!1;k<p&&(p=k,a.copy(f))}}return i.vsub(e,h),h.dot(a)>0&&a.negate(a),!0}},{key:"testSepAxis",value:function(t,e,i,r,a,o){n.project(this,t,i,r,Fu),n.project(e,t,a,o,Bu);var s=Fu[0],l=Fu[1],u=Bu[0],h=Bu[1];if(s<h||u<l)return!1;var c=s-h,d=u-l;return c<d?c:d}},{key:"calculateLocalInertia",value:function(t,e){var n=new wu,i=new wu;this.computeLocalAABB(i,n);var r=n.x-i.x,a=n.y-i.y,o=n.z-i.z;e.x=1/12*t*(2*a*2*a+2*o*2*o),e.y=1/12*t*(2*r*2*r+2*o*2*o),e.z=1/12*t*(2*a*2*a+2*r*2*r)}},{key:"getPlaneConstantOfFace",value:function(t){var e=this.faces[t],n=this.faceNormals[t],i=this.vertices[e[0]];return-n.dot(i)}},{key:"clipFaceAgainstHull",value:function(t,e,n,i,r,a,o){for(var s=new wu,l=new wu,u=new wu,h=new wu,c=new wu,d=new wu,f=new wu,p=new wu,v=this,m=i,g=[],y=-1,_=Number.MAX_VALUE,x=0;x<v.faces.length;x++){s.copy(v.faceNormals[x]),n.vmult(s,s);var b=s.dot(t);b<_&&(_=b,y=x)}if(!(y<0)){var w=v.faces[y];w.connectedFaces=[];for(var S=0;S<v.faces.length;S++)for(var T=0;T<v.faces[S].length;T++)-1!==w.indexOf(v.faces[S][T])&&S!==y&&-1===w.connectedFaces.indexOf(S)&&w.connectedFaces.push(S);for(var M=w.length,E=0;E<M;E++){var A=v.vertices[w[E]],P=v.vertices[w[(E+1)%M]];A.vsub(P,l),u.copy(l),n.vmult(u,u),e.vadd(u,u),h.copy(this.faceNormals[y]),n.vmult(h,h),e.vadd(h,h),u.cross(h,c),c.negate(c),d.copy(A),n.vmult(d,d),e.vadd(d,d);var C=w.connectedFaces[E];f.copy(this.faceNormals[C]);var k=this.getPlaneConstantOfFace(C);p.copy(f),n.vmult(p,p);var R=k-p.dot(e);for(this.clipFaceAgainstPlane(m,g,p,R);m.length;)m.shift();for(;g.length;)m.push(g.shift())}f.copy(this.faceNormals[y]);var I=this.getPlaneConstantOfFace(y);p.copy(f),n.vmult(p,p);for(var D=I-p.dot(e),O=0;O<m.length;O++){var L=p.dot(m[O])+D;if(L<=r&&(console.log("clamped: depth="+L+" to minDist="+r),L=r),L<=a){var N=m[O];if(L<=1e-6){var F={point:N,normal:p,depth:L};o.push(F)}}}}}},{key:"clipFaceAgainstPlane",value:function(t,e,n,i){var r,a,o=t.length;if(o<2)return e;var s=t[t.length-1],l=t[0];r=n.dot(s)+i;for(var u=0;u<o;u++){if(l=t[u],a=n.dot(l)+i,r<0)if(a<0){var h=new wu;h.copy(l),e.push(h)}else{var c=new wu;s.lerp(l,r/(r-a),c),e.push(c)}else if(a<0){var d=new wu;s.lerp(l,r/(r-a),d),e.push(d),e.push(l)}s=l,r=a}return e}},{key:"computeWorldVertices",value:function(t,e){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new wu);for(var n=this.vertices,i=this.worldVertices,r=0;r!==this.vertices.length;r++)e.vmult(n[r],i[r]),t.vadd(i[r],i[r]);this.worldVerticesNeedsUpdate=!1}},{key:"computeLocalAABB",value:function(t,e){var n=this.vertices;t.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),e.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(var i=0;i<this.vertices.length;i++){var r=n[i];r.x<t.x?t.x=r.x:r.x>e.x&&(e.x=r.x),r.y<t.y?t.y=r.y:r.y>e.y&&(e.y=r.y),r.z<t.z?t.z=r.z:r.z>e.z&&(e.z=r.z)}}},{key:"computeWorldFaceNormals",value:function(t){for(var e=this.faceNormals.length;this.worldFaceNormals.length<e;)this.worldFaceNormals.push(new wu);for(var n=this.faceNormals,i=this.worldFaceNormals,r=0;r!==e;r++)t.vmult(n[r],i[r]);this.worldFaceNormalsNeedsUpdate=!1}},{key:"updateBoundingSphereRadius",value:function(){for(var t=0,e=this.vertices,n=0;n!==e.length;n++){var i=e[n].lengthSquared();i>t&&(t=i)}this.boundingSphereRadius=Math.sqrt(t)}},{key:"calculateWorldAABB",value:function(t,e,n,i){for(var r,a,o,s,l,u,h=this.vertices,c=new wu,d=0;d<h.length;d++){c.copy(h[d]),e.vmult(c,c),t.vadd(c,c);var f=c;(void 0===r||f.x<r)&&(r=f.x),(void 0===s||f.x>s)&&(s=f.x),(void 0===a||f.y<a)&&(a=f.y),(void 0===l||f.y>l)&&(l=f.y),(void 0===o||f.z<o)&&(o=f.z),(void 0===u||f.z>u)&&(u=f.z)}n.set(r,a,o),i.set(s,l,u)}},{key:"volume",value:function(){return 4*Math.PI*this.boundingSphereRadius/3}},{key:"getAveragePointLocal",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wu,e=this.vertices,n=0;n<e.length;n++)t.vadd(e[n],t);return t.scale(1/e.length,t),t}},{key:"transformAllPoints",value:function(t,e){var n=this.vertices.length,i=this.vertices;if(e){for(var r=0;r<n;r++){var a=i[r];e.vmult(a,a)}for(var o=0;o<this.faceNormals.length;o++){var s=this.faceNormals[o];e.vmult(s,s)}}if(t)for(var l=0;l<n;l++){var u=i[l];u.vadd(t,u)}}},{key:"pointIsInside",value:function(t){var e=this.vertices,n=this.faces,i=this.faceNormals,r=new wu;this.getAveragePointLocal(r);for(var a=0;a<this.faces.length;a++){var o=i[a],s=e[n[a][0]],l=new wu;t.vsub(s,l);var u=o.dot(l),h=new wu;r.vsub(s,h);var c=o.dot(h);if(u<0&&c>0||u>0&&c<0)return!1}return-1}}],[{key:"computeNormal",value:function(t,e,n,i){var r=new wu,a=new wu;e.vsub(t,a),n.vsub(e,r),r.cross(a,i),i.isZero()||i.normalize()}},{key:"project",value:function(t,e,n,i,r){var a=t.vertices.length,o=Uu,s=0,l=0,u=Gu,h=t.vertices;u.setZero(),Ou.vectorToLocalFrame(n,i,e,o),Ou.pointToLocalFrame(n,i,u,u);var c=u.dot(o);l=s=h[0].dot(o);for(var d=1;d<a;d++){var f=h[d].dot(o);f>s&&(s=f),f<l&&(l=f)}if((l-=c)>(s-=c)){var p=l;l=s,s=p}r[0]=s,r[1]=l}}]),n}(Du),Fu=[],Bu=[],Uu=new wu,Gu=new wu,zu=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this,{type:Du.types.BOX})).halfExtents=void 0,i.convexPolyhedronRepresentation=void 0,i.halfExtents=t,i.convexPolyhedronRepresentation=null,i.updateConvexPolyhedronRepresentation(),i.updateBoundingSphereRadius(),i}return s(n,[{key:"updateConvexPolyhedronRepresentation",value:function(){var t=this.halfExtents.x,e=this.halfExtents.y,n=this.halfExtents.z,i=wu,r=[new i(-t,-e,-n),new i(t,-e,-n),new i(t,e,-n),new i(-t,e,-n),new i(-t,-e,n),new i(t,-e,n),new i(t,e,n),new i(-t,e,n)],a=[new i(0,0,1),new i(0,1,0),new i(1,0,0)],o=new Nu({vertices:r,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:a});this.convexPolyhedronRepresentation=o,o.material=this.material}},{key:"calculateLocalInertia",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return n.calculateInertia(this.halfExtents,t,e),e}},{key:"getSideNormals",value:function(t,e){var n=t,i=this.halfExtents;if(n[0].set(i.x,0,0),n[1].set(0,i.y,0),n[2].set(0,0,i.z),n[3].set(-i.x,0,0),n[4].set(0,-i.y,0),n[5].set(0,0,-i.z),void 0!==e)for(var r=0;r!==n.length;r++)e.vmult(n[r],n[r]);return n}},{key:"volume",value:function(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}},{key:"updateBoundingSphereRadius",value:function(){this.boundingSphereRadius=this.halfExtents.length()}},{key:"forEachWorldCorner",value:function(t,e,n){for(var i=this.halfExtents,r=[[i.x,i.y,i.z],[-i.x,i.y,i.z],[-i.x,-i.y,i.z],[-i.x,-i.y,-i.z],[i.x,-i.y,-i.z],[i.x,i.y,-i.z],[-i.x,i.y,-i.z],[i.x,-i.y,i.z]],a=0;a<r.length;a++)Hu.set(r[a][0],r[a][1],r[a][2]),e.vmult(Hu,Hu),t.vadd(Hu,Hu),n(Hu.x,Hu.y,Hu.z)}},{key:"calculateWorldAABB",value:function(t,e,n,i){var r=this.halfExtents;Vu[0].set(r.x,r.y,r.z),Vu[1].set(-r.x,r.y,r.z),Vu[2].set(-r.x,-r.y,r.z),Vu[3].set(-r.x,-r.y,-r.z),Vu[4].set(r.x,-r.y,-r.z),Vu[5].set(r.x,r.y,-r.z),Vu[6].set(-r.x,r.y,-r.z),Vu[7].set(r.x,-r.y,r.z);var a=Vu[0];e.vmult(a,a),t.vadd(a,a),i.copy(a),n.copy(a);for(var o=1;o<8;o++){var s=Vu[o];e.vmult(s,s),t.vadd(s,s);var l=s.x,u=s.y,h=s.z;l>i.x&&(i.x=l),u>i.y&&(i.y=u),h>i.z&&(i.z=h),l<n.x&&(n.x=l),u<n.y&&(n.y=u),h<n.z&&(n.z=h)}}}],[{key:"calculateInertia",value:function(t,e,n){var i=t;n.x=1/12*e*(2*i.y*2*i.y+2*i.z*2*i.z),n.y=1/12*e*(2*i.x*2*i.x+2*i.z*2*i.z),n.z=1/12*e*(2*i.y*2*i.y+2*i.x*2*i.x)}}]),n}(Du),Hu=new wu,Vu=[new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu],ju=1,Xu=2,Wu=4,qu=0,Yu=1,Ku=2,Zu=function(t){d(n,t);var e=m(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,n),(t=e.call(this)).id=void 0,t.index=void 0,t.world=void 0,t.preStep=void 0,t.postStep=void 0,t.vlambda=void 0,t.collisionFilterGroup=void 0,t.collisionFilterMask=void 0,t.collisionResponse=void 0,t.position=void 0,t.previousPosition=void 0,t.interpolatedPosition=void 0,t.initPosition=void 0,t.velocity=void 0,t.initVelocity=void 0,t.force=void 0,t.mass=void 0,t.invMass=void 0,t.material=void 0,t.linearDamping=void 0,t.type=void 0,t.allowSleep=void 0,t.sleepState=void 0,t.sleepSpeedLimit=void 0,t.sleepTimeLimit=void 0,t.timeLastSleepy=void 0,t.wakeUpAfterNarrowphase=void 0,t.torque=void 0,t.quaternion=void 0,t.initQuaternion=void 0,t.previousQuaternion=void 0,t.interpolatedQuaternion=void 0,t.angularVelocity=void 0,t.initAngularVelocity=void 0,t.shapes=void 0,t.shapeOffsets=void 0,t.shapeOrientations=void 0,t.inertia=void 0,t.invInertia=void 0,t.invInertiaWorld=void 0,t.invMassSolve=void 0,t.invInertiaSolve=void 0,t.invInertiaWorldSolve=void 0,t.fixedRotation=void 0,t.angularDamping=void 0,t.linearFactor=void 0,t.angularFactor=void 0,t.aabb=void 0,t.aabbNeedsUpdate=void 0,t.boundingRadius=void 0,t.wlambda=void 0,t.isTrigger=void 0,t.id=n.idCounter++,t.index=-1,t.world=null,t.preStep=null,t.postStep=null,t.vlambda=new wu,t.collisionFilterGroup="number"===typeof i.collisionFilterGroup?i.collisionFilterGroup:1,t.collisionFilterMask="number"===typeof i.collisionFilterMask?i.collisionFilterMask:-1,t.collisionResponse="boolean"!==typeof i.collisionResponse||i.collisionResponse,t.position=new wu,t.previousPosition=new wu,t.interpolatedPosition=new wu,t.initPosition=new wu,i.position&&(t.position.copy(i.position),t.previousPosition.copy(i.position),t.interpolatedPosition.copy(i.position),t.initPosition.copy(i.position)),t.velocity=new wu,i.velocity&&t.velocity.copy(i.velocity),t.initVelocity=new wu,t.force=new wu;var r="number"===typeof i.mass?i.mass:0;return t.mass=r,t.invMass=r>0?1/r:0,t.material=i.material||null,t.linearDamping="number"===typeof i.linearDamping?i.linearDamping:.01,t.type=r<=0?n.STATIC:n.DYNAMIC,typeof i.type===typeof n.STATIC&&(t.type=i.type),t.allowSleep="undefined"===typeof i.allowSleep||i.allowSleep,t.sleepState=n.AWAKE,t.sleepSpeedLimit="undefined"!==typeof i.sleepSpeedLimit?i.sleepSpeedLimit:.1,t.sleepTimeLimit="undefined"!==typeof i.sleepTimeLimit?i.sleepTimeLimit:1,t.timeLastSleepy=0,t.wakeUpAfterNarrowphase=!1,t.torque=new wu,t.quaternion=new ku,t.initQuaternion=new ku,t.previousQuaternion=new ku,t.interpolatedQuaternion=new ku,i.quaternion&&(t.quaternion.copy(i.quaternion),t.initQuaternion.copy(i.quaternion),t.previousQuaternion.copy(i.quaternion),t.interpolatedQuaternion.copy(i.quaternion)),t.angularVelocity=new wu,i.angularVelocity&&t.angularVelocity.copy(i.angularVelocity),t.initAngularVelocity=new wu,t.shapes=[],t.shapeOffsets=[],t.shapeOrientations=[],t.inertia=new wu,t.invInertia=new wu,t.invInertiaWorld=new xu,t.invMassSolve=0,t.invInertiaSolve=new wu,t.invInertiaWorldSolve=new xu,t.fixedRotation="undefined"!==typeof i.fixedRotation&&i.fixedRotation,t.angularDamping="undefined"!==typeof i.angularDamping?i.angularDamping:.01,t.linearFactor=new wu(1,1,1),i.linearFactor&&t.linearFactor.copy(i.linearFactor),t.angularFactor=new wu(1,1,1),i.angularFactor&&t.angularFactor.copy(i.angularFactor),t.aabb=new Eu,t.aabbNeedsUpdate=!0,t.boundingRadius=0,t.wlambda=new wu,t.isTrigger=Boolean(i.isTrigger),i.shape&&t.addShape(i.shape),t.updateMassProperties(),t}return s(n,[{key:"wakeUp",value:function(){var t=this.sleepState;this.sleepState=n.AWAKE,this.wakeUpAfterNarrowphase=!1,t===n.SLEEPING&&this.dispatchEvent(n.wakeupEvent)}},{key:"sleep",value:function(){this.sleepState=n.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}},{key:"sleepTick",value:function(t){if(this.allowSleep){var e=this.sleepState,i=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),r=Math.pow(this.sleepSpeedLimit,2);e===n.AWAKE&&i<r?(this.sleepState=n.SLEEPY,this.timeLastSleepy=t,this.dispatchEvent(n.sleepyEvent)):e===n.SLEEPY&&i>r?this.wakeUp():e===n.SLEEPY&&t-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(n.sleepEvent))}}},{key:"updateSolveMassProperties",value:function(){this.sleepState===n.SLEEPING||this.type===n.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}},{key:"pointToLocalFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return t.vsub(this.position,e),this.quaternion.conjugate().vmult(e,e),e}},{key:"vectorToLocalFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return this.quaternion.conjugate().vmult(t,e),e}},{key:"pointToWorldFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return this.quaternion.vmult(t,e),e.vadd(this.position,e),e}},{key:"vectorToWorldFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;return this.quaternion.vmult(t,e),e}},{key:"addShape",value:function(t,e,n){var i=new wu,r=new ku;return e&&i.copy(e),n&&r.copy(n),this.shapes.push(t),this.shapeOffsets.push(i),this.shapeOrientations.push(r),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=this,this}},{key:"removeShape",value:function(t){var e=this.shapes.indexOf(t);return-1===e?(console.warn("Shape does not belong to the body"),this):(this.shapes.splice(e,1),this.shapeOffsets.splice(e,1),this.shapeOrientations.splice(e,1),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,t.body=null,this)}},{key:"updateBoundingRadius",value:function(){for(var t=this.shapes,e=this.shapeOffsets,n=t.length,i=0,r=0;r!==n;r++){var a=t[r];a.updateBoundingSphereRadius();var o=e[r].length(),s=a.boundingSphereRadius;o+s>i&&(i=o+s)}this.boundingRadius=i}},{key:"updateAABB",value:function(){for(var t=this.shapes,e=this.shapeOffsets,n=this.shapeOrientations,i=t.length,r=Ju,a=Qu,o=this.quaternion,s=this.aabb,l=$u,u=0;u!==i;u++){var h=t[u];o.vmult(e[u],r),r.vadd(this.position,r),o.mult(n[u],a),h.calculateWorldAABB(r,a,l.lowerBound,l.upperBound),0===u?s.copy(l):s.extend(l)}this.aabbNeedsUpdate=!1}},{key:"updateInertiaWorld",value:function(t){var e=this.invInertia;if(e.x!==e.y||e.y!==e.z||t){var n=th,i=eh;n.setRotationFromQuaternion(this.quaternion),n.transpose(i),n.scale(e,n),n.mmult(i,this.invInertiaWorld)}else;}},{key:"applyForce",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var i=nh;e.cross(t,i),this.force.vadd(t,this.force),this.torque.vadd(i,this.torque)}}},{key:"applyLocalForce",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;if(this.type===n.DYNAMIC){var i=ih,r=rh;this.vectorToWorldFrame(t,i),this.vectorToWorldFrame(e,r),this.applyForce(i,r)}}},{key:"applyTorque",value:function(t){this.type===n.DYNAMIC&&(this.sleepState===n.SLEEPING&&this.wakeUp(),this.torque.vadd(t,this.torque))}},{key:"applyImpulse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;if(this.type===n.DYNAMIC){this.sleepState===n.SLEEPING&&this.wakeUp();var i=e,r=ah;r.copy(t),r.scale(this.invMass,r),this.velocity.vadd(r,this.velocity);var a=oh;i.cross(t,a),this.invInertiaWorld.vmult(a,a),this.angularVelocity.vadd(a,this.angularVelocity)}}},{key:"applyLocalImpulse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;if(this.type===n.DYNAMIC){var i=sh,r=lh;this.vectorToWorldFrame(t,i),this.vectorToWorldFrame(e,r),this.applyImpulse(i,r)}}},{key:"updateMassProperties",value:function(){var t=uh;this.invMass=this.mass>0?1/this.mass:0;var e=this.inertia,n=this.fixedRotation;this.updateAABB(),t.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),zu.calculateInertia(t,this.mass,e),this.invInertia.set(e.x>0&&!n?1/e.x:0,e.y>0&&!n?1/e.y:0,e.z>0&&!n?1/e.z:0),this.updateInertiaWorld(!0)}},{key:"getVelocityAtWorldPoint",value:function(t,e){var n=new wu;return t.vsub(this.position,n),this.angularVelocity.cross(n,e),this.velocity.vadd(e,e),e}},{key:"integrate",value:function(t,e,i){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),(this.type===n.DYNAMIC||this.type===n.KINEMATIC)&&this.sleepState!==n.SLEEPING){var r=this.velocity,a=this.angularVelocity,o=this.position,s=this.force,l=this.torque,u=this.quaternion,h=this.invMass,c=this.invInertiaWorld,d=this.linearFactor,f=h*t;r.x+=s.x*f*d.x,r.y+=s.y*f*d.y,r.z+=s.z*f*d.z;var p=c.elements,v=this.angularFactor,m=l.x*v.x,g=l.y*v.y,y=l.z*v.z;a.x+=t*(p[0]*m+p[1]*g+p[2]*y),a.y+=t*(p[3]*m+p[4]*g+p[5]*y),a.z+=t*(p[6]*m+p[7]*g+p[8]*y),o.x+=r.x*t,o.y+=r.y*t,o.z+=r.z*t,u.integrate(this.angularVelocity,t,this.angularFactor,u),e&&(i?u.normalizeFast():u.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}}]),n}(Cu);Zu.idCounter=0,Zu.COLLIDE_EVENT_NAME="collide",Zu.DYNAMIC=ju,Zu.STATIC=Xu,Zu.KINEMATIC=Wu,Zu.AWAKE=qu,Zu.SLEEPY=Yu,Zu.SLEEPING=Ku,Zu.wakeupEvent={type:"wakeup"},Zu.sleepyEvent={type:"sleepy"},Zu.sleepEvent={type:"sleep"};var Ju=new wu,Qu=new ku,$u=new Eu,th=new xu,eh=new xu,nh=new wu,ih=new wu,rh=new wu,ah=new wu,oh=new wu,sh=new wu,lh=new wu,uh=new wu,hh=(new wu,new wu,function(){function t(){a(this,t),this.rayFromWorld=void 0,this.rayToWorld=void 0,this.hitNormalWorld=void 0,this.hitPointWorld=void 0,this.hasHit=void 0,this.shape=void 0,this.body=void 0,this.hitFaceIndex=void 0,this.distance=void 0,this.shouldStop=void 0,this.rayFromWorld=new wu,this.rayToWorld=new wu,this.hitNormalWorld=new wu,this.hitPointWorld=new wu,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}return s(t,[{key:"reset",value:function(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}},{key:"abort",value:function(){this.shouldStop=!0}},{key:"set",value:function(t,e,n,i,r,a,o){this.rayFromWorld.copy(t),this.rayToWorld.copy(e),this.hitNormalWorld.copy(n),this.hitPointWorld.copy(i),this.shape=r,this.body=a,this.distance=o}}]),t}()),ch=1,dh=2,fh=4,ph=function(t,e,n,i,r,o,l){function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new wu,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wu;a(this,u),this.from=void 0,this.to=void 0,this.direction=void 0,this.precision=void 0,this.checkCollisionResponse=void 0,this.skipBackfaces=void 0,this.collisionFilterMask=void 0,this.collisionFilterGroup=void 0,this.mode=void 0,this.result=void 0,this.hasHit=void 0,this.callback=void 0,this.from=t.clone(),this.to=e.clone(),this.direction=new wu,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=u.ANY,this.result=new hh,this.hasHit=!1,this.callback=function(t){}}return s(u,[{key:t,get:function(){return this._intersectSphere}},{key:e,get:function(){return this._intersectPlane}},{key:n,get:function(){return this._intersectBox}},{key:i,get:function(){return this._intersectConvex}},{key:r,get:function(){return this._intersectConvex}},{key:o,get:function(){return this._intersectHeightfield}},{key:l,get:function(){return this._intersectTrimesh}},{key:"intersectWorld",value:function(t,e){return this.mode=e.mode||u.ANY,this.result=e.result||new hh,this.skipBackfaces=!!e.skipBackfaces,this.collisionFilterMask="undefined"!==typeof e.collisionFilterMask?e.collisionFilterMask:-1,this.collisionFilterGroup="undefined"!==typeof e.collisionFilterGroup?e.collisionFilterGroup:-1,this.checkCollisionResponse="undefined"===typeof e.checkCollisionResponse||e.checkCollisionResponse,e.from&&this.from.copy(e.from),e.to&&this.to.copy(e.to),this.callback=e.callback||function(){},this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(vh),mh.length=0,t.broadphase.aabbQuery(t,vh,mh),this.intersectBodies(mh),this.hasHit}},{key:"intersectBody",value:function(t,e){e&&(this.result=e,this.updateDirection());var n=this.checkCollisionResponse;if((!n||t.collisionResponse)&&0!==(this.collisionFilterGroup&t.collisionFilterMask)&&0!==(t.collisionFilterGroup&this.collisionFilterMask))for(var i=_h,r=xh,a=0,o=t.shapes.length;a<o;a++){var s=t.shapes[a];if((!n||s.collisionResponse)&&(t.quaternion.mult(t.shapeOrientations[a],r),t.quaternion.vmult(t.shapeOffsets[a],i),i.vadd(t.position,i),this.intersectShape(s,r,i,t),this.result.shouldStop))break}}},{key:"intersectBodies",value:function(t,e){e&&(this.result=e,this.updateDirection());for(var n=0,i=t.length;!this.result.shouldStop&&n<i;n++)this.intersectBody(t[n])}},{key:"updateDirection",value:function(){this.to.vsub(this.from,this.direction),this.direction.normalize()}},{key:"intersectShape",value:function(t,e,n,i){var r=function(t,e,n){n.vsub(t,zh);var i=zh.dot(e);return e.scale(i,Hh),Hh.vadd(t,Hh),n.distanceTo(Hh)}(this.from,this.direction,n);if(!(r>t.boundingSphereRadius)){var a=this[t.type];a&&a.call(this,t,e,n,i,t)}}},{key:"_intersectBox",value:function(t,e,n,i,r){return this._intersectConvex(t.convexPolyhedronRepresentation,e,n,i,r)}},{key:"_intersectPlane",value:function(t,e,n,i,r){var a=this.from,o=this.to,s=this.direction,l=new wu(0,0,1);e.vmult(l,l);var u=new wu;a.vsub(n,u);var h=u.dot(l);if(o.vsub(n,u),!(h*u.dot(l)>0)&&!(a.distanceTo(o)<h)){var c=l.dot(s);if(!(Math.abs(c)<this.precision)){var d=new wu,f=new wu,p=new wu;a.vsub(n,d);var v=-l.dot(d)/c;s.scale(v,f),a.vadd(f,p),this.reportIntersection(l,p,r,i,-1)}}}},{key:"getAABB",value:function(t){var e=t.lowerBound,n=t.upperBound,i=this.to,r=this.from;e.x=Math.min(i.x,r.x),e.y=Math.min(i.y,r.y),e.z=Math.min(i.z,r.z),n.x=Math.max(i.x,r.x),n.y=Math.max(i.y,r.y),n.z=Math.max(i.z,r.z)}},{key:"_intersectHeightfield",value:function(t,e,n,i,r){t.data,t.elementSize;var a=Ah;a.from.copy(this.from),a.to.copy(this.to),Ou.pointToLocalFrame(n,e,a.from,a.from),Ou.pointToLocalFrame(n,e,a.to,a.to),a.updateDirection();var o,s,l,u,h=Ph;o=s=0,l=u=t.data.length-1;var c=new Eu;a.getAABB(c),t.getIndexOfPosition(c.lowerBound.x,c.lowerBound.y,h,!0),o=Math.max(o,h[0]),s=Math.max(s,h[1]),t.getIndexOfPosition(c.upperBound.x,c.upperBound.y,h,!0),l=Math.min(l,h[0]+1),u=Math.min(u,h[1]+1);for(var d=o;d<l;d++)for(var f=s;f<u;f++){if(this.result.shouldStop)return;if(t.getAabbAtIndex(d,f,c),c.overlapsRay(a)){if(t.getConvexTrianglePillar(d,f,!1),Ou.pointToWorldFrame(n,e,t.pillarOffset,Eh),this._intersectConvex(t.pillarConvex,e,Eh,i,r,Mh),this.result.shouldStop)return;t.getConvexTrianglePillar(d,f,!0),Ou.pointToWorldFrame(n,e,t.pillarOffset,Eh),this._intersectConvex(t.pillarConvex,e,Eh,i,r,Mh)}}}},{key:"_intersectSphere",value:function(t,e,n,i,r){var a=this.from,o=this.to,s=t.radius,l=Math.pow(o.x-a.x,2)+Math.pow(o.y-a.y,2)+Math.pow(o.z-a.z,2),u=2*((o.x-a.x)*(a.x-n.x)+(o.y-a.y)*(a.y-n.y)+(o.z-a.z)*(a.z-n.z)),h=Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2)+Math.pow(a.z-n.z,2)-Math.pow(s,2),c=Math.pow(u,2)-4*l*h,d=Ch,f=kh;if(!(c<0))if(0===c)a.lerp(o,c,d),d.vsub(n,f),f.normalize(),this.reportIntersection(f,d,r,i,-1);else{var p=(-u-Math.sqrt(c))/(2*l),v=(-u+Math.sqrt(c))/(2*l);if(p>=0&&p<=1&&(a.lerp(o,p,d),d.vsub(n,f),f.normalize(),this.reportIntersection(f,d,r,i,-1)),this.result.shouldStop)return;v>=0&&v<=1&&(a.lerp(o,v,d),d.vsub(n,f),f.normalize(),this.reportIntersection(f,d,r,i,-1))}}},{key:"_intersectConvex",value:function(t,e,n,i,r,a){for(var o=Rh,s=Ih,l=a&&a.faceList||null,h=t.faces,c=t.vertices,d=t.faceNormals,f=this.direction,p=this.from,v=this.to,m=p.distanceTo(v),g=l?l.length:h.length,y=this.result,_=0;!y.shouldStop&&_<g;_++){var x=l?l[_]:_,b=h[x],w=d[x],S=e,T=n;s.copy(c[b[0]]),S.vmult(s,s),s.vadd(T,s),s.vsub(p,s),S.vmult(w,o);var M=f.dot(o);if(!(Math.abs(M)<this.precision)){var E=o.dot(s)/M;if(!(E<0)){f.scale(E,bh),bh.vadd(p,bh),wh.copy(c[b[0]]),S.vmult(wh,wh),T.vadd(wh,wh);for(var A=1;!y.shouldStop&&A<b.length-1;A++){Sh.copy(c[b[A]]),Th.copy(c[b[A+1]]),S.vmult(Sh,Sh),S.vmult(Th,Th),T.vadd(Sh,Sh),T.vadd(Th,Th);var P=bh.distanceTo(p);!u.pointInTriangle(bh,wh,Sh,Th)&&!u.pointInTriangle(bh,Sh,wh,Th)||P>m||this.reportIntersection(o,bh,r,i,x)}}}}}},{key:"_intersectTrimesh",value:function(t,e,n,i,r,a){var o=Dh,s=Uh,l=Gh,h=Ih,c=Oh,d=Lh,f=Nh,p=Bh,v=Fh,m=t.indices;t.vertices;var g=this.from,y=this.to,_=this.direction;l.position.copy(n),l.quaternion.copy(e),Ou.vectorToLocalFrame(n,e,_,c),Ou.pointToLocalFrame(n,e,g,d),Ou.pointToLocalFrame(n,e,y,f),f.x*=t.scale.x,f.y*=t.scale.y,f.z*=t.scale.z,d.x*=t.scale.x,d.y*=t.scale.y,d.z*=t.scale.z,f.vsub(d,c),c.normalize();var x=d.distanceSquared(f);t.tree.rayQuery(this,l,s);for(var b=0,w=s.length;!this.result.shouldStop&&b!==w;b++){var S=s[b];t.getNormal(S,o),t.getVertex(m[3*S],wh),wh.vsub(d,h);var T=c.dot(o),M=o.dot(h)/T;if(!(M<0)){c.scale(M,bh),bh.vadd(d,bh),t.getVertex(m[3*S+1],Sh),t.getVertex(m[3*S+2],Th);var E=bh.distanceSquared(d);!u.pointInTriangle(bh,Sh,wh,Th)&&!u.pointInTriangle(bh,wh,Sh,Th)||E>x||(Ou.vectorToWorldFrame(e,o,v),Ou.pointToWorldFrame(n,e,bh,p),this.reportIntersection(v,p,r,i,S))}}s.length=0}},{key:"reportIntersection",value:function(t,e,n,i,r){var a=this.from,o=this.to,s=a.distanceTo(e),l=this.result;if(!(this.skipBackfaces&&t.dot(this.direction)>0))switch(l.hitFaceIndex="undefined"!==typeof r?r:-1,this.mode){case u.ALL:this.hasHit=!0,l.set(a,o,t,e,n,i,s),l.hasHit=!0,this.callback(l);break;case u.CLOSEST:(s<l.distance||!l.hasHit)&&(this.hasHit=!0,l.hasHit=!0,l.set(a,o,t,e,n,i,s));break;case u.ANY:this.hasHit=!0,l.hasHit=!0,l.set(a,o,t,e,n,i,s),l.shouldStop=!0}}}],[{key:"pointInTriangle",value:function(t,e,n,i){i.vsub(e,zh),n.vsub(e,gh),t.vsub(e,yh);var r,a,o=zh.dot(zh),s=zh.dot(gh),l=zh.dot(yh),u=gh.dot(gh),h=gh.dot(yh);return(r=u*l-s*h)>=0&&(a=o*h-s*l)>=0&&r+a<o*u-s*s}}]),u}(Du.types.SPHERE,Du.types.PLANE,Du.types.BOX,Du.types.CYLINDER,Du.types.CONVEXPOLYHEDRON,Du.types.HEIGHTFIELD,Du.types.TRIMESH);ph.CLOSEST=ch,ph.ANY=dh,ph.ALL=fh;var vh=new Eu,mh=[],gh=new wu,yh=new wu,_h=new wu,xh=new ku,bh=new wu,wh=new wu,Sh=new wu,Th=new wu,Mh={faceList:[0]},Eh=new wu,Ah=new ph,Ph=[],Ch=new wu,kh=new wu,Rh=new wu,Ih=new wu,Dh=new wu,Oh=new wu,Lh=new wu,Nh=new wu,Fh=new wu,Bh=new wu;new Eu;var Uh=[],Gh=new Ou,zh=new wu,Hh=new wu;var Vh=function(){function t(){a(this,t)}return s(t,null,[{key:"defaults",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;for(var n in e)n in t||(t[n]=e[n]);return t}}]),t}(),jh=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a(this,t),this.equations=void 0,this.bodyA=void 0,this.bodyB=void 0,this.id=void 0,this.collideConnected=void 0,i=Vh.defaults(i,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=n,this.id=t.idCounter++,this.collideConnected=i.collideConnected,i.wakeUpBodies&&(e&&e.wakeUp(),n&&n.wakeUp())}return s(t,[{key:"update",value:function(){throw new Error("method update() not implmemented in this Constraint subclass!")}},{key:"enable",value:function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!0}},{key:"disable",value:function(){for(var t=this.equations,e=0;e<t.length;e++)t[e].enabled=!1}}]),t}();jh.idCounter=0;var Xh=function(){function t(){a(this,t),this.spatial=void 0,this.rotational=void 0,this.spatial=new wu,this.rotational=new wu}return s(t,[{key:"multiplyElement",value:function(t){return t.spatial.dot(this.spatial)+t.rotational.dot(this.rotational)}},{key:"multiplyVectors",value:function(t,e){return t.dot(this.spatial)+e.dot(this.rotational)}}]),t}(),Wh=function(){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1e6,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e6;a(this,t),this.id=void 0,this.minForce=void 0,this.maxForce=void 0,this.bi=void 0,this.bj=void 0,this.si=void 0,this.sj=void 0,this.a=void 0,this.b=void 0,this.eps=void 0,this.jacobianElementA=void 0,this.jacobianElementB=void 0,this.enabled=void 0,this.multiplier=void 0,this.id=t.idCounter++,this.minForce=i,this.maxForce=r,this.bi=e,this.bj=n,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new Xh,this.jacobianElementB=new Xh,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}return s(t,[{key:"setSpookParams",value:function(t,e,n){var i=e,r=t,a=n;this.a=4/(a*(1+4*i)),this.b=4*i/(1+4*i),this.eps=4/(a*a*r*(1+4*i))}},{key:"computeB",value:function(t,e,n){var i=this.computeGW();return-this.computeGq()*t-i*e-this.computeGiMf()*n}},{key:"computeGq",value:function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,i=this.bj,r=n.position,a=i.position;return t.spatial.dot(r)+e.spatial.dot(a)}},{key:"computeGW",value:function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,i=this.bj,r=n.velocity,a=i.velocity,o=n.angularVelocity,s=i.angularVelocity;return t.multiplyVectors(r,o)+e.multiplyVectors(a,s)}},{key:"computeGWlambda",value:function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,i=this.bj,r=n.vlambda,a=i.vlambda,o=n.wlambda,s=i.wlambda;return t.multiplyVectors(r,o)+e.multiplyVectors(a,s)}},{key:"computeGiMf",value:function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,i=this.bj,r=n.force,a=n.torque,o=i.force,s=i.torque,l=n.invMassSolve,u=i.invMassSolve;return r.scale(l,qh),o.scale(u,Yh),n.invInertiaWorldSolve.vmult(a,Kh),i.invInertiaWorldSolve.vmult(s,Zh),t.multiplyVectors(qh,Kh)+e.multiplyVectors(Yh,Zh)}},{key:"computeGiMGt",value:function(){var t=this.jacobianElementA,e=this.jacobianElementB,n=this.bi,i=this.bj,r=n.invMassSolve,a=i.invMassSolve,o=n.invInertiaWorldSolve,s=i.invInertiaWorldSolve,l=r+a;return o.vmult(t.rotational,Jh),l+=Jh.dot(t.rotational),s.vmult(e.rotational,Jh),l+=Jh.dot(e.rotational)}},{key:"addToWlambda",value:function(t){var e=this.jacobianElementA,n=this.jacobianElementB,i=this.bi,r=this.bj,a=Qh;i.vlambda.addScaledVector(i.invMassSolve*t,e.spatial,i.vlambda),r.vlambda.addScaledVector(r.invMassSolve*t,n.spatial,r.vlambda),i.invInertiaWorldSolve.vmult(e.rotational,a),i.wlambda.addScaledVector(t,a,i.wlambda),r.invInertiaWorldSolve.vmult(n.rotational,a),r.wlambda.addScaledVector(t,a,r.wlambda)}},{key:"computeC",value:function(){return this.computeGiMGt()+this.eps}}]),t}();Wh.idCounter=0;var qh=new wu,Yh=new wu,Kh=new wu,Zh=new wu,Jh=new wu,Qh=new wu,$h=(new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,s((function t(e,n,i){a(this,t),this.id=void 0,this.materials=void 0,this.friction=void 0,this.restitution=void 0,this.contactEquationStiffness=void 0,this.contactEquationRelaxation=void 0,this.frictionEquationStiffness=void 0,this.frictionEquationRelaxation=void 0,i=Vh.defaults(i,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=t.idCounter++,this.materials=[e,n],this.friction=i.friction,this.restitution=i.restitution,this.contactEquationStiffness=i.contactEquationStiffness,this.contactEquationRelaxation=i.contactEquationRelaxation,this.frictionEquationStiffness=i.frictionEquationStiffness,this.frictionEquationRelaxation=i.frictionEquationRelaxation})));$h.idCounter=0;var tc=s((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.name=void 0,this.id=void 0,this.friction=void 0,this.restitution=void 0;var n="";"string"===typeof e&&(n=e,e={}),this.name=n,this.id=t.idCounter++,this.friction="undefined"!==typeof e.friction?e.friction:-1,this.restitution="undefined"!==typeof e.restitution?e.restitution:-1}));tc.idCounter=0;new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu;new ph;new wu,new wu,new wu(1,0,0),new wu(0,1,0),new wu(0,0,1),new wu,new wu,new wu,new wu;new wu,new wu,new wu,new wu;new wu,new wu,new wu;new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu;new wu,new Eu,new wu,new Eu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new Eu,new wu,new Ou,new Eu,Zu.STATIC;var ec={sphereSphere:Du.types.SPHERE,spherePlane:Du.types.SPHERE|Du.types.PLANE,boxBox:Du.types.BOX|Du.types.BOX,sphereBox:Du.types.SPHERE|Du.types.BOX,planeBox:Du.types.PLANE|Du.types.BOX,convexConvex:Du.types.CONVEXPOLYHEDRON,sphereConvex:Du.types.SPHERE|Du.types.CONVEXPOLYHEDRON,planeConvex:Du.types.PLANE|Du.types.CONVEXPOLYHEDRON,boxConvex:Du.types.BOX|Du.types.CONVEXPOLYHEDRON,sphereHeightfield:Du.types.SPHERE|Du.types.HEIGHTFIELD,boxHeightfield:Du.types.BOX|Du.types.HEIGHTFIELD,convexHeightfield:Du.types.CONVEXPOLYHEDRON|Du.types.HEIGHTFIELD,sphereParticle:Du.types.PARTICLE|Du.types.SPHERE,planeParticle:Du.types.PLANE|Du.types.PARTICLE,boxParticle:Du.types.BOX|Du.types.PARTICLE,convexParticle:Du.types.PARTICLE|Du.types.CONVEXPOLYHEDRON,cylinderCylinder:Du.types.CYLINDER,sphereCylinder:Du.types.SPHERE|Du.types.CYLINDER,planeCylinder:Du.types.PLANE|Du.types.CYLINDER,boxCylinder:Du.types.BOX|Du.types.CYLINDER,convexCylinder:Du.types.CONVEXPOLYHEDRON|Du.types.CYLINDER,heightfieldCylinder:Du.types.HEIGHTFIELD|Du.types.CYLINDER,particleCylinder:Du.types.PARTICLE|Du.types.CYLINDER,sphereTrimesh:Du.types.SPHERE|Du.types.TRIMESH,planeTrimesh:Du.types.PLANE|Du.types.TRIMESH};new wu,new wu,new wu,new wu,new wu,new ku,new ku,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new Eu,new wu,new wu,new wu,new wu,new wu;new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new ku,new wu,new wu,new wu,new wu,new wu,new wu,new wu,new wu;new Eu;new ph;var nc=globalThis.performance||{};if(!nc.now){var ic=Date.now();nc.timing&&nc.timing.navigationStart&&(ic=nc.timing.navigationStart),nc.now=function(){return Date.now()-ic}}Zu.COLLIDE_EVENT_NAME;function rc(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ac(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var oc,sc,lc,uc,hc,cc,dc,fc,pc,vc,mc,gc={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},yc={duration:.5,overwrite:!1,delay:0},_c=1e8,xc=1e-8,bc=2*Math.PI,wc=bc/4,Sc=0,Tc=Math.sqrt,Mc=Math.cos,Ec=Math.sin,Ac=function(t){return"string"===typeof t},Pc=function(t){return"function"===typeof t},Cc=function(t){return"number"===typeof t},kc=function(t){return"undefined"===typeof t},Rc=function(t){return"object"===typeof t},Ic=function(t){return!1!==t},Dc=function(){return"undefined"!==typeof window},Oc=function(t){return Pc(t)||Ac(t)},Lc="function"===typeof ArrayBuffer&&ArrayBuffer.isView||function(){},Nc=Array.isArray,Fc=/(?:-?\.?\d|\.)+/gi,Bc=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Uc=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Gc=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,zc=/[+-]=-?[.\d]+/,Hc=/[^,'"\[\]\s]+/gi,Vc=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,jc={},Xc={},Wc=function(t){return(Xc=bd(t,jc))&&Tp},qc=function(t,e){return console.warn("Invalid property",t,"set to",e,"Missing plugin? gsap.registerPlugin()")},Yc=function(t,e){return!e&&console.warn(t)},Kc=function(t,e){return t&&(jc[t]=e)&&Xc&&(Xc[t]=e)||jc},Zc=function(){return 0},Jc={suppressEvents:!0,isStart:!0,kill:!1},Qc={suppressEvents:!0,kill:!1},$c={suppressEvents:!0},td={},ed=[],nd={},id={},rd={},ad=30,od=[],sd="",ld=function(t){var e,n,i=t[0];if(Rc(i)||Pc(i)||(t=[t]),!(e=(i._gsap||{}).harness)){for(n=od.length;n--&&!od[n].targetTest(i););e=od[n]}for(n=t.length;n--;)t[n]&&(t[n]._gsap||(t[n]._gsap=new Bf(t[n],e)))||t.splice(n,1);return t},ud=function(t){return t._gsap||ld(tf(t))[0]._gsap},hd=function(t,e,n){return(n=t[e])&&Pc(n)?t[e]():kc(n)&&t.getAttribute&&t.getAttribute(e)||n},cd=function(t,e){return(t=t.split(",")).forEach(e)||t},dd=function(t){return Math.round(1e5*t)/1e5||0},fd=function(t){return Math.round(1e7*t)/1e7||0},pd=function(t,e){var n=e.charAt(0),i=parseFloat(e.substr(2));return t=parseFloat(t),"+"===n?t+i:"-"===n?t-i:"*"===n?t*i:t/i},vd=function(t,e){for(var n=e.length,i=0;t.indexOf(e[i])<0&&++i<n;);return i<n},md=function(){var t,e,n=ed.length,i=ed.slice(0);for(nd={},ed.length=0,t=0;t<n;t++)(e=i[t])&&e._lazy&&(e.render(e._lazy[0],e._lazy[1],!0)._lazy=0)},gd=function(t,e,n,i){ed.length&&!sc&&md(),t.render(e,n,i||sc&&e<0&&(t._initted||t._startAt)),ed.length&&!sc&&md()},yd=function(t){var e=parseFloat(t);return(e||0===e)&&(t+"").match(Hc).length<2?e:Ac(t)?t.trim():t},_d=function(t){return t},xd=function(t,e){for(var n in e)n in t||(t[n]=e[n]);return t},bd=function(t,e){for(var n in e)t[n]=e[n];return t},wd=function t(e,n){for(var i in n)"__proto__"!==i&&"constructor"!==i&&"prototype"!==i&&(e[i]=Rc(n[i])?t(e[i]||(e[i]={}),n[i]):n[i]);return e},Sd=function(t,e){var n,i={};for(n in t)n in e||(i[n]=t[n]);return i},Td=function(t){var e,n=t.parent||uc,i=t.keyframes?(e=Nc(t.keyframes),function(t,n){for(var i in n)i in t||"duration"===i&&e||"ease"===i||(t[i]=n[i])}):xd;if(Ic(t.inherit))for(;n;)i(t,n.vars.defaults),n=n.parent||n._dp;return t},Md=function(t,e,n,i,r){void 0===n&&(n="_first"),void 0===i&&(i="_last");var a,o=t[i];if(r)for(a=e[r];o&&o[r]>a;)o=o._prev;return o?(e._next=o._next,o._next=e):(e._next=t[n],t[n]=e),e._next?e._next._prev=e:t[i]=e,e._prev=o,e.parent=e._dp=t,e},Ed=function(t,e,n,i){void 0===n&&(n="_first"),void 0===i&&(i="_last");var r=e._prev,a=e._next;r?r._next=a:t[n]===e&&(t[n]=a),a?a._prev=r:t[i]===e&&(t[i]=r),e._next=e._prev=e.parent=null},Ad=function(t,e){t.parent&&(!e||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},Pd=function(t,e){if(t&&(!e||e._end>t._dur||e._start<0))for(var n=t;n;)n._dirty=1,n=n.parent;return t},Cd=function(t){for(var e=t.parent;e&&e.parent;)e._dirty=1,e.totalDuration(),e=e.parent;return t},kd=function(t,e,n,i){return t._startAt&&(sc?t._startAt.revert(Qc):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(e,!0,i))},Rd=function t(e){return!e||e._ts&&t(e.parent)},Id=function(t){return t._repeat?Dd(t._tTime,t=t.duration()+t._rDelay)*t:0},Dd=function(t,e){var n=Math.floor(t/=e);return t&&n===t?n-1:n},Od=function(t,e){return(t-e._start)*e._ts+(e._ts>=0?0:e._dirty?e.totalDuration():e._tDur)},Ld=function(t){return t._end=fd(t._start+(t._tDur/Math.abs(t._ts||t._rts||xc)||0))},Nd=function(t,e){var n=t._dp;return n&&n.smoothChildTiming&&t._ts&&(t._start=fd(n._time-(t._ts>0?e/t._ts:((t._dirty?t.totalDuration():t._tDur)-e)/-t._ts)),Ld(t),n._dirty||Pd(n,t)),t},Fd=function(t,e){var n;if((e._time||!e._dur&&e._initted||e._start<t._time&&(e._dur||!e.add))&&(n=Od(t.rawTime(),e),(!e._dur||Kd(0,e.totalDuration(),n)-e._tTime>xc)&&e.render(n,!0)),Pd(t,e)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(n=t;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;t._zTime=-1e-8}},Bd=function(t,e,n,i){return e.parent&&Ad(e),e._start=fd((Cc(n)?n:n||t!==uc?Wd(t,n,e):t._time)+e._delay),e._end=fd(e._start+(e.totalDuration()/Math.abs(e.timeScale())||0)),Md(t,e,"_first","_last",t._sort?"_start":0),Hd(e)||(t._recent=e),i||Fd(t,e),t._ts<0&&Nd(t,t._tTime),t},Ud=function(t,e){return(jc.ScrollTrigger||qc("scrollTrigger",e))&&jc.ScrollTrigger.create(e,t)},Gd=function(t,e,n,i,r){return Wf(t,e,r),t._initted?!n&&t._pt&&!sc&&(t._dur&&!1!==t.vars.lazy||!t._dur&&t.vars.lazy)&&pc!==Mf.frame?(ed.push(t),t._lazy=[r,i],1):void 0:1},zd=function t(e){var n=e.parent;return n&&n._ts&&n._initted&&!n._lock&&(n.rawTime()<0||t(n))},Hd=function(t){var e=t.data;return"isFromStart"===e||"isStart"===e},Vd=function(t,e,n,i){var r=t._repeat,a=fd(e)||0,o=t._tTime/t._tDur;return o&&!i&&(t._time*=a/t._dur),t._dur=a,t._tDur=r?r<0?1e10:fd(a*(r+1)+t._rDelay*r):a,o>0&&!i&&Nd(t,t._tTime=t._tDur*o),t.parent&&Ld(t),n||Pd(t.parent,t),t},jd=function(t){return t instanceof Gf?Pd(t):Vd(t,t._dur)},Xd={_start:0,endTime:Zc,totalDuration:Zc},Wd=function t(e,n,i){var r,a,o,s=e.labels,l=e._recent||Xd,u=e.duration()>=_c?l.endTime(!1):e._dur;return Ac(n)&&(isNaN(n)||n in s)?(a=n.charAt(0),o="%"===n.substr(-1),r=n.indexOf("="),"<"===a||">"===a?(r>=0&&(n=n.replace(/=/,"")),("<"===a?l._start:l.endTime(l._repeat>=0))+(parseFloat(n.substr(1))||0)*(o?(r<0?l:i).totalDuration()/100:1)):r<0?(n in s||(s[n]=u),s[n]):(a=parseFloat(n.charAt(r-1)+n.substr(r+1)),o&&i&&(a=a/100*(Nc(i)?i[0]:i).totalDuration()),r>1?t(e,n.substr(0,r-1),i)+a:u+a)):null==n?u:+n},qd=function(t,e,n){var i,r,a=Cc(e[1]),o=(a?2:1)+(t<2?0:1),s=e[o];if(a&&(s.duration=e[1]),s.parent=n,t){for(i=s,r=n;r&&!("immediateRender"in i);)i=r.vars.defaults||{},r=Ic(r.vars.inherit)&&r.parent;s.immediateRender=Ic(i.immediateRender),t<2?s.runBackwards=1:s.startAt=e[o-1]}return new Jf(e[0],s,e[o+1])},Yd=function(t,e){return t||0===t?e(t):e},Kd=function(t,e,n){return n<t?t:n>e?e:n},Zd=function(t,e){return Ac(t)&&(e=Vc.exec(t))?e[1]:""},Jd=[].slice,Qd=function(t,e){return t&&Rc(t)&&"length"in t&&(!e&&!t.length||t.length-1 in t&&Rc(t[0]))&&!t.nodeType&&t!==hc},$d=function(t,e,n){return void 0===n&&(n=[]),t.forEach((function(t){var i;return Ac(t)&&!e||Qd(t,1)?(i=n).push.apply(i,tf(t)):n.push(t)}))||n},tf=function(t,e,n){return lc&&!e&&lc.selector?lc.selector(t):!Ac(t)||n||!cc&&Ef()?Nc(t)?$d(t,n):Qd(t)?Jd.call(t,0):t?[t]:[]:Jd.call((e||dc).querySelectorAll(t),0)},ef=function(t){return t=tf(t)[0]||Yc("Invalid scope")||{},function(e){var n=t.current||t.nativeElement||t;return tf(e,n.querySelectorAll?n:n===t?Yc("Invalid scope")||dc.createElement("div"):t)}},nf=function(t){return t.sort((function(){return.5-Math.random()}))},rf=function(t){if(Pc(t))return t;var e=Rc(t)?t:{each:t},n=Df(e.ease),i=e.from||0,r=parseFloat(e.base)||0,a={},o=i>0&&i<1,s=isNaN(i)||o,l=e.axis,u=i,h=i;return Ac(i)?u=h={center:.5,edges:.5,end:1}[i]||0:!o&&s&&(u=i[0],h=i[1]),function(t,o,c){var d,f,p,v,m,g,y,_,x,b=(c||e).length,w=a[b];if(!w){if(!(x="auto"===e.grid?0:(e.grid||[1,_c])[1])){for(y=-_c;y<(y=c[x++].getBoundingClientRect().left)&&x<b;);x--}for(w=a[b]=[],d=s?Math.min(x,b)*u-.5:i%x,f=x===_c?0:s?b*h/x-.5:i/x|0,y=0,_=_c,g=0;g<b;g++)p=g%x-d,v=f-(g/x|0),w[g]=m=l?Math.abs("y"===l?v:p):Tc(p*p+v*v),m>y&&(y=m),m<_&&(_=m);"random"===i&&nf(w),w.max=y-_,w.min=_,w.v=b=(parseFloat(e.amount)||parseFloat(e.each)*(x>b?b-1:l?"y"===l?b/x:x:Math.max(x,b/x))||0)*("edges"===i?-1:1),w.b=b<0?r-b:r,w.u=Zd(e.amount||e.each)||0,n=n&&b<0?Rf(n):n}return b=(w[t]-w.min)/w.max||0,fd(w.b+(n?n(b):b)*w.v)+w.u}},af=function(t){var e=Math.pow(10,((t+"").split(".")[1]||"").length);return function(n){var i=fd(Math.round(parseFloat(n)/t)*t*e);return(i-i%1)/e+(Cc(n)?0:Zd(n))}},of=function(t,e){var n,i,r=Nc(t);return!r&&Rc(t)&&(n=r=t.radius||_c,t.values?(t=tf(t.values),(i=!Cc(t[0]))&&(n*=n)):t=af(t.increment)),Yd(e,r?Pc(t)?function(e){return i=t(e),Math.abs(i-e)<=n?i:e}:function(e){for(var r,a,o=parseFloat(i?e.x:e),s=parseFloat(i?e.y:0),l=_c,u=0,h=t.length;h--;)(r=i?(r=t[h].x-o)*r+(a=t[h].y-s)*a:Math.abs(t[h]-o))<l&&(l=r,u=h);return u=!n||l<=n?t[u]:e,i||u===e||Cc(e)?u:u+Zd(e)}:af(t))},sf=function(t,e,n,i){return Yd(Nc(t)?!e:!0===n?!!(n=0):!i,(function(){return Nc(t)?t[~~(Math.random()*t.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((t-n/2+Math.random()*(e-t+.99*n))/n)*n*i)/i}))},lf=function(t,e,n){return Yd(n,(function(n){return t[~~e(n)]}))},uf=function(t){for(var e,n,i,r,a=0,o="";~(e=t.indexOf("random(",a));)i=t.indexOf(")",e),r="["===t.charAt(e+7),n=t.substr(e+7,i-e-7).match(r?Hc:Fc),o+=t.substr(a,e-a)+sf(r?n:+n[0],r?0:+n[1],+n[2]||1e-5),a=i+1;return o+t.substr(a,t.length-a)},hf=function(t,e,n,i,r){var a=e-t,o=i-n;return Yd(r,(function(e){return n+((e-t)/a*o||0)}))},cf=function(t,e,n){var i,r,a,o=t.labels,s=_c;for(i in o)(r=o[i]-e)<0===!!n&&r&&s>(r=Math.abs(r))&&(a=i,s=r);return a},df=function(t,e,n){var i,r,a,o=t.vars,s=o[e],l=lc,u=t._ctx;if(s)return i=o[e+"Params"],r=o.callbackScope||t,n&&ed.length&&md(),u&&(lc=u),a=i?s.apply(r,i):s.call(r),lc=l,a},ff=function(t){return Ad(t),t.scrollTrigger&&t.scrollTrigger.kill(!!sc),t.progress()<1&&df(t,"onInterrupt"),t},pf=[],vf=function(t){if(Dc()&&t){var e=(t=!t.name&&t.default||t).name,n=Pc(t),i=e&&!n&&t.init?function(){this._props=[]}:t,r={init:Zc,render:op,add:jf,kill:lp,modifier:sp,rawVars:0},a={targetTest:0,get:0,getSetter:np,aliases:{},register:0};if(Ef(),t!==i){if(id[e])return;xd(i,xd(Sd(t,r),a)),bd(i.prototype,bd(r,Sd(t,a))),id[i.prop=e]=i,t.targetTest&&(od.push(i),td[e]=1),e=("css"===e?"CSS":e.charAt(0).toUpperCase()+e.substr(1))+"Plugin"}Kc(e,i),t.register&&t.register(Tp,i,cp)}else t&&pf.push(t)},mf=255,gf={aqua:[0,mf,mf],lime:[0,mf,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,mf],navy:[0,0,128],white:[mf,mf,mf],olive:[128,128,0],yellow:[mf,mf,0],orange:[mf,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[mf,0,0],pink:[mf,192,203],cyan:[0,mf,mf],transparent:[mf,mf,mf,0]},yf=function(t,e,n){return(6*(t+=t<0?1:t>1?-1:0)<1?e+(n-e)*t*6:t<.5?n:3*t<2?e+(n-e)*(2/3-t)*6:e)*mf+.5|0},_f=function(t,e,n){var i,r,a,o,s,l,u,h,c,d,f=t?Cc(t)?[t>>16,t>>8&mf,t&mf]:0:gf.black;if(!f){if(","===t.substr(-1)&&(t=t.substr(0,t.length-1)),gf[t])f=gf[t];else if("#"===t.charAt(0)){if(t.length<6&&(i=t.charAt(1),r=t.charAt(2),a=t.charAt(3),t="#"+i+i+r+r+a+a+(5===t.length?t.charAt(4)+t.charAt(4):"")),9===t.length)return[(f=parseInt(t.substr(1,6),16))>>16,f>>8&mf,f&mf,parseInt(t.substr(7),16)/255];f=[(t=parseInt(t.substr(1),16))>>16,t>>8&mf,t&mf]}else if("hsl"===t.substr(0,3))if(f=d=t.match(Fc),e){if(~t.indexOf("="))return f=t.match(Bc),n&&f.length<4&&(f[3]=1),f}else o=+f[0]%360/360,s=+f[1]/100,i=2*(l=+f[2]/100)-(r=l<=.5?l*(s+1):l+s-l*s),f.length>3&&(f[3]*=1),f[0]=yf(o+1/3,i,r),f[1]=yf(o,i,r),f[2]=yf(o-1/3,i,r);else f=t.match(Fc)||gf.transparent;f=f.map(Number)}return e&&!d&&(i=f[0]/mf,r=f[1]/mf,a=f[2]/mf,l=((u=Math.max(i,r,a))+(h=Math.min(i,r,a)))/2,u===h?o=s=0:(c=u-h,s=l>.5?c/(2-u-h):c/(u+h),o=u===i?(r-a)/c+(r<a?6:0):u===r?(a-i)/c+2:(i-r)/c+4,o*=60),f[0]=~~(o+.5),f[1]=~~(100*s+.5),f[2]=~~(100*l+.5)),n&&f.length<4&&(f[3]=1),f},xf=function(t){var e=[],n=[],i=-1;return t.split(wf).forEach((function(t){var r=t.match(Uc)||[];e.push.apply(e,r),n.push(i+=r.length+1)})),e.c=n,e},bf=function(t,e,n){var i,r,a,o,s="",l=(t+s).match(wf),u=e?"hsla(":"rgba(",h=0;if(!l)return t;if(l=l.map((function(t){return(t=_f(t,e,1))&&u+(e?t[0]+","+t[1]+"%,"+t[2]+"%,"+t[3]:t.join(","))+")"})),n&&(a=xf(t),(i=n.c).join(s)!==a.c.join(s)))for(o=(r=t.replace(wf,"1").split(Uc)).length-1;h<o;h++)s+=r[h]+(~i.indexOf(h)?l.shift()||u+"0,0,0,0)":(a.length?a:l.length?l:n).shift());if(!r)for(o=(r=t.split(wf)).length-1;h<o;h++)s+=r[h]+l[h];return s+r[o]},wf=function(){var t,e="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(t in gf)e+="|"+t+"\\b";return new RegExp(e+")","gi")}(),Sf=/hsl[a]?\(/,Tf=function(t){var e,n=t.join(" ");if(wf.lastIndex=0,wf.test(n))return e=Sf.test(n),t[1]=bf(t[1],e),t[0]=bf(t[0],e,xf(t[1])),!0},Mf=function(){var t,e,n,i,r,a,o=Date.now,s=500,l=33,u=o(),h=u,c=1e3/240,d=c,f=[],p=function n(p){var v,m,g,y,_=o()-h,x=!0===p;if(_>s&&(u+=_-l),((v=(g=(h+=_)-u)-d)>0||x)&&(y=++i.frame,r=g-1e3*i.time,i.time=g/=1e3,d+=v+(v>=c?4:c-v),m=1),x||(t=e(n)),m)for(a=0;a<f.length;a++)f[a](g,r,y,p)};return i={time:0,frame:0,tick:function(){p(!0)},deltaRatio:function(t){return r/(1e3/(t||60))},wake:function(){fc&&(!cc&&Dc()&&(hc=cc=window,dc=hc.document||{},jc.gsap=Tp,(hc.gsapVersions||(hc.gsapVersions=[])).push(Tp.version),Wc(Xc||hc.GreenSockGlobals||!hc.gsap&&hc||{}),n=hc.requestAnimationFrame,pf.forEach(vf)),t&&i.sleep(),e=n||function(t){return setTimeout(t,d-1e3*i.time+1|0)},mc=1,p(2))},sleep:function(){(n?hc.cancelAnimationFrame:clearTimeout)(t),mc=0,e=Zc},lagSmoothing:function(t,e){s=t||1/0,l=Math.min(e||33,s)},fps:function(t){c=1e3/(t||240),d=1e3*i.time+c},add:function(t,e,n){var r=e?function(e,n,a,o){t(e,n,a,o),i.remove(r)}:t;return i.remove(t),f[n?"unshift":"push"](r),Ef(),r},remove:function(t,e){~(e=f.indexOf(t))&&f.splice(e,1)&&a>=e&&a--},_listeners:f}}(),Ef=function(){return!mc&&Mf.wake()},Af={},Pf=/^[\d.\-M][\d.\-,\s]/,Cf=/["']/g,kf=function(t){for(var e,n,i,r={},a=t.substr(1,t.length-3).split(":"),o=a[0],s=1,l=a.length;s<l;s++)n=a[s],e=s!==l-1?n.lastIndexOf(","):n.length,i=n.substr(0,e),r[o]=isNaN(i)?i.replace(Cf,"").trim():+i,o=n.substr(e+1).trim();return r},Rf=function(t){return function(e){return 1-t(1-e)}},If=function t(e,n){for(var i,r=e._first;r;)r instanceof Gf?t(r,n):!r.vars.yoyoEase||r._yoyo&&r._repeat||r._yoyo===n||(r.timeline?t(r.timeline,n):(i=r._ease,r._ease=r._yEase,r._yEase=i,r._yoyo=n)),r=r._next},Df=function(t,e){return t&&(Pc(t)?t:Af[t]||function(t){var e=(t+"").split("("),n=Af[e[0]];return n&&e.length>1&&n.config?n.config.apply(null,~t.indexOf("{")?[kf(e[1])]:function(t){var e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.indexOf("(",e);return t.substring(e,~i&&i<n?t.indexOf(")",n+1):n)}(t).split(",").map(yd)):Af._CE&&Pf.test(t)?Af._CE("",t):n}(t))||e},Of=function(t,e,n,i){void 0===n&&(n=function(t){return 1-e(1-t)}),void 0===i&&(i=function(t){return t<.5?e(2*t)/2:1-e(2*(1-t))/2});var r,a={easeIn:e,easeOut:n,easeInOut:i};return cd(t,(function(t){for(var e in Af[t]=jc[t]=a,Af[r=t.toLowerCase()]=n,a)Af[r+("easeIn"===e?".in":"easeOut"===e?".out":".inOut")]=Af[t+"."+e]=a[e]})),a},Lf=function(t){return function(e){return e<.5?(1-t(1-2*e))/2:.5+t(2*(e-.5))/2}},Nf=function t(e,n,i){var r=n>=1?n:1,a=(i||(e?.3:.45))/(n<1?n:1),o=a/bc*(Math.asin(1/r)||0),s=function(t){return 1===t?1:r*Math.pow(2,-10*t)*Ec((t-o)*a)+1},l="out"===e?s:"in"===e?function(t){return 1-s(1-t)}:Lf(s);return a=bc/a,l.config=function(n,i){return t(e,n,i)},l},Ff=function t(e,n){void 0===n&&(n=1.70158);var i=function(t){return t?--t*t*((n+1)*t+n)+1:0},r="out"===e?i:"in"===e?function(t){return 1-i(1-t)}:Lf(i);return r.config=function(n){return t(e,n)},r};cd("Linear,Quad,Cubic,Quart,Quint,Strong",(function(t,e){var n=e<5?e+1:e;Of(t+",Power"+(n-1),e?function(t){return Math.pow(t,n)}:function(t){return t},(function(t){return 1-Math.pow(1-t,n)}),(function(t){return t<.5?Math.pow(2*t,n)/2:1-Math.pow(2*(1-t),n)/2}))})),Af.Linear.easeNone=Af.none=Af.Linear.easeIn,Of("Elastic",Nf("in"),Nf("out"),Nf()),function(t,e){var n=1/e,i=function(i){return i<n?t*i*i:i<.7272727272727273?t*Math.pow(i-1.5/e,2)+.75:i<.9090909090909092?t*(i-=2.25/e)*i+.9375:t*Math.pow(i-2.625/e,2)+.984375};Of("Bounce",(function(t){return 1-i(1-t)}),i)}(7.5625,2.75),Of("Expo",(function(t){return t?Math.pow(2,10*(t-1)):0})),Of("Circ",(function(t){return-(Tc(1-t*t)-1)})),Of("Sine",(function(t){return 1===t?1:1-Mc(t*wc)})),Of("Back",Ff("in"),Ff("out"),Ff()),Af.SteppedEase=Af.steps=jc.SteppedEase={config:function(t,e){void 0===t&&(t=1);var n=1/t,i=t+(e?0:1),r=e?1:0;return function(t){return((i*Kd(0,.99999999,t)|0)+r)*n}}},yc.ease=Af["quad.out"],cd("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",(function(t){return sd+=t+","+t+"Params,"}));var Bf=function(t,e){this.id=Sc++,t._gsap=this,this.target=t,this.harness=e,this.get=e?e.get:hd,this.set=e?e.getSetter:np},Uf=function(){function t(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Vd(this,+t.duration,1,1),this.data=t.data,lc&&(this._ctx=lc,lc.data.push(this)),mc||Mf.wake()}var e=t.prototype;return e.delay=function(t){return t||0===t?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+t-this._delay),this._delay=t,this):this._delay},e.duration=function(t){return arguments.length?this.totalDuration(this._repeat>0?t+(t+this._rDelay)*this._repeat:t):this.totalDuration()&&this._dur},e.totalDuration=function(t){return arguments.length?(this._dirty=0,Vd(this,this._repeat<0?t:(t-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(t,e){if(Ef(),!arguments.length)return this._tTime;var n=this._dp;if(n&&n.smoothChildTiming&&this._ts){for(Nd(this,t),!n._dp||n.parent||Fd(n,this);n&&n.parent;)n.parent._time!==n._start+(n._ts>=0?n._tTime/n._ts:(n.totalDuration()-n._tTime)/-n._ts)&&n.totalTime(n._tTime,!0),n=n.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&t<this._tDur||this._ts<0&&t>0||!this._tDur&&!t)&&Bd(this._dp,this,this._start-this._delay)}return(this._tTime!==t||!this._dur&&!e||this._initted&&Math.abs(this._zTime)===xc||!t&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=t),gd(this,t,e)),this},e.time=function(t,e){return arguments.length?this.totalTime(Math.min(this.totalDuration(),t+Id(this))%(this._dur+this._rDelay)||(t?this._dur:0),e):this._time},e.totalProgress=function(t,e){return arguments.length?this.totalTime(this.totalDuration()*t,e):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},e.progress=function(t,e){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?t:1-t)+Id(this),e):this.duration()?Math.min(1,this._time/this._dur):this.ratio},e.iteration=function(t,e){var n=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(t-1)*n,e):this._repeat?Dd(this._tTime,n)+1:1},e.timeScale=function(t){if(!arguments.length)return-1e-8===this._rts?0:this._rts;if(this._rts===t)return this;var e=this.parent&&this._ts?Od(this.parent._time,this):this._tTime;return this._rts=+t||0,this._ts=this._ps||-1e-8===t?0:this._rts,this.totalTime(Kd(-Math.abs(this._delay),this._tDur,e),!0),Ld(this),Cd(this)},e.paused=function(t){return arguments.length?(this._ps!==t&&(this._ps=t,t?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ef(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==xc&&(this._tTime-=xc)))),this):this._ps},e.startTime=function(t){if(arguments.length){this._start=t;var e=this.parent||this._dp;return e&&(e._sort||!this.parent)&&Bd(e,this,t-this._delay),this}return this._start},e.endTime=function(t){return this._start+(Ic(t)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(t){var e=this.parent||this._dp;return e?t&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Od(e.rawTime(t),this):this._tTime:this._tTime},e.revert=function(t){void 0===t&&(t=$c);var e=sc;return sc=t,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(t),this.totalTime(-.01,t.suppressEvents)),"nested"!==this.data&&!1!==t.kill&&this.kill(),sc=e,this},e.globalTime=function(t){for(var e=this,n=arguments.length?t:e.rawTime();e;)n=e._start+n/(e._ts||1),e=e._dp;return!this.parent&&this._sat?this._sat.vars.immediateRender?-1/0:this._sat.globalTime(t):n},e.repeat=function(t){return arguments.length?(this._repeat=t===1/0?-2:t,jd(this)):-2===this._repeat?1/0:this._repeat},e.repeatDelay=function(t){if(arguments.length){var e=this._time;return this._rDelay=t,jd(this),e?this.time(e):this}return this._rDelay},e.yoyo=function(t){return arguments.length?(this._yoyo=t,this):this._yoyo},e.seek=function(t,e){return this.totalTime(Wd(this,t),Ic(e))},e.restart=function(t,e){return this.play().totalTime(t?-this._delay:0,Ic(e))},e.play=function(t,e){return null!=t&&this.seek(t,e),this.reversed(!1).paused(!1)},e.reverse=function(t,e){return null!=t&&this.seek(t||this.totalDuration(),e),this.reversed(!0).paused(!1)},e.pause=function(t,e){return null!=t&&this.seek(t,e),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(t){return arguments.length?(!!t!==this.reversed()&&this.timeScale(-this._rts||(t?-1e-8:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-1e-8,this},e.isActive=function(){var t,e=this.parent||this._dp,n=this._start;return!(e&&!(this._ts&&this._initted&&e.isActive()&&(t=e.rawTime(!0))>=n&&t<this.endTime(!0)-xc))},e.eventCallback=function(t,e,n){var i=this.vars;return arguments.length>1?(e?(i[t]=e,n&&(i[t+"Params"]=n),"onUpdate"===t&&(this._onUpdate=e)):delete i[t],this):i[t]},e.then=function(t){var e=this;return new Promise((function(n){var i=Pc(t)?t:_d,r=function(){var t=e.then;e.then=null,Pc(i)&&(i=i(e))&&(i.then||i===e)&&(e.then=t),n(i),e.then=t};e._initted&&1===e.totalProgress()&&e._ts>=0||!e._tTime&&e._ts<0?r():e._prom=r}))},e.kill=function(){ff(this)},t}();xd(Uf.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-1e-8,_prom:0,_ps:!1,_rts:1});var Gf=function(t){function e(e,n){var i;return void 0===e&&(e={}),(i=t.call(this,e)||this).labels={},i.smoothChildTiming=!!e.smoothChildTiming,i.autoRemoveChildren=!!e.autoRemoveChildren,i._sort=Ic(e.sortChildren),uc&&Bd(e.parent||uc,rc(i),n),e.reversed&&i.reverse(),e.paused&&i.paused(!0),e.scrollTrigger&&Ud(rc(i),e.scrollTrigger),i}ac(e,t);var n=e.prototype;return n.to=function(t,e,n){return qd(0,arguments,this),this},n.from=function(t,e,n){return qd(1,arguments,this),this},n.fromTo=function(t,e,n,i){return qd(2,arguments,this),this},n.set=function(t,e,n){return e.duration=0,e.parent=this,Td(e).repeatDelay||(e.repeat=0),e.immediateRender=!!e.immediateRender,new Jf(t,e,Wd(this,n),1),this},n.call=function(t,e,n){return Bd(this,Jf.delayedCall(0,t,e),n)},n.staggerTo=function(t,e,n,i,r,a,o){return n.duration=e,n.stagger=n.stagger||i,n.onComplete=a,n.onCompleteParams=o,n.parent=this,new Jf(t,n,Wd(this,r)),this},n.staggerFrom=function(t,e,n,i,r,a,o){return n.runBackwards=1,Td(n).immediateRender=Ic(n.immediateRender),this.staggerTo(t,e,n,i,r,a,o)},n.staggerFromTo=function(t,e,n,i,r,a,o,s){return i.startAt=n,Td(i).immediateRender=Ic(i.immediateRender),this.staggerTo(t,e,i,r,a,o,s)},n.render=function(t,e,n){var i,r,a,o,s,l,u,h,c,d,f,p,v=this._time,m=this._dirty?this.totalDuration():this._tDur,g=this._dur,y=t<=0?0:fd(t),_=this._zTime<0!==t<0&&(this._initted||!g);if(this!==uc&&y>m&&t>=0&&(y=m),y!==this._tTime||n||_){if(v!==this._time&&g&&(y+=this._time-v,t+=this._time-v),i=y,c=this._start,l=!(h=this._ts),_&&(g||(v=this._zTime),(t||!e)&&(this._zTime=t)),this._repeat){if(f=this._yoyo,s=g+this._rDelay,this._repeat<-1&&t<0)return this.totalTime(100*s+t,e,n);if(i=fd(y%s),y===m?(o=this._repeat,i=g):((o=~~(y/s))&&o===y/s&&(i=g,o--),i>g&&(i=g)),d=Dd(this._tTime,s),!v&&this._tTime&&d!==o&&this._tTime-d*s-this._dur<=0&&(d=o),f&&1&o&&(i=g-i,p=1),o!==d&&!this._lock){var x=f&&1&d,b=x===(f&&1&o);if(o<d&&(x=!x),v=x?0:y%g?g:y,this._lock=1,this.render(v||(p?0:fd(o*s)),e,!g)._lock=0,this._tTime=y,!e&&this.parent&&df(this,"onRepeat"),this.vars.repeatRefresh&&!p&&(this.invalidate()._lock=1),v&&v!==this._time||l!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(g=this._dur,m=this._tDur,b&&(this._lock=2,v=x?g:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!p&&this.invalidate()),this._lock=0,!this._ts&&!l)return this;If(this,p)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(u=function(t,e,n){var i;if(n>e)for(i=t._first;i&&i._start<=n;){if("isPause"===i.data&&i._start>e)return i;i=i._next}else for(i=t._last;i&&i._start>=n;){if("isPause"===i.data&&i._start<e)return i;i=i._prev}}(this,fd(v),fd(i)),u&&(y-=i-(i=u._start))),this._tTime=y,this._time=i,this._act=!h,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=t,v=0),!v&&i&&!e&&!o&&(df(this,"onStart"),this._tTime!==y))return this;if(i>=v&&t>=0)for(r=this._first;r;){if(a=r._next,(r._act||i>=r._start)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(i-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(i-r._start)*r._ts,e,n),i!==this._time||!this._ts&&!l){u=0,a&&(y+=this._zTime=-1e-8);break}}r=a}else{r=this._last;for(var w=t<0?t:i;r;){if(a=r._prev,(r._act||w<=r._end)&&r._ts&&u!==r){if(r.parent!==this)return this.render(t,e,n);if(r.render(r._ts>0?(w-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(w-r._start)*r._ts,e,n||sc&&(r._initted||r._startAt)),i!==this._time||!this._ts&&!l){u=0,a&&(y+=this._zTime=w?-1e-8:xc);break}}r=a}}if(u&&!e&&(this.pause(),u.render(i>=v?0:-1e-8)._zTime=i>=v?1:-1,this._ts))return this._start=c,Ld(this),this.render(t,e,n);this._onUpdate&&!e&&df(this,"onUpdate",!0),(y===m&&this._tTime>=this.totalDuration()||!y&&v)&&(c!==this._start&&Math.abs(h)===Math.abs(this._ts)||this._lock||((t||!g)&&(y===m&&this._ts>0||!y&&this._ts<0)&&Ad(this,1),e||t<0&&!v||!y&&!v&&m||(df(this,y===m&&t>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(y<m&&this.timeScale()>0)&&this._prom())))}return this},n.add=function(t,e){var n=this;if(Cc(e)||(e=Wd(this,e,t)),!(t instanceof Uf)){if(Nc(t))return t.forEach((function(t){return n.add(t,e)})),this;if(Ac(t))return this.addLabel(t,e);if(!Pc(t))return this;t=Jf.delayedCall(0,t)}return this!==t?Bd(this,t,e):this},n.getChildren=function(t,e,n,i){void 0===t&&(t=!0),void 0===e&&(e=!0),void 0===n&&(n=!0),void 0===i&&(i=-_c);for(var r=[],a=this._first;a;)a._start>=i&&(a instanceof Jf?e&&r.push(a):(n&&r.push(a),t&&r.push.apply(r,a.getChildren(!0,e,n)))),a=a._next;return r},n.getById=function(t){for(var e=this.getChildren(1,1,1),n=e.length;n--;)if(e[n].vars.id===t)return e[n]},n.remove=function(t){return Ac(t)?this.removeLabel(t):Pc(t)?this.killTweensOf(t):(Ed(this,t),t===this._recent&&(this._recent=this._last),Pd(this))},n.totalTime=function(e,n){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=fd(Mf.time-(this._ts>0?e/this._ts:(this.totalDuration()-e)/-this._ts))),t.prototype.totalTime.call(this,e,n),this._forcing=0,this):this._tTime},n.addLabel=function(t,e){return this.labels[t]=Wd(this,e),this},n.removeLabel=function(t){return delete this.labels[t],this},n.addPause=function(t,e,n){var i=Jf.delayedCall(0,e||Zc,n);return i.data="isPause",this._hasPause=1,Bd(this,i,Wd(this,t))},n.removePause=function(t){var e=this._first;for(t=Wd(this,t);e;)e._start===t&&"isPause"===e.data&&Ad(e),e=e._next},n.killTweensOf=function(t,e,n){for(var i=this.getTweensOf(t,n),r=i.length;r--;)zf!==i[r]&&i[r].kill(t,e);return this},n.getTweensOf=function(t,e){for(var n,i=[],r=tf(t),a=this._first,o=Cc(e);a;)a instanceof Jf?vd(a._targets,r)&&(o?(!zf||a._initted&&a._ts)&&a.globalTime(0)<=e&&a.globalTime(a.totalDuration())>e:!e||a.isActive())&&i.push(a):(n=a.getTweensOf(r,e)).length&&i.push.apply(i,n),a=a._next;return i},n.tweenTo=function(t,e){e=e||{};var n,i=this,r=Wd(i,t),a=e,o=a.startAt,s=a.onStart,l=a.onStartParams,u=a.immediateRender,h=Jf.to(i,xd({ease:e.ease||"none",lazy:!1,immediateRender:!1,time:r,overwrite:"auto",duration:e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale())||xc,onStart:function(){if(i.pause(),!n){var t=e.duration||Math.abs((r-(o&&"time"in o?o.time:i._time))/i.timeScale());h._dur!==t&&Vd(h,t,0,1).render(h._time,!0,!0),n=1}s&&s.apply(h,l||[])}},e));return u?h.render(0):h},n.tweenFromTo=function(t,e,n){return this.tweenTo(e,xd({startAt:{time:Wd(this,t)}},n))},n.recent=function(){return this._recent},n.nextLabel=function(t){return void 0===t&&(t=this._time),cf(this,Wd(this,t))},n.previousLabel=function(t){return void 0===t&&(t=this._time),cf(this,Wd(this,t),1)},n.currentLabel=function(t){return arguments.length?this.seek(t,!0):this.previousLabel(this._time+xc)},n.shiftChildren=function(t,e,n){void 0===n&&(n=0);for(var i,r=this._first,a=this.labels;r;)r._start>=n&&(r._start+=t,r._end+=t),r=r._next;if(e)for(i in a)a[i]>=n&&(a[i]+=t);return Pd(this)},n.invalidate=function(e){var n=this._first;for(this._lock=0;n;)n.invalidate(e),n=n._next;return t.prototype.invalidate.call(this,e)},n.clear=function(t){void 0===t&&(t=!0);for(var e,n=this._first;n;)e=n._next,this.remove(n),n=e;return this._dp&&(this._time=this._tTime=this._pTime=0),t&&(this.labels={}),Pd(this)},n.totalDuration=function(t){var e,n,i,r=0,a=this,o=a._last,s=_c;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-t:t));if(a._dirty){for(i=a.parent;o;)e=o._prev,o._dirty&&o.totalDuration(),(n=o._start)>s&&a._sort&&o._ts&&!a._lock?(a._lock=1,Bd(a,o,n-o._delay,1)._lock=0):s=n,n<0&&o._ts&&(r-=n,(!i&&!a._dp||i&&i.smoothChildTiming)&&(a._start+=n/a._ts,a._time-=n,a._tTime-=n),a.shiftChildren(-n,!1,-Infinity),s=0),o._end>r&&o._ts&&(r=o._end),o=e;Vd(a,a===uc&&a._time>r?a._time:r,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(t){if(uc._ts&&(gd(uc,Od(t,uc)),pc=Mf.frame),Mf.frame>=ad){ad+=gc.autoSleep||120;var e=uc._first;if((!e||!e._ts)&&gc.autoSleep&&Mf._listeners.length<2){for(;e&&!e._ts;)e=e._next;e||Mf.sleep()}}},e}(Uf);xd(Gf.prototype,{_lock:0,_hasPause:0,_forcing:0});var zf,Hf,Vf=function(t,e,n,i,r,a,o){var s,l,u,h,c,d,f,p,v=new cp(this._pt,t,e,0,1,ap,null,r),m=0,g=0;for(v.b=n,v.e=i,n+="",(f=~(i+="").indexOf("random("))&&(i=uf(i)),a&&(a(p=[n,i],t,e),n=p[0],i=p[1]),l=n.match(Gc)||[];s=Gc.exec(i);)h=s[0],c=i.substring(m,s.index),u?u=(u+1)%5:"rgba("===c.substr(-5)&&(u=1),h!==l[g++]&&(d=parseFloat(l[g-1])||0,v._pt={_next:v._pt,p:c||1===g?c:",",s:d,c:"="===h.charAt(1)?pd(d,h)-d:parseFloat(h)-d,m:u&&u<4?Math.round:0},m=Gc.lastIndex);return v.c=m<i.length?i.substring(m,i.length):"",v.fp=o,(zc.test(i)||f)&&(v.e=0),this._pt=v,v},jf=function(t,e,n,i,r,a,o,s,l,u){Pc(i)&&(i=i(r||0,t,a));var h,c=t[e],d="get"!==n?n:Pc(c)?l?t[e.indexOf("set")||!Pc(t["get"+e.substr(3)])?e:"get"+e.substr(3)](l):t[e]():c,f=Pc(c)?l?tp:$f:Qf;if(Ac(i)&&(~i.indexOf("random(")&&(i=uf(i)),"="===i.charAt(1)&&((h=pd(d,i)+(Zd(d)||0))||0===h)&&(i=h)),!u||d!==i||Hf)return isNaN(d*i)||""===i?(!c&&!(e in t)&&qc(e,i),Vf.call(this,t,e,d,i,f,s||gc.stringFilter,l)):(h=new cp(this._pt,t,e,+d||0,i-(d||0),"boolean"===typeof c?rp:ip,0,f),l&&(h.fp=l),o&&h.modifier(o,this,t),this._pt=h)},Xf=function(t,e,n,i,r,a){var o,s,l,u;if(id[t]&&!1!==(o=new id[t]).init(r,o.rawVars?e[t]:function(t,e,n,i,r){if(Pc(t)&&(t=Yf(t,r,e,n,i)),!Rc(t)||t.style&&t.nodeType||Nc(t)||Lc(t))return Ac(t)?Yf(t,r,e,n,i):t;var a,o={};for(a in t)o[a]=Yf(t[a],r,e,n,i);return o}(e[t],i,r,a,n),n,i,a)&&(n._pt=s=new cp(n._pt,r,t,0,1,o.render,o,0,o.priority),n!==vc))for(l=n._ptLookup[n._targets.indexOf(r)],u=o._props.length;u--;)l[o._props[u]]=s;return o},Wf=function t(e,n,i){var r,a,o,s,l,u,h,c,d,f,p,v,m,g=e.vars,y=g.ease,_=g.startAt,x=g.immediateRender,b=g.lazy,w=g.onUpdate,S=g.onUpdateParams,T=g.callbackScope,M=g.runBackwards,E=g.yoyoEase,A=g.keyframes,P=g.autoRevert,C=e._dur,k=e._startAt,R=e._targets,I=e.parent,D=I&&"nested"===I.data?I.vars.targets:R,O="auto"===e._overwrite&&!oc,L=e.timeline;if(L&&(!A||!y)&&(y="none"),e._ease=Df(y,yc.ease),e._yEase=E?Rf(Df(!0===E?y:E,yc.ease)):0,E&&e._yoyo&&!e._repeat&&(E=e._yEase,e._yEase=e._ease,e._ease=E),e._from=!L&&!!g.runBackwards,!L||A&&!g.stagger){if(v=(c=R[0]?ud(R[0]).harness:0)&&g[c.prop],r=Sd(g,td),k&&(k._zTime<0&&k.progress(1),n<0&&M&&x&&!P?k.render(-1,!0):k.revert(M&&C?Qc:Jc),k._lazy=0),_){if(Ad(e._startAt=Jf.set(R,xd({data:"isStart",overwrite:!1,parent:I,immediateRender:!0,lazy:!k&&Ic(b),startAt:null,delay:0,onUpdate:w,onUpdateParams:S,callbackScope:T,stagger:0},_))),e._startAt._dp=0,e._startAt._sat=e,n<0&&(sc||!x&&!P)&&e._startAt.revert(Qc),x&&C&&n<=0&&i<=0)return void(n&&(e._zTime=n))}else if(M&&C&&!k)if(n&&(x=!1),o=xd({overwrite:!1,data:"isFromStart",lazy:x&&!k&&Ic(b),immediateRender:x,stagger:0,parent:I},r),v&&(o[c.prop]=v),Ad(e._startAt=Jf.set(R,o)),e._startAt._dp=0,e._startAt._sat=e,n<0&&(sc?e._startAt.revert(Qc):e._startAt.render(-1,!0)),e._zTime=n,x){if(!n)return}else t(e._startAt,xc,xc);for(e._pt=e._ptCache=0,b=C&&Ic(b)||b&&!C,a=0;a<R.length;a++){if(h=(l=R[a])._gsap||ld(R)[a]._gsap,e._ptLookup[a]=f={},nd[h.id]&&ed.length&&md(),p=D===R?a:D.indexOf(l),c&&!1!==(d=new c).init(l,v||r,e,p,D)&&(e._pt=s=new cp(e._pt,l,d.name,0,1,d.render,d,0,d.priority),d._props.forEach((function(t){f[t]=s})),d.priority&&(u=1)),!c||v)for(o in r)id[o]&&(d=Xf(o,r,e,p,l,D))?d.priority&&(u=1):f[o]=s=jf.call(e,l,o,"get",r[o],p,D,0,g.stringFilter);e._op&&e._op[a]&&e.kill(l,e._op[a]),O&&e._pt&&(zf=e,uc.killTweensOf(l,f,e.globalTime(n)),m=!e.parent,zf=0),e._pt&&b&&(nd[h.id]=1)}u&&hp(e),e._onInit&&e._onInit(e)}e._onUpdate=w,e._initted=(!e._op||e._pt)&&!m,A&&n<=0&&L.render(_c,!0,!0)},qf=function(t,e,n,i){var r,a,o=e.ease||i||"power1.inOut";if(Nc(e))a=n[t]||(n[t]=[]),e.forEach((function(t,n){return a.push({t:n/(e.length-1)*100,v:t,e:o})}));else for(r in e)a=n[r]||(n[r]=[]),"ease"===r||a.push({t:parseFloat(t),v:e[r],e:o})},Yf=function(t,e,n,i,r){return Pc(t)?t.call(e,n,i,r):Ac(t)&&~t.indexOf("random(")?uf(t):t},Kf=sd+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Zf={};cd(Kf+",id,stagger,delay,duration,paused,scrollTrigger",(function(t){return Zf[t]=1}));var Jf=function(t){function e(e,n,i,r){var a;"number"===typeof n&&(i.duration=n,n=i,i=null);var o,s,l,u,h,c,d,f,p=(a=t.call(this,r?n:Td(n))||this).vars,v=p.duration,m=p.delay,g=p.immediateRender,y=p.stagger,_=p.overwrite,x=p.keyframes,b=p.defaults,w=p.scrollTrigger,S=p.yoyoEase,T=n.parent||uc,M=(Nc(e)||Lc(e)?Cc(e[0]):"length"in n)?[e]:tf(e);if(a._targets=M.length?ld(M):Yc("GSAP target "+e+" not found. https://greensock.com",!gc.nullTargetWarn)||[],a._ptLookup=[],a._overwrite=_,x||y||Oc(v)||Oc(m)){if(n=a.vars,(o=a.timeline=new Gf({data:"nested",defaults:b||{},targets:T&&"nested"===T.data?T.vars.targets:M})).kill(),o.parent=o._dp=rc(a),o._start=0,y||Oc(v)||Oc(m)){if(u=M.length,d=y&&rf(y),Rc(y))for(h in y)~Kf.indexOf(h)&&(f||(f={}),f[h]=y[h]);for(s=0;s<u;s++)(l=Sd(n,Zf)).stagger=0,S&&(l.yoyoEase=S),f&&bd(l,f),c=M[s],l.duration=+Yf(v,rc(a),s,c,M),l.delay=(+Yf(m,rc(a),s,c,M)||0)-a._delay,!y&&1===u&&l.delay&&(a._delay=m=l.delay,a._start+=m,l.delay=0),o.to(c,l,d?d(s,c,M):0),o._ease=Af.none;o.duration()?v=m=0:a.timeline=0}else if(x){Td(xd(o.vars.defaults,{ease:"none"})),o._ease=Df(x.ease||n.ease||"none");var E,A,P,C=0;if(Nc(x))x.forEach((function(t){return o.to(M,t,">")})),o.duration();else{for(h in l={},x)"ease"===h||"easeEach"===h||qf(h,x[h],l,x.easeEach);for(h in l)for(E=l[h].sort((function(t,e){return t.t-e.t})),C=0,s=0;s<E.length;s++)(P={ease:(A=E[s]).e,duration:(A.t-(s?E[s-1].t:0))/100*v})[h]=A.v,o.to(M,P,C),C+=P.duration;o.duration()<v&&o.to({},{duration:v-o.duration()})}}v||a.duration(v=o.duration())}else a.timeline=0;return!0!==_||oc||(zf=rc(a),uc.killTweensOf(M),zf=0),Bd(T,rc(a),i),n.reversed&&a.reverse(),n.paused&&a.paused(!0),(g||!v&&!x&&a._start===fd(T._time)&&Ic(g)&&Rd(rc(a))&&"nested"!==T.data)&&(a._tTime=-1e-8,a.render(Math.max(0,-m)||0)),w&&Ud(rc(a),w),a}ac(e,t);var n=e.prototype;return n.render=function(t,e,n){var i,r,a,o,s,l,u,h,c,d=this._time,f=this._tDur,p=this._dur,v=t<0,m=t>f-xc&&!v?f:t<xc?0:t;if(p){if(m!==this._tTime||!t||n||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==v){if(i=m,h=this.timeline,this._repeat){if(o=p+this._rDelay,this._repeat<-1&&v)return this.totalTime(100*o+t,e,n);if(i=fd(m%o),m===f?(a=this._repeat,i=p):((a=~~(m/o))&&a===m/o&&(i=p,a--),i>p&&(i=p)),(l=this._yoyo&&1&a)&&(c=this._yEase,i=p-i),s=Dd(this._tTime,o),i===d&&!n&&this._initted)return this._tTime=m,this;a!==s&&(h&&this._yEase&&If(h,l),!this.vars.repeatRefresh||l||this._lock||(this._lock=n=1,this.render(fd(o*a),!0).invalidate()._lock=0))}if(!this._initted){if(Gd(this,v?t:i,n,e,m))return this._tTime=0,this;if(d!==this._time)return this;if(p!==this._dur)return this.render(t,e,n)}if(this._tTime=m,this._time=i,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=u=(c||this._ease)(i/p),this._from&&(this.ratio=u=1-u),i&&!d&&!e&&!a&&(df(this,"onStart"),this._tTime!==m))return this;for(r=this._pt;r;)r.r(u,r.d),r=r._next;h&&h.render(t<0?t:!i&&l?-1e-8:h._dur*h._ease(i/this._dur),e,n)||this._startAt&&(this._zTime=t),this._onUpdate&&!e&&(v&&kd(this,t,0,n),df(this,"onUpdate")),this._repeat&&a!==s&&this.vars.onRepeat&&!e&&this.parent&&df(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(v&&!this._onUpdate&&kd(this,t,0,!0),(t||!p)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&Ad(this,1),e||v&&!d||!(m||d||l)||(df(this,m===f?"onComplete":"onReverseComplete",!0),this._prom&&!(m<f&&this.timeScale()>0)&&this._prom()))}}else!function(t,e,n,i){var r,a,o,s=t.ratio,l=e<0||!e&&(!t._start&&zd(t)&&(t._initted||!Hd(t))||(t._ts<0||t._dp._ts<0)&&!Hd(t))?0:1,u=t._rDelay,h=0;if(u&&t._repeat&&(h=Kd(0,t._tDur,e),a=Dd(h,u),t._yoyo&&1&a&&(l=1-l),a!==Dd(t._tTime,u)&&(s=1-l,t.vars.repeatRefresh&&t._initted&&t.invalidate())),l!==s||sc||i||t._zTime===xc||!e&&t._zTime){if(!t._initted&&Gd(t,e,i,n,h))return;for(o=t._zTime,t._zTime=e||(n?xc:0),n||(n=e&&!o),t.ratio=l,t._from&&(l=1-l),t._time=0,t._tTime=h,r=t._pt;r;)r.r(l,r.d),r=r._next;e<0&&kd(t,e,0,!0),t._onUpdate&&!n&&df(t,"onUpdate"),h&&t._repeat&&!n&&t.parent&&df(t,"onRepeat"),(e>=t._tDur||e<0)&&t.ratio===l&&(l&&Ad(t,1),n||sc||(df(t,l?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=e)}(this,t,e,n);return this},n.targets=function(){return this._targets},n.invalidate=function(e){return(!e||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(e),t.prototype.invalidate.call(this,e)},n.resetTo=function(t,e,n,i){mc||Mf.wake(),this._ts||this.play();var r=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||Wf(this,r),function(t,e,n,i,r,a,o){var s,l,u,h,c=(t._pt&&t._ptCache||(t._ptCache={}))[e];if(!c)for(c=t._ptCache[e]=[],u=t._ptLookup,h=t._targets.length;h--;){if((s=u[h][e])&&s.d&&s.d._pt)for(s=s.d._pt;s&&s.p!==e&&s.fp!==e;)s=s._next;if(!s)return Hf=1,t.vars[e]="+=0",Wf(t,o),Hf=0,1;c.push(s)}for(h=c.length;h--;)(s=(l=c[h])._pt||l).s=!i&&0!==i||r?s.s+(i||0)+a*s.c:i,s.c=n-s.s,l.e&&(l.e=dd(n)+Zd(l.e)),l.b&&(l.b=s.s+Zd(l.b))}(this,t,e,n,i,this._ease(r/this._dur),r)?this.resetTo(t,e,n,i):(Nd(this,0),this.parent||Md(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},n.kill=function(t,e){if(void 0===e&&(e="all"),!t&&(!e||"all"===e))return this._lazy=this._pt=0,this.parent?ff(this):this;if(this.timeline){var n=this.timeline.totalDuration();return this.timeline.killTweensOf(t,e,zf&&!0!==zf.vars.overwrite)._first||ff(this),this.parent&&n!==this.timeline.totalDuration()&&Vd(this,this._dur*this.timeline._tDur/n,0,1),this}var i,r,a,o,s,l,u,h=this._targets,c=t?tf(t):h,d=this._ptLookup,f=this._pt;if((!e||"all"===e)&&function(t,e){for(var n=t.length,i=n===e.length;i&&n--&&t[n]===e[n];);return n<0}(h,c))return"all"===e&&(this._pt=0),ff(this);for(i=this._op=this._op||[],"all"!==e&&(Ac(e)&&(s={},cd(e,(function(t){return s[t]=1})),e=s),e=function(t,e){var n,i,r,a,o=t[0]?ud(t[0]).harness:0,s=o&&o.aliases;if(!s)return e;for(i in n=bd({},e),s)if(i in n)for(r=(a=s[i].split(",")).length;r--;)n[a[r]]=n[i];return n}(h,e)),u=h.length;u--;)if(~c.indexOf(h[u]))for(s in r=d[u],"all"===e?(i[u]=e,o=r,a={}):(a=i[u]=i[u]||{},o=e),o)(l=r&&r[s])&&("kill"in l.d&&!0!==l.d.kill(s)||Ed(this,l,"_pt"),delete r[s]),"all"!==a&&(a[s]=1);return this._initted&&!this._pt&&f&&ff(this),this},e.to=function(t,n){return new e(t,n,arguments[2])},e.from=function(t,e){return qd(1,arguments)},e.delayedCall=function(t,n,i,r){return new e(n,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:t,onComplete:n,onReverseComplete:n,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:r})},e.fromTo=function(t,e,n){return qd(2,arguments)},e.set=function(t,n){return n.duration=0,n.repeatDelay||(n.repeat=0),new e(t,n)},e.killTweensOf=function(t,e,n){return uc.killTweensOf(t,e,n)},e}(Uf);xd(Jf.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),cd("staggerTo,staggerFrom,staggerFromTo",(function(t){Jf[t]=function(){var e=new Gf,n=Jd.call(arguments,0);return n.splice("staggerFromTo"===t?5:4,0,0),e[t].apply(e,n)}}));var Qf=function(t,e,n){return t[e]=n},$f=function(t,e,n){return t[e](n)},tp=function(t,e,n,i){return t[e](i.fp,n)},ep=function(t,e,n){return t.setAttribute(e,n)},np=function(t,e){return Pc(t[e])?$f:kc(t[e])&&t.setAttribute?ep:Qf},ip=function(t,e){return e.set(e.t,e.p,Math.round(1e6*(e.s+e.c*t))/1e6,e)},rp=function(t,e){return e.set(e.t,e.p,!!(e.s+e.c*t),e)},ap=function(t,e){var n=e._pt,i="";if(!t&&e.b)i=e.b;else if(1===t&&e.e)i=e.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*t):Math.round(1e4*(n.s+n.c*t))/1e4)+i,n=n._next;i+=e.c}e.set(e.t,e.p,i,e)},op=function(t,e){for(var n=e._pt;n;)n.r(t,n.d),n=n._next},sp=function(t,e,n,i){for(var r,a=this._pt;a;)r=a._next,a.p===i&&a.modifier(t,e,n),a=r},lp=function(t){for(var e,n,i=this._pt;i;)n=i._next,i.p===t&&!i.op||i.op===t?Ed(this,i,"_pt"):i.dep||(e=1),i=n;return!e},up=function(t,e,n,i){i.mSet(t,e,i.m.call(i.tween,n,i.mt),i)},hp=function(t){for(var e,n,i,r,a=t._pt;a;){for(e=a._next,n=i;n&&n.pr>a.pr;)n=n._next;(a._prev=n?n._prev:r)?a._prev._next=a:i=a,(a._next=n)?n._prev=a:r=a,a=e}t._pt=i},cp=function(){function t(t,e,n,i,r,a,o,s,l){this.t=e,this.s=i,this.c=r,this.p=n,this.r=a||ip,this.d=o||this,this.set=s||Qf,this.pr=l||0,this._next=t,t&&(t._prev=this)}return t.prototype.modifier=function(t,e,n){this.mSet=this.mSet||this.set,this.set=up,this.m=t,this.mt=n,this.tween=e},t}();cd(sd+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",(function(t){return td[t]=1})),jc.TweenMax=jc.TweenLite=Jf,jc.TimelineLite=jc.TimelineMax=Gf,uc=new Gf({sortChildren:!1,defaults:yc,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),gc.stringFilter=Tf;var dp=[],fp={},pp=[],vp=0,mp=0,gp=function(t){return(fp[t]||pp).map((function(t){return t()}))},yp=function(){var t=Date.now(),e=[];t-vp>2&&(gp("matchMediaInit"),dp.forEach((function(t){var n,i,r,a,o=t.queries,s=t.conditions;for(i in o)(n=hc.matchMedia(o[i]).matches)&&(r=1),n!==s[i]&&(s[i]=n,a=1);a&&(t.revert(),r&&e.push(t))})),gp("matchMediaRevert"),e.forEach((function(t){return t.onMatch(t)})),vp=t,gp("matchMedia"))},_p=function(){function t(t,e){this.selector=e&&ef(e),this.data=[],this._r=[],this.isReverted=!1,this.id=mp++,t&&this.add(t)}var e=t.prototype;return e.add=function(t,e,n){Pc(t)&&(n=e,e=t,t=Pc);var i=this,r=function(){var t,r=lc,a=i.selector;return r&&r!==i&&r.data.push(i),n&&(i.selector=ef(n)),lc=i,t=e.apply(i,arguments),Pc(t)&&i._r.push(t),lc=r,i.selector=a,i.isReverted=!1,t};return i.last=r,t===Pc?r(i):t?i[t]=r:r},e.ignore=function(t){var e=lc;lc=null,t(this),lc=e},e.getTweens=function(){var e=[];return this.data.forEach((function(n){return n instanceof t?e.push.apply(e,n.getTweens()):n instanceof Jf&&!(n.parent&&"nested"===n.parent.data)&&e.push(n)})),e},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(t,e){var n=this;if(t){var i=this.getTweens();this.data.forEach((function(t){"isFlip"===t.data&&(t.revert(),t.getChildren(!0,!0,!1).forEach((function(t){return i.splice(i.indexOf(t),1)})))})),i.map((function(t){return{g:t.globalTime(0),t:t}})).sort((function(t,e){return e.g-t.g||-1/0})).forEach((function(e){return e.t.revert(t)})),this.data.forEach((function(e){return!(e instanceof Jf)&&e.revert&&e.revert(t)})),this._r.forEach((function(e){return e(t,n)})),this.isReverted=!0}else this.data.forEach((function(t){return t.kill&&t.kill()}));if(this.clear(),e)for(var r=dp.length;r--;)dp[r].id===this.id&&dp.splice(r,1)},e.revert=function(t){this.kill(t||{})},t}(),xp=function(){function t(t){this.contexts=[],this.scope=t}var e=t.prototype;return e.add=function(t,e,n){Rc(t)||(t={matches:t});var i,r,a,o=new _p(0,n||this.scope),s=o.conditions={};for(r in lc&&!o.selector&&(o.selector=lc.selector),this.contexts.push(o),e=o.add("onMatch",e),o.queries=t,t)"all"===r?a=1:(i=hc.matchMedia(t[r]))&&(dp.indexOf(o)<0&&dp.push(o),(s[r]=i.matches)&&(a=1),i.addListener?i.addListener(yp):i.addEventListener("change",yp));return a&&e(o),this},e.revert=function(t){this.kill(t||{})},e.kill=function(t){this.contexts.forEach((function(e){return e.kill(t,!0)}))},t}(),bp={registerPlugin:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((function(t){return vf(t)}))},timeline:function(t){return new Gf(t)},getTweensOf:function(t,e){return uc.getTweensOf(t,e)},getProperty:function(t,e,n,i){Ac(t)&&(t=tf(t)[0]);var r=ud(t||{}).get,a=n?_d:yd;return"native"===n&&(n=""),t?e?a((id[e]&&id[e].get||r)(t,e,n,i)):function(e,n,i){return a((id[e]&&id[e].get||r)(t,e,n,i))}:t},quickSetter:function(t,e,n){if((t=tf(t)).length>1){var i=t.map((function(t){return Tp.quickSetter(t,e,n)})),r=i.length;return function(t){for(var e=r;e--;)i[e](t)}}t=t[0]||{};var a=id[e],o=ud(t),s=o.harness&&(o.harness.aliases||{})[e]||e,l=a?function(e){var i=new a;vc._pt=0,i.init(t,n?e+n:e,vc,0,[t]),i.render(1,i),vc._pt&&op(1,vc)}:o.set(t,s);return a?l:function(e){return l(t,s,n?e+n:e,o,1)}},quickTo:function(t,e,n){var i,r=Tp.to(t,bd(((i={})[e]="+=0.1",i.paused=!0,i),n||{})),a=function(t,n,i){return r.resetTo(e,t,n,i)};return a.tween=r,a},isTweening:function(t){return uc.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=Df(t.ease,yc.ease)),wd(yc,t||{})},config:function(t){return wd(gc,t||{})},registerEffect:function(t){var e=t.name,n=t.effect,i=t.plugins,r=t.defaults,a=t.extendTimeline;(i||"").split(",").forEach((function(t){return t&&!id[t]&&!jc[t]&&Yc(e+" effect requires "+t+" plugin.")})),rd[e]=function(t,e,i){return n(tf(t),xd(e||{},r),i)},a&&(Gf.prototype[e]=function(t,n,i){return this.add(rd[e](t,Rc(n)?n:(i=n)&&{},this),i)})},registerEase:function(t,e){Af[t]=Df(e)},parseEase:function(t,e){return arguments.length?Df(t,e):Af},getById:function(t){return uc.getById(t)},exportRoot:function(t,e){void 0===t&&(t={});var n,i,r=new Gf(t);for(r.smoothChildTiming=Ic(t.smoothChildTiming),uc.remove(r),r._dp=0,r._time=r._tTime=uc._time,n=uc._first;n;)i=n._next,!e&&!n._dur&&n instanceof Jf&&n.vars.onComplete===n._targets[0]||Bd(r,n,n._start-n._delay),n=i;return Bd(uc,r,0),r},context:function(t,e){return t?new _p(t,e):lc},matchMedia:function(t){return new xp(t)},matchMediaRefresh:function(){return dp.forEach((function(t){var e,n,i=t.conditions;for(n in i)i[n]&&(i[n]=!1,e=1);e&&t.revert()}))||yp()},addEventListener:function(t,e){var n=fp[t]||(fp[t]=[]);~n.indexOf(e)||n.push(e)},removeEventListener:function(t,e){var n=fp[t],i=n&&n.indexOf(e);i>=0&&n.splice(i,1)},utils:{wrap:function t(e,n,i){var r=n-e;return Nc(e)?lf(e,t(0,e.length),n):Yd(i,(function(t){return(r+(t-e)%r)%r+e}))},wrapYoyo:function t(e,n,i){var r=n-e,a=2*r;return Nc(e)?lf(e,t(0,e.length-1),n):Yd(i,(function(t){return e+((t=(a+(t-e)%a)%a||0)>r?a-t:t)}))},distribute:rf,random:sf,snap:of,normalize:function(t,e,n){return hf(t,e,0,1,n)},getUnit:Zd,clamp:function(t,e,n){return Yd(n,(function(n){return Kd(t,e,n)}))},splitColor:_f,toArray:tf,selector:ef,mapRange:hf,pipe:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){return e.reduce((function(t,e){return e(t)}),t)}},unitize:function(t,e){return function(n){return t(parseFloat(n))+(e||Zd(n))}},interpolate:function t(e,n,i,r){var a=isNaN(e+n)?0:function(t){return(1-t)*e+t*n};if(!a){var o,s,l,u,h,c=Ac(e),d={};if(!0===i&&(r=1)&&(i=null),c)e={p:e},n={p:n};else if(Nc(e)&&!Nc(n)){for(l=[],u=e.length,h=u-2,s=1;s<u;s++)l.push(t(e[s-1],e[s]));u--,a=function(t){t*=u;var e=Math.min(h,~~t);return l[e](t-e)},i=n}else r||(e=bd(Nc(e)?[]:{},e));if(!l){for(o in n)jf.call(d,e,o,"get",n[o]);a=function(t){return op(t,d)||(c?e.p:e)}}}return Yd(i,a)},shuffle:nf},install:Wc,effects:rd,ticker:Mf,updateRoot:Gf.updateRoot,plugins:id,globalTimeline:uc,core:{PropTween:cp,globals:Kc,Tween:Jf,Timeline:Gf,Animation:Uf,getCache:ud,_removeLinkedListItem:Ed,reverting:function(){return sc},context:function(t){return t&&lc&&(lc.data.push(t),t._ctx=lc),lc},suppressOverwrites:function(t){return oc=t}}};cd("to,from,fromTo,delayedCall,set,killTweensOf",(function(t){return bp[t]=Jf[t]})),Mf.add(Gf.updateRoot),vc=bp.to({},{duration:0});var wp=function(t,e){for(var n=t._pt;n&&n.p!==e&&n.op!==e&&n.fp!==e;)n=n._next;return n},Sp=function(t,e){return{name:t,rawVars:1,init:function(t,n,i){i._onInit=function(t){var i,r;if(Ac(n)&&(i={},cd(n,(function(t){return i[t]=1})),n=i),e){for(r in i={},n)i[r]=e(n[r]);n=i}!function(t,e){var n,i,r,a=t._targets;for(n in e)for(i=a.length;i--;)(r=t._ptLookup[i][n])&&(r=r.d)&&(r._pt&&(r=wp(r,n)),r&&r.modifier&&r.modifier(e[n],t,a[i],n))}(t,n)}}}},Tp=bp.registerPlugin({name:"attr",init:function(t,e,n,i,r){var a,o,s;for(a in this.tween=n,e)s=t.getAttribute(a)||"",(o=this.add(t,"setAttribute",(s||0)+"",e[a],i,r,0,0,a)).op=a,o.b=s,this._props.push(a)},render:function(t,e){for(var n=e._pt;n;)sc?n.set(n.t,n.p,n.b,n):n.r(t,n.d),n=n._next}},{name:"endArray",init:function(t,e){for(var n=e.length;n--;)this.add(t,n,t[n]||0,e[n],0,0,0,0,0,1)}},Sp("roundProps",af),Sp("modifiers"),Sp("snap",of))||bp;Jf.version=Gf.version=Tp.version="3.12.2",fc=1,Dc()&&Ef();Af.Power0,Af.Power1,Af.Power2,Af.Power3,Af.Power4,Af.Linear,Af.Quad,Af.Cubic,Af.Quart,Af.Quint,Af.Strong,Af.Elastic,Af.Back,Af.SteppedEase,Af.Bounce,Af.Sine,Af.Expo,Af.Circ;var Mp,Ep,Ap,Pp,Cp,kp,Rp,Ip,Dp={},Op=180/Math.PI,Lp=Math.PI/180,Np=Math.atan2,Fp=/([A-Z])/g,Bp=/(left|right|width|margin|padding|x)/i,Up=/[\s,\(]\S/,Gp={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},zp=function(t,e){return e.set(e.t,e.p,Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Hp=function(t,e){return e.set(e.t,e.p,1===t?e.e:Math.round(1e4*(e.s+e.c*t))/1e4+e.u,e)},Vp=function(t,e){return e.set(e.t,e.p,t?Math.round(1e4*(e.s+e.c*t))/1e4+e.u:e.b,e)},jp=function(t,e){var n=e.s+e.c*t;e.set(e.t,e.p,~~(n+(n<0?-.5:.5))+e.u,e)},Xp=function(t,e){return e.set(e.t,e.p,t?e.e:e.b,e)},Wp=function(t,e){return e.set(e.t,e.p,1!==t?e.b:e.e,e)},qp=function(t,e,n){return t.style[e]=n},Yp=function(t,e,n){return t.style.setProperty(e,n)},Kp=function(t,e,n){return t._gsap[e]=n},Zp=function(t,e,n){return t._gsap.scaleX=t._gsap.scaleY=n},Jp=function(t,e,n,i,r){var a=t._gsap;a.scaleX=a.scaleY=n,a.renderTransform(r,a)},Qp=function(t,e,n,i,r){var a=t._gsap;a[e]=n,a.renderTransform(r,a)},$p="transform",tv=$p+"Origin",ev=function t(e,n){var i=this,r=this.target,a=r.style;if(e in Dp&&a){if(this.tfm=this.tfm||{},"transform"===e)return Gp.transform.split(",").forEach((function(e){return t.call(i,e,n)}));if(~(e=Gp[e]||e).indexOf(",")?e.split(",").forEach((function(t){return i.tfm[t]=_v(r,t)})):this.tfm[e]=r._gsap.x?r._gsap[e]:_v(r,e),this.props.indexOf($p)>=0)return;r._gsap.svg&&(this.svgo=r.getAttribute("data-svg-origin"),this.props.push(tv,n,"")),e=$p}(a||n)&&this.props.push(e,n,a[e])},nv=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},iv=function(){var t,e,n=this.props,i=this.target,r=i.style,a=i._gsap;for(t=0;t<n.length;t+=3)n[t+1]?i[n[t]]=n[t+2]:n[t+2]?r[n[t]]=n[t+2]:r.removeProperty("--"===n[t].substr(0,2)?n[t]:n[t].replace(Fp,"-$1").toLowerCase());if(this.tfm){for(e in this.tfm)a[e]=this.tfm[e];a.svg&&(a.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),(t=Rp())&&t.isStart||r[$p]||(nv(r),a.uncache=1)}},rv=function(t,e){var n={target:t,props:[],revert:iv,save:ev};return t._gsap||Tp.core.getCache(t),e&&e.split(",").forEach((function(t){return n.save(t)})),n},av=function(t,e){var n=Ep.createElementNS?Ep.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):Ep.createElement(t);return n.style?n:Ep.createElement(t)},ov=function t(e,n,i){var r=getComputedStyle(e);return r[n]||r.getPropertyValue(n.replace(Fp,"-$1").toLowerCase())||r.getPropertyValue(n)||!i&&t(e,lv(n)||n,1)||""},sv="O,Moz,ms,Ms,Webkit".split(","),lv=function(t,e,n){var i=(e||Cp).style,r=5;if(t in i&&!n)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);r--&&!(sv[r]+t in i););return r<0?null:(3===r?"ms":r>=0?sv[r]:"")+t},uv=function(){"undefined"!==typeof window&&window.document&&(Mp=window,Ep=Mp.document,Ap=Ep.documentElement,Cp=av("div")||{style:{}},av("div"),$p=lv($p),tv=$p+"Origin",Cp.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Ip=!!lv("perspective"),Rp=Tp.core.reverting,Pp=1)},hv=function t(e){var n,i=av("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),r=this.parentNode,a=this.nextSibling,o=this.style.cssText;if(Ap.appendChild(i),i.appendChild(this),this.style.display="block",e)try{n=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=t}catch(s){}else this._gsapBBox&&(n=this._gsapBBox());return r&&(a?r.insertBefore(this,a):r.appendChild(this)),Ap.removeChild(i),this.style.cssText=o,n},cv=function(t,e){for(var n=e.length;n--;)if(t.hasAttribute(e[n]))return t.getAttribute(e[n])},dv=function(t){var e;try{e=t.getBBox()}catch(n){e=hv.call(t,!0)}return e&&(e.width||e.height)||t.getBBox===hv||(e=hv.call(t,!0)),!e||e.width||e.x||e.y?e:{x:+cv(t,["x","cx","x1"])||0,y:+cv(t,["y","cy","y1"])||0,width:0,height:0}},fv=function(t){return!(!t.getCTM||t.parentNode&&!t.ownerSVGElement||!dv(t))},pv=function(t,e){if(e){var n=t.style;e in Dp&&e!==tv&&(e=$p),n.removeProperty?("ms"!==e.substr(0,2)&&"webkit"!==e.substr(0,6)||(e="-"+e),n.removeProperty(e.replace(Fp,"-$1").toLowerCase())):n.removeAttribute(e)}},vv=function(t,e,n,i,r,a){var o=new cp(t._pt,e,n,0,1,a?Wp:Xp);return t._pt=o,o.b=i,o.e=r,t._props.push(n),o},mv={deg:1,rad:1,turn:1},gv={grid:1,flex:1},yv=function t(e,n,i,r){var a,o,s,l,u=parseFloat(i)||0,h=(i+"").trim().substr((u+"").length)||"px",c=Cp.style,d=Bp.test(n),f="svg"===e.tagName.toLowerCase(),p=(f?"client":"offset")+(d?"Width":"Height"),v=100,m="px"===r,g="%"===r;return r===h||!u||mv[r]||mv[h]?u:("px"!==h&&!m&&(u=t(e,n,i,"px")),l=e.getCTM&&fv(e),!g&&"%"!==h||!Dp[n]&&!~n.indexOf("adius")?(c[d?"width":"height"]=v+(m?h:r),o=~n.indexOf("adius")||"em"===r&&e.appendChild&&!f?e:e.parentNode,l&&(o=(e.ownerSVGElement||{}).parentNode),o&&o!==Ep&&o.appendChild||(o=Ep.body),(s=o._gsap)&&g&&s.width&&d&&s.time===Mf.time&&!s.uncache?dd(u/s.width*v):((g||"%"===h)&&!gv[ov(o,"display")]&&(c.position=ov(e,"position")),o===e&&(c.position="static"),o.appendChild(Cp),a=Cp[p],o.removeChild(Cp),c.position="absolute",d&&g&&((s=ud(o)).time=Mf.time,s.width=o[p]),dd(m?a*u/v:a&&u?v/a*u:0))):(a=l?e.getBBox()[d?"width":"height"]:e[p],dd(g?u/a*v:u/100*a)))},_v=function(t,e,n,i){var r;return Pp||uv(),e in Gp&&"transform"!==e&&~(e=Gp[e]).indexOf(",")&&(e=e.split(",")[0]),Dp[e]&&"transform"!==e?(r=Rv(t,i),r="transformOrigin"!==e?r[e]:r.svg?r.origin:Iv(ov(t,tv))+" "+r.zOrigin+"px"):(!(r=t.style[e])||"auto"===r||i||~(r+"").indexOf("calc("))&&(r=Tv[e]&&Tv[e](t,e,n)||ov(t,e)||hd(t,e)||("opacity"===e?1:0)),n&&!~(r+"").trim().indexOf(" ")?yv(t,e,r,n)+n:r},xv=function(t,e,n,i){if(!n||"none"===n){var r=lv(e,t,1),a=r&&ov(t,r,1);a&&a!==n?(e=r,n=a):"borderColor"===e&&(n=ov(t,"borderTopColor"))}var o,s,l,u,h,c,d,f,p,v,m,g=new cp(this._pt,t.style,e,0,1,ap),y=0,_=0;if(g.b=n,g.e=i,n+="","auto"===(i+="")&&(t.style[e]=i,i=ov(t,e)||i,t.style[e]=n),Tf(o=[n,i]),i=o[1],l=(n=o[0]).match(Uc)||[],(i.match(Uc)||[]).length){for(;s=Uc.exec(i);)d=s[0],p=i.substring(y,s.index),h?h=(h+1)%5:"rgba("!==p.substr(-5)&&"hsla("!==p.substr(-5)||(h=1),d!==(c=l[_++]||"")&&(u=parseFloat(c)||0,m=c.substr((u+"").length),"="===d.charAt(1)&&(d=pd(u,d)+m),f=parseFloat(d),v=d.substr((f+"").length),y=Uc.lastIndex-v.length,v||(v=v||gc.units[e]||m,y===i.length&&(i+=v,g.e+=v)),m!==v&&(u=yv(t,e,c,v)||0),g._pt={_next:g._pt,p:p||1===_?p:",",s:u,c:f-u,m:h&&h<4||"zIndex"===e?Math.round:0});g.c=y<i.length?i.substring(y,i.length):""}else g.r="display"===e&&"none"===i?Wp:Xp;return zc.test(i)&&(g.e=0),this._pt=g,g},bv={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},wv=function(t){var e=t.split(" "),n=e[0],i=e[1]||"50%";return"top"!==n&&"bottom"!==n&&"left"!==i&&"right"!==i||(t=n,n=i,i=t),e[0]=bv[n]||n,e[1]=bv[i]||i,e.join(" ")},Sv=function(t,e){if(e.tween&&e.tween._time===e.tween._dur){var n,i,r,a=e.t,o=a.style,s=e.u,l=a._gsap;if("all"===s||!0===s)o.cssText="",i=1;else for(r=(s=s.split(",")).length;--r>-1;)n=s[r],Dp[n]&&(i=1,n="transformOrigin"===n?tv:$p),pv(a,n);i&&(pv(a,$p),l&&(l.svg&&a.removeAttribute("transform"),Rv(a,1),l.uncache=1,nv(o)))}},Tv={clearProps:function(t,e,n,i,r){if("isFromStart"!==r.data){var a=t._pt=new cp(t._pt,e,n,0,0,Sv);return a.u=i,a.pr=-10,a.tween=r,t._props.push(n),1}}},Mv=[1,0,0,1,0,0],Ev={},Av=function(t){return"matrix(1, 0, 0, 1, 0, 0)"===t||"none"===t||!t},Pv=function(t){var e=ov(t,$p);return Av(e)?Mv:e.substr(7).match(Bc).map(dd)},Cv=function(t,e){var n,i,r,a,o=t._gsap||ud(t),s=t.style,l=Pv(t);return o.svg&&t.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(r=t.transform.baseVal.consolidate().matrix).a,r.b,r.c,r.d,r.e,r.f]).join(",")?Mv:l:(l!==Mv||t.offsetParent||t===Ap||o.svg||(r=s.display,s.display="block",(n=t.parentNode)&&t.offsetParent||(a=1,i=t.nextElementSibling,Ap.appendChild(t)),l=Pv(t),r?s.display=r:pv(t,"display"),a&&(i?n.insertBefore(t,i):n?n.appendChild(t):Ap.removeChild(t))),e&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},kv=function(t,e,n,i,r,a){var o,s,l,u=t._gsap,h=r||Cv(t,!0),c=u.xOrigin||0,d=u.yOrigin||0,f=u.xOffset||0,p=u.yOffset||0,v=h[0],m=h[1],g=h[2],y=h[3],_=h[4],x=h[5],b=e.split(" "),w=parseFloat(b[0])||0,S=parseFloat(b[1])||0;n?h!==Mv&&(s=v*y-m*g)&&(l=w*(-m/s)+S*(v/s)-(v*x-m*_)/s,w=w*(y/s)+S*(-g/s)+(g*x-y*_)/s,S=l):(w=(o=dv(t)).x+(~b[0].indexOf("%")?w/100*o.width:w),S=o.y+(~(b[1]||b[0]).indexOf("%")?S/100*o.height:S)),i||!1!==i&&u.smooth?(_=w-c,x=S-d,u.xOffset=f+(_*v+x*g)-_,u.yOffset=p+(_*m+x*y)-x):u.xOffset=u.yOffset=0,u.xOrigin=w,u.yOrigin=S,u.smooth=!!i,u.origin=e,u.originIsAbsolute=!!n,t.style[tv]="0px 0px",a&&(vv(a,u,"xOrigin",c,w),vv(a,u,"yOrigin",d,S),vv(a,u,"xOffset",f,u.xOffset),vv(a,u,"yOffset",p,u.yOffset)),t.setAttribute("data-svg-origin",w+" "+S)},Rv=function(t,e){var n=t._gsap||new Bf(t);if("x"in n&&!e&&!n.uncache)return n;var i,r,a,o,s,l,u,h,c,d,f,p,v,m,g,y,_,x,b,w,S,T,M,E,A,P,C,k,R,I,D,O,L=t.style,N=n.scaleX<0,F="px",B="deg",U=getComputedStyle(t),G=ov(t,tv)||"0";return i=r=a=l=u=h=c=d=f=0,o=s=1,n.svg=!(!t.getCTM||!fv(t)),U.translate&&("none"===U.translate&&"none"===U.scale&&"none"===U.rotate||(L[$p]=("none"!==U.translate?"translate3d("+(U.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==U.rotate?"rotate("+U.rotate+") ":"")+("none"!==U.scale?"scale("+U.scale.split(" ").join(",")+") ":"")+("none"!==U[$p]?U[$p]:"")),L.scale=L.rotate=L.translate="none"),m=Cv(t,n.svg),n.svg&&(n.uncache?(A=t.getBBox(),G=n.xOrigin-A.x+"px "+(n.yOrigin-A.y)+"px",E=""):E=!e&&t.getAttribute("data-svg-origin"),kv(t,E||G,!!E||n.originIsAbsolute,!1!==n.smooth,m)),p=n.xOrigin||0,v=n.yOrigin||0,m!==Mv&&(x=m[0],b=m[1],w=m[2],S=m[3],i=T=m[4],r=M=m[5],6===m.length?(o=Math.sqrt(x*x+b*b),s=Math.sqrt(S*S+w*w),l=x||b?Np(b,x)*Op:0,(c=w||S?Np(w,S)*Op+l:0)&&(s*=Math.abs(Math.cos(c*Lp))),n.svg&&(i-=p-(p*x+v*w),r-=v-(p*b+v*S))):(O=m[6],I=m[7],C=m[8],k=m[9],R=m[10],D=m[11],i=m[12],r=m[13],a=m[14],u=(g=Np(O,R))*Op,g&&(E=T*(y=Math.cos(-g))+C*(_=Math.sin(-g)),A=M*y+k*_,P=O*y+R*_,C=T*-_+C*y,k=M*-_+k*y,R=O*-_+R*y,D=I*-_+D*y,T=E,M=A,O=P),h=(g=Np(-w,R))*Op,g&&(y=Math.cos(-g),D=S*(_=Math.sin(-g))+D*y,x=E=x*y-C*_,b=A=b*y-k*_,w=P=w*y-R*_),l=(g=Np(b,x))*Op,g&&(E=x*(y=Math.cos(g))+b*(_=Math.sin(g)),A=T*y+M*_,b=b*y-x*_,M=M*y-T*_,x=E,T=A),u&&Math.abs(u)+Math.abs(l)>359.9&&(u=l=0,h=180-h),o=dd(Math.sqrt(x*x+b*b+w*w)),s=dd(Math.sqrt(M*M+O*O)),g=Np(T,M),c=Math.abs(g)>2e-4?g*Op:0,f=D?1/(D<0?-D:D):0),n.svg&&(E=t.getAttribute("transform"),n.forceCSS=t.setAttribute("transform","")||!Av(ov(t,$p)),E&&t.setAttribute("transform",E))),Math.abs(c)>90&&Math.abs(c)<270&&(N?(o*=-1,c+=l<=0?180:-180,l+=l<=0?180:-180):(s*=-1,c+=c<=0?180:-180)),e=e||n.uncache,n.x=i-((n.xPercent=i&&(!e&&n.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-i)?-50:0)))?t.offsetWidth*n.xPercent/100:0)+F,n.y=r-((n.yPercent=r&&(!e&&n.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-r)?-50:0)))?t.offsetHeight*n.yPercent/100:0)+F,n.z=a+F,n.scaleX=dd(o),n.scaleY=dd(s),n.rotation=dd(l)+B,n.rotationX=dd(u)+B,n.rotationY=dd(h)+B,n.skewX=c+B,n.skewY=d+B,n.transformPerspective=f+F,(n.zOrigin=parseFloat(G.split(" ")[2])||0)&&(L[tv]=Iv(G)),n.xOffset=n.yOffset=0,n.force3D=gc.force3D,n.renderTransform=n.svg?Uv:Ip?Bv:Ov,n.uncache=0,n},Iv=function(t){return(t=t.split(" "))[0]+" "+t[1]},Dv=function(t,e,n){var i=Zd(e);return dd(parseFloat(e)+parseFloat(yv(t,"x",n+"px",i)))+i},Ov=function(t,e){e.z="0px",e.rotationY=e.rotationX="0deg",e.force3D=0,Bv(t,e)},Lv="0deg",Nv="0px",Fv=") ",Bv=function(t,e){var n=e||this,i=n.xPercent,r=n.yPercent,a=n.x,o=n.y,s=n.z,l=n.rotation,u=n.rotationY,h=n.rotationX,c=n.skewX,d=n.skewY,f=n.scaleX,p=n.scaleY,v=n.transformPerspective,m=n.force3D,g=n.target,y=n.zOrigin,_="",x="auto"===m&&t&&1!==t||!0===m;if(y&&(h!==Lv||u!==Lv)){var b,w=parseFloat(u)*Lp,S=Math.sin(w),T=Math.cos(w);w=parseFloat(h)*Lp,b=Math.cos(w),a=Dv(g,a,S*b*-y),o=Dv(g,o,-Math.sin(w)*-y),s=Dv(g,s,T*b*-y+y)}v!==Nv&&(_+="perspective("+v+Fv),(i||r)&&(_+="translate("+i+"%, "+r+"%) "),(x||a!==Nv||o!==Nv||s!==Nv)&&(_+=s!==Nv||x?"translate3d("+a+", "+o+", "+s+") ":"translate("+a+", "+o+Fv),l!==Lv&&(_+="rotate("+l+Fv),u!==Lv&&(_+="rotateY("+u+Fv),h!==Lv&&(_+="rotateX("+h+Fv),c===Lv&&d===Lv||(_+="skew("+c+", "+d+Fv),1===f&&1===p||(_+="scale("+f+", "+p+Fv),g.style[$p]=_||"translate(0, 0)"},Uv=function(t,e){var n,i,r,a,o,s=e||this,l=s.xPercent,u=s.yPercent,h=s.x,c=s.y,d=s.rotation,f=s.skewX,p=s.skewY,v=s.scaleX,m=s.scaleY,g=s.target,y=s.xOrigin,_=s.yOrigin,x=s.xOffset,b=s.yOffset,w=s.forceCSS,S=parseFloat(h),T=parseFloat(c);d=parseFloat(d),f=parseFloat(f),(p=parseFloat(p))&&(f+=p=parseFloat(p),d+=p),d||f?(d*=Lp,f*=Lp,n=Math.cos(d)*v,i=Math.sin(d)*v,r=Math.sin(d-f)*-m,a=Math.cos(d-f)*m,f&&(p*=Lp,o=Math.tan(f-p),r*=o=Math.sqrt(1+o*o),a*=o,p&&(o=Math.tan(p),n*=o=Math.sqrt(1+o*o),i*=o)),n=dd(n),i=dd(i),r=dd(r),a=dd(a)):(n=v,a=m,i=r=0),(S&&!~(h+"").indexOf("px")||T&&!~(c+"").indexOf("px"))&&(S=yv(g,"x",h,"px"),T=yv(g,"y",c,"px")),(y||_||x||b)&&(S=dd(S+y-(y*n+_*r)+x),T=dd(T+_-(y*i+_*a)+b)),(l||u)&&(o=g.getBBox(),S=dd(S+l/100*o.width),T=dd(T+u/100*o.height)),o="matrix("+n+","+i+","+r+","+a+","+S+","+T+")",g.setAttribute("transform",o),w&&(g.style[$p]=o)},Gv=function(t,e,n,i,r){var a,o,s=360,l=Ac(r),u=parseFloat(r)*(l&&~r.indexOf("rad")?Op:1)-i,h=i+u+"deg";return l&&("short"===(a=r.split("_")[1])&&(u%=s)!==u%180&&(u+=u<0?s:-360),"cw"===a&&u<0?u=(u+36e9)%s-~~(u/s)*s:"ccw"===a&&u>0&&(u=(u-36e9)%s-~~(u/s)*s)),t._pt=o=new cp(t._pt,e,n,i,u,Hp),o.e=h,o.u="deg",t._props.push(n),o},zv=function(t,e){for(var n in e)t[n]=e[n];return t},Hv=function(t,e,n){var i,r,a,o,s,l,u,h=zv({},n._gsap),c=n.style;for(r in h.svg?(a=n.getAttribute("transform"),n.setAttribute("transform",""),c[$p]=e,i=Rv(n,1),pv(n,$p),n.setAttribute("transform",a)):(a=getComputedStyle(n)[$p],c[$p]=e,i=Rv(n,1),c[$p]=a),Dp)(a=h[r])!==(o=i[r])&&"perspective,force3D,transformOrigin,svgOrigin".indexOf(r)<0&&(s=Zd(a)!==(u=Zd(o))?yv(n,r,a,u):parseFloat(a),l=parseFloat(o),t._pt=new cp(t._pt,i,r,s,l-s,zp),t._pt.u=u||0,t._props.push(r));zv(i,h)};cd("padding,margin,Width,Radius",(function(t,e){var n="Top",i="Right",r="Bottom",a="Left",o=(e<3?[n,i,r,a]:[n+a,n+i,r+i,r+a]).map((function(n){return e<2?t+n:"border"+n+t}));Tv[e>1?"border"+t:t]=function(t,e,n,i,r){var a,s;if(arguments.length<4)return a=o.map((function(e){return _v(t,e,n)})),5===(s=a.join(" ")).split(a[0]).length?a[0]:s;a=(i+"").split(" "),s={},o.forEach((function(t,e){return s[t]=a[e]=a[e]||a[(e-1)/2|0]})),t.init(e,s,r)}}));var Vv={name:"css",register:uv,targetTest:function(t){return t.style&&t.nodeType},init:function(t,e,n,i,r){var a,o,s,l,u,h,c,d,f,p,v,m,g,y,_,x,b=this._props,w=t.style,S=n.vars.startAt;for(c in Pp||uv(),this.styles=this.styles||rv(t),x=this.styles.props,this.tween=n,e)if("autoRound"!==c&&(o=e[c],!id[c]||!Xf(c,e,n,i,t,r)))if(u=typeof o,h=Tv[c],"function"===u&&(u=typeof(o=o.call(n,i,t,r))),"string"===u&&~o.indexOf("random(")&&(o=uf(o)),h)h(this,t,c,o,n)&&(_=1);else if("--"===c.substr(0,2))a=(getComputedStyle(t).getPropertyValue(c)+"").trim(),o+="",wf.lastIndex=0,wf.test(a)||(d=Zd(a),f=Zd(o)),f?d!==f&&(a=yv(t,c,a,f)+f):d&&(o+=d),this.add(w,"setProperty",a,o,i,r,0,0,c),b.push(c),x.push(c,0,w[c]);else if("undefined"!==u){if(S&&c in S?(a="function"===typeof S[c]?S[c].call(n,i,t,r):S[c],Ac(a)&&~a.indexOf("random(")&&(a=uf(a)),Zd(a+"")||(a+=gc.units[c]||Zd(_v(t,c))||""),"="===(a+"").charAt(1)&&(a=_v(t,c))):a=_v(t,c),l=parseFloat(a),(p="string"===u&&"="===o.charAt(1)&&o.substr(0,2))&&(o=o.substr(2)),s=parseFloat(o),c in Gp&&("autoAlpha"===c&&(1===l&&"hidden"===_v(t,"visibility")&&s&&(l=0),x.push("visibility",0,w.visibility),vv(this,w,"visibility",l?"inherit":"hidden",s?"inherit":"hidden",!s)),"scale"!==c&&"transform"!==c&&~(c=Gp[c]).indexOf(",")&&(c=c.split(",")[0])),v=c in Dp)if(this.styles.save(c),m||((g=t._gsap).renderTransform&&!e.parseTransform||Rv(t,e.parseTransform),y=!1!==e.smoothOrigin&&g.smooth,(m=this._pt=new cp(this._pt,w,$p,0,1,g.renderTransform,g,0,-1)).dep=1),"scale"===c)this._pt=new cp(this._pt,g,"scaleY",g.scaleY,(p?pd(g.scaleY,p+s):s)-g.scaleY||0,zp),this._pt.u=0,b.push("scaleY",c),c+="X";else{if("transformOrigin"===c){x.push(tv,0,w[tv]),o=wv(o),g.svg?kv(t,o,0,y,0,this):((f=parseFloat(o.split(" ")[2])||0)!==g.zOrigin&&vv(this,g,"zOrigin",g.zOrigin,f),vv(this,w,c,Iv(a),Iv(o)));continue}if("svgOrigin"===c){kv(t,o,1,y,0,this);continue}if(c in Ev){Gv(this,g,c,l,p?pd(l,p+o):o);continue}if("smoothOrigin"===c){vv(this,g,"smooth",g.smooth,o);continue}if("force3D"===c){g[c]=o;continue}if("transform"===c){Hv(this,o,t);continue}}else c in w||(c=lv(c)||c);if(v||(s||0===s)&&(l||0===l)&&!Up.test(o)&&c in w)s||(s=0),(d=(a+"").substr((l+"").length))!==(f=Zd(o)||(c in gc.units?gc.units[c]:d))&&(l=yv(t,c,a,f)),this._pt=new cp(this._pt,v?g:w,c,l,(p?pd(l,p+s):s)-l,v||"px"!==f&&"zIndex"!==c||!1===e.autoRound?zp:jp),this._pt.u=f||0,d!==f&&"%"!==f&&(this._pt.b=a,this._pt.r=Vp);else if(c in w)xv.call(this,t,c,a,p?p+o:o);else if(c in t)this.add(t,c,a||t[c],p?p+o:o,i,r);else if("parseTransform"!==c){qc(c,o);continue}v||(c in w?x.push(c,0,w[c]):x.push(c,1,a||t[c])),b.push(c)}_&&hp(this)},render:function(t,e){if(e.tween._time||!Rp())for(var n=e._pt;n;)n.r(t,n.d),n=n._next;else e.styles.revert()},get:_v,aliases:Gp,getSetter:function(t,e,n){var i=Gp[e];return i&&i.indexOf(",")<0&&(e=i),e in Dp&&e!==tv&&(t._gsap.x||_v(t,"x"))?n&&kp===n?"scale"===e?Zp:Kp:(kp=n||{})&&("scale"===e?Jp:Qp):t.style&&!kc(t.style[e])?qp:~e.indexOf("-")?Yp:np(t,e)},core:{_removeProperty:pv,_getMatrix:Cv}};Tp.utils.checkPrefix=lv,Tp.core.getStyleSaver=rv,function(t,e,n,i){var r=cd(t+","+e+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",(function(t){Dp[t]=1}));cd(e,(function(t){gc.units[t]="deg",Ev[t]=1})),Gp[r[13]]=t+","+e,cd("0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",(function(t){var e=t.split(":");Gp[e[1]]=r[e[0]]}))}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY"),cd("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",(function(t){gc.units[t]="px"})),Tp.registerPlugin(Vv);var jv=Tp.registerPlugin(Vv)||Tp,Xv=(jv.core.Tween,function(){function t(){a(this,t),console.log("Tools"),this.parseObject=this.parseObject.bind(this),this.DEG2RAD=.0174533,this.RAD2DEG=57.2958,this.screen2WorldVectorPos=new Ee,this.screen2WorldVectorDir=new Ee,this.screen2WorldVector=new Ee}return s(t,[{key:"load",value:function(){var t=r(e().mark((function t(n,i){var r;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n);case 2:return t.next=4,t.sent.json();case 4:r=t.sent,i(r);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"angle2pos",value:function(t,e,n){return{x:t.x+e*Math.cos(Math.PI*(n/180)),y:t.y+e*Math.sin(Math.PI*(n/180))}}},{key:"pos2angle",value:function(t,e){return Math.atan2(t.y-e.y,t.x-e.x)*(180/Math.PI)}},{key:"toPoint",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:5,y:5};if(!t)return e;var i=t.changedTouches?t.changedTouches[0]:t.touches?t.touches[0]:t;return e.x=i.clientX-n.x,e.y=i.clientY-n.y+window.pageYOffset,e}},{key:"distance",value:function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y))}},{key:"distance3d",value:function(t,e){return Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.z-t.z)*(e.z-t.z))}},{key:"getMovement",value:function(t,e){var n,i;return t.x1=t.x2,t.x2=e.x,n=e.x>t.x1?1:-1,t.y1=t.y2,t.y2=e.y,i=e.y>t.y1?1:-1,{x:n*this.distance({x:t.x1,y:0},{x:t.x2,y:0}),y:i*this.distance({x:0,y:t.y1},{x:0,y:t.y2})}}},{key:"getBoundingBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=9999,n=0,i=9999,r=0;return t.map((function(t){e=Math.min(e,t.x),n=Math.max(n,t.x),i=Math.min(i,t.y),r=Math.max(r,t.y)})),{x:e,y:i,w:n-e,h:r-i}}},{key:"getInstances",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=t.material,a=t.geometry,o=new Cn,s=new zo(a,r,n);return s.update=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){t.splice(0,t.length-n),s.count=t.length,s.childrenArr=t;for(var r=0;r<t.length;r++)o.position.copy(t[r].position),i?o.lookAt(i.position):e?o.quaternion.copy(t[r].rotation):(o.rotation.x=t[r].rotation.x,o.rotation.y=t[r].rotation.y,o.rotation.z=t[r].rotation.z),o.scale.copy(t[r].scale),o.updateMatrix(),s.setMatrixAt(r,o.matrix),t[r].color&&s.setColorAt(r,t[r].color);s.instanceMatrix.needsUpdate=!0}},s.clear=function(){console.log("instance clear"),s.count=0},s.update(e),s}},{key:"getMaxByProperty",value:function(t,e){for(var n,i,r=e.split(".")[0],a=e.split(".")[1],o=0,s=t.length-1;s>=0;s--)(n=a?t[s][r][a]:t[s][r])>=o&&(o=n,i=t[s]);return i}},{key:"match",value:function(t,e){return-1!==(e||"").search(t)}},{key:"setupIs",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=t?t.headers["user-agent"]:navigator.userAgent,i=e||{};return this.match(/Trident\/|MSIE/,n)&&(i.ie=!0),this.match("Edge/",n)&&(i.edge=!0),this.match("Firefox/",n)&&(i.firefox=!0),this.match("Chrome/",n)&&(i.chrome=!0),this.match("Safari",n)&&!this.match("Chrome",n)&&(i.safari=!0),this.match(/(iPhone|iPad|iPod)/,n)&&(i.ios=!0),this.match("Android",n)&&(i.android=!0),(this.match(/iPad/i,n)||this.match(/Android/i,n)&&!this.match(/Mobile/i,n))&&(i.tablet=!0),(i.ios||i.android)&&!i.tablet&&(i.mobile=!0),!i.mobile&&!i.tablet&&(i.desktop=!0),i.images=[i.chrome||i.firefox?"webm":null,"png","jpg"].filter((function(t){return null!==t})),i}},{key:"clean",value:function(t){if(t&&!t.dontdestroy)if(t.isMesh||"Sprite"==t.type)t.parent&&t.parent.remove(t),t.geometry.dispose(),t.material.dispose();else for(;t.children.length>0;){var e=t.children[0];e.isMesh||"Sprite"==e.type?(t.remove(e),e.geometry.dispose(),e.material.dispose()):e.children&&e.children.length>0&&!e.dontDestroy?this.clean(e):t.remove(e)}}},{key:"hitTest",value:function(t,e){return this.distance({x:t.position.x,y:0},{x:e.position.x,y:0})<t.size.x/2+e.size.x/2&&this.distance({x:0,y:t.position.z},{x:0,y:e.position.z})<t.size.z/2+e.size.z/2&&{x:t.position.x<e.position.x?-1:t.position.x>e.position.x?1:0,y:t.position.z<e.position.z?1:t.position.z>e.position.z?-1:0}}},{key:"hexToRgb",value:function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}},{key:"parseObject",value:function(t){var e,n=this;return"SkinnedMesh"==t.type||"Mesh"==t.type?e=t:t.children.map((function(t){t.children&&t.children.length>0?n.parseObject(t):"SkinnedMesh"!=t.type&&"Mesh"!=t.type||(e=t)})),e}},{key:"loadFont",value:function(t,e){var n="giItTWQy01234&@=-i?0",i=document.createElement("div");document.body.appendChild(i),i.innerText=n,i.style.display="inline",i.style.visibility="hidden",i.style.position="fixed";var r=document.createElement("div");document.body.appendChild(r),r.innerText=n,r.style.display="inline",r.style.visibility="hidden",r.style.position="fixed",function(){var n=setInterval((function(){r.style.fontFamily=t[a],i.getBoundingClientRect().width!==r.getBoundingClientRect().width&&(console.log(t[a]+" loaded"),a>=t.length-1?(clearInterval(n),document.body.removeChild(i),document.body.removeChild(r),setTimeout((function(){e()}),100)):a++)}),100)}();var a=0}},{key:"shuffle",value:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}}},{key:"shortByKey",value:function(t,e){t.sort((function(t,n){return t[e]-n[e]}))}},{key:"insert",value:function(t,e,n){t.splice(e,0,n)}},{key:"range",value:function(t,e){return t+(e-t)*Math.random()}},{key:"addPhysics",value:function(t,e,n,i,r){if(u.physic.world){var a=new wu,o=new ku;t&&(a.copy(t.position),o.copy(t.quaternion));var s=new Zu({position:a,quaternion:o,mass:e,shape:n,fixedRotation:i,material:r});return s.mesh=t,t&&(t.body=s),u.physic.world.addBody(s),s}}},{key:"getShortestAngle",value:function(t,e){var n=t*this.RAD2DEG/360%1*360;return{to:(n-(e=e*this.RAD2DEG/360%1*360)<=180?Math.abs(n-e)>180?-(360-e):e:180+(e+180))*this.DEG2RAD,from:n*this.DEG2RAD}}},{key:"getPixel",value:function(t,e,n){var i=t.getImageData(e,n,1,1).data;return"#"+("000000"+this.rgbToHex(i[0],i[1],i[2])).slice(-6)}},{key:"rgbToHex",value:function(t,e,n){if(t>255||e>255||n>255)throw"Invalid color component";return(t<<16|e<<8|n).toString(16)}},{key:"hashtagToHexa",value:function(t){return"0x"+t.split("#")[1]}},{key:"hexaToHashtag",value:function(t){return"#"+t.split("0x")[1]}},{key:"extendMaterial",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;e.onBeforeCompile=function(t){t.uniforms=_u(_u({},t.uniforms),n),t.fragmentShader=r.uniformsDefinition+t.fragmentShader,t.fragmentShader=t.fragmentShader.replace("#include <dithering_fragment>","#include <dithering_fragment>\n"+r.core),t.vertexShader=i.uniformsDefinition+t.vertexShader,t.vertexShader=t.vertexShader.replace("#include <uv_vertex>","#include <uv_vertex>\n"+i.core),e.userData.shader=t},e.customProgramCacheKey=function(){return t}}},{key:"forward",value:function(t,e,n){var i=t.rotation.y*this.RAD2DEG-90,r=180-t.rotation.x*this.RAD2DEG,a=this.angle2pos({x:t.position.x,y:t.position.z},e,i),o=this.angle2pos({x:t.position.z,y:t.position.y},e,r);if(!n)return new Ee(a.x,o.y,a.y);n.set(a.x,o.y,a.y)}},{key:"clearArray",value:function(t){for(;t.length>0;)t.pop()}},{key:"world2Screen",value:function(t,e,n){var i=this.screen2WorldVectorPos,r=this.screen2WorldVectorDir;i.set(2*t.x/window.innerWidth-1,2*t.y/window.innerHeight-1,.5).unproject(e),r.copy(i).sub(e.position).normalize();var a=-e.position.z/r.z;return this.screen2WorldVector.copy(e.position).add(r.multiplyScalar(a)),this.screen2WorldVector.y*=-1,this.screen2WorldVector.x+=n.x,this.screen2WorldVector.y+=n.y,this.screen2WorldVector}},{key:"getViewSize",value:function(t,e,n){var i=e.fov*Math.PI/180,r=2*Math.tan(i/2)*Math.abs(t),a=r*e.aspect;if(!n)return{x:a,y:r,z:t};n.set(a,r,t)}},{key:"colorTo",value:function(t,e,n){var i=new ve(e);jv.to(t.color,{duration:n,r:i.r,g:i.g,b:i.b})}},{key:"getTextShape",value:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if(""==e)return new bi;var s=0,l=0,u=new Vn({color:i,side:2,transparent:!0,opacity:a});u.userData.outlineParameters={visible:!1};var h=e,c=n.generateShapes(h,r),d=new gu(c);return d.computeBoundingBox(),o&&(s=-.5*(d.boundingBox.max.x-d.boundingBox.min.x),l=d.boundingBox.max.y-d.boundingBox.min.y),d.translate(s,l,0),(t=new bi(d,u)).height=l+2*r,t.width=d.boundingBox.max.x,t}},{key:"getProperties",value:function(t){var e=[];do{for(var n=Object.getOwnPropertyNames(t),i=0,r=n.length;i<r;i++){var a=n[i],o=Object.getOwnPropertyDescriptor(t,a);o.get||o.set||e.push(a)}}while(t=Object.getPrototypeOf(t));return e}},{key:"autobind",value:function(t){for(var e=this.getProperties(t),n=0,i=e.length;n<i;n++){var r=e[n],a=t[r];"constructor"!==r&&"function"===typeof a&&(t[r]=t[r].bind(t))}return t}},{key:"switchChars",value:function(t,e){var n="";t+="";for(var i=0;i<t.length;i++)n+=e;return n}},{key:"timeToSec",value:function(t){var e=Math.floor(t/1e3),n=Math.round(t-1e3*e);return e+Math.round(n/10)/100}}]),t}()),Wv=new Xv,qv=n(845),Yv=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this,t)).dracoLoader=null,i.ktx2Loader=null,i.meshoptDecoder=null,i.pluginCallbacks=[],i.register((function(t){return new $v(t)})),i.register((function(t){return new rm(t)})),i.register((function(t){return new am(t)})),i.register((function(t){return new tm(t)})),i.register((function(t){return new em(t)})),i.register((function(t){return new nm(t)})),i.register((function(t){return new im(t)})),i.register((function(t){return new Jv(t)})),i.register((function(t){return new om(t)})),i}return s(n,[{key:"load",value:function(t,e,n,i){var r,a=this;r=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:nu.extractUrlBase(t),this.manager.itemStart(t);var o=function(e){i?i(e):console.error(e),a.manager.itemError(t),a.manager.itemEnd(t)},s=new Bl(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(t,(function(n){try{a.parse(n,r,(function(n){e(n),a.manager.itemEnd(t)}),o)}catch(i){o(i)}}),n,o)}},{key:"setDRACOLoader",value:function(t){return this.dracoLoader=t,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(t){return this.ktx2Loader=t,this}},{key:"setMeshoptDecoder",value:function(t){return this.meshoptDecoder=t,this}},{key:"register",value:function(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}},{key:"unregister",value:function(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}},{key:"parse",value:function(t,e,n,i){var r,a={},o={};if("string"===typeof t)r=t;else if(nu.decodeText(new Uint8Array(t,0,4))===sm){try{a[Zv.KHR_BINARY_GLTF]=new hm(t)}catch(p){return void(i&&i(p))}r=a[Zv.KHR_BINARY_GLTF].content}else r=nu.decodeText(new Uint8Array(t));var s=JSON.parse(r);if(void 0===s.asset||s.asset.version[0]<2)i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var l=new Vm(s,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(var u=0;u<this.pluginCallbacks.length;u++){var h=this.pluginCallbacks[u](l);o[h.name]=h,a[h.name]=!0}if(s.extensionsUsed)for(var c=0;c<s.extensionsUsed.length;++c){var d=s.extensionsUsed[c],f=s.extensionsRequired||[];switch(d){case Zv.KHR_MATERIALS_UNLIT:a[d]=new Qv;break;case Zv.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:a[d]=new pm;break;case Zv.KHR_DRACO_MESH_COMPRESSION:a[d]=new cm(s,this.dracoLoader);break;case Zv.KHR_TEXTURE_TRANSFORM:a[d]=new dm;break;case Zv.KHR_MESH_QUANTIZATION:a[d]=new vm;break;default:f.indexOf(d)>=0&&void 0===o[d]&&console.warn('THREE.GLTFLoader: Unknown extension "'+d+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(n,i)}}}]),n}(Ll);function Kv(){var t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}var Zv={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},Jv=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return s(t,[{key:"_markDefs",value:function(){for(var t=this.parser,e=this.parser.json.nodes||[],n=0,i=e.length;n<i;n++){var r=e[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&t._addNodeRef(this.cache,r.extensions[this.name].light)}}},{key:"_loadLight",value:function(t){var e=this.parser,n="light:"+t,i=e.cache.get(n);if(i)return i;var r,a=e.json,o=((a.extensions&&a.extensions[this.name]||{}).lights||[])[t],s=new ve(16777215);void 0!==o.color&&s.fromArray(o.color);var l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(r=new tu(s)).target.position.set(0,0,-1),r.add(r.target);break;case"point":(r=new Ql(s)).distance=l;break;case"spot":(r=new ql(s)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,r.angle=o.spot.outerConeAngle,r.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,r.target.position.set(0,0,-1),r.add(r.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return r.position.set(0,0,0),r.decay=2,void 0!==o.intensity&&(r.intensity=o.intensity),r.name=e.createUniqueName(o.name||"light_"+t),i=Promise.resolve(r),e.cache.add(n,i),i}},{key:"createNodeAttachment",value:function(t){var e=this,n=this.parser,i=n.json.nodes[t],r=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===r?null:this._loadLight(r).then((function(t){return n._getNodeRef(e.cache,r,t)}))}}]),t}(),Qv=function(){function t(){a(this,t),this.name=Zv.KHR_MATERIALS_UNLIT}return s(t,[{key:"getMaterialType",value:function(){return Vn}},{key:"extendParams",value:function(t,e,n){var i=[];t.color=new ve(1,1,1),t.opacity=1;var r=e.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){var a=r.baseColorFactor;t.color.fromArray(a),t.opacity=a[3]}void 0!==r.baseColorTexture&&i.push(n.assignTexture(t,"map",r.baseColorTexture))}return Promise.all(i)}}]),t}(),$v=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_MATERIALS_CLEARCOAT}return s(t,[{key:"getMaterialType",value:function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ul:null}},{key:"extendMaterialParams",value:function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var r=[],a=i.extensions[this.name];if(void 0!==a.clearcoatFactor&&(e.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&r.push(n.assignTexture(e,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(e.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&r.push(n.assignTexture(e,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(r.push(n.assignTexture(e,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){var o=a.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new te(o,-o)}return Promise.all(r)}}]),t}(),tm=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_MATERIALS_TRANSMISSION}return s(t,[{key:"getMaterialType",value:function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ul:null}},{key:"extendMaterialParams",value:function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var r=[],a=i.extensions[this.name];return void 0!==a.transmissionFactor&&(e.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&r.push(n.assignTexture(e,"transmissionMap",a.transmissionTexture)),Promise.all(r)}}]),t}(),em=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_MATERIALS_VOLUME}return s(t,[{key:"getMaterialType",value:function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ul:null}},{key:"extendMaterialParams",value:function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var r=[],a=i.extensions[this.name];e.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&r.push(n.assignTexture(e,"thicknessMap",a.thicknessTexture)),e.attenuationDistance=a.attenuationDistance||0;var o=a.attenuationColor||[1,1,1];return e.attenuationTint=new ve(o[0],o[1],o[2]),Promise.all(r)}}]),t}(),nm=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_MATERIALS_IOR}return s(t,[{key:"getMaterialType",value:function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ul:null}},{key:"extendMaterialParams",value:function(t,e){var n=this.parser.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var i=n.extensions[this.name];return e.ior=void 0!==i.ior?i.ior:1.5,Promise.resolve()}}]),t}(),im=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_MATERIALS_SPECULAR}return s(t,[{key:"getMaterialType",value:function(t){var e=this.parser.json.materials[t];return e.extensions&&e.extensions[this.name]?ul:null}},{key:"extendMaterialParams",value:function(t,e){var n=this.parser,i=n.json.materials[t];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var r=[],a=i.extensions[this.name];e.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&r.push(n.assignTexture(e,"specularIntensityMap",a.specularTexture));var o=a.specularColorFactor||[1,1,1];return e.specularTint=new ve(o[0],o[1],o[2]),void 0!==a.specularColorTexture&&r.push(n.assignTexture(e,"specularTintMap",a.specularColorTexture).then((function(t){t.encoding=It}))),Promise.all(r)}}]),t}(),rm=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.KHR_TEXTURE_BASISU}return s(t,[{key:"loadTexture",value:function(t){var e=this.parser,n=e.json,i=n.textures[t];if(!i.extensions||!i.extensions[this.name])return null;var r=i.extensions[this.name],a=n.images[r.source],o=e.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(t,a,o)}}]),t}(),am=function(){function t(e){a(this,t),this.parser=e,this.name=Zv.EXT_TEXTURE_WEBP,this.isSupported=null}return s(t,[{key:"loadTexture",value:function(t){var e=this.name,n=this.parser,i=n.json,r=i.textures[t];if(!r.extensions||!r.extensions[e])return null;var a=r.extensions[e],o=i.images[a.source],s=n.textureLoader;if(o.uri){var l=n.options.manager.getHandler(o.uri);null!==l&&(s=l)}return this.detectSupport().then((function(r){if(r)return n.loadTextureImage(t,o,s);if(i.extensionsRequired&&i.extensionsRequired.indexOf(e)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(t)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(t){var e=new Image;e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",e.onload=e.onerror=function(){t(1===e.height)}}))),this.isSupported}}]),t}(),om=function(){function t(e){a(this,t),this.name=Zv.EXT_MESHOPT_COMPRESSION,this.parser=e}return s(t,[{key:"loadBufferView",value:function(t){var e=this.parser.json,n=e.bufferViews[t];if(n.extensions&&n.extensions[this.name]){var i=n.extensions[this.name],r=this.parser.getDependency("buffer",i.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,a.ready]).then((function(t){var e=i.byteOffset||0,n=i.byteLength||0,r=i.count,o=i.byteStride,s=new ArrayBuffer(r*o),l=new Uint8Array(t[0],e,n);return a.decodeGltfBuffer(new Uint8Array(s),r,o,l,i.mode,i.filter),s}))}return null}}]),t}(),sm="glTF",lm=1313821514,um=5130562,hm=s((function t(e){a(this,t),this.name=Zv.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(e,0,12);if(this.header={magic:nu.decodeText(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==sm)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,r=new DataView(e,12),o=0;o<i;){var s=r.getUint32(o,!0);o+=4;var l=r.getUint32(o,!0);if(o+=4,l===lm){var u=new Uint8Array(e,12+o,s);this.content=nu.decodeText(u)}else if(l===um){var h=12+o;this.body=e.slice(h,h+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")})),cm=function(){function t(e,n){if(a(this,t),!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Zv.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}return s(t,[{key:"decodePrimitive",value:function(t,e){var n=this.json,i=this.dracoLoader,r=t.extensions[this.name].bufferView,a=t.extensions[this.name].attributes,o={},s={},l={};for(var u in a){var h=km[u]||u.toLowerCase();o[h]=a[u]}for(var c in t.attributes){var d=km[c]||c.toLowerCase();if(void 0!==a[c]){var f=n.accessors[t.attributes[c]],p=Em[f.componentType];l[d]=p,s[d]=!0===f.normalized}}return e.getDependency("bufferView",r).then((function(t){return new Promise((function(e){i.decodeDracoFile(t,(function(t){for(var n in t.attributes){var i=t.attributes[n],r=s[n];void 0!==r&&(i.normalized=r)}e(t)}),o,l)}))}))}}]),t}(),dm=function(){function t(){a(this,t),this.name=Zv.KHR_TEXTURE_TRANSFORM}return s(t,[{key:"extendTexture",value:function(t,e){return void 0!==e.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===e.offset&&void 0===e.rotation&&void 0===e.scale||(t=t.clone(),void 0!==e.offset&&t.offset.fromArray(e.offset),void 0!==e.rotation&&(t.rotation=e.rotation),void 0!==e.scale&&t.repeat.fromArray(e.scale),t.needsUpdate=!0),t}}]),t}(),fm=function(t){d(n,t);var e=m(n);function n(t){var i;a(this,n),(i=e.call(this)).isGLTFSpecularGlossinessMaterial=!0;var r=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),o=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),s=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),u=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),c={specular:{value:(new ve).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return i._extraUniforms=c,i.onBeforeCompile=function(t){for(var e in c)t.uniforms[e]=c[e];t.fragmentShader=t.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",r).replace("#include <metalnessmap_pars_fragment>",o).replace("#include <roughnessmap_fragment>",s).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",u)},Object.defineProperties(h(i),{specular:{get:function(){return c.specular.value},set:function(t){c.specular.value=t}},specularMap:{get:function(){return c.specularMap.value},set:function(t){c.specularMap.value=t,t?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return c.glossiness.value},set:function(t){c.glossiness.value=t}},glossinessMap:{get:function(){return c.glossinessMap.value},set:function(t){c.glossinessMap.value=t,t?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete i.metalness,delete i.roughness,delete i.metalnessMap,delete i.roughnessMap,i.setValues(t),i}return s(n,[{key:"copy",value:function(t){return M(f(n.prototype),"copy",this).call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(ll),pm=function(){function t(){a(this,t),this.name=Zv.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return s(t,[{key:"getMaterialType",value:function(){return fm}},{key:"extendParams",value:function(t,e,n){var i=e.extensions[this.name];t.color=new ve(1,1,1),t.opacity=1;var r=[];if(Array.isArray(i.diffuseFactor)){var a=i.diffuseFactor;t.color.fromArray(a),t.opacity=a[3]}if(void 0!==i.diffuseTexture&&r.push(n.assignTexture(t,"map",i.diffuseTexture)),t.emissive=new ve(0,0,0),t.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,t.specular=new ve(1,1,1),Array.isArray(i.specularFactor)&&t.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var o=i.specularGlossinessTexture;r.push(n.assignTexture(t,"glossinessMap",o)),r.push(n.assignTexture(t,"specularMap",o))}return Promise.all(r)}},{key:"createMaterial",value:function(t){var e=new fm(t);return e.fog=!0,e.color=t.color,e.map=void 0===t.map?null:t.map,e.lightMap=null,e.lightMapIntensity=1,e.aoMap=void 0===t.aoMap?null:t.aoMap,e.aoMapIntensity=1,e.emissive=t.emissive,e.emissiveIntensity=1,e.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,e.bumpMap=void 0===t.bumpMap?null:t.bumpMap,e.bumpScale=1,e.normalMap=void 0===t.normalMap?null:t.normalMap,e.normalMapType=0,t.normalScale&&(e.normalScale=t.normalScale),e.displacementMap=null,e.displacementScale=1,e.displacementBias=0,e.specularMap=void 0===t.specularMap?null:t.specularMap,e.specular=t.specular,e.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,e.glossiness=t.glossiness,e.alphaMap=null,e.envMap=void 0===t.envMap?null:t.envMap,e.envMapIntensity=1,e.refractionRatio=.98,e}}]),t}(),vm=s((function t(){a(this,t),this.name=Zv.KHR_MESH_QUANTIZATION})),mm=function(t){d(n,t);var e=m(n);function n(t,i,r,o){return a(this,n),e.call(this,t,i,r,o)}return s(n,[{key:"copySampleValue_",value:function(t){for(var e=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=t*i*3+i,a=0;a!==i;a++)e[a]=n[r+a];return e}}]),n}(yl);mm.prototype.beforeStart_=mm.prototype.copySampleValue_,mm.prototype.afterEnd_=mm.prototype.copySampleValue_,mm.prototype.interpolate_=function(t,e,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=i-e,h=(n-e)/u,c=h*h,d=c*h,f=t*l,p=f-l,v=-2*d+3*c,m=d-c,g=1-v,y=m-c+h,_=0;_!==o;_++){var x=a[p+_+o],b=a[p+_+s]*u,w=a[f+_+o],S=a[f+_]*u;r[_]=g*x+y*b+v*w+m*S}return r};var gm=new Me,ym=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.apply(this,arguments)}return s(n,[{key:"interpolate_",value:function(t,e,i,r){var a=M(f(n.prototype),"interpolate_",this).call(this,t,e,i,r);return gm.fromArray(a).normalize().toArray(a),a}}]),n}(mm),_m=0,xm=1,bm=2,wm=3,Sm=4,Tm=5,Mm=6,Em={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Am={9728:F,9729:G,9984:B,9985:z,9986:U,9987:H},Pm={33071:L,33648:N,10497:O},Cm={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},km={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Rm={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Im={CUBICSPLINE:void 0,LINEAR:Mt,STEP:Tt},Dm="OPAQUE",Om="MASK",Lm="BLEND";function Nm(t,e){return"string"!==typeof t||""===t?"":(/^https?:\/\//i.test(e)&&/^\//.test(t)&&(e=e.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:e+t)}function Fm(t,e,n){for(var i in n.extensions)void 0===t[i]&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function Bm(t,e){void 0!==e.extras&&("object"===typeof e.extras?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Um(t,e){if(t.updateMorphTargets(),void 0!==e.weights)for(var n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){var r=e.extras.targetNames;if(t.morphTargetInfluences.length===r.length){t.morphTargetDictionary={};for(var a=0,o=r.length;a<o;a++)t.morphTargetDictionary[r[a]]=a}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Gm(t){var e=t.extensions&&t.extensions[Zv.KHR_DRACO_MESH_COMPRESSION];return e?"draco:"+e.bufferView+":"+e.indices+":"+zm(e.attributes):t.indices+":"+zm(t.attributes)+":"+t.mode}function zm(t){for(var e="",n=Object.keys(t).sort(),i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function Hm(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var Vm=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new Kv,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new iu(this.options.manager):this.textureLoader=new Gl(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Bl(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return s(t,[{key:"setExtensions",value:function(t){this.extensions=t}},{key:"setPlugins",value:function(t){this.plugins=t}},{key:"parse",value:function(t,e){var n=this,i=this.json,r=this.extensions;this.cache.removeAll(),this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(e){var a={scene:e[0][i.scene||0],scenes:e[0],animations:e[1],cameras:e[2],asset:i.asset,parser:n,userData:{}};Fm(r,a,i),Bm(a,i),Promise.all(n._invokeAll((function(t){return t.afterRoot&&t.afterRoot(a)}))).then((function(){t(a)}))})).catch(e)}},{key:"_markDefs",value:function(){for(var t=this.json.nodes||[],e=this.json.skins||[],n=this.json.meshes||[],i=0,r=e.length;i<r;i++)for(var a=e[i].joints,o=0,s=a.length;o<s;o++)t[a[o]].isBone=!0;for(var l=0,u=t.length;l<u;l++){var h=t[l];void 0!==h.mesh&&(this._addNodeRef(this.meshCache,h.mesh),void 0!==h.skin&&(n[h.mesh].isSkinnedMesh=!0)),void 0!==h.camera&&this._addNodeRef(this.cameraCache,h.camera)}}},{key:"_addNodeRef",value:function(t,e){void 0!==e&&(void 0===t.refs[e]&&(t.refs[e]=t.uses[e]=0),t.refs[e]++)}},{key:"_getNodeRef",value:function(t,e,n){if(t.refs[e]<=1)return n;var i=n.clone();return i.name+="_instance_"+t.uses[e]++,i}},{key:"_invokeOne",value:function(t){var e=Object.values(this.plugins);e.push(this);for(var n=0;n<e.length;n++){var i=t(e[n]);if(i)return i}return null}},{key:"_invokeAll",value:function(t){var e=Object.values(this.plugins);e.unshift(this);for(var n=[],i=0;i<e.length;i++){var r=t(e[i]);r&&n.push(r)}return n}},{key:"getDependency",value:function(t,e){var n=t+":"+e,i=this.cache.get(n);if(!i){switch(t){case"scene":i=this.loadScene(e);break;case"node":i=this.loadNode(e);break;case"mesh":i=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(e)}));break;case"accessor":i=this.loadAccessor(e);break;case"bufferView":i=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(e)}));break;case"buffer":i=this.loadBuffer(e);break;case"material":i=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(e)}));break;case"texture":i=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(e)}));break;case"skin":i=this.loadSkin(e);break;case"animation":i=this.loadAnimation(e);break;case"camera":i=this.loadCamera(e);break;default:throw new Error("Unknown type: "+t)}this.cache.add(n,i)}return i}},{key:"getDependencies",value:function(t){var e=this.cache.get(t);if(!e){var n=this,i=this.json[t+("mesh"===t?"es":"s")]||[];e=Promise.all(i.map((function(e,i){return n.getDependency(t,i)}))),this.cache.add(t,e)}return e}},{key:"loadBuffer",value:function(t){var e=this.json.buffers[t],n=this.fileLoader;if(e.type&&"arraybuffer"!==e.type)throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(void 0===e.uri&&0===t)return Promise.resolve(this.extensions[Zv.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(t,r){n.load(Nm(e.uri,i.path),t,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))}))}))}},{key:"loadBufferView",value:function(t){var e=this.json.bufferViews[t];return this.getDependency("buffer",e.buffer).then((function(t){var n=e.byteLength||0,i=e.byteOffset||0;return t.slice(i,i+n)}))}},{key:"loadAccessor",value:function(t){var e=this,n=this.json,i=this.json.accessors[t];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var r=[];return void 0!==i.bufferView?r.push(this.getDependency("bufferView",i.bufferView)):r.push(null),void 0!==i.sparse&&(r.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(r).then((function(t){var r,a,o=t[0],s=Cm[i.type],l=Em[i.componentType],u=l.BYTES_PER_ELEMENT,h=u*s,c=i.byteOffset||0,d=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,f=!0===i.normalized;if(d&&d!==h){var p=Math.floor(c/d),v="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+p+":"+i.count,m=e.cache.get(v);m||(r=new l(o,p*d,i.count*d/u),m=new wo(r,d/u),e.cache.add(v,m)),a=new To(m,s,c%d/u,f)}else r=null===o?new l(i.count*s):new l(o,c,i.count*s),a=new Wn(r,s,f);if(void 0!==i.sparse){var g=Cm.SCALAR,y=Em[i.sparse.indices.componentType],_=i.sparse.indices.byteOffset||0,x=i.sparse.values.byteOffset||0,b=new y(t[1],_,i.sparse.count*g),w=new l(t[2],x,i.sparse.count*s);null!==o&&(a=new Wn(a.array.slice(),a.itemSize,a.normalized));for(var S=0,T=b.length;S<T;S++){var M=b[S];if(a.setX(M,w[S*s]),s>=2&&a.setY(M,w[S*s+1]),s>=3&&a.setZ(M,w[S*s+2]),s>=4&&a.setW(M,w[S*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a}))}},{key:"loadTexture",value:function(t){var e=this.json,n=this.options,i=e.textures[t],r=e.images[i.source],a=this.textureLoader;if(r.uri){var o=n.manager.getHandler(r.uri);null!==o&&(a=o)}return this.loadTextureImage(t,r,a)}},{key:"loadTextureImage",value:function(t,e,n){var i=this,r=this.json,a=this.options,o=r.textures[t],s=(e.uri||e.bufferView)+":"+o.sampler;if(this.textureCache[s])return this.textureCache[s];var l=self.URL||self.webkitURL,u=e.uri||"",h=!1,c=!0,d=u.search(/\.jpe?g($|\?)/i)>0||0===u.search(/^data\:image\/jpeg/);if(("image/jpeg"===e.mimeType||d)&&(c=!1),void 0!==e.bufferView)u=i.getDependency("bufferView",e.bufferView).then((function(t){if("image/png"===e.mimeType){var n=new DataView(t,25,1).getUint8(0,!1);c=6===n||4===n||3===n}h=!0;var i=new Blob([t],{type:e.mimeType});return u=l.createObjectURL(i)}));else if(void 0===e.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");var f=Promise.resolve(u).then((function(t){return new Promise((function(e,i){var r=e;!0===n.isImageBitmapLoader&&(r=function(t){var n=new xe(t);n.needsUpdate=!0,e(n)}),n.load(Nm(t,a.path),r,void 0,i)}))})).then((function(e){!0===h&&l.revokeObjectURL(u),e.flipY=!1,o.name&&(e.name=o.name),c||(e.format=K);var n=(r.samplers||{})[o.sampler]||{};return e.magFilter=Am[n.magFilter]||G,e.minFilter=Am[n.minFilter]||H,e.wrapS=Pm[n.wrapS]||O,e.wrapT=Pm[n.wrapT]||O,i.associations.set(e,{type:"textures",index:t}),e})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",u),null}));return this.textureCache[s]=f,f}},{key:"assignTexture",value:function(t,e,n){var i=this;return this.getDependency("texture",n.index).then((function(r){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===e&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+e+" not yet supported."),i.extensions[Zv.KHR_TEXTURE_TRANSFORM]){var a=void 0!==n.extensions?n.extensions[Zv.KHR_TEXTURE_TRANSFORM]:void 0;if(a){var o=i.associations.get(r);r=i.extensions[Zv.KHR_TEXTURE_TRANSFORM].extendTexture(r,a),i.associations.set(r,o)}}return t[e]=r,r}))}},{key:"assignFinalMaterial",value:function(t){var e=t.geometry,n=t.material,i=void 0!==e.attributes.tangent,r=void 0!==e.attributes.color,a=void 0===e.attributes.normal;if(t.isPoints){var o="PointsMaterial:"+n.uuid,s=this.cache.get(o);s||(s=new $o,Hn.prototype.copy.call(s,n),s.color.copy(n.color),s.map=n.map,s.sizeAttenuation=!1,this.cache.add(o,s)),n=s}else if(t.isLine){var l="LineBasicMaterial:"+n.uuid,u=this.cache.get(l);u||(u=new Ho,Hn.prototype.copy.call(u,n),u.color.copy(n.color),this.cache.add(l,u)),n=u}if(i||r||a){var h="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(h+="specular-glossiness:"),i&&(h+="vertex-tangents:"),r&&(h+="vertex-colors:"),a&&(h+="flat-shading:");var c=this.cache.get(h);c||(c=n.clone(),r&&(c.vertexColors=!0),a&&(c.flatShading=!0),i&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(h,c),this.associations.set(c,this.associations.get(n))),n=c}n.aoMap&&void 0===e.attributes.uv2&&void 0!==e.attributes.uv&&e.setAttribute("uv2",e.attributes.uv),t.material=n}},{key:"getMaterialType",value:function(){return ll}},{key:"loadMaterial",value:function(t){var e,n=this,i=this.json,r=this.extensions,a=i.materials[t],o={},s=a.extensions||{},l=[];if(s[Zv.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var u=r[Zv.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];e=u.getMaterialType(),l.push(u.extendParams(o,a,n))}else if(s[Zv.KHR_MATERIALS_UNLIT]){var h=r[Zv.KHR_MATERIALS_UNLIT];e=h.getMaterialType(),l.push(h.extendParams(o,a,n))}else{var c=a.pbrMetallicRoughness||{};if(o.color=new ve(1,1,1),o.opacity=1,Array.isArray(c.baseColorFactor)){var d=c.baseColorFactor;o.color.fromArray(d),o.opacity=d[3]}void 0!==c.baseColorTexture&&l.push(n.assignTexture(o,"map",c.baseColorTexture)),o.metalness=void 0!==c.metallicFactor?c.metallicFactor:1,o.roughness=void 0!==c.roughnessFactor?c.roughnessFactor:1,void 0!==c.metallicRoughnessTexture&&(l.push(n.assignTexture(o,"metalnessMap",c.metallicRoughnessTexture)),l.push(n.assignTexture(o,"roughnessMap",c.metallicRoughnessTexture))),e=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),l.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,o)}))))}!0===a.doubleSided&&(o.side=2);var f=a.alphaMode||Dm;return f===Lm?(o.transparent=!0,o.depthWrite=!1):(o.format=K,o.transparent=!1,f===Om&&(o.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&e!==Vn&&(l.push(n.assignTexture(o,"normalMap",a.normalTexture)),o.normalScale=new te(1,-1),void 0!==a.normalTexture.scale&&o.normalScale.set(a.normalTexture.scale,-a.normalTexture.scale)),void 0!==a.occlusionTexture&&e!==Vn&&(l.push(n.assignTexture(o,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(o.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&e!==Vn&&(o.emissive=(new ve).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&e!==Vn&&l.push(n.assignTexture(o,"emissiveMap",a.emissiveTexture)),Promise.all(l).then((function(){var i;return i=e===fm?r[Zv.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(o):new e(o),a.name&&(i.name=a.name),i.map&&(i.map.encoding=It),i.emissiveMap&&(i.emissiveMap.encoding=It),Bm(i,a),n.associations.set(i,{type:"materials",index:t}),a.extensions&&Fm(r,i,a),i}))}},{key:"createUniqueName",value:function(t){for(var e=fu.sanitizeNodeName(t||""),n=e,i=1;this.nodeNamesUsed[n];++i)n=e+"_"+i;return this.nodeNamesUsed[n]=!0,n}},{key:"loadGeometries",value:function(t){var e=this,n=this.extensions,i=this.primitiveCache;function r(t){return n[Zv.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,e).then((function(n){return Xm(n,t,e)}))}for(var a=[],o=0,s=t.length;o<s;o++){var l=t[o],u=Gm(l),h=i[u];if(h)a.push(h.promise);else{var c=void 0;c=l.extensions&&l.extensions[Zv.KHR_DRACO_MESH_COMPRESSION]?r(l):Xm(new ii,l,e),i[u]={primitive:l,promise:c},a.push(c)}}return Promise.all(a)}},{key:"loadMesh",value:function(t){for(var e,n=this,i=this.json,r=this.extensions,a=i.meshes[t],o=a.primitives,s=[],l=0,u=o.length;l<u;l++){var h=void 0===o[l].material?(void 0===(e=this.cache).DefaultMaterial&&(e.DefaultMaterial=new ll({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),e.DefaultMaterial):this.getDependency("material",o[l].material);s.push(h)}return s.push(n.loadGeometries(o)),Promise.all(s).then((function(e){for(var i=e.slice(0,e.length-1),s=e[e.length-1],l=[],u=0,h=s.length;u<h;u++){var c=s[u],d=o[u],f=void 0,p=i[u];if(d.mode===Sm||d.mode===Tm||d.mode===Mm||void 0===d.mode)!0!==(f=!0===a.isSkinnedMesh?new ko(c,p):new bi(c,p)).isSkinnedMesh||f.geometry.attributes.skinWeight.normalized||f.normalizeSkinWeights(),d.mode===Tm?f.geometry=Wm(f.geometry,1):d.mode===Mm&&(f.geometry=Wm(f.geometry,2));else if(d.mode===xm)f=new Jo(c,p);else if(d.mode===wm)f=new Yo(c,p);else if(d.mode===bm)f=new Qo(c,p);else{if(d.mode!==_m)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);f=new rs(c,p)}Object.keys(f.geometry.morphAttributes).length>0&&Um(f,a),f.name=n.createUniqueName(a.name||"mesh_"+t),Bm(f,a),d.extensions&&Fm(r,f,d),n.assignFinalMaterial(f),l.push(f)}if(1===l.length)return l[0];for(var v=new ho,m=0,g=l.length;m<g;m++)v.add(l[m]);return v}))}},{key:"loadCamera",value:function(t){var e,n=this.json.cameras[t],i=n[n.type];if(i)return"perspective"===n.type?e=new Ci($t.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(e=new $i(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),n.name&&(e.name=this.createUniqueName(n.name)),Bm(e,n),Promise.resolve(e);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(t){var e=this.json.skins[t],n={joints:e.joints};return void 0===e.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",e.inverseBindMatrices).then((function(t){return n.inverseBindMatrices=t,n}))}},{key:"loadAnimation",value:function(t){for(var e=this.json.animations[t],n=[],i=[],r=[],a=[],o=[],s=0,l=e.channels.length;s<l;s++){var u=e.channels[s],h=e.samplers[u.sampler],c=u.target,d=void 0!==c.node?c.node:c.id,f=void 0!==e.parameters?e.parameters[h.input]:h.input,p=void 0!==e.parameters?e.parameters[h.output]:h.output;n.push(this.getDependency("node",d)),i.push(this.getDependency("accessor",f)),r.push(this.getDependency("accessor",p)),a.push(h),o.push(c)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(r),Promise.all(a),Promise.all(o)]).then((function(n){for(var i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=[],u=function(t,e){var n=i[t],u=r[t],h=a[t],c=o[t],d=s[t];if(void 0===n)return"continue";n.updateMatrix(),n.matrixAutoUpdate=!0;var f=void 0;switch(Rm[d.path]){case Rm.weights:f=Ml;break;case Rm.rotation:f=Al;break;default:f=Cl}var p=n.name?n.name:n.uuid,v=void 0!==c.interpolation?Im[c.interpolation]:Mt,m=[];Rm[d.path]===Rm.weights?n.traverse((function(t){!0===t.isMesh&&t.morphTargetInfluences&&m.push(t.name?t.name:t.uuid)})):m.push(p);var g=h.array;if(h.normalized){for(var y=Hm(g.constructor),_=new Float32Array(g.length),x=0,b=g.length;x<b;x++)_[x]=g[x]*y;g=_}for(var w=0,S=m.length;w<S;w++){var T=new f(m[w]+"."+Rm[d.path],u.array,g,v);"CUBICSPLINE"===c.interpolation&&(T.createInterpolant=function(t){return new(this instanceof Al?ym:mm)(this.times,this.values,this.getValueSize()/3,t)},T.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(T)}},h=0,c=i.length;h<c;h++)u(h);var d=e.name?e.name:"animation_"+t;return new kl(d,void 0,l)}))}},{key:"createNodeMesh",value:function(t){var e=this.json,n=this,i=e.nodes[t];return void 0===i.mesh?null:n.getDependency("mesh",i.mesh).then((function(t){var e=n._getNodeRef(n.meshCache,i.mesh,t);return void 0!==i.weights&&e.traverse((function(t){if(t.isMesh)for(var e=0,n=i.weights.length;e<n;e++)t.morphTargetInfluences[e]=i.weights[e]})),e}))}},{key:"loadNode",value:function(t){var e=this.json,n=this.extensions,i=this,r=e.nodes[t],a=r.name?i.createUniqueName(r.name):"";return function(){var e=[],n=i._invokeOne((function(e){return e.createNodeMesh&&e.createNodeMesh(t)}));return n&&e.push(n),void 0!==r.camera&&e.push(i.getDependency("camera",r.camera).then((function(t){return i._getNodeRef(i.cameraCache,r.camera,t)}))),i._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(t){e.push(t)})),Promise.all(e)}().then((function(e){var o;if((o=!0===r.isBone?new Ro:e.length>1?new ho:1===e.length?e[0]:new Cn)!==e[0])for(var s=0,l=e.length;s<l;s++)o.add(e[s]);if(r.name&&(o.userData.name=r.name,o.name=a),Bm(o,r),r.extensions&&Fm(n,o,r),void 0!==r.matrix){var u=new rn;u.fromArray(r.matrix),o.applyMatrix4(u)}else void 0!==r.translation&&o.position.fromArray(r.translation),void 0!==r.rotation&&o.quaternion.fromArray(r.rotation),void 0!==r.scale&&o.scale.fromArray(r.scale);return i.associations.set(o,{type:"nodes",index:t}),o}))}},{key:"loadScene",value:function(t){var e=this.json,n=this.extensions,i=this.json.scenes[t],r=new ho;i.name&&(r.name=this.createUniqueName(i.name)),Bm(r,i),i.extensions&&Fm(n,r,i);for(var a=i.nodes||[],o=[],s=0,l=a.length;s<l;s++)o.push(jm(a[s],r,e,this));return Promise.all(o).then((function(){return r}))}}]),t}();function jm(t,e,n,i){var r=n.nodes[t];return i.getDependency("node",t).then((function(t){return void 0===r.skin?t:i.getDependency("skin",r.skin).then((function(t){for(var n=[],r=0,a=(e=t).joints.length;r<a;r++)n.push(i.getDependency("node",e.joints[r]));return Promise.all(n)})).then((function(n){return t.traverse((function(t){if(t.isMesh){for(var i=[],r=[],a=0,o=n.length;a<o;a++){var s=n[a];if(s){i.push(s);var l=new rn;void 0!==e.inverseBindMatrices&&l.fromArray(e.inverseBindMatrices.array,16*a),r.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[a])}t.bind(new Lo(i,r),t.matrixWorld)}})),t}));var e})).then((function(t){e.add(t);var a=[];if(r.children)for(var o=r.children,s=0,l=o.length;s<l;s++){var u=o[s];a.push(jm(u,t,n,i))}return Promise.all(a)}))}function Xm(t,e,n){var i=e.attributes,r=[];function a(e,i){return n.getDependency("accessor",e).then((function(e){t.setAttribute(i,e)}))}for(var o in i){var s=km[o]||o.toLowerCase();s in t.attributes||r.push(a(i[o],s))}if(void 0!==e.indices&&!t.index){var l=n.getDependency("accessor",e.indices).then((function(e){t.setIndex(e)}));r.push(l)}return Bm(t,e),function(t,e,n){var i=e.attributes,r=new Ce;if(void 0!==i.POSITION){var a=n.json.accessors[i.POSITION],o=a.min,s=a.max;if(void 0!==o&&void 0!==s){if(r.set(new Ee(o[0],o[1],o[2]),new Ee(s[0],s[1],s[2])),a.normalized){var l=Hm(Em[a.componentType]);r.min.multiplyScalar(l),r.max.multiplyScalar(l)}var u=e.targets;if(void 0!==u){for(var h=new Ee,c=new Ee,d=0,f=u.length;d<f;d++){var p=u[d];if(void 0!==p.POSITION){var v=n.json.accessors[p.POSITION],m=v.min,g=v.max;if(void 0!==m&&void 0!==g){if(c.setX(Math.max(Math.abs(m[0]),Math.abs(g[0]))),c.setY(Math.max(Math.abs(m[1]),Math.abs(g[1]))),c.setZ(Math.max(Math.abs(m[2]),Math.abs(g[2]))),v.normalized){var y=Hm(Em[v.componentType]);c.multiplyScalar(y)}h.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(h)}t.boundingBox=r;var _=new Ye;r.getCenter(_.center),_.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=_}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,e,n),Promise.all(r).then((function(){return void 0!==e.targets?function(t,e,n){for(var i=!1,r=!1,a=0,o=e.length;a<o;a++){var s=e[a];if(void 0!==s.POSITION&&(i=!0),void 0!==s.NORMAL&&(r=!0),i&&r)break}if(!i&&!r)return Promise.resolve(t);for(var l=[],u=[],h=0,c=e.length;h<c;h++){var d=e[h];if(i){var f=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):t.attributes.position;l.push(f)}if(r){var p=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):t.attributes.normal;u.push(p)}}return Promise.all([Promise.all(l),Promise.all(u)]).then((function(e){var n=e[0],a=e[1];return i&&(t.morphAttributes.position=n),r&&(t.morphAttributes.normal=a),t.morphTargetsRelative=!0,t}))}(t,e.targets,n):t}))}function Wm(t,e){var n=t.getIndex();if(null===n){var i=[],r=t.getAttribute("position");if(void 0===r)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var a=0;a<r.count;a++)i.push(a);t.setIndex(i),n=t.getIndex()}var o=n.count-2,s=[];if(2===e)for(var l=1;l<=o;l++)s.push(n.getX(0)),s.push(n.getX(l)),s.push(n.getX(l+1));else for(var u=0;u<o;u++)u%2===0?(s.push(n.getX(u)),s.push(n.getX(u+1)),s.push(n.getX(u+2))):(s.push(n.getX(u+2)),s.push(n.getX(u+1)),s.push(n.getX(u)));s.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var h=t.clone();return h.setIndex(s),h}var qm=function(){function t(){var e=this;a(this,t),this._incDataLoaded=function(){e.dataLoaded++},this._checkNameAvailability=this._checkNameAvailability.bind(this),this.imgs=[],this.jsons=[],this.audio=[],this.glbs=[],this.assets={},this.dataSize=0,this.dataLoaded=0}return s(t,[{key:"addEventListener",value:function(t,e){switch(t){case"complete":this._completeCallback=e;break;case"progress":this._progressCallback=e}}},{key:"removeEventListener",value:function(t){switch(t){case"complete":this._completeCallback=null;break;case"progress":this._progressCallback=null}}},{key:"add",value:function(t){var e=t.path.split(".").pop();switch(e){case"jpg":case"png":this.imgs.push(t),this.dataSize++;break;case"json":this.jsons.push(t),this.dataSize++;break;case"mp3":this.audio.push(t),this.dataSize++;break;case"glb":this.glbs.push(t),this.dataSize++;break;default:console.warn("AssetsLoader::","'."+e+"' type not supported for now")}}},{key:"load",value:function(){var t=this;this._process(),this.isAllAssetsLoaded=setInterval((function(){var e=t.dataLoaded/t.dataSize;t._progressCallback&&t._progressCallback({type:"progress",percent:e}),e>=1&&(t.isAllAssetsLoaded&&clearInterval(t.isAllAssetsLoaded),t._completeCallback&&t._completeCallback({type:"complete",assets:t.assets}))}),100)}},{key:"_process",value:function(){this._loadImgs(),this._loadJson(),this._loadAudio(),this._loadGlb()}},{key:"_loadImgs",value:function(){for(var t,e=this,n=0;n<this.imgs.length;n++)(t=new Image)._name=this.imgs[n].name,t._path=this.imgs[n].path,t._ext=this.imgs[n].path.split(".").pop(),t.addEventListener("load",(function(t){e._checkNameAvailability(t.target._name,t.target,t.target._ext)}),!1),t.addEventListener("error",(function(t){console.warn("AssetsLoader::",t.target._path,"error loading"),e._incDataLoaded()}),!1),t.src=this.imgs[n].path}},{key:"_loadAudio",value:function(){for(var t,e=this.audio,n=this._incDataLoaded,i=this._checkNameAvailability,r=0;r<e.length;r++)(t=new qv.Howl({src:[e[r].path],sprite:e[r].audioSprite,onload:function(){i(this._name,this,this._ext)},onloaderror:function(){console.warn("AssetsLoader::",this._name,"error loading"),n()}}))._name=e[r].name,t._ext=e[r].path.split(".").pop()}},{key:"_loadGlb",value:function(){for(var t=this,e=0;e<this.glbs.length;e++){var n=new Yv;n.resourcePath=this.glbs[e].name,n.load(this.glbs[e].path,(function(e){t._checkNameAvailability(e.parser.options.path,e,"glb")}),null,(function(e){console.warn("AssetsLoader:: glb loading error,",e),t._incDataLoaded()}))}}},{key:"loadGlb",value:function(t,e,n,i){var r=new Yv;r.resourcePath=t,r.load(e,(function(t){n(t)}),null,(function(t){i("AssetsLoader:: glb loading error,"+t)}))}},{key:"_loadJson",value:function(){var t=r(e().mark((function t(){var n,i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<this.jsons.length)){t.next=18;break}return t.prev=2,t.next=5,fetch(this.jsons[n].path);case 5:return t.next=7,t.sent.json();case 7:i=t.sent,this._checkNameAvailability(this.jsons[n].name,i,"json"),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(2),console.warn("AssetsLoader::",this.jsons[n].path,t.t0),this._incDataLoaded();case 15:n++,t.next=1;break;case 18:case"end":return t.stop()}}),t,this,[[2,11]])})));return function(){return t.apply(this,arguments)}}()},{key:"_checkNameAvailability",value:function(t,e,n){this.assets[t]?console.warn(t,"AssetsLoader::","already assigned"):this.assets[t]=e,this._incDataLoaded()}},{key:"verbose",get:function(){return this._verbose},set:function(t){this._verbose=t}}]),t}(),Ym=new qm;var Km=function(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))};var Zm=function(t){return new this((function(e,n){if(!t||"undefined"===typeof t.length)return n(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function a(t,n){if(n&&("object"===typeof n||"function"===typeof n)){var o=n.then;if("function"===typeof o)return void o.call(n,(function(e){a(t,e)}),(function(n){i[t]={status:"rejected",reason:n},0===--r&&e(i)}))}i[t]={status:"fulfilled",value:n},0===--r&&e(i)}for(var o=0;o<i.length;o++)a(o,i[o])}))};function Jm(t,e){this.name="AggregateError",this.errors=t,this.message=e||""}Jm.prototype=Error.prototype;var Qm=function(t){var e=this;return new e((function(n,i){if(!t||"undefined"===typeof t.length)return i(new TypeError("Promise.any accepts an array"));var r=Array.prototype.slice.call(t);if(0===r.length)return i();for(var a=[],o=0;o<r.length;o++)try{e.resolve(r[o]).then(n).catch((function(t){a.push(t),a.length===r.length&&i(new Jm(a,"All promises were rejected"))}))}catch(s){i(s)}}))},$m=setTimeout;function tg(t){return Boolean(t&&"undefined"!==typeof t.length)}function eg(){}function ng(t){if(!(this instanceof ng))throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],lg(t,this)}function ig(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,ng._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(r){return void ag(e.promise,r)}rg(e.promise,i)}else(1===t._state?rg:ag)(e.promise,t._value)}))):t._deferreds.push(e)}function rg(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof ng)return t._state=3,t._value=e,void og(t);if("function"===typeof n)return void lg((i=n,r=e,function(){i.apply(r,arguments)}),t)}t._state=1,t._value=e,og(t)}catch(a){ag(t,a)}var i,r}function ag(t,e){t._state=2,t._value=e,og(t)}function og(t){2===t._state&&0===t._deferreds.length&&ng._immediateFn((function(){t._handled||ng._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)ig(t,t._deferreds[e]);t._deferreds=null}function sg(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function lg(t,e){var n=!1;try{t((function(t){n||(n=!0,rg(e,t))}),(function(t){n||(n=!0,ag(e,t))}))}catch(i){if(n)return;n=!0,ag(e,i)}}ng.prototype.catch=function(t){return this.then(null,t)},ng.prototype.then=function(t,e){var n=new this.constructor(eg);return ig(this,new sg(t,e,n)),n},ng.prototype.finally=Km,ng.all=function(t){return new ng((function(e,n){if(!tg(t))return n(new TypeError("Promise.all accepts an array"));var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var r=i.length;function a(t,o){try{if(o&&("object"===typeof o||"function"===typeof o)){var s=o.then;if("function"===typeof s)return void s.call(o,(function(e){a(t,e)}),n)}i[t]=o,0===--r&&e(i)}catch(l){n(l)}}for(var o=0;o<i.length;o++)a(o,i[o])}))},ng.any=Qm,ng.allSettled=Zm,ng.resolve=function(t){return t&&"object"===typeof t&&t.constructor===ng?t:new ng((function(e){e(t)}))},ng.reject=function(t){return new ng((function(e,n){n(t)}))},ng.race=function(t){return new ng((function(e,n){if(!tg(t))return n(new TypeError("Promise.race accepts an array"));for(var i=0,r=t.length;i<r;i++)ng.resolve(t[i]).then(e,n)}))},ng._immediateFn="function"===typeof setImmediate&&function(t){setImmediate(t)}||function(t){$m(t,0)},ng._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var ug=ng,hg=n(725);"undefined"===typeof globalThis&&("undefined"!==typeof self?self.globalThis=self:"undefined"!==typeof global&&(global.globalThis=global)),globalThis.Promise||(globalThis.Promise=ug),Object.assign||(Object.assign=hg);if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!globalThis.performance||!globalThis.performance.now){var cg=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-cg}}for(var dg,fg,pg,vg,mg,gg,yg,_g,xg,bg,wg,Sg,Tg,Mg,Eg,Ag,Pg,Cg,kg,Rg,Ig=Date.now(),Dg=["ms","moz","webkit","o"],Og=0;Og<Dg.length&&!globalThis.requestAnimationFrame;++Og){var Lg=Dg[Og];globalThis.requestAnimationFrame=globalThis[Lg+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[Lg+"CancelAnimationFrame"]||globalThis[Lg+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(t){if("function"!==typeof t)throw new TypeError(t+"is not a function");var e=Date.now(),n=16+Ig-e;return n<0&&(n=0),Ig=e,globalThis.self.setTimeout((function(){Ig=Date.now(),t(performance.now())}),n)}),globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(t){return clearTimeout(t)}),Math.sign||(Math.sign=function(t){return 0===(t=Number(t))||isNaN(t)?t:t>0?1:-1}),Number.isInteger||(Number.isInteger=function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t}),globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array),globalThis.Float32Array||(globalThis.Float32Array=Array),globalThis.Uint32Array||(globalThis.Uint32Array=Array),globalThis.Uint16Array||(globalThis.Uint16Array=Array),globalThis.Uint8Array||(globalThis.Uint8Array=Array),globalThis.Int32Array||(globalThis.Int32Array=Array),function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(dg||(dg={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(fg||(fg={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(pg||(pg={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(vg||(vg={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(mg||(mg={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.RG=33319]="RG",t[t.RED=6403]="RED",t[t.RGBA_INTEGER=36249]="RGBA_INTEGER",t[t.RGB_INTEGER=36248]="RGB_INTEGER",t[t.RG_INTEGER=33320]="RG_INTEGER",t[t.RED_INTEGER=36244]="RED_INTEGER",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(gg||(gg={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(yg||(yg={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.UNSIGNED_INT=5125]="UNSIGNED_INT",t[t.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",t[t.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",t[t.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",t[t.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",t[t.BYTE=5120]="BYTE",t[t.SHORT=5122]="SHORT",t[t.INT=5124]="INT",t[t.FLOAT=5126]="FLOAT",t[t.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(_g||(_g={})),function(t){t[t.FLOAT=0]="FLOAT",t[t.INT=1]="INT",t[t.UINT=2]="UINT"}(xg||(xg={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(bg||(bg={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(wg||(wg={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON",t[t.ON_MANUAL=3]="ON_MANUAL"}(Sg||(Sg={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",t[t.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"}(Tg||(Tg={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(Mg||(Mg={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(Eg||(Eg={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(Ag||(Ag={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE",t[t.COLOR=4]="COLOR"}(Pg||(Pg={})),function(t){t[t.RED=1]="RED",t[t.GREEN=2]="GREEN",t[t.BLUE=4]="BLUE",t[t.ALPHA=8]="ALPHA"}(Cg||(Cg={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(kg||(kg={})),function(t){t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"}(Rg||(Rg={}));var Ng={createCanvas:function(t,e){var n=document.createElement("canvas");return n.width=t,n.height=e,n},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var t;return null!==(t=document.baseURI)&&void 0!==t?t:window.location.href},fetch:function(t){function e(e,n){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){return fetch(t,e)}))},Fg=/iPhone/i,Bg=/iPod/i,Ug=/iPad/i,Gg=/\biOS-universal(?:.+)Mac\b/i,zg=/\bAndroid(?:.+)Mobile\b/i,Hg=/Android/i,Vg=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,jg=/Silk/i,Xg=/Windows Phone/i,Wg=/\bWindows(?:.+)ARM\b/i,qg=/BlackBerry/i,Yg=/BB10/i,Kg=/Opera Mini/i,Zg=/\b(CriOS|Chrome)(?:.+)Mobile/i,Jg=/Mobile(?:.+)Firefox\b/i,Qg=function(t){return"undefined"!==typeof t&&"MacIntel"===t.platform&&"number"===typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"===typeof MSStream};var $g=function(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"===typeof navigator?"string"===typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var n=e.userAgent,i=n.split("[FBAN");"undefined"!==typeof i[1]&&(n=i[0]),"undefined"!==typeof(i=n.split("Twitter"))[1]&&(n=i[0]);var r=function(t){return function(e){return e.test(t)}}(n),a={apple:{phone:r(Fg)&&!r(Xg),ipod:r(Bg),tablet:!r(Fg)&&(r(Ug)||Qg(e))&&!r(Xg),universal:r(Gg),device:(r(Fg)||r(Bg)||r(Ug)||r(Gg)||Qg(e))&&!r(Xg)},amazon:{phone:r(Vg),tablet:!r(Vg)&&r(jg),device:r(Vg)||r(jg)},android:{phone:!r(Xg)&&r(Vg)||!r(Xg)&&r(zg),tablet:!r(Xg)&&!r(Vg)&&!r(zg)&&(r(jg)||r(Hg)),device:!r(Xg)&&(r(Vg)||r(jg)||r(zg)||r(Hg))||r(/\bokhttp\b/i)},windows:{phone:r(Xg),tablet:r(Wg),device:r(Xg)||r(Wg)},other:{blackberry:r(qg),blackberry10:r(Yg),opera:r(Kg),firefox:r(Jg),chrome:r(Zg),device:r(qg)||r(Yg)||r(Kg)||r(Jg)||r(Zg)},any:!1,phone:!1,tablet:!1};return a.any=a.apple.device||a.android.device||a.windows.device||a.other.device,a.phone=a.apple.phone||a.android.phone||a.windows.phone,a.tablet=a.apple.tablet||a.android.tablet||a.windows.tablet,a}(globalThis.navigator);var ty={ADAPTER:Ng,MIPMAP_TEXTURES:Sg.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:kg.NONE,SPRITE_MAX_TEXTURES:function(t){var e=!0;if($g.tablet||$g.phone){var n;if($g.apple.device)if(n=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(n[1],10)<11&&(e=!1);if($g.android.device)if(n=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(n[1],10)<7&&(e=!1)}return e?t:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:Eg.AUTO,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:wg.CLAMP,SCALE_MODE:bg.LINEAR,PRECISION_VERTEX:Ag.HIGH,PRECISION_FRAGMENT:$g.apple.device?Ag.HIGH:Ag.MEDIUM,CAN_UPLOAD_SAME_BUFFER:!$g.apple.device,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},ey=n(810),ny=n(89),iy=n(114),ry={parse:iy.Qc,format:iy.WU,resolve:iy.DB};ty.RETINA_PREFIX=/@([0-9\.]+)x/,ty.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var ay,oy=!1;var sy={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function ly(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function uy(t){var e=t.toString(16);return"#"+(e="000000".substring(0,6-e.length)+e)}function hy(t){return"string"===typeof t&&"#"===(t=sy[t.toLowerCase()]||t)[0]&&(t=t.slice(1)),parseInt(t,16)}var cy=function(){for(var t=[],e=[],n=0;n<32;n++)t[n]=n,e[n]=n;t[vg.NORMAL_NPM]=vg.NORMAL,t[vg.ADD_NPM]=vg.ADD,t[vg.SCREEN_NPM]=vg.SCREEN,e[vg.NORMAL]=vg.NORMAL_NPM,e[vg.ADD]=vg.ADD_NPM,e[vg.SCREEN]=vg.SCREEN_NPM;var i=[];return i.push(e),i.push(t),i}();function dy(t,e){return cy[e?1:0][t]}function fy(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var n=t>>16&255,i=t>>8&255,r=255&t;return(255*e<<24)+((n=n*e+.5|0)<<16)+((i=i*e+.5|0)<<8)+(r=r*e+.5|0)}function py(t,e,n,i){return(n=n||new Float32Array(4))[0]=(t>>16&255)/255,n[1]=(t>>8&255)/255,n[2]=(255&t)/255,(i||void 0===i)&&(n[0]*=e,n[1]*=e,n[2]*=e),n[3]=e,n}function vy(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}Float32Array,Uint32Array,Int32Array,Uint8Array;function my(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function gy(t){return!(t&t-1)&&!!t}function yy(t){var e=(t>65535?1:0)<<4,n=((t>>>=e)>255?1:0)<<3;return e|=n,e|=n=((t>>>=n)>15?1:0)<<2,(e|=n=((t>>>=n)>3?1:0)<<1)|(t>>>=n)>>1}function _y(t,e,n){var i,r=t.length;if(!(e>=r||0===n)){var a=r-(n=e+n>r?r-e:n);for(i=e;i<a;++i)t[i]=t[i+n];t.length=a}}function xy(t){return 0===t?0:t<0?-1:1}var by=0;function wy(){return++by}var Sy={};function Ty(t,e,n){if(void 0===n&&(n=3),!Sy[e]){var i=(new Error).stack;"undefined"===typeof i?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(i=i.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(i))),Sy[e]=!0}}var My={},Ey=Object.create(null),Ay=Object.create(null);var Py=function(){function t(t,e,n){this.canvas=ty.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=n||ty.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),t}();var Cy;function ky(t,e){var n=ty.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==e?e:1}var Ry,Iy=2*Math.PI,Dy=180/Math.PI,Oy=Math.PI/180;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Ry||(Ry={}));var Ly=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},t}(),Ny=[new Ly,new Ly,new Ly,new Ly],Fy=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(n),this.height=Number(i),this.type=Ry.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.intersects=function(t,e){if(!e){var n=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=n)return!1;var i=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>i}var r=this.left,a=this.right,o=this.top,s=this.bottom;if(a<=r||s<=o)return!1;var l=Ny[0].set(t.left,t.top),u=Ny[1].set(t.left,t.bottom),h=Ny[2].set(t.right,t.top),c=Ny[3].set(t.right,t.bottom);if(h.x<=l.x||u.y<=l.y)return!1;var d=Math.sign(e.a*e.d-e.b*e.c);if(0===d)return!1;if(e.apply(l,l),e.apply(u,u),e.apply(h,h),e.apply(c,c),Math.max(l.x,u.x,h.x,c.x)<=r||Math.min(l.x,u.x,h.x,c.x)>=a||Math.max(l.y,u.y,h.y,c.y)<=o||Math.min(l.y,u.y,h.y,c.y)>=s)return!1;var f=d*(u.y-l.y),p=d*(l.x-u.x),v=f*r+p*o,m=f*a+p*o,g=f*r+p*s,y=f*a+p*s;if(Math.max(v,m,g,y)<=f*l.x+p*l.y||Math.min(v,m,g,y)>=f*c.x+p*c.y)return!1;var _=d*(l.y-h.y),x=d*(h.x-l.x),b=_*r+x*o,w=_*a+x*o,S=_*r+x*s,T=_*a+x*s;return!(Math.max(b,w,S,T)<=_*l.x+x*l.y||Math.min(b,w,S,T)>=_*c.x+x*c.y)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),n=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),r=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(n-e,0),this.y=i,this.height=Math.max(r-i,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var n=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=n-this.x,this.height=i-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),n=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),r=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=n-e,this.y=i,this.height=r-i,this},t.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),By=function(){function t(t,e,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),this.x=t,this.y=e,this.radius=n,this.type=Ry.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,e){if(this.radius<=0)return!1;var n=this.radius*this.radius,i=this.x-t,r=this.y-e;return(i*=i)+(r*=r)<=n},t.prototype.getBounds=function(){return new Fy(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},t}(),Uy=function(){function t(t,e,n,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),this.x=t,this.y=e,this.width=n,this.height=i,this.type=Ry.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var n=(t-this.x)/this.width,i=(e-this.y)/this.height;return(n*=n)+(i*=i)<=1},t.prototype.getBounds=function(){return new Fy(this.x-this.width,this.y-this.height,this.width,this.height)},t.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t}(),Gy=function(){function t(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=Array.isArray(e[0])?e[0]:e;if("number"!==typeof i[0]){for(var r=[],a=0,o=i.length;a<o;a++)r.push(i[a].x,i[a].y);i=r}this.points=i,this.type=Ry.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var e=new t(this.points.slice());return e.closeStroke=this.closeStroke,e},t.prototype.contains=function(t,e){for(var n=!1,i=this.points.length/2,r=0,a=i-1;r<i;a=r++){var o=this.points[2*r],s=this.points[2*r+1],l=this.points[2*a],u=this.points[2*a+1];s>e!==u>e&&t<(e-s)/(u-s)*(l-o)+o&&(n=!n)}return n},t.prototype.toString=function(){return"[@pixi/math:PolygoncloseStroke="+this.closeStroke+"points="+this.points.reduce((function(t,e){return t+", "+e}),"")+"]"},t}(),zy=function(){function t(t,e,n,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=20),this.x=t,this.y=e,this.width=n,this.height=i,this.radius=r,this.type=Ry.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var n=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+n&&e<=this.y+this.height-n||t>=this.x+n&&t<=this.x+this.width-n)return!0;var i=t-(this.x+n),r=e-(this.y+n),a=n*n;if(i*i+r*r<=a)return!0;if((i=t-(this.x+this.width-n))*i+r*r<=a)return!0;if(i*i+(r=e-(this.y+this.height-n))*r<=a)return!0;if((i=t-(this.x+n))*i+r*r<=a)return!0}return!1},t.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+"width="+this.width+" height="+this.height+" radius="+this.radius+"]"},t}(),Hy=function(){function t(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0),this._x=n,this._y=i,this.cb=t,this.scope=e}return t.prototype.clone=function(e,n){return void 0===e&&(e=this.cb),void 0===n&&(n=this.scope),new t(e,n,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},t.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),Vy=function(){function t(t,e,n,i,r,a){void 0===t&&(t=1),void 0===e&&(e=0),void 0===n&&(n=0),void 0===i&&(i=1),void 0===r&&(r=0),void 0===a&&(a=0),this.array=null,this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=a}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,n,i,r,a){return this.a=t,this.b=e,this.c=n,this.d=i,this.tx=r,this.ty=a,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var n=e||this.array;return t?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},t.prototype.apply=function(t,e){e=e||new Ly;var n=t.x,i=t.y;return e.x=this.a*n+this.c*i+this.tx,e.y=this.b*n+this.d*i+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Ly;var n=1/(this.a*this.d+this.c*-this.b),i=t.x,r=t.y;return e.x=this.d*n*i+-this.c*n*r+(this.ty*this.c-this.tx*this.d)*n,e.y=this.a*n*r+-this.b*n*i+(-this.ty*this.a+this.tx*this.b)*n,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),n=Math.sin(t),i=this.a,r=this.c,a=this.tx;return this.a=i*e-this.b*n,this.b=i*n+this.b*e,this.c=r*e-this.d*n,this.d=r*n+this.d*e,this.tx=a*e-this.ty*n,this.ty=a*n+this.ty*e,this},t.prototype.append=function(t){var e=this.a,n=this.b,i=this.c,r=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*n+t.b*r,this.c=t.c*e+t.d*i,this.d=t.c*n+t.d*r,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*n+t.ty*r+this.ty,this},t.prototype.setTransform=function(t,e,n,i,r,a,o,s,l){return this.a=Math.cos(o+l)*r,this.b=Math.sin(o+l)*r,this.c=-Math.sin(o-s)*a,this.d=Math.cos(o-s)*a,this.tx=t-(n*this.a+i*this.c),this.ty=e-(n*this.b+i*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var n=this.a,i=this.c;this.a=n*t.a+this.b*t.c,this.b=n*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,n=this.b,i=this.c,r=this.d,a=t.pivot,o=-Math.atan2(-i,r),s=Math.atan2(n,e),l=Math.abs(o+s);return l<1e-5||Math.abs(Iy-l)<1e-5?(t.rotation=s,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=s),t.scale.x=Math.sqrt(e*e+n*n),t.scale.y=Math.sqrt(i*i+r*r),t.position.x=this.tx+(a.x*e+a.y*i),t.position.y=this.ty+(a.x*n+a.y*r),t},t.prototype.invert=function(){var t=this.a,e=this.b,n=this.c,i=this.d,r=this.tx,a=t*i-e*n;return this.a=i/a,this.b=-e/a,this.c=-n/a,this.d=t/a,this.tx=(n*this.ty-i*r)/a,this.ty=-(t*this.ty-e*r)/a,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),jy=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Xy=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Wy=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],qy=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Yy=[],Ky=[],Zy=Math.sign;!function(){for(var t=0;t<16;t++){var e=[];Yy.push(e);for(var n=0;n<16;n++)for(var i=Zy(jy[t]*jy[n]+Wy[t]*Xy[n]),r=Zy(Xy[t]*jy[n]+qy[t]*Xy[n]),a=Zy(jy[t]*Wy[n]+Wy[t]*qy[n]),o=Zy(Xy[t]*Wy[n]+qy[t]*qy[n]),s=0;s<16;s++)if(jy[s]===i&&Xy[s]===r&&Wy[s]===a&&qy[s]===o){e.push(s);break}}for(t=0;t<16;t++){var l=new Vy;l.set(jy[t],Xy[t],Wy[t],qy[t],0,0),Ky.push(l)}}();var Jy={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return jy[t]},uY:function(t){return Xy[t]},vX:function(t){return Wy[t]},vY:function(t){return qy[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return Yy[t][e]},sub:function(t,e){return Yy[t][Jy.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2===(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Jy.S:Jy.N:2*Math.abs(e)<=Math.abs(t)?t>0?Jy.E:Jy.W:e>0?t>0?Jy.SE:Jy.SW:t>0?Jy.NE:Jy.NW},matrixAppendRotationInv:function(t,e,n,i){void 0===n&&(n=0),void 0===i&&(i=0);var r=Ky[Jy.inv(e)];r.tx=n,r.ty=i,t.append(r)}},Qy=function(){function t(){this.worldTransform=new Vy,this.localTransform=new Vy,this.position=new Hy(this.onChange,this,0,0),this.scale=new Hy(this.onChange,this,1,1),this.pivot=new Hy(this.onChange,this,0,0),this.skew=new Hy(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.toString=function(){return"[@pixi/math:Transform position=("+this.position.x+", "+this.position.y+") rotation="+this.rotation+" scale=("+this.scale.x+", "+this.scale.y+") skew=("+this.skew.x+", "+this.skew.y+") ]"},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var n=t.worldTransform,i=this.worldTransform;i.a=e.a*n.a+e.b*n.c,i.b=e.a*n.b+e.b*n.d,i.c=e.c*n.a+e.d*n.c,i.d=e.c*n.b+e.d*n.d,i.tx=e.tx*n.a+e.ty*n.c+n.tx,i.ty=e.tx*n.b+e.ty*n.d+n.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();ty.SORTABLE_CHILDREN=!1;var $y=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?Fy.EMPTY:((t=t||new Fy(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addPointMatrix=function(t,e){var n=t.a,i=t.b,r=t.c,a=t.d,o=t.tx,s=t.ty,l=n*e.x+r*e.y+o,u=i*e.x+a*e.y+s;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,u),this.maxY=Math.max(this.maxY,u)},t.prototype.addQuad=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY,a=t[0],o=t[1];e=a<e?a:e,n=o<n?o:n,i=a>i?a:i,r=o>r?o:r,e=(a=t[2])<e?a:e,n=(o=t[3])<n?o:n,i=a>i?a:i,r=o>r?o:r,e=(a=t[4])<e?a:e,n=(o=t[5])<n?o:n,i=a>i?a:i,r=o>r?o:r,e=(a=t[6])<e?a:e,n=(o=t[7])<n?o:n,i=a>i?a:i,r=o>r?o:r,this.minX=e,this.minY=n,this.maxX=i,this.maxY=r},t.prototype.addFrame=function(t,e,n,i,r){this.addFrameMatrix(t.worldTransform,e,n,i,r)},t.prototype.addFrameMatrix=function(t,e,n,i,r){var a=t.a,o=t.b,s=t.c,l=t.d,u=t.tx,h=t.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,v=a*e+s*n+u,m=o*e+l*n+h;c=v<c?v:c,d=m<d?m:d,f=v>f?v:f,p=m>p?m:p,c=(v=a*i+s*n+u)<c?v:c,d=(m=o*i+l*n+h)<d?m:d,f=v>f?v:f,p=m>p?m:p,c=(v=a*e+s*r+u)<c?v:c,d=(m=o*e+l*r+h)<d?m:d,f=v>f?v:f,p=m>p?m:p,c=(v=a*i+s*r+u)<c?v:c,d=(m=o*i+l*r+h)<d?m:d,f=v>f?v:f,p=m>p?m:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p},t.prototype.addVertexData=function(t,e,n){for(var i=this.minX,r=this.minY,a=this.maxX,o=this.maxY,s=e;s<n;s+=2){var l=t[s],u=t[s+1];i=l<i?l:i,r=u<r?u:r,a=l>a?l:a,o=u>o?u:o}this.minX=i,this.minY=r,this.maxX=a,this.maxY=o},t.prototype.addVertices=function(t,e,n,i){this.addVerticesMatrix(t.worldTransform,e,n,i)},t.prototype.addVerticesMatrix=function(t,e,n,i,r,a){void 0===r&&(r=0),void 0===a&&(a=r);for(var o=t.a,s=t.b,l=t.c,u=t.d,h=t.tx,c=t.ty,d=this.minX,f=this.minY,p=this.maxX,v=this.maxY,m=n;m<i;m+=2){var g=e[m],y=e[m+1],_=o*g+l*y+h,x=u*y+s*g+c;d=Math.min(d,_-r),p=Math.max(p,_+r),f=Math.min(f,x-a),v=Math.max(v,x+a)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=v},t.prototype.addBounds=function(t){var e=this.minX,n=this.minY,i=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<n?t.minY:n,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var n=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(n<=r&&i<=a){var o=this.minX,s=this.minY,l=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<s?i:s,this.maxX=r>l?r:l,this.maxY=a>u?a:u}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var n=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(n<=r&&i<=a){var o=this.minX,s=this.minY,l=this.maxX,u=this.maxY;this.minX=n<o?n:o,this.minY=i<s?i:s,this.maxX=r>l?r:l,this.maxY=a>u?a:u}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,n,i,r,a){t-=r,e-=a,n+=r,i+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},t}(),t_=function(t,e){return t_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t_(t,e)};function e_(t,e){function n(){this.constructor=t}t_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var n_=function(t){function e(){var e=t.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new Qy,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new $y,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return e_(e,t),e.mixin=function(t){for(var n=Object.keys(t),i=0;i<n.length;++i){var r=n[i];Object.defineProperty(e.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},Object.defineProperty(e.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),e.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},e.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},e.prototype.getBounds=function(t,e){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),e||(this._boundsRect||(this._boundsRect=new Fy),e=this._boundsRect),this._bounds.getRectangle(e)},e.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new Fy),t=this._localBoundsRect),this._localBounds||(this._localBounds=new $y);var e=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var i=this._bounds,r=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=n,this.transform=e,this._bounds=i,this._bounds.updateID+=this._boundsID-r,a},e.prototype.toGlobal=function(t,e,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},e.prototype.toLocal=function(t,e,n,i){return e&&(t=e.toGlobal(t,n,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,n)},e.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},e.prototype.setTransform=function(t,e,n,i,r,a,o,s,l){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=1),void 0===r&&(r=0),void 0===a&&(a=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=0),this.position.x=t,this.position.y=e,this.scale.x=n||1,this.scale.y=i||1,this.rotation=r,this.skew.x=a,this.skew.y=o,this.pivot.x=s,this.pivot.y=l,this},e.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(e.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new i_),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),e.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},e.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(e.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return this.transform.rotation*Dy},set:function(t){this.transform.rotation=t*Oy},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){var e;if(this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1));if(this._mask=t,this._mask)(e=this._mask.isMaskData?this._mask.maskObject:this._mask)&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}},enumerable:!1,configurable:!0}),e}(ey),i_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return e_(e,t),e}(n_);function r_(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}n_.prototype.displayObjectUpdateTransform=n_.prototype.updateTransform;var a_=function(t){function e(){var e=t.call(this)||this;return e.children=[],e.sortableChildren=ty.SORTABLE_CHILDREN,e.sortDirty=!1,e}return e_(e,t),e.prototype.onChildrenChange=function(t){},e.prototype.addChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.addChild(e[i]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},e.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},e.prototype.swapChildren=function(t,e){if(t!==e){var n=this.getChildIndex(t),i=this.getChildIndex(e);this.children[n]=e,this.children[i]=t,this.onChildrenChange(n<i?n:i)}},e.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},e.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);_y(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},e.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},e.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var i=0;i<e.length;i++)this.removeChild(e[i]);else{var r=e[0],a=this.children.indexOf(r);if(-1===a)return null;r.parent=null,r.transform._parentID=-1,_y(this.children,a,1),this._boundsID++,this.onChildrenChange(a),r.emit("removed",this),this.emit("childRemoved",r,this,a)}return e[0]},e.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,_y(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},e.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var n,i=t,r=e-i;if(r>0&&r<=e){n=this.children.splice(i,r);for(var a=0;a<n.length;++a)n[a].parent=null,n[a].transform&&(n[a].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(a=0;a<n.length;++a)n[a].emit("removed",this),this.emit("childRemoved",n[a],this,a);return n}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},e.prototype.sortChildren=function(){for(var t=!1,e=0,n=this.children.length;e<n;++e){var i=this.children[e];i._lastSortedIndex=e,t||0===i.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(r_),this.sortDirty=!1},e.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var n=this.children[t];n.visible&&n.updateTransform()}},e.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var n=e._mask.isMaskData?e._mask.maskObject:e._mask;n?(n.calculateBounds(),this._bounds.addBoundsMask(e._bounds,n._bounds)):this._bounds.addBounds(e._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},e.prototype.getLocalBounds=function(e,n){void 0===n&&(n=!1);var i=t.prototype.getLocalBounds.call(this,e);if(!n)for(var r=0,a=this.children.length;r<a;++r){var o=this.children[r];o.visible&&o.updateTransform()}return i},e.prototype._calculateBounds=function(){},e.prototype._renderWithCulling=function(t){var n=t.renderTexture.sourceFrame;if(n.width>0&&n.height>0){var i,r;if(this.cullArea?(i=this.cullArea,r=this.worldTransform):this._render!==e.prototype._render&&(i=this.getBounds(!0)),i&&n.intersects(i,r))this._render(t);else if(this.cullArea)return;for(var a=0,o=this.children.length;a<o;++a){var s=this.children[a],l=s.cullable;s.cullable=l||!this.cullArea,s.render(t),s.cullable=l}}},e.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else if(this.cullable)this._renderWithCulling(t);else{this._render(t);for(var e=0,n=this.children.length;e<n;++e)this.children[e].render(t)}},e.prototype.renderAdvanced=function(t){var e=this.filters,n=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var i=0;i<e.length;i++)e[i].enabled&&this._enabledFilters.push(e[i])}var r=e&&this._enabledFilters&&this._enabledFilters.length||n&&(!n.isMaskData||n.enabled&&(n.autoDetect||n.type!==Pg.NONE));if(r&&t.batch.flush(),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.push(this,this._enabledFilters),n&&t.mask.push(this,this._mask),this.cullable)this._renderWithCulling(t);else{this._render(t);i=0;for(var a=this.children.length;i<a;++i)this.children[i].render(t)}r&&t.batch.flush(),n&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},e.prototype._render=function(t){},e.prototype.destroy=function(e){t.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"===typeof e?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(n)for(var r=0;r<i.length;++r)i[r].destroy(e)},Object.defineProperty(e.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),e}(n_);a_.prototype.containerUpdateTransform=a_.prototype.updateTransform;var o_,s_=function(){return s_=Object.assign||function(t){for(var e,n=arguments,i=1,r=arguments.length;i<r;i++)for(var a in e=n[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},s_.apply(this,arguments)};!function(t){t.Application="application",t.RendererPlugin="renderer-webgl-plugin",t.CanvasRendererPlugin="renderer-canvas-plugin",t.Loader="loader",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser"}(o_||(o_={}));var l_,u_=function(t){if("function"===typeof t||"object"===typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");var e="object"!==typeof t.extension?{type:t.extension}:t.extension;t=s_(s_({},e),{ref:t})}if("object"!==typeof t)throw new Error("Invalid extension type");return"string"===typeof(t=s_({},t)).type&&(t.type=[t.type]),t},h_={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var t=arguments,e=this,n=[],i=0;i<arguments.length;i++)n[i]=t[i];return n.map(u_).forEach((function(t){t.type.forEach((function(n){var i,r;return null===(r=(i=e._removeHandlers)[n])||void 0===r?void 0:r.call(i,t)}))})),this},add:function(){for(var t=arguments,e=this,n=[],i=0;i<arguments.length;i++)n[i]=t[i];return n.map(u_).forEach((function(t){t.type.forEach((function(n){var i=e._addHandlers,r=e._queue;i[n]?i[n](t):(r[n]=r[n]||[],r[n].push(t))}))})),this},handle:function(t,e,n){var i=this._addHandlers=this._addHandlers||{},r=this._removeHandlers=this._removeHandlers||{};if(i[t]||r[t])throw new Error("Extension type "+t+" already has a handler");i[t]=e,r[t]=n;var a=this._queue;return a[t]&&(a[t].forEach((function(t){return e(t)})),delete a[t]),this},handleByMap:function(t,e){return this.handle(t,(function(t){e[t.name]=t.ref}),(function(t){delete e[t.name]}))},handleByList:function(t,e){return this.handle(t,(function(n){var i,r;e.includes(n.ref)||(e.push(n.ref),t===o_.Loader&&(null===(r=(i=n.ref).add)||void 0===r||r.call(i)))}),(function(t){var n=e.indexOf(t.ref);-1!==n&&e.splice(n,1)}))}},c_=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,n,i,r,a,o,s){if(arguments.length>8)throw new Error("max arguments reached");var l=this,u=l.name,h=l.items;this._aliasCount++;for(var c=0,d=h.length;c<d;c++)h[c][u](t,e,n,i,r,a,o,s);return h===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(c_.prototype,{dispatch:{value:c_.prototype.emit},run:{value:c_.prototype.emit}}),ty.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(l_||(l_={}));var d_=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=0),void 0===i&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=n,this.once=i}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),f_=function(){function t(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new d_(null,null,1/0),this.deltaMS=1/ty.TARGET_FPMS,this.elapsedMS=1/ty.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,n){return void 0===n&&(n=l_.NORMAL),this._addListener(new d_(t,e,n))},t.prototype.addOnce=function(t,e,n){return void 0===n&&(n=l_.NORMAL),this._addListener(new d_(t,e,n,!0))},t.prototype._addListener=function(t){var e=this._head.next,n=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(n);break}n=e,e=e.next}t.previous||t.connect(n)}else t.connect(n);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var n=this._head.next;n;)n=n.match(t,e)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*ty.TARGET_FPMS;for(var i=this._head,r=i.next;r;)r=r.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,e)/1e3,ty.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),p_=function(){function t(){}return t.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,l_.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?f_.shared:new f_,t.autoStart&&this.start()},t.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},t.extension=o_.Application,t}();ty.PREFER_ENV=$g.any?dg.WEBGL:dg.WEBGL2,ty.STRICT_TEXTURE_CACHE=!1;var v_=[];function m_(t,e){if(!t)return null;var n="";if("string"===typeof t){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);i&&(n=i[1].toLowerCase())}for(var r=v_.length-1;r>=0;--r){var a=v_[r];if(a.test&&a.test(t,n))return new a(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var g_=function(t,e){return g_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},g_(t,e)};function y_(t,e){function n(){this.constructor=t}g_(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var __=function(){return __=Object.assign||function(t){for(var e,n=arguments,i=1,r=arguments.length;i<r;i++)for(var a in e=n[i])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},__.apply(this,arguments)};var x_=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new c_("setRealSize"),this.onUpdate=new c_("update"),this.onError=new c_("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,n){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),b_=function(t){function e(e,n){var i=this,r=n||{},a=r.width,o=r.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return(i=t.call(this,a,o)||this).data=e,i}return y_(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Tg.UNPACK);var r=e.realWidth,a=e.realHeight;return n.width===r&&n.height===a?i.texSubImage2D(e.target,0,0,0,r,a,e.format,n.type,this.data):(n.width=r,n.height=a,i.texImage2D(e.target,0,n.internalFormat,r,a,0,e.format,n.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(x_),w_={scaleMode:bg.NEAREST,format:gg.RGBA,alphaMode:Tg.NPM},S_=function(t){function e(e,n){void 0===e&&(e=null),void 0===n&&(n=null);var i=t.call(this)||this,r=(n=n||{}).alphaMode,a=n.mipmap,o=n.anisotropicLevel,s=n.scaleMode,l=n.width,u=n.height,h=n.wrapMode,c=n.format,d=n.type,f=n.target,p=n.resolution,v=n.resourceOptions;return!e||e instanceof x_||((e=m_(e,v)).internal=!0),i.resolution=p||ty.RESOLUTION,i.width=Math.round((l||0)*i.resolution)/i.resolution,i.height=Math.round((u||0)*i.resolution)/i.resolution,i._mipmap=void 0!==a?a:ty.MIPMAP_TEXTURES,i.anisotropicLevel=void 0!==o?o:ty.ANISOTROPIC_LEVEL,i._wrapMode=h||ty.WRAP_MODE,i._scaleMode=void 0!==s?s:ty.SCALE_MODE,i.format=c||gg.RGBA,i.type=d||_g.UNSIGNED_BYTE,i.target=f||yg.TEXTURE_2D,i.alphaMode=void 0!==r?r:Tg.UNPACK,i.uid=wy(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=l>0&&u>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return y_(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mipmap",{get:function(){return this._mipmap},set:function(t){this._mipmap!==t&&(this._mipmap=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(t){this._scaleMode!==t&&(this._scaleMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(t){this._wrapMode!==t&&(this._wrapMode=t,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var n;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,n=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,n=!0),n&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,n){return n=n||this.resolution,this.setRealSize(t*n,e*n,n)},e.prototype.setRealSize=function(t,e,n){return this.resolution=n||this.resolution,this.width=Math.round(t)/this.resolution,this.height=Math.round(e)/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=gy(this.realWidth)&&gy(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t||(this.resolution=t,this.valid&&(this.width=Math.round(this.width*e)/t,this.height=Math.round(this.height*e)/t,this.emit("update",this)),this._refreshPOT()),this},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ay[this.cacheId],delete Ey[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,n,i){void 0===i&&(i=ty.STRICT_TEXTURE_CACHE);var r="string"===typeof t,a=null;if(r)a=t;else{if(!t._pixiId){var o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+wy()}a=t._pixiId}var s=Ay[a];if(r&&i&&!s)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return s||((s=new e(t,n)).cacheId=a,e.addToCache(s,a)),s},e.fromBuffer=function(t,n,i,r){t=t||new Float32Array(n*i*4);var a=new b_(t,{width:n,height:i}),o=t instanceof Float32Array?_g.FLOAT:_g.UNSIGNED_BYTE;return new e(a,Object.assign({},w_,r||{width:n,height:i,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ay[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),Ay[e]=t)},e.removeFromCache=function(t){if("string"===typeof t){var e=Ay[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ay[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)delete Ay[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(ey),T_=function(t){function e(e,n){var i=this,r=n||{},a=r.width,o=r.height;(i=t.call(this,a,o)||this).items=[],i.itemDirtyIds=[];for(var s=0;s<e;s++){var l=new S_;i.items.push(l),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return y_(e,t),e.prototype.initFromArray=function(t,e){for(var n=0;n<this.length;n++)t[n]&&(t[n].castToBaseTexture?this.addBaseTextureAt(t[n].castToBaseTexture(),n):t[n]instanceof x_?this.addResourceAt(t[n],n):this.addResourceAt(m_(t[n],e),n))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=e,this.items[n].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var n=0;n<this.length;n++)this.items[n].parentTextureArray=null,this.items[n].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map((function(t){return t.resource})).filter((function(t){return t})).map((function(t){return t.load()}));return this._load=Promise.all(e).then((function(){var e=t.items[0],n=e.realWidth,i=e.realHeight;return t.resize(n,i),Promise.resolve(t)})),this._load},e}(x_),M_=function(t){function e(e,n){var i,r,a=this,o=n||{},s=o.width,l=o.height;return Array.isArray(e)?(i=e,r=e.length):r=e,a=t.call(this,r,{width:s,height:l})||this,i&&a.initFromArray(i,n),a}return y_(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=yg.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,n){var i=this,r=i.length,a=i.itemDirtyIds,o=i.items,s=t.gl;n.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,n.internalFormat,this._width,this._height,r,0,e.format,n.type,null);for(var l=0;l<r;l++){var u=o[l];a[l]<u.dirtyId&&(a[l]=u.dirtyId,u.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,l,u.resource.width,u.resource.height,1,e.format,n.type,u.resource.source))}return!0},e}(T_),E_=function(t){function e(e){var n=this,i=e,r=i.naturalWidth||i.videoWidth||i.width,a=i.naturalHeight||i.videoHeight||i.height;return(n=t.call(this,r,a)||this).source=e,n.noSubImage=!1,n}return y_(e,t),e.crossOrigin=function(t,e,n){void 0===n&&0!==e.indexOf("data:")?t.crossOrigin=function(t,e){if(void 0===e&&(e=globalThis.location),0===t.indexOf("data:"))return"";e=e||globalThis.location,Cy||(Cy=document.createElement("a")),Cy.href=t;var n=ry.parse(Cy.href),i=!n.port&&""===e.port||n.port===e.port;return n.hostname===e.hostname&&i&&n.protocol===e.protocol?"":"anonymous"}(e):!1!==n&&(t.crossOrigin="string"===typeof n?n:"anonymous")},e.prototype.upload=function(t,e,n,i){var r=t.gl,a=e.realWidth,o=e.realHeight;if((i=i||this.source)instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if(i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Tg.UNPACK),this.noSubImage||e.target!==r.TEXTURE_2D||n.width!==a||n.height!==o?(n.width=a,n.height=o,r.texImage2D(e.target,0,n.internalFormat,e.format,n.type,i)):r.texSubImage2D(r.TEXTURE_2D,0,0,0,e.format,n.type,i),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,n=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(n,i),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(x_),A_=function(t){function e(e){return t.call(this,e)||this}return y_(e,t),e.test=function(t){var e=globalThis.OffscreenCanvas;return!!(e&&t instanceof e)||globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement},e}(E_),P_=function(t){function e(n,i){var r=this,a=i||{},o=a.width,s=a.height,l=a.autoLoad,u=a.linkBaseTexture;if(n&&n.length!==e.SIDES)throw new Error("Invalid length. Got "+n.length+", expected 6");r=t.call(this,6,{width:o,height:s})||this;for(var h=0;h<e.SIDES;h++)r.items[h].target=yg.TEXTURE_CUBE_MAP_POSITIVE_X+h;return r.linkBaseTexture=!1!==u,n&&r.initFromArray(n,i),!1!==l&&r.load(),r}return y_(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=yg.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,n){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=yg.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,n,i){for(var r=this.itemDirtyIds,a=0;a<e.SIDES;a++){var o=this.items[a];(r[a]<o.dirtyId||i.dirtyId<n.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(t,o,i),r[a]=o.dirtyId):r[a]<-1&&(t.gl.texImage2D(o.target,0,i.internalFormat,n.realWidth,n.realHeight,0,n.format,i.type,null),r[a]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(T_),C_=function(t){function e(e,n){var i=this;if(n=n||{},!(e instanceof HTMLImageElement)){var r=new Image;E_.crossOrigin(r,e,n.crossorigin),r.src=e,e=r}return i=t.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(void 0!==n.createBitmap?n.createBitmap:ty.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode="number"===typeof n.alphaMode?n.alphaMode:null,i.bitmap=null,i._load=null,!1!==n.autoLoad&&i.load(),i}return y_(e,t),e.prototype.load=function(t){var e=this;return this._load||(void 0!==t&&(this.createBitmap=t),this._load=new Promise((function(t,n){var i=e.source;e.url=i.src;var r=function(){e.destroyed||(i.onload=null,i.onerror=null,e.resize(i.width,i.height),e._load=null,e.createBitmap?t(e.process()):t(e))};i.complete&&i.src?r():(i.onload=r,i.onerror=function(t){n(t),e.onError.emit(t)})}))),this._load},e.prototype.process=function(){var t=this,e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);var n=globalThis.createImageBitmap,i=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:i?"cors":"no-cors"}).then((function(t){return t.blob()})).then((function(i){return n(i,0,0,e.width,e.height,{premultiplyAlpha:null===t.alphaMode||t.alphaMode===Tg.UNPACK?"premultiply":"none"})})).then((function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))})),this._process},e.prototype.upload=function(e,n,i){if("number"===typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,n,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,n,i,this.bitmap),!this.preserveBitmap){var r=!0,a=n._glTextures;for(var o in a){var s=a[o];if(s!==i&&s.dirtyId!==n.dirtyId){r=!1;break}}r&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"===typeof t||t instanceof HTMLImageElement},e}(E_),k_=function(t){function e(e,n){var i=this;return n=n||{},(i=t.call(this,ty.ADAPTER.createCanvas())||this)._width=0,i._height=0,i.svg=e,i.scale=n.scale||1,i._overrideWidth=n.width,i._overrideHeight=n.height,i._resolve=null,i._crossorigin=n.crossorigin,i._load=null,!1!==n.autoLoad&&i.load(),i}return y_(e,t),e.prototype.load=function(){var t=this;return this._load||(this._load=new Promise((function(n){if(t._resolve=function(){t.resize(t.source.width,t.source.height),n(t)},e.SVG_XML.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}))),this._load},e.prototype._loadSvg=function(){var t=this,e=new Image;E_.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(n){t._resolve&&(e.onerror=null,t.onError.emit(n))},e.onload=function(){if(t._resolve){var n=e.width,i=e.height;if(!n||!i)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var r=n*t.scale,a=i*t.scale;(t._overrideWidth||t._overrideHeight)&&(r=t._overrideWidth||t._overrideHeight/i*n,a=t._overrideHeight||t._overrideWidth/n*i),r=Math.round(r),a=Math.round(a);var o=t.source;o.width=r,o.height=a,o._pixiId="canvas_"+wy(),o.getContext("2d").drawImage(e,0,0,n,i,0,0,r,a),t._resolve(),t._resolve=null}}},e.getSize=function(t){var n=e.SVG_SIZE.exec(t),i={};return n&&(i[n[1]]=Math.round(parseFloat(n[3])),i[n[5]]=Math.round(parseFloat(n[7]))),i},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,n){return"svg"===n||"string"===typeof t&&t.startsWith("data:image/svg+xml")||"string"===typeof t&&e.SVG_XML.test(t)},e.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(E_),R_=function(t){function e(n,i){var r=this;if(i=i||{},!(n instanceof HTMLVideoElement)){var a=document.createElement("video");a.setAttribute("preload","auto"),a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),"string"===typeof n&&(n=[n]);var o=n[0].src||n[0];E_.crossOrigin(a,o,i.crossorigin);for(var s=0;s<n.length;++s){var l=document.createElement("source"),u=n[s],h=u.src,c=u.mime,d=(h=h||n[s]).split("?").shift().toLowerCase(),f=d.slice(d.lastIndexOf(".")+1);c=c||e.MIME_TYPES[f]||"video/"+f,l.src=h,l.type=c,a.appendChild(l)}n=a}return(r=t.call(this,n)||this).noSubImage=!0,r._autoUpdate=!0,r._isConnectedToTicker=!1,r._updateFPS=i.updateFPS||0,r._msToNextUpdate=0,r.autoPlay=!1!==i.autoPlay,r._load=null,r._resolve=null,r._onCanPlay=r._onCanPlay.bind(r),r._onError=r._onError.bind(r),!1!==i.autoLoad&&r.load(),r}return y_(e,t),e.prototype.update=function(e){if(!this.destroyed){var n=f_.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){t.valid?n(t):(t._resolve=n,e.load())})),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return!t.paused&&!t.ended&&this._isSourceReady()},e.prototype._isSourceReady=function(){return this.source.readyState>2},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(f_.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(f_.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&(f_.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(f_.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(f_.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,n){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.indexOf(n)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(E_),I_=function(t){function e(e){return t.call(this,e)||this}return y_(e,t),e.test=function(t){return!!globalThis.createImageBitmap&&"undefined"!==typeof ImageBitmap&&t instanceof ImageBitmap},e}(E_);v_.push(C_,I_,A_,R_,k_,b_,P_,M_);var D_={__proto__:null,Resource:x_,BaseImageResource:E_,INSTALLED:v_,autoDetectResource:m_,AbstractMultiResource:T_,ArrayResource:M_,BufferResource:b_,CanvasResource:A_,CubeResource:P_,ImageResource:C_,SVGResource:k_,VideoResource:R_,ImageBitmapResource:I_},O_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return y_(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===Tg.UNPACK);var r=e.realWidth,a=e.realHeight;return n.width===r&&n.height===a?i.texSubImage2D(e.target,0,0,0,r,a,e.format,n.type,this.data):(n.width=r,n.height=a,i.texImage2D(e.target,0,n.internalFormat,r,a,0,e.format,n.type,this.data)),!0},e}(b_),L_=function(){function t(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new c_("disposeFramebuffer"),this.multisample=kg.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new S_(null,{scaleMode:bg.NEAREST,resolution:1,mipmap:Sg.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new S_(new O_(null,{width:this.width,height:this.height}),{scaleMode:bg.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Sg.OFF,format:gg.DEPTH_COMPONENT,type:_g.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var i=this.colorTextures[n],r=i.resolution;i.setSize(t/r,e/r)}if(this.depthTexture){r=this.depthTexture.resolution;this.depthTexture.setSize(t/r,e/r)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),N_=function(t){function e(e){void 0===e&&(e={});var n=this;if("number"===typeof e){var i=arguments[0],r=arguments[1],a=arguments[2],o=arguments[3];e={width:i,height:r,scaleMode:a,resolution:o}}return e.width=e.width||100,e.height=e.height||100,e.multisample=void 0!==e.multisample?e.multisample:kg.NONE,(n=t.call(this,null,e)||this).mipmap=Sg.OFF,n.valid=!0,n.clearColor=[0,0,0,0],n.framebuffer=new L_(n.realWidth,n.realHeight).addColorTexture(0,n),n.framebuffer.multisample=e.multisample,n.maskStack=[],n.filterStack=[{}],n}return y_(e,t),e.prototype.resize=function(t,e){this.framebuffer.resize(t*this.resolution,e*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(S_),F_=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,n){var i=e.width,r=e.height;if(n){var a=t.width/2/i,o=t.height/2/r,s=t.x/i+a,l=t.y/r+o;n=Jy.add(n,Jy.NW),this.x0=s+a*Jy.uX(n),this.y0=l+o*Jy.uY(n),n=Jy.add(n,2),this.x1=s+a*Jy.uX(n),this.y1=l+o*Jy.uY(n),n=Jy.add(n,2),this.x2=s+a*Jy.uX(n),this.y2=l+o*Jy.uY(n),n=Jy.add(n,2),this.x3=s+a*Jy.uX(n),this.y3=l+o*Jy.uY(n)}else this.x0=t.x/i,this.y0=t.y/r,this.x1=(t.x+t.width)/i,this.y1=t.y/r,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/r,this.x3=t.x/i,this.y3=(t.y+t.height)/r;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t.prototype.toString=function(){return"[@pixi/core:TextureUvs x0="+this.x0+" y0="+this.y0+" x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" y2="+this.y2+" x3="+this.x3+" y3="+this.y3+"]"},t}(),B_=new F_;function U_(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}var G_=function(t){function e(n,i,r,a,o,s){var l=t.call(this)||this;if(l.noFrame=!1,i||(l.noFrame=!0,i=new Fy(0,0,1,1)),n instanceof e&&(n=n.baseTexture),l.baseTexture=n,l._frame=i,l.trim=a,l.valid=!1,l._uvs=B_,l.uvMatrix=null,l.orig=r||i,l._rotate=Number(o||0),!0===o)l._rotate=2;else if(l._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return l.defaultAnchor=s?new Ly(s.x,s.y):new Ly(0,0),l._updateID=0,l.textureCacheIds=[],n.valid?l.noFrame?n.valid&&l.onBaseTextureUpdated(n):l.frame=i:n.once("loaded",l.onBaseTextureUpdated,l),l.noFrame&&n.on("update",l.onBaseTextureUpdated,l),l}return y_(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var n=this.baseTexture.resource;n&&n.url&&Ey[n.url]&&e.removeFromCache(n.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){var t=this._frame.clone(),n=this._frame===this.orig?t:this.orig.clone(),i=new e(this.baseTexture,!this.noFrame&&t,n,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=t),i},e.prototype.updateUvs=function(){this._uvs===B_&&(this._uvs=new F_),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,n,i){void 0===n&&(n={}),void 0===i&&(i=ty.STRICT_TEXTURE_CACHE);var r="string"===typeof t,a=null;if(r)a=t;else if(t instanceof S_){if(!t.cacheId){var o=n&&n.pixiIdPrefix||"pixiid";t.cacheId=o+"-"+wy(),S_.addToCache(t,t.cacheId)}a=t.cacheId}else{if(!t._pixiId){o=n&&n.pixiIdPrefix||"pixiid";t._pixiId=o+"_"+wy()}a=t._pixiId}var s=Ey[a];if(r&&i&&!s)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return s||t instanceof S_?!s&&t instanceof S_&&(s=new e(t),e.addToCache(s,a)):(n.resolution||(n.resolution=ky(t)),(s=new e(new S_(t,n))).baseTexture.cacheId=a,S_.addToCache(s.baseTexture,a),e.addToCache(s,a)),s},e.fromURL=function(t,n){var i=Object.assign({autoLoad:!1},null===n||void 0===n?void 0:n.resourceOptions),r=e.from(t,Object.assign({resourceOptions:i},n),!1),a=r.baseTexture.resource;return r.baseTexture.valid?Promise.resolve(r):a.load().then((function(){return Promise.resolve(r)}))},e.fromBuffer=function(t,n,i,r){return new e(S_.fromBuffer(t,n,i,r))},e.fromLoader=function(t,n,i,r){var a=new S_(t,Object.assign({scaleMode:ty.SCALE_MODE,resolution:ky(n)},r)),o=a.resource;o instanceof C_&&(o.url=n);var s=new e(a);return i||(i=n),S_.addToCache(s.baseTexture,i),e.addToCache(s,i),i!==n&&(S_.addToCache(s.baseTexture,n),e.addToCache(s,n)),s.baseTexture.valid?Promise.resolve(s):new Promise((function(t){s.baseTexture.once("loaded",(function(){return t(s)}))}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Ey[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Ey[e]=t)},e.removeFromCache=function(t){if("string"===typeof t){var e=Ey[t];if(e){var n=e.textureCacheIds.indexOf(t);return n>-1&&e.textureCacheIds.splice(n,1),delete Ey[t],e}}else if(t&&t.textureCacheIds){for(var i=0;i<t.textureCacheIds.length;++i)Ey[t.textureCacheIds[i]]===t&&delete Ey[t.textureCacheIds[i]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,n=t.y,i=t.width,r=t.height,a=e+i>this.baseTexture.width,o=n+r>this.baseTexture.height;if(a||o){var s=a&&o?"and":"or",l="X: "+e+" + "+i+" = "+(e+i)+" > "+this.baseTexture.width,u="Y: "+n+" + "+r+" = "+(n+r)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+l+" "+s+" "+u)}this.valid=i&&r&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(e,"EMPTY",{get:function(){return e._EMPTY||(e._EMPTY=new e(new S_),U_(e._EMPTY),U_(e._EMPTY.baseTexture)),e._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(e,"WHITE",{get:function(){if(!e._WHITE){var t=ty.ADAPTER.createCanvas(16,16),n=t.getContext("2d");t.width=16,t.height=16,n.fillStyle="white",n.fillRect(0,0,16,16),e._WHITE=new e(S_.from(t)),U_(e._WHITE),U_(e._WHITE.baseTexture)}return e._WHITE},enumerable:!1,configurable:!0}),e}(ey),z_=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return y_(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(t){this.framebuffer.multisample=t},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,n){void 0===n&&(n=!0);var i=this.baseTexture.resolution,r=Math.round(t*i)/i,a=Math.round(e*i)/i;this.valid=r>0&&a>0,this._frame.width=this.orig.width=r,this._frame.height=this.orig.height=a,n&&this.baseTexture.resize(r,a),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){for(var n=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=n[r];return"number"===typeof t&&(Ty("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),t={width:t,height:i[0],scaleMode:i[1],resolution:i[2]}),new e(new N_(t))},e}(G_),H_=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e,n){void 0===n&&(n=kg.NONE);var i=new N_(Object.assign({width:t,height:e,resolution:1,multisample:n},this.textureOptions));return new z_(i)},t.prototype.getOptimalTexture=function(t,e,n,i){var r;void 0===n&&(n=1),void 0===i&&(i=kg.NONE),t=Math.ceil(t*n-1e-6),e=Math.ceil(e*n-1e-6),this.enableFullScreen&&t===this._pixelsWidth&&e===this._pixelsHeight?r=i>1?-i:-1:(r=((65535&(t=my(t)))<<16|65535&(e=my(e)))>>>0,i>1&&(r+=4294967296*i)),this.texturePool[r]||(this.texturePool[r]=[]);var a=this.texturePool[r].pop();return a||(a=this.createTexture(t,e,i)),a.filterPoolKey=r,a.setResolution(n),a},t.prototype.getFilterTexture=function(t,e,n){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,n||kg.NONE);return i.filterFrame=t.filterFrame,i},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){for(var e in this.enableFullScreen=t.width>0&&t.height>0,this.texturePool)if(Number(e)<0){var n=this.texturePool[e];if(n)for(var i=0;i<n.length;i++)n[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},t.SCREEN_KEY=-1,t}(),V_=function(){function t(t,e,n,i,r,a,o){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===i&&(i=_g.FLOAT),this.buffer=t,this.size=e,this.normalized=n,this.type=i,this.stride=r,this.start=a,this.instance=o}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,n,i,r,a){return new t(e,n,i,r,a)},t}(),j_=0,X_=function(){function t(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=e,this.id=j_++,this.disposeRunner=new c_("disposeBuffer")}return t.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(t.prototype,"index",{get:function(){return this.type===Rg.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?Rg.ELEMENT_ARRAY_BUFFER:Rg.ARRAY_BUFFER},enumerable:!1,configurable:!0}),t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}(),W_={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var q_={5126:4,5123:2,5121:1},Y_=0,K_={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Z_=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Y_++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new c_("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,n,i,r,a,o,s){if(void 0===n&&(n=0),void 0===i&&(i=!1),void 0===s&&(s=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof X_||(e instanceof Array&&(e=new Float32Array(e)),e=new X_(e));var l=t.split("|");if(l.length>1){for(var u=0;u<l.length;u++)this.addAttribute(l[u],e,n,i,r);return this}var h=this.buffers.indexOf(e);return-1===h&&(this.buffers.push(e),h=this.buffers.length-1),this.attributes[t]=new V_(h,n,i,r,a,o,s),this.instanced=this.instanced||s,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof X_||(t instanceof Array&&(t=new Uint16Array(t)),t=new X_(t)),t.type=Rg.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],n=[],i=new X_;for(t in this.attributes){var r=this.attributes[t],a=this.buffers[r.buffer];e.push(a.data),n.push(r.size*q_[r.type]/4),r.buffer=0}for(i.data=function(t,e){for(var n=0,i=0,r={},a=0;a<t.length;a++)i+=e[a],n+=t[a].length;var o=new ArrayBuffer(4*n),s=null,l=0;for(a=0;a<t.length;a++){var u=e[a],h=t[a],c=vy(h);r[c]||(r[c]=new W_[c](o)),s=r[c];for(var d=0;d<h.length;d++)s[(d/u|0)*i+l+d%u]=h[d];l+=u}return new Float32Array(o)}(e,n),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,n=0;n<this.buffers.length;n++)e.buffers[n]=new X_(this.buffers[n].data.slice(0));for(var n in this.attributes){var i=this.attributes[n];e.attributes[n]=new V_(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=Rg.ELEMENT_ARRAY_BUFFER),e},t.merge=function(e){for(var n,i=new t,r=[],a=[],o=[],s=0;s<e.length;s++){n=e[s];for(var l=0;l<n.buffers.length;l++)a[l]=a[l]||0,a[l]+=n.buffers[l].data.length,o[l]=0}for(s=0;s<n.buffers.length;s++)r[s]=new(K_[vy(n.buffers[s].data)])(a[s]),i.buffers[s]=new X_(r[s]);for(s=0;s<e.length;s++){n=e[s];for(l=0;l<n.buffers.length;l++)r[l].set(n.buffers[l].data,o[l]),o[l]+=n.buffers[l].data.length}if(i.attributes=n.attributes,n.indexBuffer){i.indexBuffer=i.buffers[n.buffers.indexOf(n.indexBuffer)],i.indexBuffer.type=Rg.ELEMENT_ARRAY_BUFFER;var u=0,h=0,c=0,d=0;for(s=0;s<n.buffers.length;s++)if(n.buffers[s]!==n.indexBuffer){d=s;break}for(var s in n.attributes){var f=n.attributes[s];(0|f.buffer)===d&&(h+=f.size*q_[f.type]/4)}for(s=0;s<e.length;s++){var p=e[s].indexBuffer.data;for(l=0;l<p.length;l++)i.indexBuffer.data[l+c]+=u;u+=e[s].buffers[d].data.length/h,c+=p.length}}return i},t}(),J_=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return y_(e,t),e}(Z_),Q_=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new X_(e.vertices),e.uvBuffer=new X_(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return y_(e,t),e.prototype.map=function(t,e){var n=0,i=0;return this.uvs[0]=n,this.uvs[1]=i,this.uvs[2]=n+e.width/t.width,this.uvs[3]=i,this.uvs[4]=n+e.width/t.width,this.uvs[5]=i+e.height/t.height,this.uvs[6]=n,this.uvs[7]=i+e.height/t.height,n=e.x,i=e.y,this.vertices[0]=n,this.vertices[1]=i,this.vertices[2]=n+e.width,this.vertices[3]=i,this.vertices[4]=n+e.width,this.vertices[5]=i+e.height,this.vertices[6]=n,this.vertices[7]=i+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Z_),$_=0,tx=function(){function t(t,e,n){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=$_++,this.static=!!e,this.ubo=!!n,t instanceof X_?(this.buffer=t,this.buffer.type=Rg.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new X_(new Float32Array(1)),this.buffer.type=Rg.UNIFORM_BUFFER,this.autoManage=!0))}return t.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},t.prototype.add=function(e,n,i){if(this.ubo)throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new t(n,i)},t.from=function(e,n,i){return new t(e,n,i)},t.uboFrom=function(e,n){return new t(e,null===n||void 0===n||n,!0)},t}(),ex=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=kg.NONE,this.sourceFrame=new Fy,this.destinationFrame=new Fy,this.bindingSourceFrame=new Fy,this.bindingDestinationFrame=new Fy,this.filters=[],this.transform=null}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),nx=[new Ly,new Ly,new Ly,new Ly],ix=new Vy,rx=function(){function t(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new H_,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new J_,this.quadUv=new Q_,this.tempRect=new Fy,this.activeState={},this.globalUniforms=new tx({outputFrame:new Fy,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return t.prototype.push=function(t,e){for(var n,i,r=this.renderer,a=this.defaultFilterStack,o=this.statePool.pop()||new ex,s=this.renderer.renderTexture,l=e[0].resolution,u=e[0].multisample,h=e[0].padding,c=e[0].autoFit,d=null===(n=e[0].legacy)||void 0===n||n,f=1;f<e.length;f++){var p=e[f];l=Math.min(l,p.resolution),u=Math.min(u,p.multisample),h=this.useMaxPadding?Math.max(h,p.padding):h+p.padding,c=c&&p.autoFit,d=d||null===(i=p.legacy)||void 0===i||i}1===a.length&&(this.defaultFilterStack[0].renderTexture=s.current),a.push(o),o.resolution=l,o.multisample=u,o.legacy=d,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(h);var v=this.tempRect.copyFrom(s.sourceFrame);r.projection.transform&&this.transformAABB(ix.copyFrom(r.projection.transform).invert(),v),c?(o.sourceFrame.fit(v),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(v)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,s.current?s.current.resolution:r.resolution,s.sourceFrame,s.destinationFrame,r.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,l,u),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var m=this.tempRect;m.x=0,m.y=0,m.width=o.sourceFrame.width,m.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(s.sourceFrame),o.bindingDestinationFrame.copyFrom(s.destinationFrame),o.transform=r.projection.transform,r.projection.transform=null,s.bind(o.renderTexture,o.sourceFrame,m),r.framebuffer.clear(0,0,0,0)},t.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),n=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var r=i.inputSize,a=i.inputPixel,o=i.inputClamp;if(r[0]=e.destinationFrame.width,r[1]=e.destinationFrame.height,r[2]=1/r[0],r[3]=1/r[1],a[0]=Math.round(r[0]*e.resolution),a[1]=Math.round(r[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=e.sourceFrame.width*r[2]-.5*a[2],o[3]=e.sourceFrame.height*r[3]-.5*a[3],e.legacy){var s=i.filterArea;s[0]=e.destinationFrame.width,s[1]=e.destinationFrame.height,s[2]=e.sourceFrame.x,s[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var l=t[t.length-1];if(this.renderer.framebuffer.blit(),1===n.length)n[0].apply(this,e.renderTexture,l.renderTexture,Mg.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,h=this.getOptimalFilterTexture(u.width,u.height,e.resolution);h.filterFrame=u.filterFrame;var c=0;for(c=0;c<n.length-1;++c){1===c&&e.multisample>1&&((h=this.getOptimalFilterTexture(u.width,u.height,e.resolution)).filterFrame=u.filterFrame),n[c].apply(this,u,h,Mg.CLEAR,e);var d=u;u=h,h=d}n[c].apply(this,u,l.renderTexture,Mg.BLEND,e),c>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(u),this.returnFilterTexture(h)}e.clear(),this.statePool.push(e)},t.prototype.bindAndClear=function(t,e){void 0===e&&(e=Mg.CLEAR);var n=this.renderer,i=n.renderTexture,r=n.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=1&r.stateId||this.forceClear;(e===Mg.CLEAR||e===Mg.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},t.prototype.applyFilter=function(t,e,n,i){var r=this.renderer;r.state.set(t.state),this.bindAndClear(n,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,r.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),r.geometry.bind(this.quadUv),r.geometry.draw(mg.TRIANGLES)):(r.geometry.bind(this.quad),r.geometry.draw(mg.TRIANGLE_STRIP))},t.prototype.calculateSpriteMatrix=function(t,e){var n=this.activeState,i=n.sourceFrame,r=n.destinationFrame,a=e._texture.orig,o=t.set(r.width,0,0,r.height,i.x,i.y),s=e.worldTransform.copyTo(Vy.TEMP_MATRIX);return s.invert(),o.prepend(s),o.scale(1/a.width,1/a.height),o.translate(e.anchor.x,e.anchor.y),o},t.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},t.prototype.getOptimalFilterTexture=function(t,e,n,i){return void 0===n&&(n=1),void 0===i&&(i=kg.NONE),this.texturePool.getOptimalTexture(t,e,n,i)},t.prototype.getFilterTexture=function(t,e,n){if("number"===typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,n||kg.NONE);return r.filterFrame=t.filterFrame,r},t.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},t.prototype.emptyPool=function(){this.texturePool.clear(!0)},t.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},t.prototype.transformAABB=function(t,e){var n=nx[0],i=nx[1],r=nx[2],a=nx[3];n.set(e.left,e.top),i.set(e.left,e.bottom),r.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(n,n),t.apply(i,i),t.apply(r,r),t.apply(a,a);var o=Math.min(n.x,i.x,r.x,a.x),s=Math.min(n.y,i.y,r.y,a.y),l=Math.max(n.x,i.x,r.x,a.x),u=Math.max(n.y,i.y,r.y,a.y);e.x=o,e.y=s,e.width=l-o,e.height=u-s},t.prototype.roundFrame=function(t,e,n,i,r){if(!(t.width<=0||t.height<=0||n.width<=0||n.height<=0)){if(r){var a=r.a,o=r.b,s=r.c,l=r.d;if((Math.abs(o)>1e-4||Math.abs(s)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(l)>1e-4))return}(r=r?ix.copyFrom(r):ix.identity()).translate(-n.x,-n.y).scale(i.width/n.width,i.height/n.height).translate(i.x,i.y),this.transformAABB(r,t),t.ceil(e),this.transformAABB(r.invert(),t)}},t}(),ax=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),ox=function(){function t(t){this.renderer=t,this.emptyRenderer=new ax(t),this.currentRenderer=this.emptyRenderer}return t.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(t,e){for(var n=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=n[i]||null,t[i]&&(t[i]._batchLocation=i)},t.prototype.boundArray=function(t,e,n,i){for(var r=t.elements,a=t.ids,o=t.count,s=0,l=0;l<o;l++){var u=r[l],h=u._batchLocation;if(h>=0&&h<i&&e[h]===u)a[l]=h;else for(;s<i;){var c=e[s];if(!c||c._batchEnabled!==n||c._batchLocation!==s){a[l]=s,u._batchLocation=s,e[s]=u;break}s++}}},t.prototype.destroy=function(){this.renderer=null},t}(),sx=0,lx=function(){function t(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(t.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),t.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=sx++},t.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=sx++,this.renderer.runners.contextChange.emit(t)},t.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},t.prototype.createContext=function(t,e){var n;if(ty.PREFER_ENV>=dg.WEBGL2&&(n=t.getContext("webgl2",e)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},t.prototype.getExtensions=function(){var t=this.gl,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},t.prototype.handleContextLost=function(t){var e=this;t.preventDefault(),setTimeout((function(){e.gl.isContextLost()&&e.extensions.loseContext&&e.extensions.loseContext.restoreContext()}),0)},t.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},t.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},t.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},t.prototype.validateContext=function(t){var e=t.getContextAttributes(),n="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;n&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=n||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},t}(),ux=function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=kg.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0},hx=new Fy,cx=function(){function t(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new L_(10,10),this.msaaSamples=null}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Fy,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;ty.PREFER_ENV===dg.WEBGL_LEGACY&&(e=null,n=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},t.prototype.bind=function(t,e,n){void 0===n&&(n=0);var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.mipLevel!==n&&(t.dirtyId++,t.dirtyFormat++,r.mipLevel=n),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,r.dirtySize=t.dirtySize,this.updateFramebuffer(t,n)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var a=0;a<t.colorTextures.length;a++){var o=t.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var s=e.width>>n,l=e.height>>n,u=s/e.width;this.setViewport(e.x*u,e.y*u,s,l)}else{s=t.width>>n,l=t.height>>n;this.setViewport(0,0,s,l)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},t.prototype.setViewport=function(t,e,n,i){var r=this.viewport;t=Math.round(t),e=Math.round(e),n=Math.round(n),i=Math.round(i),r.width===n&&r.height===i&&r.x===t&&r.y===e||(r.x=t,r.y=e,r.width=n,r.height=i,this.gl.viewport(t,e,n,i))},Object.defineProperty(t.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),t.prototype.clear=function(t,e,n,i,r){void 0===r&&(r=pg.COLOR|pg.DEPTH);var a=this.gl;a.clearColor(t,e,n,i),a.clear(r)},t.prototype.initFramebuffer=function(t){var e=this.gl,n=new ux(e.createFramebuffer());return n.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=n,this.managedFramebuffers.push(t),t.disposeRunner.add(this),n},t.prototype.resizeFramebuffer=function(t){var e=this.gl,n=t.glFramebuffers[this.CONTEXT_UID];n.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,n.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.RGBA8,t.width,t.height)),n.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,n.stencil),n.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,n.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,r=i.length;e.drawBuffers||(r=Math.min(r,1));for(var a=0;a<r;a++){var o=i[a],s=o.parentTextureArray||o;this.renderer.texture.bind(s,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},t.prototype.updateFramebuffer=function(t,e){var n=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures,a=r.length;n.drawBuffers||(a=Math.min(a,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.msaaBuffer),n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.RGBA8,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(n.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],s=0;s<a;s++){var l=r[s],u=l.parentTextureArray||l;this.renderer.texture.bind(u,0),0===s&&i.msaaBuffer||(n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,l.target,u._glTextures[this.CONTEXT_UID].texture,e),o.push(n.COLOR_ATTACHMENT0+s))}if((o.length>1&&n.drawBuffers(o),t.depthTexture)&&this.writeDepthTexture){var h=t.depthTexture;this.renderer.texture.bind(h,0),n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,e)}!t.stencil&&!t.depth||t.depthTexture&&this.writeDepthTexture?i.stencil&&(n.deleteRenderbuffer(i.stencil),i.stencil=null):(i.stencil=i.stencil||n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,i.stencil),i.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,i.multisample,n.DEPTH24_STENCIL8,t.width,t.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,t.width,t.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,i.stencil))},t.prototype.canMultisampleFramebuffer=function(t){return 1!==this.renderer.context.webGLVersion&&t.colorTextures.length<=1&&!t.depthTexture},t.prototype.detectSamples=function(t){var e=this.msaaSamples,n=kg.NONE;if(t<=1||null===e)return n;for(var i=0;i<e.length;i++)if(e[i]<=t){n=e[i];break}return 1===n&&(n=kg.NONE),n},t.prototype.blit=function(t,e,n){var i=this,r=i.current,a=i.renderer,o=i.gl,s=i.CONTEXT_UID;if(2===a.context.webGLVersion&&r){var l=r.glFramebuffers[s];if(l){if(!t){if(!l.msaaBuffer)return;var u=r.colorTextures[0];if(!u)return;l.blitFramebuffer||(l.blitFramebuffer=new L_(r.width,r.height),l.blitFramebuffer.addColorTexture(0,u)),(t=l.blitFramebuffer).colorTextures[0]!==u&&(t.colorTextures[0]=u,t.dirtyId++,t.dirtyFormat++),t.width===r.width&&t.height===r.height||(t.width=r.width,t.height=r.height,t.dirtyId++,t.dirtySize++)}e||((e=hx).width=r.width,e.height=r.height),n||(n=e);var h=e.width===n.width&&e.height===n.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,l.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,n.left,n.top,n.right,n.bottom,o.COLOR_BUFFER_BIT,h?o.NEAREST:o.LINEAR)}}},t.prototype.disposeFramebuffer=function(t,e){var n=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(n){delete t.glFramebuffers[this.CONTEXT_UID];var r=this.managedFramebuffers.indexOf(t);r>=0&&this.managedFramebuffers.splice(r,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(n.framebuffer),n.msaaBuffer&&i.deleteRenderbuffer(n.msaaBuffer),n.stencil&&i.deleteRenderbuffer(n.stencil)),n.blitFramebuffer&&n.blitFramebuffer.dispose()}},t.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<e.length;n++)this.disposeFramebuffer(e[n],t)},t.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.stencil=!0;var n=t.width,i=t.height,r=this.gl,a=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,a),e.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,e.multisample,r.DEPTH24_STENCIL8,n,i):r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,n,i),e.stencil=a,r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,a)}}},t.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Fy},t.prototype.destroy=function(){this.renderer=null},t}(),dx={5126:4,5123:2,5121:1},fx=function(){function t(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return t.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==e.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;ty.PREFER_ENV===dg.WEBGL_LEGACY&&(n=null),n?(t.createVertexArray=function(){return n.createVertexArrayOES()},t.bindVertexArray=function(t){return n.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return n.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(2!==e.webGLVersion){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(t,e){return i.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,n,r,a){return i.drawElementsInstancedANGLE(t,e,n,r,a)},t.drawArraysInstanced=function(t,e,n,r){return i.drawArraysInstancedANGLE(t,e,n,r)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},t.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var n=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],r=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},r=!0);var a=i[e.program.id]||this.initGeometryVao(t,e,r);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?n.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()},t.prototype.reset=function(){this.unbind()},t.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,n=0;n<t.buffers.length;n++){var i=t.buffers[n];e.update(i)}},t.prototype.checkCompatibility=function(t,e){var n=t.attributes,i=e.attributeData;for(var r in i)if(!n[r])throw new Error('shader and geometry incompatible, geometry missing the "'+r+'" attribute')},t.prototype.getSignature=function(t,e){var n=t.attributes,i=e.attributeData,r=["g",t.id];for(var a in n)i[a]&&r.push(a,i[a].location);return r.join("-")},t.prototype.initGeometryVao=function(t,e,n){void 0===n&&(n=!0);var i=this.gl,r=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[r]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var s=this.getSignature(t,o),l=t.glVertexArrayObjects[this.CONTEXT_UID],u=l[s];if(u)return l[o.id]=u,u;var h=t.buffers,c=t.attributes,d={},f={};for(var p in h)d[p]=0,f[p]=0;for(var p in c)!c[p].size&&o.attributeData[p]?c[p].size=o.attributeData[p].size:c[p].size||console.warn("PIXI Geometry attribute '"+p+"' size cannot be determined (likely the bound shader does not have the attribute)"),d[c[p].buffer]+=c[p].size*dx[c[p].type];for(var p in c){var v=c[p],m=v.size;void 0===v.stride&&(d[v.buffer]===m*dx[v.type]?v.stride=0:v.stride=d[v.buffer]),void 0===v.start&&(v.start=f[v.buffer],f[v.buffer]+=m*dx[v.type])}u=i.createVertexArray(),i.bindVertexArray(u);for(var g=0;g<h.length;g++){var y=h[g];a.bind(y),n&&y._glBuffers[r].refCount++}return this.activateVao(t,o),this._activeVao=u,l[o.id]=u,l[s]=u,u},t.prototype.disposeGeometry=function(t,e){var n;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,a=t.buffers,o=null===(n=this.renderer)||void 0===n?void 0:n.buffer;if(t.disposeRunner.remove(this),i){if(o)for(var s=0;s<a.length;s++){var l=a[s]._glBuffers[this.CONTEXT_UID];l&&(l.refCount--,0!==l.refCount||e||o.dispose(a[s],e))}if(!e)for(var u in i)if("g"===u[0]){var h=i[u];this._activeVao===h&&this.unbind(),r.deleteVertexArray(h)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),n=0;n<e.length;n++)this.disposeGeometry(this.managedGeometries[e[n]],t)},t.prototype.activateVao=function(t,e){var n=this.gl,i=this.CONTEXT_UID,r=this.renderer.buffer,a=t.buffers,o=t.attributes;t.indexBuffer&&r.bind(t.indexBuffer);var s=null;for(var l in o){var u=o[l],h=a[u.buffer],c=h._glBuffers[i];if(e.attributeData[l]){s!==c&&(r.bind(h),s=c);var d=e.attributeData[l].location;if(n.enableVertexAttribArray(d),n.vertexAttribPointer(d,u.size,u.type||n.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(d,1)}}}},t.prototype.draw=function(t,e,n,i){var r=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,s=2===o?r.UNSIGNED_SHORT:r.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?a.instanced?r.drawElementsInstanced(t,e||a.indexBuffer.data.length,s,(n||0)*o,i||1):r.drawElements(t,e||a.indexBuffer.data.length,s,(n||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?r.drawArraysInstanced(t,n,e||a.getSize(),i||1):r.drawArrays(t,n,e||a.getSize());return this},t.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},t.prototype.destroy=function(){this.renderer=null},t}(),px=function(){function t(t){void 0===t&&(t=null),this.type=Pg.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=ty.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(t.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Pg.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function vx(t,e,n){var i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}function mx(t,e){var n=t.getShaderSource(e).split("\n").map((function(t,e){return e+": "+t})),i=t.getShaderInfoLog(e),r=i.split("\n"),a={},o=r.map((function(t){return parseFloat(t.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))})).filter((function(t){return!(!t||a[t])&&(a[t]=!0,!0)})),s=[""];o.forEach((function(t){n[t-1]="%c"+n[t-1]+"%c",s.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")}));var l=n.join("\n");s[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,s),console.groupEnd()}function gx(t){for(var e=new Array(t),n=0;n<e.length;n++)e[n]=!1;return e}function yx(t,e){switch(t){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"uvec2":return new Uint32Array(2*e);case"uvec3":return new Uint32Array(3*e);case"uvec4":return new Uint32Array(4*e);case"bool":return!1;case"bvec2":return gx(2*e);case"bvec3":return gx(3*e);case"bvec4":return gx(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var _x,xx={},bx=xx;function wx(){if(!_x){_x=Ag.MEDIUM;var t=function(){if(bx===xx||bx&&bx.isContextLost()){var t=ty.ADAPTER.createCanvas(),e=void 0;ty.PREFER_ENV>=dg.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),bx=e}return bx}();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);_x=e.precision?Ag.HIGH:Ag.MEDIUM}}return _x}function Sx(t,e,n){if("precision"!==t.substring(0,9)){var i=e;return e===Ag.HIGH&&n!==Ag.HIGH&&(i=Ag.MEDIUM),"precision "+i+" float;\n"+t}return n!==Ag.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var Tx={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function Mx(t){return Tx[t]}var Ex=null,Ax={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Px(t,e){if(!Ex){var n=Object.keys(Ax);Ex={};for(var i=0;i<n.length;++i){var r=n[i];Ex[t[r]]=Ax[r]}}return Ex[e]}var Cx=[{test:function(t){return"float"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t,e){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray&&(null==e||void 0!==e.castToBaseTexture)},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&!t.isArray&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '},codeUbo:function(t){return"\n                var "+t+"_matrix = uv."+t+".toArray(true);\n\n                data[offset] = "+t+"_matrix[0];\n                data[offset+1] = "+t+"_matrix[1];\n                data[offset+2] = "+t+"_matrix[2];\n        \n                data[offset + 4] = "+t+"_matrix[3];\n                data[offset + 5] = "+t+"_matrix[4];\n                data[offset + 6] = "+t+"_matrix[5];\n        \n                data[offset + 8] = "+t+"_matrix[6];\n                data[offset + 9] = "+t+"_matrix[7];\n                data[offset + 10] = "+t+"_matrix[8];\n            "}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&!t.isArray&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'},codeUbo:function(t){return"\n                v = uv."+t+";\n\n                data[offset] = v.x;\n                data[offset+1] = v.y;\n            "}},{test:function(t){return"vec2"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&!t.isArray&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'},codeUbo:function(t){return"\n                    v = uv."+t+";\n\n                    data[offset] = v.x;\n                    data[offset+1] = v.y;\n                    data[offset+2] = v.width;\n                    data[offset+3] = v.height;\n                "}},{test:function(t){return"vec4"===t.type&&1===t.size&&!t.isArray},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],kx={float:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1f(location, v);\n    }",vec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n    }",int:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",ivec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",ivec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",ivec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",uint:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1ui(location, v);\n    }",uvec2:"\n    if (cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2ui(location, v[0], v[1]);\n    }",uvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3ui(location, v[0], v[1], v[2]);\n    }",uvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n    }",bool:"\n    if (cv !== v)\n    {\n        cu.value = v;\n        gl.uniform1i(location, v);\n    }",bvec2:"\n    if (cv[0] != v[0] || cv[1] != v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n\n        gl.uniform2i(location, v[0], v[1]);\n    }",bvec3:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3i(location, v[0], v[1], v[2]);\n    }",bvec4:"\n    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n        cv[3] = v[3];\n\n        gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n    }",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",samplerCube:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }",sampler2DArray:"\n    if (cv !== v)\n    {\n        cu.value = v;\n\n        gl.uniform1i(location, v);\n    }"},Rx={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Ix,Dx=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ox(t){for(var e="",n=0;n<t;++n)n>0&&(e+="\nelse "),n<t-1&&(e+="if(test == "+n+".0){}");return e}var Lx=0,Nx={},Fx=function(){function t(e,n,i){void 0===i&&(i="pixi-shader"),this.id=Lx++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=n||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(i=i.replace(/\s+/g,"-"),Nx[i]?(Nx[i]++,i+="-"+Nx[i]):Nx[i]=1,this.vertexSrc="#define SHADER_NAME "+i+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+i+"\n"+this.fragmentSrc,this.vertexSrc=Sx(this.vertexSrc,ty.PRECISION_VERTEX,Ag.HIGH),this.fragmentSrc=Sx(this.fragmentSrc,ty.PRECISION_FRAGMENT,wx())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(t,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},enumerable:!1,configurable:!0}),t.from=function(e,n,i){var r=e+n,a=My[r];return a||(My[r]=a=new t(e,n,i)),a},t}(),Bx=function(){function t(t,e){this.uniformBindCount=0,this.program=t,this.uniformGroup=e?e instanceof tx?e:new tx(e):new tx({}),this.disposeRunner=new c_("disposeShader")}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var n in e.uniforms){var i=e.uniforms[n];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,n,i){return new t(Fx.from(e,n),i)},t}(),Ux=function(){function t(){this.data=0,this.blendMode=vg.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(1&this.data)},set:function(t){!!(1&this.data)!==t&&(this.data^=1)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(2&this.data)},set:function(t){!!(2&this.data)!==t&&(this.data^=2)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(4&this.data)},set:function(t){!!(4&this.data)!==t&&(this.data^=4)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(8&this.data)},set:function(t){!!(8&this.data)!==t&&(this.data^=8)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return!!(32&this.data)},set:function(t){!!(32&this.data)!==t&&(this.data^=32)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(16&this.data)},set:function(t){!!(16&this.data)!==t&&(this.data^=16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==vg.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"[@pixi/core:State blendMode="+this.blendMode+" clockwiseFrontFace="+this.clockwiseFrontFace+" culling="+this.culling+" depthMask="+this.depthMask+" polygonOffset="+this.polygonOffset+"]"},t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Gx=function(t){function e(n,i,r){var a=this,o=Fx.from(n||e.defaultVertexSrc,i||e.defaultFragmentSrc);return(a=t.call(this,o,r)||this).padding=0,a.resolution=ty.FILTER_RESOLUTION,a.multisample=ty.FILTER_MULTISAMPLE,a.enabled=!0,a.autoFit=!0,a.state=new Ux,a}return y_(e,t),e.prototype.apply=function(t,e,n,i,r){t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._resolution=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},enumerable:!1,configurable:!0}),e}(Bx),zx=new Vy,Hx=function(){function t(t,e){this._texture=t,this.mapCoord=new Vy,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin="undefined"===typeof e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var n=this.mapCoord,i=0;i<t.length;i+=2){var r=t[i],a=t[i+1];e[i]=r*n.a+a*n.c+n.tx,e[i+1]=r*n.b+a*n.d+n.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var n=e._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var i=e.orig,r=e.trim;r&&(zx.set(i.width/r.width,0,0,i.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(zx));var a=e.baseTexture,o=this.uClampFrame,s=this.clampMargin/a.resolution,l=this.clampOffset;return o[0]=(e._frame.x+s+l)/a.width,o[1]=(e._frame.y+s+l)/a.height,o[2]=(e._frame.x+e._frame.width-s+l)/a.width,o[3]=(e._frame.y+e._frame.height-s+l)/a.height,this.uClampOffset[0]=l/a.realWidth,this.uClampOffset[1]=l/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&0===e.rotate,!0},t}(),Vx=function(t){function e(e,n,i){var r=this,a=null;return"string"!==typeof e&&void 0===n&&void 0===i&&(a=e,e=void 0,n=void 0,i=void 0),(r=t.call(this,e||"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",n||"varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",i)||this).maskSprite=a,r.maskMatrix=new Vy,r}return y_(e,t),Object.defineProperty(e.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(t){this._maskSprite=t,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),e.prototype.apply=function(t,e,n,i){var r=this._maskSprite,a=r._texture;a.valid&&(a.uvMatrix||(a.uvMatrix=new Hx(a,0)),a.uvMatrix.update(),this.uniforms.npmAlpha=a.baseTexture.alphaMode?0:1,this.uniforms.mask=a,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,r).prepend(a.uvMatrix.mapCoord),this.uniforms.alpha=r.worldAlpha,this.uniforms.maskClamp=a.uvMatrix.uClampFrame,t.applyFilter(this,e,n,i))},e}(Gx),jx=function(){function t(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return t.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},t.prototype.push=function(t,e){var n=e;if(!n.isMaskData){var i=this.maskDataPool.pop()||new px;i.pooled=!0,i.maskObject=e,n=i}var r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(n.copyCountersOrReset(r),n._colorMask=r?r._colorMask:15,n.autoDetect&&this.detect(n),n._target=t,n.type!==Pg.SPRITE&&this.maskStack.push(n),n.enabled)switch(n.type){case Pg.SCISSOR:this.renderer.scissor.push(n);break;case Pg.STENCIL:this.renderer.stencil.push(n);break;case Pg.SPRITE:n.copyCountersOrReset(null),this.pushSpriteMask(n);break;case Pg.COLOR:this.pushColorMask(n)}n.type===Pg.SPRITE&&this.maskStack.push(n)},t.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){if(e.enabled)switch(e.type){case Pg.SCISSOR:this.renderer.scissor.pop(e);break;case Pg.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Pg.SPRITE:this.popSpriteMask(e);break;case Pg.COLOR:this.popColorMask(e)}if(e.reset(),e.pooled&&this.maskDataPool.push(e),0!==this.maskStack.length){var n=this.maskStack[this.maskStack.length-1];n.type===Pg.SPRITE&&n._filters&&(n._filters[0].maskSprite=n.maskObject)}}},t.prototype.detect=function(t){var e=t.maskObject;e?e.isSprite?t.type=Pg.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Pg.SCISSOR:t.type=Pg.STENCIL:t.type=Pg.COLOR},t.prototype.pushSpriteMask=function(t){var e,n,i=t.maskObject,r=t._target,a=t._filters;a||(a=this.alphaMaskPool[this.alphaMaskIndex])||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new Vx]);var o,s,l=this.renderer,u=l.renderTexture;if(u.current){var h=u.current;o=t.resolution||h.resolution,s=null!==(e=t.multisample)&&void 0!==e?e:h.multisample}else o=t.resolution||l.resolution,s=null!==(n=t.multisample)&&void 0!==n?n:l.multisample;a[0].resolution=o,a[0].multisample=s,a[0].maskSprite=i;var c=r.filterArea;r.filterArea=i.getBounds(!0),l.filter.push(r,a),r.filterArea=c,t._filters||this.alphaMaskIndex++},t.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},t.prototype.pushColorMask=function(t){var e=t._colorMask,n=t._colorMask=e&t.colorMask;n!==e&&this.renderer.gl.colorMask(0!==(1&n),0!==(2&n),0!==(4&n),0!==(8&n))},t.prototype.popColorMask=function(t){var e=t._colorMask,n=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;n!==e&&this.renderer.gl.colorMask(0!==(1&n),0!==(2&n),0!==(4&n),0!==(8&n))},t.prototype.destroy=function(){this.renderer=null},t}(),Xx=function(){function t(t){this.renderer=t,this.maskStack=[],this.glConst=0}return t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(t){var e=this.renderer.gl,n=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==n&&(0===i?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){this.renderer=null,this.maskStack=null},t}(),Wx=new Vy,qx=[],Yx=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=ty.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,n}return y_(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.calcScissorRect=function(t){var e;if(!t._scissorRectLocal){var n=t._scissorRect,i=t.maskObject,r=this.renderer,a=r.renderTexture,o=i.getBounds(!0,null!==(e=qx.pop())&&void 0!==e?e:new Fy);this.roundFrameToPixels(o,a.current?a.current.resolution:r.resolution,a.sourceFrame,a.destinationFrame,r.projection.transform),n&&o.fit(n),t._scissorRectLocal=o}},e.isMatrixRotated=function(t){if(!t)return!1;var e=t.a,n=t.b,i=t.c,r=t.d;return(Math.abs(n)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(r)>1e-4)},e.prototype.testScissor=function(t){var n=t.maskObject;if(!n.isFastRect||!n.isFastRect())return!1;if(e.isMatrixRotated(n.worldTransform))return!1;if(e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);var i=t._scissorRectLocal;return i.width>0&&i.height>0},e.prototype.roundFrameToPixels=function(t,n,i,r,a){e.isMatrixRotated(a)||((a=a?Wx.copyFrom(a):Wx.identity()).translate(-i.x,-i.y).scale(r.width/i.width,r.height/i.height).translate(r.x,r.y),this.renderer.filter.transformAABB(a,t),t.fit(r),t.x=Math.round(t.x*n),t.y=Math.round(t.y*n),t.width=Math.round(t.width*n),t.height=Math.round(t.height*n))},e.prototype.push=function(t){t._scissorRectLocal||this.calcScissorRect(t);var e=this.renderer.gl;t._scissorRect||e.enable(e.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=t._scissorRectLocal,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;t&&qx.push(t._scissorRectLocal),this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t,e=this.maskStack[this.maskStack.length-1]._scissorRect;t=this.renderer.renderTexture.current?e.y:this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,t,e.width,e.height)},e}(Xx),Kx=function(t){function e(e){var n=t.call(this,e)||this;return n.glConst=ty.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,n}return y_(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,n=this.renderer.gl,i=t._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),n.clearStencil(0),n.clear(n.STENCIL_BUFFER_BIT),n.enable(n.STENCIL_TEST)),t._stencilCounter++;var r=t._colorMask;0!==r&&(t._colorMask=0,n.colorMask(!1,!1,!1,!1)),n.stencilFunc(n.EQUAL,i,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==r&&(t._colorMask=r,n.colorMask(0!==(1&r),0!==(2&r),0!==(4&r),0!==(8&r))),this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;if(0===this.getStackLength())e.disable(e.STENCIL_TEST);else{var n=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,i=n?n._colorMask:15;0!==i&&(n._colorMask=0,e.colorMask(!1,!1,!1,!1)),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==i&&(n._colorMask=i,e.colorMask(0!==(1&i),0!==(2&i),0!==(4&i),0!==(8&i))),this._useCurrent()}},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.stencilFunc(t.EQUAL,this.getStackLength(),4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e}(Xx),Zx=function(){function t(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Vy,this.transform=null}return t.prototype.update=function(t,e,n,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,i),this.transform&&this.projectionMatrix.append(this.transform);var r=this.renderer;r.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,r.globalUniforms.update(),r.shader.shader&&r.shader.syncUniformGroup(r.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(t,e,n,i){var r=this.projectionMatrix,a=i?-1:1;r.identity(),r.a=1/e.width*2,r.d=a*(1/e.height*2),r.tx=-1-e.x*r.a,r.ty=-a-e.y*r.d},t.prototype.setTransform=function(t){},t.prototype.destroy=function(){this.renderer=null},t}(),Jx=new Fy,Qx=new Fy,$x=function(){function t(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new Fy,this.destinationFrame=new Fy,this.viewportFrame=new Fy}return t.prototype.bind=function(t,e,n){void 0===t&&(t=null);var i,r,a,o=this.renderer;this.current=t,t?(a=(i=t.baseTexture).resolution,e||(Jx.width=t.frame.width,Jx.height=t.frame.height,e=Jx),n||(Qx.x=t.frame.x,Qx.y=t.frame.y,Qx.width=e.width,Qx.height=e.height,n=Qx),r=i.framebuffer):(a=o.resolution,e||(Jx.width=o.screen.width,Jx.height=o.screen.height,e=Jx),n||((n=Jx).width=e.width,n.height=e.height));var s=this.viewportFrame;s.x=n.x*a,s.y=n.y*a,s.width=n.width*a,s.height=n.height*a,t||(s.y=o.view.height-(s.y+s.height)),s.ceil(),this.renderer.framebuffer.bind(r,s),this.renderer.projection.update(n,e,a,!r),t?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(n)},t.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor;var n=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,r=n.width!==i.width||n.height!==i.height;if(r){var a=this.viewportFrame,o=a.x,s=a.y,l=a.width,u=a.height;o=Math.round(o),s=Math.round(s),l=Math.round(l),u=Math.round(u),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,s,l,u)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),r&&this.renderer.scissor.pop()},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t.prototype.destroy=function(){this.renderer=null},t}();function tb(t,e,n,i,r){n.buffer.update(r)}var eb={float:"\n        data[offset] = v;\n    ",vec2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n    ",vec3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n    ",vec4:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n        data[offset+3] = v[3];\n    ",mat2:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n\n        data[offset+4] = v[2];\n        data[offset+5] = v[3];\n    ",mat3:"\n        data[offset] = v[0];\n        data[offset+1] = v[1];\n        data[offset+2] = v[2];\n\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];\n    ",mat4:"\n        for(var i = 0; i < 16; i++)\n        {\n            data[offset + i] = v[i];\n        }\n    "},nb={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};function ib(t,e){if(!t.autoManage)return{size:0,syncFunc:tb};for(var n=function(t,e){var n=[];for(var i in t)e[i]&&n.push(e[i]);return n.sort((function(t,e){return t.index-e.index})),n}(t.uniforms,e),i=function(t){for(var e=t.map((function(t){return{data:t,offset:0,dataLen:0,dirty:0}})),n=0,i=0,r=0,a=0;a<e.length;a++){var o=e[a];if(n=nb[o.data.type],o.data.size>1&&(n=Math.max(n,16)*o.data.size),o.dataLen=n,i%n!==0&&i<16){var s=i%n%16;i+=s,r+=s}i+n>16?(r=16*Math.ceil(r/16),o.offset=r,r+=n,i=n):(o.offset=r,i+=n,r+=n)}return{uboElements:e,size:r=16*Math.ceil(r/16)}}(n),r=i.uboElements,a=i.size,o=["\n    var v = null;\n    var v2 = null;\n    var cv = null;\n    var t = 0;\n    var gl = renderer.gl\n    var index = 0;\n    var data = buffer.data;\n    "],s=0;s<r.length;s++){for(var l=r[s],u=t.uniforms[l.data.name],h=l.data.name,c=!1,d=0;d<Cx.length;d++){var f=Cx[d];if(f.codeUbo&&f.test(l.data,u)){o.push("offset = "+l.offset/4+";",Cx[d].codeUbo(l.data.name,u)),c=!0;break}}if(!c)if(l.data.size>1){var p=Mx(l.data.type),v=Math.max(nb[l.data.type]/16,1),m=p/v,g=(4-m%4)%4;o.push("\n                cv = ud."+h+".value;\n                v = uv."+h+";\n                offset = "+l.offset/4+";\n\n                t = 0;\n\n                for(var i=0; i < "+l.data.size*v+"; i++)\n                {\n                    for(var j = 0; j < "+m+"; j++)\n                    {\n                        data[offset++] = v[t++];\n                    }\n                    offset += "+g+";\n                }\n\n                ")}else{var y=eb[l.data.type];o.push("\n                cv = ud."+h+".value;\n                v = uv."+h+";\n                offset = "+l.offset/4+";\n                "+y+";\n                ")}}return o.push("\n       renderer.buffer.update(buffer);\n    "),{size:a,syncFunc:new Function("ud","uv","renderer","syncData","buffer",o.join("\n"))}}var rb=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},t}();function ab(t,e){var n=vx(t,t.VERTEX_SHADER,e.vertexSrc),i=vx(t,t.FRAGMENT_SHADER,e.fragmentSrc),r=t.createProgram();if(t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||function(t,e,n,i){t.getProgramParameter(e,t.LINK_STATUS)||(t.getShaderParameter(n,t.COMPILE_STATUS)||mx(t,n),t.getShaderParameter(i,t.COMPILE_STATUS)||mx(t,i),console.error("PixiJS Error: Could not initialize shader."),""!==t.getProgramInfoLog(e)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(e)))}(t,r,n,i),e.attributeData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),r=0;r<i;r++){var a=e.getActiveAttrib(t,r);if(0!==a.name.indexOf("gl_")){var o=Px(e,a.type),s={type:o,name:a.name,size:Mx(o),location:e.getAttribLocation(t,a.name)};n[a.name]=s}}return n}(r,t),e.uniformData=function(t,e){for(var n={},i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<i;r++){var a=e.getActiveUniform(t,r),o=a.name.replace(/\[.*?\]$/,""),s=!!a.name.match(/\[.*?\]$/),l=Px(e,a.type);n[o]={name:o,index:r,type:l,size:a.size,isArray:s,value:yx(l,a.size)}}return n}(r,t),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(e.vertexSrc)){var a=Object.keys(e.attributeData);a.sort((function(t,e){return t>e?1:-1}));for(var o=0;o<a.length;o++)e.attributeData[a[o]].location=o,t.bindAttribLocation(r,o,a[o]);t.linkProgram(r)}t.deleteShader(n),t.deleteShader(i);var s={};for(var o in e.uniformData){var l=e.uniformData[o];s[o]={location:t.getUniformLocation(r,o),value:yx(l.type,l.size)}}return new rb(r,s)}var ob=0,sb={textureCount:0,uboCount:0},lb=function(){function t(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ob++}return t.prototype.systemCheck=function(){if(!function(){if("boolean"===typeof Ix)return Ix;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");Ix=!0===t({a:"b"},"a","b")}catch(e){Ix=!1}return Ix}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(t){this.gl=t,this.reset()},t.prototype.bind=function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var n=t.program,i=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==n&&(this.program=n,this.gl.useProgram(i.program)),e||(sb.textureCount=0,sb.uboCount=0,this.syncUniformGroup(t.uniformGroup,sb)),i},t.prototype.setUniforms=function(t){var e=this.shader.program,n=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(n.uniformData,t,this.renderer)},t.prototype.syncUniformGroup=function(t,e){var n=this.getGlProgram();t.static&&t.dirtyId===n.uniformDirtyGroups[t.id]||(n.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,n,e))},t.prototype.syncUniforms=function(t,e,n){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,n)},t.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=function(t,e){var n,i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n    "];for(var r in t.uniforms){var a=e[r];if(a){for(var o=t.uniforms[r],s=!1,l=0;l<Cx.length;l++)if(Cx[l].test(a,o)){i.push(Cx[l].code(r,o)),s=!0;break}if(!s){var u=(1!==a.size||a.isArray?Rx:kx)[a.type].replace("location",'ud["'+r+'"].location');i.push('\n            cu = ud["'+r+'"];\n            cv = cu.value;\n            v = uv["'+r+'"];\n            '+u+";")}}else(null===(n=t.uniforms[r])||void 0===n?void 0:n.group)&&(t.uniforms[r].ubo?i.push("\n                        renderer.shader.syncUniformBufferGroup(uv."+r+", '"+r+"');\n                    "):i.push("\n                        renderer.shader.syncUniformGroup(uv."+r+", syncData);\n                    "))}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},t.prototype.syncUniformBufferGroup=function(t,e){var n=this.getGlProgram();if(!t.static||0!==t.dirtyId||!n.uniformGroups[t.id]){t.dirtyId=0;var i=n.uniformGroups[t.id]||this.createSyncBufferGroup(t,n,e);t.buffer.update(),i(n.uniformData,t.uniforms,this.renderer,sb,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,n.uniformBufferBindings[e])},t.prototype.createSyncBufferGroup=function(t,e,n){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var r=this.gl.getUniformBlockIndex(e.program,n);e.uniformBufferBindings[n]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,r,this.shader.uniformBindCount),this.shader.uniformBindCount++;var a=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[a];if(o||(o=this._uboCache[a]=ib(t,this.shader.program.uniformData)),t.autoManage){var s=new Float32Array(o.size/4);t.buffer.update(s)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},t.prototype.getSignature=function(t,e,n){var i=t.uniforms,r=[n+"-"];for(var a in i)r.push(a),e[a]&&r.push(e[a].type);return r.join("-")},t.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateProgram=function(t){var e=this.gl,n=t.program,i=ab(e,n);return n.glPrograms[this.renderer.CONTEXT_UID]=i,i},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.disposeShader=function(t){this.shader===t&&(this.shader=null)},t.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},t}();var ub=function(){function t(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=vg.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new Ux,this.defaultState.blend=!0}return t.prototype.contextChange=function(t){this.gl=t,this.blendModes=function(t,e){return void 0===e&&(e=[]),e[vg.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.ADD]=[t.ONE,t.ONE],e[vg.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.NONE]=[0,0],e[vg.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[vg.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[vg.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[vg.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[vg.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[vg.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[vg.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[vg.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[vg.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[vg.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[vg.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}(t),this.set(this.defaultState),this.reset()},t.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,n=0;e;)1&e&&this.map[n].call(this,!!(t.data&1<<n)),e>>=1,n++;this.stateId=t.data}for(n=0;n<this.checks.length;n++)this.checks[n](this,t)},t.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},t.prototype.setBlend=function(e){this.updateCheck(t.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},t.prototype.setOffset=function(e){this.updateCheck(t.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},t.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},t.prototype.setDepthMask=function(t){this.gl.depthMask(t)},t.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},t.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},t.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],n=this.gl;2===e.length?n.blendFunc(e[0],e[1]):n.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,n.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},t.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},t.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},t.prototype.updateCheck=function(t,e){var n=this.checks.indexOf(t);e&&-1===n?this.checks.push(t):e||-1===n||this.checks.splice(n,1)},t.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},t.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},t.prototype.destroy=function(){this.gl=null},t}(),hb=function(){function t(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=ty.GC_MAX_IDLE,this.checkCountMax=ty.GC_MAX_CHECK_COUNT,this.mode=ty.GC_MODE}return t.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Eg.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},t.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,n=!1,i=0;i<e.length;i++){var r=e[i];!r.framebuffer&&this.count-r.touched>this.maxIdle&&(t.destroyTexture(r,!0),e[i]=null,n=!0)}if(n){var a=0;for(i=0;i<e.length;i++)null!==e[i]&&(e[a++]=e[i]);e.length=a}},t.prototype.unload=function(t){var e=this.renderer.texture,n=t._texture;n&&!n.framebuffer&&e.destroyTexture(n);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},t.prototype.destroy=function(){this.renderer=null},t}();var cb=function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=_g.UNSIGNED_BYTE,this.internalFormat=gg.RGBA,this.samplerType=0},db=function(){function t(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new S_,this.hasIntegerTextures=!1}return t.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=function(t){var e,n,i,r,a,o,s,l,u,h,c,d,f,p,v,m,g,y,_,x,b,w,S;return"WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext?((e={})[_g.UNSIGNED_BYTE]=((n={})[gg.RGBA]=t.RGBA8,n[gg.RGB]=t.RGB8,n[gg.RG]=t.RG8,n[gg.RED]=t.R8,n[gg.RGBA_INTEGER]=t.RGBA8UI,n[gg.RGB_INTEGER]=t.RGB8UI,n[gg.RG_INTEGER]=t.RG8UI,n[gg.RED_INTEGER]=t.R8UI,n[gg.ALPHA]=t.ALPHA,n[gg.LUMINANCE]=t.LUMINANCE,n[gg.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,n),e[_g.BYTE]=((i={})[gg.RGBA]=t.RGBA8_SNORM,i[gg.RGB]=t.RGB8_SNORM,i[gg.RG]=t.RG8_SNORM,i[gg.RED]=t.R8_SNORM,i[gg.RGBA_INTEGER]=t.RGBA8I,i[gg.RGB_INTEGER]=t.RGB8I,i[gg.RG_INTEGER]=t.RG8I,i[gg.RED_INTEGER]=t.R8I,i),e[_g.UNSIGNED_SHORT]=((r={})[gg.RGBA_INTEGER]=t.RGBA16UI,r[gg.RGB_INTEGER]=t.RGB16UI,r[gg.RG_INTEGER]=t.RG16UI,r[gg.RED_INTEGER]=t.R16UI,r[gg.DEPTH_COMPONENT]=t.DEPTH_COMPONENT16,r),e[_g.SHORT]=((a={})[gg.RGBA_INTEGER]=t.RGBA16I,a[gg.RGB_INTEGER]=t.RGB16I,a[gg.RG_INTEGER]=t.RG16I,a[gg.RED_INTEGER]=t.R16I,a),e[_g.UNSIGNED_INT]=((o={})[gg.RGBA_INTEGER]=t.RGBA32UI,o[gg.RGB_INTEGER]=t.RGB32UI,o[gg.RG_INTEGER]=t.RG32UI,o[gg.RED_INTEGER]=t.R32UI,o[gg.DEPTH_COMPONENT]=t.DEPTH_COMPONENT24,o),e[_g.INT]=((s={})[gg.RGBA_INTEGER]=t.RGBA32I,s[gg.RGB_INTEGER]=t.RGB32I,s[gg.RG_INTEGER]=t.RG32I,s[gg.RED_INTEGER]=t.R32I,s),e[_g.FLOAT]=((l={})[gg.RGBA]=t.RGBA32F,l[gg.RGB]=t.RGB32F,l[gg.RG]=t.RG32F,l[gg.RED]=t.R32F,l[gg.DEPTH_COMPONENT]=t.DEPTH_COMPONENT32F,l),e[_g.HALF_FLOAT]=((u={})[gg.RGBA]=t.RGBA16F,u[gg.RGB]=t.RGB16F,u[gg.RG]=t.RG16F,u[gg.RED]=t.R16F,u),e[_g.UNSIGNED_SHORT_5_6_5]=((h={})[gg.RGB]=t.RGB565,h),e[_g.UNSIGNED_SHORT_4_4_4_4]=((c={})[gg.RGBA]=t.RGBA4,c),e[_g.UNSIGNED_SHORT_5_5_5_1]=((d={})[gg.RGBA]=t.RGB5_A1,d),e[_g.UNSIGNED_INT_2_10_10_10_REV]=((f={})[gg.RGBA]=t.RGB10_A2,f[gg.RGBA_INTEGER]=t.RGB10_A2UI,f),e[_g.UNSIGNED_INT_10F_11F_11F_REV]=((p={})[gg.RGB]=t.R11F_G11F_B10F,p),e[_g.UNSIGNED_INT_5_9_9_9_REV]=((v={})[gg.RGB]=t.RGB9_E5,v),e[_g.UNSIGNED_INT_24_8]=((m={})[gg.DEPTH_STENCIL]=t.DEPTH24_STENCIL8,m),e[_g.FLOAT_32_UNSIGNED_INT_24_8_REV]=((g={})[gg.DEPTH_STENCIL]=t.DEPTH32F_STENCIL8,g),S=e):((y={})[_g.UNSIGNED_BYTE]=((_={})[gg.RGBA]=t.RGBA,_[gg.RGB]=t.RGB,_[gg.ALPHA]=t.ALPHA,_[gg.LUMINANCE]=t.LUMINANCE,_[gg.LUMINANCE_ALPHA]=t.LUMINANCE_ALPHA,_),y[_g.UNSIGNED_SHORT_5_6_5]=((x={})[gg.RGB]=t.RGB,x),y[_g.UNSIGNED_SHORT_4_4_4_4]=((b={})[gg.RGBA]=t.RGBA,b),y[_g.UNSIGNED_SHORT_5_5_5_1]=((w={})[gg.RGBA]=t.RGBA,w),S=y),S}(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var n=0;n<e;n++)this.boundTextures[n]=null;this.emptyTextures={};var i=new cb(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new cb(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(n=0;n<6;n++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(n=0;n<this.boundTextures.length;n++)this.bind(null,n)},t.prototype.bind=function(t,e){void 0===e&&(e=0);var n=this.gl;if((t=null===t||void 0===t?void 0:t.castToBaseTexture())&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,n.activeTexture(n.TEXTURE0+e)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[e]=null},t.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},t.prototype.unbind=function(t){var e=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<n.length;i++)n[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<n.length;i++)n[i]===t&&(this.currentLocation!==i&&(e.activeTexture(e.TEXTURE0+i),this.currentLocation=i),e.bindTexture(t.target,this.emptyTextures[t.target].texture),n[i]=null)},t.prototype.ensureSamplerType=function(t){var e=this,n=e.boundTextures,i=e.hasIntegerTextures,r=e.CONTEXT_UID;if(i)for(var a=t-1;a>=0;--a){var o=n[a];if(o)o._glTextures[r].samplerType!==xg.FLOAT&&this.renderer.texture.unbind(o)}},t.prototype.initTexture=function(t){var e=new cb(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},t.prototype.initTextureType=function(t,e){var n,i;e.internalFormat=null!==(i=null===(n=this.internalFormats[t.type])||void 0===n?void 0:n[t.format])&&void 0!==i?i:t.format,2===this.webGLVersion&&t.type===_g.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},t.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var n=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(n,t,e))e.samplerType!==xg.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,r=t.realHeight,a=n.gl;(e.width!==i||e.height!==r||e.dirtyId<0)&&(e.width=i,e.height=r,a.texImage2D(t.target,0,e.internalFormat,i,r,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},t.prototype.destroyTexture=function(t,e){var n=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),n.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);-1!==i&&_y(this.managedTextures,i,1)}},t.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==Sg.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=wg.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},t.prototype.setStyle=function(t,e){var n=this.gl;if(e.mipmap&&t.mipmap!==Sg.ON_MANUAL&&n.generateMipmap(t.target),n.texParameteri(t.target,n.TEXTURE_WRAP_S,e.wrapMode),n.texParameteri(t.target,n.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===bg.LINEAR?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===bg.LINEAR){var r=Math.min(t.anisotropicLevel,n.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,r)}}else n.texParameteri(t.target,n.TEXTURE_MIN_FILTER,t.scaleMode===bg.LINEAR?n.LINEAR:n.NEAREST);n.texParameteri(t.target,n.TEXTURE_MAG_FILTER,t.scaleMode===bg.LINEAR?n.LINEAR:n.NEAREST)},t.prototype.destroy=function(){this.renderer=null},t}(),fb={__proto__:null,FilterSystem:rx,BatchSystem:ox,ContextSystem:lx,FramebufferSystem:cx,GeometrySystem:fx,MaskSystem:jx,ScissorSystem:Yx,StencilSystem:Kx,ProjectionSystem:Zx,RenderTextureSystem:$x,ShaderSystem:lb,StateSystem:ub,TextureGCSystem:hb,TextureSystem:db},pb=new Vy,vb=function(t){function e(e,n){void 0===e&&(e=fg.UNKNOWN);var i=t.call(this)||this;return n=Object.assign({},ty.RENDER_OPTIONS,n),i.options=n,i.type=e,i.screen=new Fy(0,0,n.width,n.height),i.view=n.view||ty.ADAPTER.createCanvas(),i.resolution=n.resolution||ty.RESOLUTION,i.useContextAlpha=n.useContextAlpha,i.autoDensity=!!n.autoDensity,i.preserveDrawingBuffer=n.preserveDrawingBuffer,i.clearBeforeRender=n.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=n.backgroundColor||i._backgroundColor,i.backgroundAlpha=n.backgroundAlpha,void 0!==n.transparent&&(Ty("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=n.transparent,i.backgroundAlpha=n.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return y_(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.view.width=Math.round(t*this.resolution),this.view.height=Math.round(e*this.resolution);var n=this.view.width/this.resolution,i=this.view.height/this.resolution;this.screen.width=n,this.screen.height=i,this.autoDensity&&(this.view.style.width=n+"px",this.view.style.height=i+"px"),this.emit("resize",n,i)},e.prototype.generateTexture=function(t,e,n,i){void 0===e&&(e={}),"number"===typeof e&&(Ty("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),e={scaleMode:e,resolution:n,region:i});var r=e.region,a=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}(e,["region"]);0===(i=r||t.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var o=z_.create(__({width:i.width,height:i.height},a));return pb.tx=-i.x,pb.ty=-i.y,this.render(t,{renderTexture:o,clear:!1,transform:pb,skipUpdateTransform:!!t.parent}),o},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var n=this;n.plugins=null,n.type=fg.UNKNOWN,n.view=null,n.screen=null,n._tempDisplayObjectParent=null,n.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=uy(t),ly(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(t){this._backgroundColorRgba[3]=t},enumerable:!1,configurable:!0}),e}(ey),mb=function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0},gb=function(){function t(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return t.prototype.destroy=function(){this.renderer=null},t.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},t.prototype.bind=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n]||this.createGLBuffer(t);e.bindBuffer(t.type,i.buffer)},t.prototype.bindBufferBase=function(t,e){var n=this.gl,i=this.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var r=t._glBuffers[i]||this.createGLBuffer(t);this.boundBufferBases[e]=t,n.bindBufferBase(n.UNIFORM_BUFFER,e,r.buffer)}},t.prototype.bindBufferRange=function(t,e,n){var i=this.gl,r=this.CONTEXT_UID;n=n||0;var a=t._glBuffers[r]||this.createGLBuffer(t);i.bindBufferRange(i.UNIFORM_BUFFER,e||0,a.buffer,256*n,256)},t.prototype.update=function(t){var e=this.gl,n=this.CONTEXT_UID,i=t._glBuffers[n];if(t._updateID!==i.updateID)if(i.updateID=t._updateID,e.bindBuffer(t.type,i.buffer),i.byteLength>=t.data.byteLength)e.bufferSubData(t.type,0,t.data);else{var r=t.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;i.byteLength=t.data.byteLength,e.bufferData(t.type,t.data,r)}},t.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var n=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),n&&(e||i.deleteBuffer(n.buffer),delete t._glBuffers[this.CONTEXT_UID])}},t.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),n=0;n<e.length;n++)this.dispose(this.managedBuffers[e[n]],t)},t.prototype.createGLBuffer=function(t){var e=this.CONTEXT_UID,n=this.gl;return t._glBuffers[e]=new mb(n.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[e]},t}(),yb=function(t){function e(n){var i=t.call(this,fg.WEBGL,n)||this;return n=i.options,i.gl=null,i.CONTEXT_UID=0,i.runners={destroy:new c_("destroy"),contextChange:new c_("contextChange"),reset:new c_("reset"),update:new c_("update"),postrender:new c_("postrender"),prerender:new c_("prerender"),resize:new c_("resize")},i.runners.contextChange.add(i),i.globalUniforms=new tx({projectionMatrix:new Vy},!0),i.addSystem(jx,"mask").addSystem(lx,"context").addSystem(ub,"state").addSystem(lb,"shader").addSystem(db,"texture").addSystem(gb,"buffer").addSystem(fx,"geometry").addSystem(cx,"framebuffer").addSystem(Yx,"scissor").addSystem(Kx,"stencil").addSystem(Zx,"projection").addSystem(hb,"textureGC").addSystem(rx,"filter").addSystem($x,"renderTexture").addSystem(ox,"batch"),i.initPlugins(e.__plugins),i.multisample=void 0,n.context?i.context.initFromContext(n.context):i.context.initFromOptions({alpha:!!i.useContextAlpha,antialias:n.antialias,premultipliedAlpha:i.useContextAlpha&&"notMultiplied"!==i.useContextAlpha,stencil:!0,preserveDrawingBuffer:n.preserveDrawingBuffer,powerPreference:i.options.powerPreference}),i.renderingToScreen=!0,function(t){var e;if(!oy){if(ty.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 6.5.10 - \u2730 "+t+" \u2730  %c  %c  http://www.pixijs.com/  %c %c \u2665%c\u2665%c\u2665 \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=globalThis.console).log.apply(e,n)}else globalThis.console&&globalThis.console.log("PixiJS 6.5.10 - "+t+" - http://www.pixijs.com/");oy=!0}}(2===i.context.webGLVersion?"WebGL 2":"WebGL 1"),i.resize(i.options.width,i.options.height),i}return y_(e,t),e.create=function(t){if("undefined"===typeof ay&&(ay=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:ty.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!ty.ADAPTER.getWebGLRenderingContext())return!1;var e=ty.ADAPTER.createCanvas(),n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!(!n||!n.getContextAttributes().stencil);if(n){var r=n.getExtension("WEBGL_lose_context");r&&r.loseContext()}return n=null,i}catch(a){return!1}}()),ay)return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.contextChange=function(){var t,e=this.gl;if(1===this.context.webGLVersion){var n=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,n)}else{n=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n)}t>=kg.HIGH?this.multisample=kg.HIGH:t>=kg.MEDIUM?this.multisample=kg.MEDIUM:t>=kg.LOW?this.multisample=kg.LOW:this.multisample=kg.NONE},e.prototype.addSystem=function(t,e){var n=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var i in this[e]=n,this.runners)this.runners[i].add(n);return this},e.prototype.render=function(t,e){var n,i,r,a;if(e&&(e instanceof z_?(Ty("6.0.0","Renderer#render arguments changed, use options instead."),n=e,i=arguments[2],r=arguments[3],a=arguments[4]):(n=e.renderTexture,i=e.clear,r=e.transform,a=e.skipUpdateTransform)),this.renderingToScreen=!n,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(n||(this._lastObjectRendered=t),!a){var o=t.enableTempParent();t.updateTransform(),t.disableTempParent(o)}this.renderTexture.bind(n),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),n&&n.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.generateTexture=function(e,n,i,r){void 0===n&&(n={});var a=t.prototype.generateTexture.call(this,e,n,i,r);return this.framebuffer.blit(),a},e.prototype.resize=function(e,n){t.prototype.resize.call(this,e,n),this.runners.resize.emit(this.screen.height,this.screen.width)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var n in this.runners.destroy.emit(),this.runners)this.runners[n].destroy();t.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(e.prototype,"extract",{get:function(){return Ty("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),e.registerPlugin=function(t,e){Ty("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),h_.add({name:t,type:o_.RendererPlugin,ref:e})},e.__plugins={},e}(vb);h_.handleByMap(o_.RendererPlugin,yb.__plugins);var _b="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",xb=(function(){function t(t){Ty("6.1.0","System class is deprecated, implemement ISystem interface instead."),this.renderer=t}t.prototype.destroy=function(){this.renderer=null}}(),function(){this.texArray=null,this.blend=0,this.type=mg.TRIANGLES,this.start=0,this.size=0,this.data=null}),bb=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),wb=function(){function t(t){"number"===typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),Sb=function(t){function e(e){var n=t.call(this,e)||this;return n.shaderGenerator=null,n.geometryClass=null,n.vertexSize=null,n.state=Ux.for2d(),n.size=4*ty.SPRITE_BATCH_SIZE,n._vertexCount=0,n._indexCount=0,n._bufferedElements=[],n._bufferedTextures=[],n._bufferSize=0,n._shader=null,n._packedGeometries=[],n._packedGeometryPoolSize=2,n._flushId=0,n._aBuffers={},n._iBuffers={},n.MAX_TEXTURES=1,n.renderer.on("prerender",n.onPrerender,n),e.runners.contextChange.add(n),n._dcIndex=0,n._aIndex=0,n._iIndex=0,n._attributeBuffer=null,n._indexBuffer=null,n._tempBoundTextures=[],n}return y_(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;ty.PREFER_ENV===dg.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),ty.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=e.createShader(e.FRAGMENT_SHADER);;){var i=Dx.replace(/%forloop%/gi,Ox(t));if(e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))break;t=t/2|0}return t}(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,n=e._textureArrayPool,i=this.size/4,r=Math.floor(i/this.MAX_TEXTURES)+1;t.length<i;)t.push(new xb);for(;n.length<r;)n.push(new bb);for(var a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,n=this.MAX_TEXTURES,i=e._textureArrayPool,r=this.renderer.batch,a=this._tempBoundTextures,o=this.renderer.textureGC.count,s=++S_._globalBatch,l=0,u=i[0],h=0;r.copyBoundTextures(a,n);for(var c=0;c<this._bufferSize;++c){var d=t[c];t[c]=null,d._batchEnabled!==s&&(u.count>=n&&(r.boundArray(u,a,s,n),this.buildDrawCalls(u,h,c),h=c,u=i[++l],++s),d._batchEnabled=s,d.touched=o,u.elements[u.count++]=d)}u.count>0&&(r.boundArray(u,a,s,n),this.buildDrawCalls(u,h,this._bufferSize),++l,++s);for(c=0;c<a.length;c++)a[c]=null;S_._globalBatch=s},e.prototype.buildDrawCalls=function(t,n,i){var r=this,a=r._bufferedElements,o=r._attributeBuffer,s=r._indexBuffer,l=r.vertexSize,u=e._drawCallPool,h=this._dcIndex,c=this._aIndex,d=this._iIndex,f=u[h];f.start=this._iIndex,f.texArray=t;for(var p=n;p<i;++p){var v=a[p],m=v._texture.baseTexture,g=cy[m.alphaMode?1:0][v.blendMode];a[p]=null,n<p&&f.blend!==g&&(f.size=d-f.start,n=p,(f=u[++h]).texArray=t,f.start=d),this.packInterleavedGeometry(v,o,s,c,d),c+=v.vertexData.length/2*l,d+=v.indices.length,f.blend=g}n<i&&(f.size=d-f.start,++h),this._dcIndex=h,this._aIndex=c,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,n=0;n<t.count;n++)e.bind(t.elements[n],t.ids[n]),t.elements[n]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this,e=t._packedGeometries,n=t._attributeBuffer,i=t._indexBuffer;ty.CAN_UPLOAD_SAME_BUFFER?(e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,e[this._flushId]=new this.geometryClass),e[this._flushId]._buffer.update(n.rawBinaryData),e[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(e[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,n=this.renderer,i=n.gl,r=n.state,a=e._drawCallPool,o=null,s=0;s<t;s++){var l=a[s],u=l.texArray,h=l.type,c=l.size,d=l.start,f=l.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=f,r.set(this.state),i.drawElements(h,c,i.UNSIGNED_SHORT,2*d)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),ty.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=my(Math.ceil(t/8)),n=yy(e),i=8*e;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._aBuffers[i];return r||(this._aBuffers[i]=r=new wb(i*this.vertexSize*4)),r},e.prototype.getIndexBuffer=function(t){var e=my(Math.ceil(t/12)),n=yy(e),i=12*e;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var r=this._iBuffers[n];return r||(this._iBuffers[n]=r=new Uint16Array(i)),r},e.prototype.packInterleavedGeometry=function(t,e,n,i,r){for(var a=e.uint32View,o=e.float32View,s=i/this.vertexSize,l=t.uvs,u=t.indices,h=t.vertexData,c=t._texture.baseTexture._batchLocation,d=Math.min(t.worldAlpha,1),f=d<1&&t._texture.baseTexture.alphaMode?fy(t._tintRGB,d):t._tintRGB+(255*d<<24),p=0;p<h.length;p+=2)o[i++]=h[p],o[i++]=h[p+1],o[i++]=l[p],o[i++]=l[p+1],a[i++]=f,o[i++]=c;for(p=0;p<u.length;p++)n[r++]=s+u[p]},e._drawCallPool=[],e._textureArrayPool=[],e}(ax),Tb=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),n=0;n<t;n++)e[n]=n;this.defaultGroupCache[t]=tx.from({uSamplers:e},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Fx(this.vertexSrc,i)}var r={tint:new Float32Array([1,1,1,1]),translationMatrix:new Vy,default:this.defaultGroupCache[t]};return new Bx(this.programCache[t],r)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var n=0;n<t;n++)n>0&&(e+="\nelse "),n<t-1&&(e+="if(vTextureId < "+n+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),Mb=function(t){function e(e){void 0===e&&(e=!1);var n=t.call(this)||this;return n._buffer=new X_(null,e,!1),n._indexBuffer=new X_(null,e,!0),n.addAttribute("aVertexPosition",n._buffer,2,!1,_g.FLOAT).addAttribute("aTextureCoord",n._buffer,2,!1,_g.FLOAT).addAttribute("aColor",n._buffer,4,!0,_g.UNSIGNED_BYTE).addAttribute("aTextureId",n._buffer,1,!0,_g.FLOAT).addIndex(n._indexBuffer),n}return y_(e,t),e}(Z_),Eb="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Ab="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Pb=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:Eb,fragment:Ab,geometryClass:Mb,vertexSize:6},t),n=e.vertex,i=e.fragment,r=e.vertexSize,a=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new Tb(n,i),o.geometryClass=a,o.vertexSize=r,o}return y_(e,t),e}(Sb)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return Eb},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return Ab},enumerable:!1,configurable:!0}),t}(),Cb=Pb.create();Object.assign(Cb,{extension:{name:"batch",type:o_.RendererPlugin}});var kb={},Rb=function(t){Object.defineProperty(kb,t,{get:function(){return Ty("6.0.0","PIXI.systems."+t+" has moved to PIXI."+t),D_[t]}})};for(var Ib in D_)Rb(Ib);var Db={},Ob=function(t){Object.defineProperty(Db,t,{get:function(){return Ty("6.0.0","PIXI.resources."+t+" has moved to PIXI."+t),fb[t]}})};for(var Ib in fb)Ob(Ib);n_.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});var Lb=function(){function t(t){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,($g.tablet||$g.phone)&&this.createTouchHook();var e=document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.zIndex=2..toString(),this.div=e,this.renderer=t,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(t.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),t.prototype.createTouchHook=function(){var t=this,e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",(function(){t._isMobileAccessibility=!0,t.activate(),t.destroyTouchHook()})),document.body.appendChild(e),this._hookDiv=e},t.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},t.prototype.activate=function(){var t;this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),null===(t=this.renderer.view.parentNode)||void 0===t||t.appendChild(this.div))},t.prototype.deactivate=function(){var t;this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),null===(t=this.div.parentNode)||void 0===t||t.removeChild(this.div))},t.prototype.updateAccessibleObjects=function(t){if(t.visible&&t.accessibleChildren){t.accessible&&t.interactive&&(t._accessibleActive||this.addChild(t),t.renderId=this.renderId);var e=t.children;if(e)for(var n=0;n<e.length;n++)this.updateAccessibleObjects(e[n])}},t.prototype.update=function(){var t=performance.now();if(!($g.android.device&&t<this.androidUpdateCount)&&(this.androidUpdateCount=t+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var e=this.renderer.view.getBoundingClientRect(),n=e.left,i=e.top,r=e.width,a=e.height,o=this.renderer,s=o.width,l=o.height,u=o.resolution,h=r/s*u,c=a/l*u,d=this.div;d.style.left=n+"px",d.style.top=i+"px",d.style.width=s+"px",d.style.height=l+"px";for(var f=0;f<this.children.length;f++){var p=this.children[f];if(p.renderId!==this.renderId)p._accessibleActive=!1,_y(this.children,f,1),this.div.removeChild(p._accessibleDiv),this.pool.push(p._accessibleDiv),p._accessibleDiv=null,f--;else{d=p._accessibleDiv;var v=p.hitArea,m=p.worldTransform;p.hitArea?(d.style.left=(m.tx+v.x*m.a)*h+"px",d.style.top=(m.ty+v.y*m.d)*c+"px",d.style.width=v.width*m.a*h+"px",d.style.height=v.height*m.d*c+"px"):(v=p.getBounds(),this.capHitArea(v),d.style.left=v.x*h+"px",d.style.top=v.y*c+"px",d.style.width=v.width*h+"px",d.style.height=v.height*c+"px",d.title!==p.accessibleTitle&&null!==p.accessibleTitle&&(d.title=p.accessibleTitle),d.getAttribute("aria-label")!==p.accessibleHint&&null!==p.accessibleHint&&d.setAttribute("aria-label",p.accessibleHint)),p.accessibleTitle===d.title&&p.tabIndex===d.tabIndex||(d.title=p.accessibleTitle,d.tabIndex=p.tabIndex,this.debug&&this.updateDebugHTML(d))}}this.renderId++}},t.prototype.updateDebugHTML=function(t){t.innerHTML="type: "+t.type+"</br> title : "+t.title+"</br> tabIndex: "+t.tabIndex},t.prototype.capHitArea=function(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);var e=this.renderer,n=e.width,i=e.height;t.x+t.width>n&&(t.width=n-t.x),t.y+t.height>i&&(t.height=i-t.y)},t.prototype.addChild=function(t){var e=this.pool.pop();e||((e=document.createElement("button")).style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title="displayObject "+t.tabIndex),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),this.debug&&this.updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.displayObject=t,this.children.push(t),this.div.appendChild(t._accessibleDiv),t._accessibleDiv.tabIndex=t.tabIndex},t.prototype._onClick=function(t){var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"click",i),e.dispatchEvent(n,"pointertap",i),e.dispatchEvent(n,"tap",i)},t.prototype._onFocus=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseover",i)},t.prototype._onFocusOut=function(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite");var e=this.renderer.plugins.interaction,n=t.target.displayObject,i=e.eventData;e.dispatchEvent(n,"mouseout",i)},t.prototype._onKeyDown=function(t){9===t.keyCode&&this.activate()},t.prototype._onMouseMove=function(t){0===t.movementX&&0===t.movementY||this.deactivate()},t.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},t.extension={name:"accessibility",type:[o_.RendererPlugin,o_.CanvasRendererPlugin]},t}(),Nb=function(){function t(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new Ly,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(t.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),t.prototype.getLocalPosition=function(t,e,n){return t.worldTransform.applyInverse(n||this.global,e)},t.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},t.prototype.reset=function(){this.isPrimary=!1},t}(),Fb=function(t,e){return Fb=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},Fb(t,e)};var Bb=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}(),Ub=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!==(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!==(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!==(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}(),Gb=function(){function t(){this._tempPoint=new Ly}return t.prototype.recursiveFindHit=function(t,e,n,i,r){var a;if(!e||!e.visible)return!1;var o=t.data.global,s=!1,l=r=e.interactive||r,u=!0;if(e.hitArea)i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(i=!1,u=!1)),l=!1;else if(e._mask&&i){var h=e._mask.isMaskData?e._mask.maskObject:e._mask;h&&!(null===(a=h.containsPoint)||void 0===a?void 0:a.call(h,o))&&(i=!1)}if(u&&e.interactiveChildren&&e.children)for(var c=e.children,d=c.length-1;d>=0;d--){var f=c[d],p=this.recursiveFindHit(t,f,n,i,l);if(p){if(!f.parent)continue;l=!1,p&&(t.target&&(i=!1),s=!0)}}return r&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),n&&n(t,e,!!s))),s},t.prototype.findHit=function(t,e,n,i){this.recursiveFindHit(t,e,n,i,!1)},t}(),zb={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};n_.mixin(zb);var Hb={target:null,data:{global:null}},Vb=function(t){function e(e,n){var i=t.call(this)||this;return n=n||{},i.renderer=e,i.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,i.interactionFrequency=n.interactionFrequency||10,i.mouse=new Nb,i.mouse.identifier=1,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[1]=i.mouse,i.interactionDataPool=[],i.eventData=new Bb,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new Gb,i._tempDisplayObject=new i_,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return function(t,e){function n(){this.constructor=t}Fb(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),Object.defineProperty(e.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),e.prototype.hitTest=function(t,e){return Hb.target=null,Hb.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(Hb,e,null,!0),Hb.target},e.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},e.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(f_.system.add(this.tickerUpdate,this,l_.INTERACTION),this.tickerAdded=!0)},e.prototype.removeTickerListener=function(){this.tickerAdded&&(f_.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},e.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},e.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},e.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},e.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var n=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},e.prototype.setCursorMode=function(t){t=t||"default";var e=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(e=!1),this.currentCursorMode!==t){this.currentCursorMode=t;var n=this.cursorStyles[t];if(n)switch(typeof n){case"string":e&&(this.interactionDOMElement.style.cursor=n);break;case"function":n(t);break;case"object":e&&Object.assign(this.interactionDOMElement.style,n)}else e&&"string"===typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.interactionDOMElement.style.cursor=t)}},e.prototype.dispatchEvent=function(t,e,n){n.stopPropagationHint&&t!==n.stopsPropagatingAt||(n.currentTarget=t,n.type=e,t.emit(e,n),t[e]&&t[e](n))},e.prototype.delayDispatchEvent=function(t,e,n){this.delayedEvents.push({displayObject:t,eventString:e,eventData:n})},e.prototype.mapPositionToPoint=function(t,e,n){var i;i=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var r=1/this.resolution;t.x=(e-i.left)*(this.interactionDOMElement.width/i.width)*r,t.y=(n-i.top)*(this.interactionDOMElement.height/i.height)*r},e.prototype.processInteractive=function(t,e,n,i){var r=this.search.findHit(t,e,n,i),a=this.delayedEvents;if(!a.length)return r;t.stopPropagationHint=!1;var o=a.length;this.delayedEvents=[];for(var s=0;s<o;s++){var l=a[s],u=l.displayObject,h=l.eventString,c=l.eventData;c.stopsPropagatingAt===u&&(c.stopPropagationHint=!0),this.dispatchEvent(u,h,c)}return r},e.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var n=e.length,i=0;i<n;i++){var r=e[i],a=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,a);if(o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",o),"touch"===r.pointerType)this.emit("touchstart",o);else if("mouse"===r.pointerType||"pen"===r.pointerType){var s=2===r.button;this.emit(s?"rightdown":"mousedown",this.eventData)}}}},e.prototype.processPointerDown=function(t,e,n){var i=t.data,r=t.data.identifier;if(n)if(e.trackedPointers[r]||(e.trackedPointers[r]=new Ub(r)),this.dispatchEvent(e,"pointerdown",t),"touch"===i.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===i.pointerType||"pen"===i.pointerType){var a=2===i.button;a?e.trackedPointers[r].rightDown=!0:e.trackedPointers[r].leftDown=!0,this.dispatchEvent(e,a?"rightdown":"mousedown",t)}},e.prototype.onPointerComplete=function(t,e,n){var i=this.normalizeToPointerData(t),r=i.length,a=t.target;t.composedPath&&t.composedPath().length>0&&(a=t.composedPath()[0]);for(var o=a!==this.interactionDOMElement?"outside":"",s=0;s<r;s++){var l=i[s],u=this.getInteractionDataForPointerId(l),h=this.configureInteractionEventForDOMEvent(this.eventData,l,u);if(h.data.originalEvent=t,this.processInteractive(h,this.lastObjectRendered,n,e||!o),this.emit(e?"pointercancel":"pointerup"+o,h),"mouse"===l.pointerType||"pen"===l.pointerType){var c=2===l.button;this.emit(c?"rightup"+o:"mouseup"+o,h)}else"touch"===l.pointerType&&(this.emit(e?"touchcancel":"touchend"+o,h),this.releaseInteractionDataForPointerId(l.pointerId))}},e.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},e.prototype.processPointerCancel=function(t,e){var n=t.data,i=t.data.identifier;void 0!==e.trackedPointers[i]&&(delete e.trackedPointers[i],this.dispatchEvent(e,"pointercancel",t),"touch"===n.pointerType&&this.dispatchEvent(e,"touchcancel",t))},e.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},e.prototype.processPointerUp=function(t,e,n){var i=t.data,r=t.data.identifier,a=e.trackedPointers[r],o="touch"===i.pointerType,s="mouse"===i.pointerType||"pen"===i.pointerType,l=!1;if(s){var u=2===i.button,h=Ub.FLAGS,c=u?h.RIGHT_DOWN:h.LEFT_DOWN,d=void 0!==a&&a.flags&c;n?(this.dispatchEvent(e,u?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,u?"rightclick":"click",t),l=!0)):d&&this.dispatchEvent(e,u?"rightupoutside":"mouseupoutside",t),a&&(u?a.rightDown=!1:a.leftDown=!1)}n?(this.dispatchEvent(e,"pointerup",t),o&&this.dispatchEvent(e,"touchend",t),a&&(s&&!l||this.dispatchEvent(e,"pointertap",t),o&&(this.dispatchEvent(e,"tap",t),a.over=!1))):a&&(this.dispatchEvent(e,"pointerupoutside",t),o&&this.dispatchEvent(e,"touchendoutside",t)),a&&a.none&&delete e.trackedPointers[r]},e.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var n=e.length,i=0;i<n;i++){var r=e[i],a=this.getInteractionDataForPointerId(r),o=this.configureInteractionEventForDOMEvent(this.eventData,r,a);o.data.originalEvent=t,this.processInteractive(o,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",o),"touch"===r.pointerType&&this.emit("touchmove",o),"mouse"!==r.pointerType&&"pen"!==r.pointerType||this.emit("mousemove",o)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},e.prototype.processPointerMove=function(t,e,n){var i=t.data,r="touch"===i.pointerType,a="mouse"===i.pointerType||"pen"===i.pointerType;a&&this.processPointerOverOut(t,e,n),this.moveWhenInside&&!n||(this.dispatchEvent(e,"pointermove",t),r&&this.dispatchEvent(e,"touchmove",t),a&&this.dispatchEvent(e,"mousemove",t))},e.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",i),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",i):this.releaseInteractionDataForPointerId(n.identifier)}},e.prototype.processPointerOverOut=function(t,e,n){var i=t.data,r=t.data.identifier,a="mouse"===i.pointerType||"pen"===i.pointerType,o=e.trackedPointers[r];n&&!o&&(o=e.trackedPointers[r]=new Ub(r)),void 0!==o&&(n&&this.mouseOverRenderer?(o.over||(o.over=!0,this.delayDispatchEvent(e,"pointerover",t),a&&this.delayDispatchEvent(e,"mouseover",t)),a&&null===this.cursor&&(this.cursor=e.cursor)):o.over&&(o.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),a&&this.dispatchEvent(e,"mouseout",t),o.none&&delete e.trackedPointers[r]))},e.prototype.onPointerOver=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0],n=this.getInteractionDataForPointerId(e),i=this.configureInteractionEventForDOMEvent(this.eventData,e,n);i.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",i),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",i)}},e.prototype.getInteractionDataForPointerId=function(t){var e,n=t.pointerId;return 1===n||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[n]?e=this.activeInteractionData[n]:((e=this.interactionDataPool.pop()||new Nb).identifier=n,this.activeInteractionData[n]=e),e.copyEvent(t),e},e.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},e.prototype.configureInteractionEventForDOMEvent=function(t,e,n){return t.data=n,this.mapPositionToPoint(n.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=n.global.x,e.globalY=n.global.y),n.originalEvent=e,t.reset(),t},e.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var n=0,i=t.changedTouches.length;n<i;n++){var r=t.changedTouches[n];"undefined"===typeof r.button&&(r.button=t.touches.length?1:0),"undefined"===typeof r.buttons&&(r.buttons=t.touches.length?1:0),"undefined"===typeof r.isPrimary&&(r.isPrimary=1===t.touches.length&&"touchstart"===t.type),"undefined"===typeof r.width&&(r.width=r.radiusX||1),"undefined"===typeof r.height&&(r.height=r.radiusY||1),"undefined"===typeof r.tiltX&&(r.tiltX=0),"undefined"===typeof r.tiltY&&(r.tiltY=0),"undefined"===typeof r.pointerType&&(r.pointerType="touch"),"undefined"===typeof r.pointerId&&(r.pointerId=r.identifier||0),"undefined"===typeof r.pressure&&(r.pressure=r.force||.5),"undefined"===typeof r.twist&&(r.twist=0),"undefined"===typeof r.tangentialPressure&&(r.tangentialPressure=0),"undefined"===typeof r.layerX&&(r.layerX=r.offsetX=r.clientX),"undefined"===typeof r.layerY&&(r.layerY=r.offsetY=r.clientY),r.isNormalized=!0,e.push(r)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{var a=t;"undefined"===typeof a.isPrimary&&(a.isPrimary=!0),"undefined"===typeof a.width&&(a.width=1),"undefined"===typeof a.height&&(a.height=1),"undefined"===typeof a.tiltX&&(a.tiltX=0),"undefined"===typeof a.tiltY&&(a.tiltY=0),"undefined"===typeof a.pointerType&&(a.pointerType="mouse"),"undefined"===typeof a.pointerId&&(a.pointerId=1),"undefined"===typeof a.pressure&&(a.pressure=.5),"undefined"===typeof a.twist&&(a.twist=0),"undefined"===typeof a.tangentialPressure&&(a.tangentialPressure=0),a.isNormalized=!0,e.push(a)}return e},e.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},e.extension={name:"interaction",type:[o_.RendererPlugin,o_.CanvasRendererPlugin]},e}(ey),jb=new Fy,Xb=function(){function t(t){this.renderer=t}return t.prototype.image=function(t,e,n){var i=new Image;return i.src=this.base64(t,e,n),i},t.prototype.base64=function(t,e,n){return this.canvas(t).toDataURL(e,n)},t.prototype.canvas=function(e,n){var i=this._rawPixels(e,n),r=i.pixels,a=i.width,o=i.height,s=i.flipY,l=new Py(a,o,1),u=l.context.getImageData(0,0,a,o);if(t.arrayPostDivide(r,u.data),l.context.putImageData(u,0,0),s){var h=new Py(l.width,l.height,1);h.context.scale(1,-1),h.context.drawImage(l.canvas,0,-o),l.destroy(),l=h}return l.canvas},t.prototype.pixels=function(e,n){var i=this._rawPixels(e,n).pixels;return t.arrayPostDivide(i,i),i},t.prototype._rawPixels=function(t,e){var n,i,r=this.renderer,a=!1,o=!1;if(t)if(t instanceof z_)i=t;else{var s=r.context.webGLVersion>=2?r.multisample:kg.NONE;if(i=this.renderer.generateTexture(t,{multisample:s}),s!==kg.NONE){var l=z_.create({width:i.width,height:i.height});r.framebuffer.bind(i.framebuffer),r.framebuffer.blit(l.framebuffer),r.framebuffer.bind(null),i.destroy(!0),i=l}o=!0}i?(n=i.baseTexture.resolution,e=null!==e&&void 0!==e?e:i.frame,a=!1,r.renderTexture.bind(i)):(n=r.resolution,e||((e=jb).width=r.width,e.height=r.height),a=!0,r.renderTexture.bind(null));var u=Math.round(e.width*n),h=Math.round(e.height*n),c=new Uint8Array(4*u*h),d=r.gl;return d.readPixels(Math.round(e.x*n),Math.round(e.y*n),u,h,d.RGBA,d.UNSIGNED_BYTE,c),o&&i.destroy(!0),{pixels:c,width:u,height:h,flipY:a}},t.prototype.destroy=function(){this.renderer=null},t.arrayPostDivide=function(t,e){for(var n=0;n<t.length;n+=4){var i=e[n+3]=t[n+3];0!==i?(e[n]=Math.round(Math.min(255*t[n]/i,255)),e[n+1]=Math.round(Math.min(255*t[n+1]/i,255)),e[n+2]=Math.round(Math.min(255*t[n+2]/i,255))):(e[n]=t[n],e[n+1]=t[n+1],e[n+2]=t[n+2])}},t.extension={name:"extract",type:o_.RendererPlugin},t}(),Wb=function(){function t(t,e,n){void 0===e&&(e=!1),this._fn=t,this._once=e,this._thisArg=n,this._next=this._prev=this._owner=null}return t.prototype.detach=function(){return null!==this._owner&&(this._owner.detach(this),!0)},t}();function qb(t,e){return t._head?(t._tail._next=e,e._prev=t._tail,t._tail=e):(t._head=e,t._tail=e),e._owner=t,e}var Yb,Kb=function(){function t(){this._head=this._tail=void 0}return t.prototype.handlers=function(t){void 0===t&&(t=!1);var e=this._head;if(t)return!!e;for(var n=[];e;)n.push(e),e=e._next;return n},t.prototype.has=function(t){if(!(t instanceof Wb))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},t.prototype.dispatch=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0},t.prototype.add=function(t,e){if(void 0===e&&(e=null),"function"!==typeof t)throw new Error("MiniSignal#add(): First arg must be a Function.");return qb(this,new Wb(t,!1,e))},t.prototype.once=function(t,e){if(void 0===e&&(e=null),"function"!==typeof t)throw new Error("MiniSignal#once(): First arg must be a Function.");return qb(this,new Wb(t,!0,e))},t.prototype.detach=function(t){if(!(t instanceof Wb))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this||(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,null===t._next&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null),this},t.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},t}();function Zb(t,e){e=e||{};for(var n={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},i=n.parser[e.strictMode?"strict":"loose"].exec(t),r={},a=14;a--;)r[n.key[a]]=i[a]||"";return r[n.q.name]={},r[n.key[12]].replace(n.q.parser,(function(t,e,i){e&&(r[n.q.name][e]=i)})),r}var Jb=null;function Qb(){}function $b(t,e,n){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=n)}function tw(t){return t.toString().replace("object ","")}var ew=function(){function t(e,n,i){if(this._dequeue=Qb,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,"string"!==typeof e||"string"!==typeof n)throw new Error("Both name and url are required for constructing a resource.");i=i||{},this._flags=0,this._setFlag(t.STATUS_FLAGS.DATA_URL,0===n.indexOf("data:")),this.name=e,this.url=n,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===i.crossOrigin?"anonymous":i.crossOrigin,this.timeout=i.timeout||0,this.loadType=i.loadType||this._determineLoadType(),this.xhrType=i.xhrType,this.metadata=i.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=t.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Qb,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Kb,this.onProgress=new Kb,this.onComplete=new Kb,this.onAfterMiddleware=new Kb}return t.setExtensionLoadType=function(e,n){$b(t._loadTypeMap,e,n)},t.setExtensionXhrType=function(e,n){$b(t._xhrTypeMap,e,n)},Object.defineProperty(t.prototype,"isDataUrl",{get:function(){return this._hasFlag(t.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isComplete",{get:function(){return this._hasFlag(t.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return this._hasFlag(t.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),t.prototype.complete=function(){this._clearEvents(),this._finish()},t.prototype.abort=function(e){if(!this.error){if(this.error=new Error(e),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=t.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},t.prototype.load=function(e){var n=this;if(!this.isLoading)if(this.isComplete)e&&setTimeout((function(){return e(n)}),1);else switch(e&&this.onComplete.once(e),this._setFlag(t.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"===typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case t.LOAD_TYPE.IMAGE:this.type=t.TYPE.IMAGE,this._loadElement("image");break;case t.LOAD_TYPE.AUDIO:this.type=t.TYPE.AUDIO,this._loadSourceElement("audio");break;case t.LOAD_TYPE.VIDEO:this.type=t.TYPE.VIDEO,this._loadSourceElement("video");break;case t.LOAD_TYPE.XHR:default:"undefined"===typeof Yb&&(Yb=!(!globalThis.XDomainRequest||"withCredentials"in new XMLHttpRequest)),Yb&&this.crossOrigin?this._loadXdr():this._loadXhr()}},t.prototype._hasFlag=function(t){return 0!==(this._flags&t)},t.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},t.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},t.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(t.STATUS_FLAGS.COMPLETE,!0),this._setFlag(t.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},t.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&"undefined"!==typeof globalThis.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},t.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&"undefined"!==typeof globalThis.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,n=0;n<this.url.length;++n)this.data.appendChild(this._createSource(t,this.url[n],Array.isArray(e)?e[n]:e));else{e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},t.prototype._loadXhr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var e=this.xhr=new XMLHttpRequest;"use-credentials"===this.crossOrigin&&(e.withCredentials=!0),e.open("GET",this.url,!0),e.timeout=this.timeout,this.xhrType===t.XHR_RESPONSE_TYPE.JSON||this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT?e.responseType=t.XHR_RESPONSE_TYPE.TEXT:e.responseType=this.xhrType,e.addEventListener("error",this._boundXhrOnError,!1),e.addEventListener("timeout",this._boundXhrOnTimeout,!1),e.addEventListener("abort",this._boundXhrOnAbort,!1),e.addEventListener("progress",this._boundOnProgress,!1),e.addEventListener("load",this._boundXhrOnLoad,!1),e.send()},t.prototype._loadXdr=function(){"string"!==typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout((function(){return t.send()}),1)},t.prototype._createSource=function(t,e,n){n||(n=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=n,i},t.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},t.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},t.prototype._onTimeout=function(){this.abort("Load timed out.")},t.prototype._xhrOnError=function(){var t=this.xhr;this.abort(tw(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},t.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(tw(t)+" Request timed out.")},t.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(tw(t)+" Request was aborted by the user.")},t.prototype._xhrOnLoad=function(){var e=this.xhr,n="",i="undefined"===typeof e.status?200:e.status;if(""!==e.responseType&&"text"!==e.responseType&&"undefined"!==typeof e.responseType||(n=e.responseText),0===i&&(n.length>0||e.responseType===t.XHR_RESPONSE_TYPE.BUFFER)?i=200:1223===i&&(i=204),2===(i/100|0)){if(this.xhrType===t.XHR_RESPONSE_TYPE.TEXT)this.data=n,this.type=t.TYPE.TEXT;else if(this.xhrType===t.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(n),this.type=t.TYPE.JSON}catch(o){return void this.abort("Error trying to parse loaded json: "+o)}else if(this.xhrType===t.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var r=new DOMParser;this.data=r.parseFromString(n,"text/xml")}else{var a=document.createElement("div");a.innerHTML=n,this.data=a}this.type=t.TYPE.XML}catch(s){return void this.abort("Error trying to parse loaded xml: "+s)}else this.data=e.response||n;this.complete()}else this.abort("["+e.status+"] "+e.statusText+": "+e.responseURL)},t.prototype._determineCrossOrigin=function(t,e){if(0===t.indexOf("data:"))return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,Jb||(Jb=document.createElement("a")),Jb.href=t;var n=Zb(Jb.href,{strictMode:!0}),i=!n.port&&""===e.port||n.port===e.port,r=n.protocol?n.protocol+":":"";return n.host===e.hostname&&i&&r===e.protocol?"":"anonymous"},t.prototype._determineXhrType=function(){return t._xhrTypeMap[this.extension]||t.XHR_RESPONSE_TYPE.TEXT},t.prototype._determineLoadType=function(){return t._loadTypeMap[this.extension]||t.LOAD_TYPE.XHR},t.prototype._getExtension=function(t){void 0===t&&(t=this.url);var e="";if(this.isDataUrl){var n=t.indexOf("/");e=t.substring(n+1,t.indexOf(";",n))}else{var i=t.indexOf("?"),r=t.indexOf("#"),a=Math.min(i>-1?i:t.length,r>-1?r:t.length);e=(t=t.substring(0,a)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},t.prototype._getMimeFromXhrType=function(e){switch(e){case t.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case t.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case t.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case t.XHR_RESPONSE_TYPE.JSON:return"application/json";case t.XHR_RESPONSE_TYPE.DEFAULT:case t.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},t}();function nw(){}function iw(t){return function(){for(var e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];if(null===t)throw new Error("Callback was already called.");var r=t;t=null,r.apply(this,n)}}!function(t){var e,n,i,r;(e=t.STATUS_FLAGS||(t.STATUS_FLAGS={}))[e.NONE=0]="NONE",e[e.DATA_URL=1]="DATA_URL",e[e.COMPLETE=2]="COMPLETE",e[e.LOADING=4]="LOADING",(n=t.TYPE||(t.TYPE={}))[n.UNKNOWN=0]="UNKNOWN",n[n.JSON=1]="JSON",n[n.XML=2]="XML",n[n.IMAGE=3]="IMAGE",n[n.AUDIO=4]="AUDIO",n[n.VIDEO=5]="VIDEO",n[n.TEXT=6]="TEXT",(i=t.LOAD_TYPE||(t.LOAD_TYPE={}))[i.XHR=1]="XHR",i[i.IMAGE=2]="IMAGE",i[i.AUDIO=3]="AUDIO",i[i.VIDEO=4]="VIDEO",(r=t.XHR_RESPONSE_TYPE||(t.XHR_RESPONSE_TYPE={})).DEFAULT="text",r.BUFFER="arraybuffer",r.BLOB="blob",r.DOCUMENT="document",r.JSON="json",r.TEXT="text",t._loadTypeMap={gif:t.LOAD_TYPE.IMAGE,png:t.LOAD_TYPE.IMAGE,bmp:t.LOAD_TYPE.IMAGE,jpg:t.LOAD_TYPE.IMAGE,jpeg:t.LOAD_TYPE.IMAGE,tif:t.LOAD_TYPE.IMAGE,tiff:t.LOAD_TYPE.IMAGE,webp:t.LOAD_TYPE.IMAGE,tga:t.LOAD_TYPE.IMAGE,avif:t.LOAD_TYPE.IMAGE,svg:t.LOAD_TYPE.IMAGE,"svg+xml":t.LOAD_TYPE.IMAGE,mp3:t.LOAD_TYPE.AUDIO,ogg:t.LOAD_TYPE.AUDIO,wav:t.LOAD_TYPE.AUDIO,mp4:t.LOAD_TYPE.VIDEO,webm:t.LOAD_TYPE.VIDEO},t._xhrTypeMap={xhtml:t.XHR_RESPONSE_TYPE.DOCUMENT,html:t.XHR_RESPONSE_TYPE.DOCUMENT,htm:t.XHR_RESPONSE_TYPE.DOCUMENT,xml:t.XHR_RESPONSE_TYPE.DOCUMENT,tmx:t.XHR_RESPONSE_TYPE.DOCUMENT,svg:t.XHR_RESPONSE_TYPE.DOCUMENT,tsx:t.XHR_RESPONSE_TYPE.DOCUMENT,gif:t.XHR_RESPONSE_TYPE.BLOB,png:t.XHR_RESPONSE_TYPE.BLOB,bmp:t.XHR_RESPONSE_TYPE.BLOB,jpg:t.XHR_RESPONSE_TYPE.BLOB,jpeg:t.XHR_RESPONSE_TYPE.BLOB,tif:t.XHR_RESPONSE_TYPE.BLOB,tiff:t.XHR_RESPONSE_TYPE.BLOB,webp:t.XHR_RESPONSE_TYPE.BLOB,tga:t.XHR_RESPONSE_TYPE.BLOB,avif:t.XHR_RESPONSE_TYPE.BLOB,json:t.XHR_RESPONSE_TYPE.JSON,text:t.XHR_RESPONSE_TYPE.TEXT,txt:t.XHR_RESPONSE_TYPE.TEXT,ttf:t.XHR_RESPONSE_TYPE.BUFFER,otf:t.XHR_RESPONSE_TYPE.BUFFER},t.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="}(ew||(ew={}));var rw=function(t,e){this.data=t,this.callback=e},aw=function(){function t(t,e){var n=this;if(void 0===e&&(e=1),this.workers=0,this.saturated=nw,this.unsaturated=nw,this.empty=nw,this.drain=nw,this.error=nw,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(t,e,i){if(i&&"function"!==typeof i)throw new Error("task callback must be a function");if(n.started=!0,null==t&&n.idle())setTimeout((function(){return n.drain()}),1);else{var r=new rw(t,"function"===typeof i?i:nw);e?n._tasks.unshift(r):n._tasks.push(r),setTimeout(n.process,1)}},this.process=function(){for(;!n.paused&&n.workers<n.concurrency&&n._tasks.length;){var t=n._tasks.shift();0===n._tasks.length&&n.empty(),n.workers+=1,n.workers===n.concurrency&&n.saturated(),n._worker(t.data,iw(n._next(t)))}},this._worker=t,0===e)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return t.prototype._next=function(t){var e=this;return function(){for(var n=arguments,i=[],r=0;r<arguments.length;r++)i[r]=n[r];e.workers-=1,t.callback.apply(t,i),null!=i[0]&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},t.prototype.push=function(t,e){this._insert(t,!1,e)},t.prototype.kill=function(){this.workers=0,this.drain=nw,this.started=!1,this._tasks=[]},t.prototype.unshift=function(t,e){this._insert(t,!0,e)},t.prototype.length=function(){return this._tasks.length},t.prototype.running=function(){return this.workers},t.prototype.idle=function(){return this._tasks.length+this.workers===0},t.prototype.pause=function(){!0!==this.paused&&(this.paused=!0)},t.prototype.resume=function(){if(!1!==this.paused){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},t.eachSeries=function(t,e,n,i){var r=0,a=t.length;!function o(s){s||r===a?n&&n(s):i?setTimeout((function(){e(t[r++],o)}),1):e(t[r++],o)}()},t.queue=function(e,n){return new t(e,n)},t}(),ow=/(#[\w-]+)?$/,sw=function(){function t(e,n){var i=this;void 0===e&&(e=""),void 0===n&&(n=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this.resources={},this.baseUrl=e,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return i._loadResource(t,e)},this._queue=aw.queue(this._boundLoadResource,n),this._queue.pause(),this.resources={},this.onProgress=new Kb,this.onError=new Kb,this.onLoad=new Kb,this.onStart=new Kb,this.onComplete=new Kb;for(var r=0;r<t._plugins.length;++r){var a=t._plugins[r],o=a.pre,s=a.use;o&&this.pre(o),s&&this.use(s)}this._protected=!1}return t.prototype._add=function(t,e,n,i){if(this.loading&&(!n||!n.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new ew(t,e,n),"function"===typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var r=n.parentResource,a=[],o=0;o<r.children.length;++o)r.children[o].isComplete||a.push(r.children[o]);var s=r.progressChunk*(a.length+1)/(a.length+2);r.children.push(this.resources[t]),r.progressChunk=s;for(o=0;o<a.length;++o)a[o].progressChunk=s;this.resources[t].progressChunk=s}return this._queue.push(this.resources[t]),this},t.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},t.prototype.use=function(t){return this._afterMiddleware.push(t),this},t.prototype.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},t.prototype.load=function(t){if(Ty("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),"function"===typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=100/this._queue._tasks.length,n=0;n<this._queue._tasks.length;++n)this._queue._tasks[n].data.progressChunk=e;this._onStart(),this._queue.resume()}return this},Object.defineProperty(t.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),t.prototype._prepareUrl=function(t){var e,n=Zb(t,{strictMode:!0});if(e=n.protocol||!n.path||0===t.indexOf("//")?t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==t.charAt(0)?this.baseUrl+"/"+t:this.baseUrl+t,this.defaultQueryString){var i=ow.exec(e)[0];-1!==(e=e.slice(0,e.length-i.length)).indexOf("?")?e+="&"+this.defaultQueryString:e+="?"+this.defaultQueryString,e+=i}return e},t.prototype._loadResource=function(t,e){var n=this;t._dequeue=e,aw.eachSeries(this._beforeMiddleware,(function(e,i){e.call(n,t,(function(){i(t.isComplete?{}:null)}))}),(function(){t.isComplete?n._onLoad(t):(t._onLoadBinding=t.onComplete.once(n._onLoad,n),t.load())}),!0)},t.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},t.prototype._onComplete=function(){this.progress=100,this.loading=!1,this.onComplete.dispatch(this,this.resources)},t.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),aw.eachSeries(this._afterMiddleware,(function(n,i){n.call(e,t,i)}),(function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(100,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()}),!0)},t.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(t,"shared",{get:function(){var e=t._shared;return e||((e=new t)._protected=!0,t._shared=e),e},enumerable:!1,configurable:!0}),t.registerPlugin=function(e){return Ty("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),h_.add({type:o_.Loader,ref:e}),t},t._plugins=[],t}();h_.handleByList(o_.Loader,sw._plugins),sw.prototype.add=function(t,e,n,i){if(Array.isArray(t)){for(var r=0;r<t.length;++r)this.add(t[r]);return this}if("object"===typeof t&&(n=t,i=e||n.callback||n.onComplete,e=n.url,t=n.name||n.key||n.url),"string"!==typeof e&&(i=n,n=e,e=t),"string"!==typeof e)throw new Error("No url passed to add resource to loader.");return"function"===typeof n&&(i=n,n=null),this._add(t,e,n,i)};var lw=function(){function t(){}return t.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?sw.shared:new sw},t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.extension=o_.Application,t}(),uw=function(){function t(){}return t.add=function(){ew.setExtensionLoadType("svg",ew.LOAD_TYPE.XHR),ew.setExtensionXhrType("svg",ew.XHR_RESPONSE_TYPE.TEXT)},t.use=function(t,e){if(!t.data||t.type!==ew.TYPE.IMAGE&&"svg"!==t.extension)e();else{var n=t.data,i=t.url,r=t.name,a=t.metadata;G_.fromLoader(n,i,r,a).then((function(n){t.texture=n,e()})).catch(e)}},t.extension=o_.Loader,t}();function hw(t,e){if(t.data){if(t.xhr&&t.xhrType===ew.XHR_RESPONSE_TYPE.BLOB)if(self.Blob&&"string"!==typeof t.data){if(0===t.data.type.indexOf("image")){var n=globalThis.URL||globalThis.webkitURL,i=n.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=i,t.type=ew.TYPE.IMAGE,void(t.data.onload=function(){n.revokeObjectURL(i),t.data.onload=null,e()})}}else{var r=t.xhr.getResponseHeader("content-type");if(r&&0===r.indexOf("image"))return t.data=new Image,t.data.src="data:"+r+";base64,"+function(t){for(var e="",n=0;n<t.length;){for(var i=[0,0,0],r=[0,0,0,0],a=0;a<i.length;++a)n<t.length?i[a]=255&t.charCodeAt(n++):i[a]=0;switch(r[0]=i[0]>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|i[2]>>6,r[3]=63&i[2],n-(t.length-1)){case 2:r[3]=64,r[2]=64;break;case 1:r[3]=64}for(a=0;a<r.length;++a)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(r[a])}return e}(t.xhr.responseText),t.type=ew.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}var cw,dw,fw=function(){function t(){}return t.extension=o_.Loader,t.use=hw,t}();h_.add(uw,fw),function(t){t[t.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",t[t.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",t[t.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",t[t.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",t[t.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",t[t.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",t[t.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",t[t.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",t[t.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",t[t.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",t[t.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",t[t.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",t[t.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",t[t.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",t[t.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",t[t.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",t[t.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",t[t.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",t[t.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR"}(dw||(dw={}));var pw=((cw={})[dw.COMPRESSED_RGB_S3TC_DXT1_EXT]=.5,cw[dw.COMPRESSED_RGBA_S3TC_DXT1_EXT]=.5,cw[dw.COMPRESSED_RGBA_S3TC_DXT3_EXT]=1,cw[dw.COMPRESSED_RGBA_S3TC_DXT5_EXT]=1,cw[dw.COMPRESSED_SRGB_S3TC_DXT1_EXT]=.5,cw[dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT]=.5,cw[dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT]=1,cw[dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT]=1,cw[dw.COMPRESSED_R11_EAC]=.5,cw[dw.COMPRESSED_SIGNED_R11_EAC]=.5,cw[dw.COMPRESSED_RG11_EAC]=1,cw[dw.COMPRESSED_SIGNED_RG11_EAC]=1,cw[dw.COMPRESSED_RGB8_ETC2]=.5,cw[dw.COMPRESSED_RGBA8_ETC2_EAC]=1,cw[dw.COMPRESSED_SRGB8_ETC2]=.5,cw[dw.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC]=1,cw[dw.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,cw[dw.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2]=.5,cw[dw.COMPRESSED_RGB_PVRTC_4BPPV1_IMG]=.5,cw[dw.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG]=.5,cw[dw.COMPRESSED_RGB_PVRTC_2BPPV1_IMG]=.25,cw[dw.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG]=.25,cw[dw.COMPRESSED_RGB_ETC1_WEBGL]=.5,cw[dw.COMPRESSED_RGB_ATC_WEBGL]=.5,cw[dw.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL]=1,cw[dw.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL]=1,cw[dw.COMPRESSED_RGBA_ASTC_4x4_KHR]=1,cw),vw=function(t,e){return vw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},vw(t,e)};function mw(t,e){function n(){this.constructor=t}vw(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function gw(t,e,n,i){return new(n||(n=Promise))((function(r,a){function o(t){try{l(i.next(t))}catch(e){a(e)}}function s(t){try{l(i.throw(t))}catch(e){a(e)}}function l(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,s)}l((i=i.apply(t,e||[])).next())}))}function yw(t,e){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=(r=o.trys).length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=e.call(t,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var _w,xw,bw=function(t){function e(e,n){void 0===n&&(n={width:1,height:1,autoLoad:!0});var i,r,a=this;return"string"===typeof e?(i=e,r=new Uint8Array):(i=null,r=e),(a=t.call(this,r,n)||this).origin=i,a.buffer=r?new wb(r):null,a.origin&&!1!==n.autoLoad&&a.load(),r&&r.length&&(a.loaded=!0,a.onBlobLoaded(a.buffer.rawBinaryData)),a}return mw(e,t),e.prototype.onBlobLoaded=function(t){},e.prototype.load=function(){return gw(this,void 0,Promise,(function(){var t;return yw(this,(function(e){switch(e.label){case 0:return[4,fetch(this.origin)];case 1:return[4,e.sent().blob()];case 2:return[4,e.sent().arrayBuffer()];case 3:return t=e.sent(),this.data=new Uint32Array(t),this.buffer=new wb(t),this.loaded=!0,this.onBlobLoaded(t),this.update(),[2,this]}}))}))},e}(b_),ww=function(t){function e(n,i){var r=t.call(this,n,i)||this;return r.format=i.format,r.levels=i.levels||1,r._width=i.width,r._height=i.height,r._extension=e._formatToExtension(r.format),(i.levelBuffers||r.buffer)&&(r._levelBuffers=i.levelBuffers||e._createLevelBuffers(n instanceof Uint8Array?n:r.buffer.uint8View,r.format,r.levels,4,4,r.width,r.height)),r}return mw(e,t),e.prototype.upload=function(t,e,n){var i=t.gl;if(!t.context.extensions[this._extension])throw new Error(this._extension+" textures are not supported on the current machine");if(!this._levelBuffers)return!1;for(var r=0,a=this.levels;r<a;r++){var o=this._levelBuffers[r],s=o.levelID,l=o.levelWidth,u=o.levelHeight,h=o.levelBuffer;i.compressedTexImage2D(i.TEXTURE_2D,s,this.format,l,u,0,h)}return!0},e.prototype.onBlobLoaded=function(){this._levelBuffers=e._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)},e._formatToExtension=function(t){if(t>=33776&&t<=33779)return"s3tc";if(t>=37488&&t<=37497)return"etc";if(t>=35840&&t<=35843)return"pvrtc";if(t>=36196)return"etc1";if(t>=35986&&t<=34798)return"atc";throw new Error("Invalid (compressed) texture format given!")},e._createLevelBuffers=function(t,e,n,i,r,a,o){for(var s=new Array(n),l=t.byteOffset,u=a,h=o,c=u+i-1&~(i-1),d=h+r-1&~(r-1),f=c*d*pw[e],p=0;p<n;p++)s[p]={levelID:p,levelWidth:n>1?u:c,levelHeight:n>1?h:d,levelBuffer:new Uint8Array(t.buffer,l,f)},l+=f,f=(c=(u=u>>1||1)+i-1&~(i-1))*(d=(h=h>>1||1)+r-1&~(r-1))*pw[e];return s},e}(bw),Sw=function(){function t(){}return t.use=function(e,n){var i=e.data;if(e.type===ew.TYPE.JSON&&i&&i.cacheID&&i.textures){for(var r=i.textures,a=void 0,o=void 0,s=0,l=r.length;s<l;s++){var u=r[s],h=u.src,c=u.format;if(c||(o=h),t.textureFormats[c]){a=h;break}}if(!(a=a||o))return void n(new Error("Cannot load compressed-textures in "+e.url+", make sure you provide a fallback"));if(a===e.url)return void n(new Error("URL of compressed texture cannot be the same as the manifest's URL"));var d={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},f=ry.resolve(e.url.replace(this.baseUrl,""),a),p=i.cacheID;this.add(p,f,d,(function(t){if(t.error)n(t.error);else{var i=t.texture,r=void 0===i?null:i,a=t.textures,o=void 0===a?{}:a;Object.assign(e,{texture:r,textures:o}),n()}}))}else n()},Object.defineProperty(t,"textureExtensions",{get:function(){if(!t._textureExtensions){var e=ty.ADAPTER.createCanvas().getContext("webgl");if(!e)return console.warn("WebGL not available for compressed textures. Silently failing."),{};var n={s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};t._textureExtensions=n}return t._textureExtensions},enumerable:!1,configurable:!0}),Object.defineProperty(t,"textureFormats",{get:function(){if(!t._textureFormats){var e=t.textureExtensions;for(var n in t._textureFormats={},e){var i=e[n];i&&Object.assign(t._textureFormats,Object.getPrototypeOf(i))}}return t._textureFormats},enumerable:!1,configurable:!0}),t.extension=o_.Loader,t}();function Tw(t,e,n){var i={textures:{},texture:null};return e?(e.map((function(t){return new G_(new S_(t,Object.assign({mipmap:Sg.OFF,alphaMode:Tg.NO_PREMULTIPLIED_ALPHA},n)))})).forEach((function(e,n){var r=e.baseTexture,a=t+"-"+(n+1);S_.addToCache(r,a),G_.addToCache(e,a),0===n&&(S_.addToCache(r,t),G_.addToCache(e,t),i.texture=e),i.textures[a]=e})),i):i}var Mw,Ew,Aw=124,Pw=3,Cw=4,kw=7,Rw=19,Iw=2,Dw=0,Ow=1,Lw=2,Nw=3;!function(t){t[t.DXGI_FORMAT_UNKNOWN=0]="DXGI_FORMAT_UNKNOWN",t[t.DXGI_FORMAT_R32G32B32A32_TYPELESS=1]="DXGI_FORMAT_R32G32B32A32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32A32_FLOAT=2]="DXGI_FORMAT_R32G32B32A32_FLOAT",t[t.DXGI_FORMAT_R32G32B32A32_UINT=3]="DXGI_FORMAT_R32G32B32A32_UINT",t[t.DXGI_FORMAT_R32G32B32A32_SINT=4]="DXGI_FORMAT_R32G32B32A32_SINT",t[t.DXGI_FORMAT_R32G32B32_TYPELESS=5]="DXGI_FORMAT_R32G32B32_TYPELESS",t[t.DXGI_FORMAT_R32G32B32_FLOAT=6]="DXGI_FORMAT_R32G32B32_FLOAT",t[t.DXGI_FORMAT_R32G32B32_UINT=7]="DXGI_FORMAT_R32G32B32_UINT",t[t.DXGI_FORMAT_R32G32B32_SINT=8]="DXGI_FORMAT_R32G32B32_SINT",t[t.DXGI_FORMAT_R16G16B16A16_TYPELESS=9]="DXGI_FORMAT_R16G16B16A16_TYPELESS",t[t.DXGI_FORMAT_R16G16B16A16_FLOAT=10]="DXGI_FORMAT_R16G16B16A16_FLOAT",t[t.DXGI_FORMAT_R16G16B16A16_UNORM=11]="DXGI_FORMAT_R16G16B16A16_UNORM",t[t.DXGI_FORMAT_R16G16B16A16_UINT=12]="DXGI_FORMAT_R16G16B16A16_UINT",t[t.DXGI_FORMAT_R16G16B16A16_SNORM=13]="DXGI_FORMAT_R16G16B16A16_SNORM",t[t.DXGI_FORMAT_R16G16B16A16_SINT=14]="DXGI_FORMAT_R16G16B16A16_SINT",t[t.DXGI_FORMAT_R32G32_TYPELESS=15]="DXGI_FORMAT_R32G32_TYPELESS",t[t.DXGI_FORMAT_R32G32_FLOAT=16]="DXGI_FORMAT_R32G32_FLOAT",t[t.DXGI_FORMAT_R32G32_UINT=17]="DXGI_FORMAT_R32G32_UINT",t[t.DXGI_FORMAT_R32G32_SINT=18]="DXGI_FORMAT_R32G32_SINT",t[t.DXGI_FORMAT_R32G8X24_TYPELESS=19]="DXGI_FORMAT_R32G8X24_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT_S8X24_UINT=20]="DXGI_FORMAT_D32_FLOAT_S8X24_UINT",t[t.DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS=21]="DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS",t[t.DXGI_FORMAT_X32_TYPELESS_G8X24_UINT=22]="DXGI_FORMAT_X32_TYPELESS_G8X24_UINT",t[t.DXGI_FORMAT_R10G10B10A2_TYPELESS=23]="DXGI_FORMAT_R10G10B10A2_TYPELESS",t[t.DXGI_FORMAT_R10G10B10A2_UNORM=24]="DXGI_FORMAT_R10G10B10A2_UNORM",t[t.DXGI_FORMAT_R10G10B10A2_UINT=25]="DXGI_FORMAT_R10G10B10A2_UINT",t[t.DXGI_FORMAT_R11G11B10_FLOAT=26]="DXGI_FORMAT_R11G11B10_FLOAT",t[t.DXGI_FORMAT_R8G8B8A8_TYPELESS=27]="DXGI_FORMAT_R8G8B8A8_TYPELESS",t[t.DXGI_FORMAT_R8G8B8A8_UNORM=28]="DXGI_FORMAT_R8G8B8A8_UNORM",t[t.DXGI_FORMAT_R8G8B8A8_UNORM_SRGB=29]="DXGI_FORMAT_R8G8B8A8_UNORM_SRGB",t[t.DXGI_FORMAT_R8G8B8A8_UINT=30]="DXGI_FORMAT_R8G8B8A8_UINT",t[t.DXGI_FORMAT_R8G8B8A8_SNORM=31]="DXGI_FORMAT_R8G8B8A8_SNORM",t[t.DXGI_FORMAT_R8G8B8A8_SINT=32]="DXGI_FORMAT_R8G8B8A8_SINT",t[t.DXGI_FORMAT_R16G16_TYPELESS=33]="DXGI_FORMAT_R16G16_TYPELESS",t[t.DXGI_FORMAT_R16G16_FLOAT=34]="DXGI_FORMAT_R16G16_FLOAT",t[t.DXGI_FORMAT_R16G16_UNORM=35]="DXGI_FORMAT_R16G16_UNORM",t[t.DXGI_FORMAT_R16G16_UINT=36]="DXGI_FORMAT_R16G16_UINT",t[t.DXGI_FORMAT_R16G16_SNORM=37]="DXGI_FORMAT_R16G16_SNORM",t[t.DXGI_FORMAT_R16G16_SINT=38]="DXGI_FORMAT_R16G16_SINT",t[t.DXGI_FORMAT_R32_TYPELESS=39]="DXGI_FORMAT_R32_TYPELESS",t[t.DXGI_FORMAT_D32_FLOAT=40]="DXGI_FORMAT_D32_FLOAT",t[t.DXGI_FORMAT_R32_FLOAT=41]="DXGI_FORMAT_R32_FLOAT",t[t.DXGI_FORMAT_R32_UINT=42]="DXGI_FORMAT_R32_UINT",t[t.DXGI_FORMAT_R32_SINT=43]="DXGI_FORMAT_R32_SINT",t[t.DXGI_FORMAT_R24G8_TYPELESS=44]="DXGI_FORMAT_R24G8_TYPELESS",t[t.DXGI_FORMAT_D24_UNORM_S8_UINT=45]="DXGI_FORMAT_D24_UNORM_S8_UINT",t[t.DXGI_FORMAT_R24_UNORM_X8_TYPELESS=46]="DXGI_FORMAT_R24_UNORM_X8_TYPELESS",t[t.DXGI_FORMAT_X24_TYPELESS_G8_UINT=47]="DXGI_FORMAT_X24_TYPELESS_G8_UINT",t[t.DXGI_FORMAT_R8G8_TYPELESS=48]="DXGI_FORMAT_R8G8_TYPELESS",t[t.DXGI_FORMAT_R8G8_UNORM=49]="DXGI_FORMAT_R8G8_UNORM",t[t.DXGI_FORMAT_R8G8_UINT=50]="DXGI_FORMAT_R8G8_UINT",t[t.DXGI_FORMAT_R8G8_SNORM=51]="DXGI_FORMAT_R8G8_SNORM",t[t.DXGI_FORMAT_R8G8_SINT=52]="DXGI_FORMAT_R8G8_SINT",t[t.DXGI_FORMAT_R16_TYPELESS=53]="DXGI_FORMAT_R16_TYPELESS",t[t.DXGI_FORMAT_R16_FLOAT=54]="DXGI_FORMAT_R16_FLOAT",t[t.DXGI_FORMAT_D16_UNORM=55]="DXGI_FORMAT_D16_UNORM",t[t.DXGI_FORMAT_R16_UNORM=56]="DXGI_FORMAT_R16_UNORM",t[t.DXGI_FORMAT_R16_UINT=57]="DXGI_FORMAT_R16_UINT",t[t.DXGI_FORMAT_R16_SNORM=58]="DXGI_FORMAT_R16_SNORM",t[t.DXGI_FORMAT_R16_SINT=59]="DXGI_FORMAT_R16_SINT",t[t.DXGI_FORMAT_R8_TYPELESS=60]="DXGI_FORMAT_R8_TYPELESS",t[t.DXGI_FORMAT_R8_UNORM=61]="DXGI_FORMAT_R8_UNORM",t[t.DXGI_FORMAT_R8_UINT=62]="DXGI_FORMAT_R8_UINT",t[t.DXGI_FORMAT_R8_SNORM=63]="DXGI_FORMAT_R8_SNORM",t[t.DXGI_FORMAT_R8_SINT=64]="DXGI_FORMAT_R8_SINT",t[t.DXGI_FORMAT_A8_UNORM=65]="DXGI_FORMAT_A8_UNORM",t[t.DXGI_FORMAT_R1_UNORM=66]="DXGI_FORMAT_R1_UNORM",t[t.DXGI_FORMAT_R9G9B9E5_SHAREDEXP=67]="DXGI_FORMAT_R9G9B9E5_SHAREDEXP",t[t.DXGI_FORMAT_R8G8_B8G8_UNORM=68]="DXGI_FORMAT_R8G8_B8G8_UNORM",t[t.DXGI_FORMAT_G8R8_G8B8_UNORM=69]="DXGI_FORMAT_G8R8_G8B8_UNORM",t[t.DXGI_FORMAT_BC1_TYPELESS=70]="DXGI_FORMAT_BC1_TYPELESS",t[t.DXGI_FORMAT_BC1_UNORM=71]="DXGI_FORMAT_BC1_UNORM",t[t.DXGI_FORMAT_BC1_UNORM_SRGB=72]="DXGI_FORMAT_BC1_UNORM_SRGB",t[t.DXGI_FORMAT_BC2_TYPELESS=73]="DXGI_FORMAT_BC2_TYPELESS",t[t.DXGI_FORMAT_BC2_UNORM=74]="DXGI_FORMAT_BC2_UNORM",t[t.DXGI_FORMAT_BC2_UNORM_SRGB=75]="DXGI_FORMAT_BC2_UNORM_SRGB",t[t.DXGI_FORMAT_BC3_TYPELESS=76]="DXGI_FORMAT_BC3_TYPELESS",t[t.DXGI_FORMAT_BC3_UNORM=77]="DXGI_FORMAT_BC3_UNORM",t[t.DXGI_FORMAT_BC3_UNORM_SRGB=78]="DXGI_FORMAT_BC3_UNORM_SRGB",t[t.DXGI_FORMAT_BC4_TYPELESS=79]="DXGI_FORMAT_BC4_TYPELESS",t[t.DXGI_FORMAT_BC4_UNORM=80]="DXGI_FORMAT_BC4_UNORM",t[t.DXGI_FORMAT_BC4_SNORM=81]="DXGI_FORMAT_BC4_SNORM",t[t.DXGI_FORMAT_BC5_TYPELESS=82]="DXGI_FORMAT_BC5_TYPELESS",t[t.DXGI_FORMAT_BC5_UNORM=83]="DXGI_FORMAT_BC5_UNORM",t[t.DXGI_FORMAT_BC5_SNORM=84]="DXGI_FORMAT_BC5_SNORM",t[t.DXGI_FORMAT_B5G6R5_UNORM=85]="DXGI_FORMAT_B5G6R5_UNORM",t[t.DXGI_FORMAT_B5G5R5A1_UNORM=86]="DXGI_FORMAT_B5G5R5A1_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_UNORM=87]="DXGI_FORMAT_B8G8R8A8_UNORM",t[t.DXGI_FORMAT_B8G8R8X8_UNORM=88]="DXGI_FORMAT_B8G8R8X8_UNORM",t[t.DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM=89]="DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM",t[t.DXGI_FORMAT_B8G8R8A8_TYPELESS=90]="DXGI_FORMAT_B8G8R8A8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8A8_UNORM_SRGB=91]="DXGI_FORMAT_B8G8R8A8_UNORM_SRGB",t[t.DXGI_FORMAT_B8G8R8X8_TYPELESS=92]="DXGI_FORMAT_B8G8R8X8_TYPELESS",t[t.DXGI_FORMAT_B8G8R8X8_UNORM_SRGB=93]="DXGI_FORMAT_B8G8R8X8_UNORM_SRGB",t[t.DXGI_FORMAT_BC6H_TYPELESS=94]="DXGI_FORMAT_BC6H_TYPELESS",t[t.DXGI_FORMAT_BC6H_UF16=95]="DXGI_FORMAT_BC6H_UF16",t[t.DXGI_FORMAT_BC6H_SF16=96]="DXGI_FORMAT_BC6H_SF16",t[t.DXGI_FORMAT_BC7_TYPELESS=97]="DXGI_FORMAT_BC7_TYPELESS",t[t.DXGI_FORMAT_BC7_UNORM=98]="DXGI_FORMAT_BC7_UNORM",t[t.DXGI_FORMAT_BC7_UNORM_SRGB=99]="DXGI_FORMAT_BC7_UNORM_SRGB",t[t.DXGI_FORMAT_AYUV=100]="DXGI_FORMAT_AYUV",t[t.DXGI_FORMAT_Y410=101]="DXGI_FORMAT_Y410",t[t.DXGI_FORMAT_Y416=102]="DXGI_FORMAT_Y416",t[t.DXGI_FORMAT_NV12=103]="DXGI_FORMAT_NV12",t[t.DXGI_FORMAT_P010=104]="DXGI_FORMAT_P010",t[t.DXGI_FORMAT_P016=105]="DXGI_FORMAT_P016",t[t.DXGI_FORMAT_420_OPAQUE=106]="DXGI_FORMAT_420_OPAQUE",t[t.DXGI_FORMAT_YUY2=107]="DXGI_FORMAT_YUY2",t[t.DXGI_FORMAT_Y210=108]="DXGI_FORMAT_Y210",t[t.DXGI_FORMAT_Y216=109]="DXGI_FORMAT_Y216",t[t.DXGI_FORMAT_NV11=110]="DXGI_FORMAT_NV11",t[t.DXGI_FORMAT_AI44=111]="DXGI_FORMAT_AI44",t[t.DXGI_FORMAT_IA44=112]="DXGI_FORMAT_IA44",t[t.DXGI_FORMAT_P8=113]="DXGI_FORMAT_P8",t[t.DXGI_FORMAT_A8P8=114]="DXGI_FORMAT_A8P8",t[t.DXGI_FORMAT_B4G4R4A4_UNORM=115]="DXGI_FORMAT_B4G4R4A4_UNORM",t[t.DXGI_FORMAT_P208=116]="DXGI_FORMAT_P208",t[t.DXGI_FORMAT_V208=117]="DXGI_FORMAT_V208",t[t.DXGI_FORMAT_V408=118]="DXGI_FORMAT_V408",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE=119]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIN_MIP_OPAQUE",t[t.DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE=120]="DXGI_FORMAT_SAMPLER_FEEDBACK_MIP_REGION_USED_OPAQUE",t[t.DXGI_FORMAT_FORCE_UINT=121]="DXGI_FORMAT_FORCE_UINT"}(Mw||(Mw={})),function(t){t[t.DDS_DIMENSION_TEXTURE1D=2]="DDS_DIMENSION_TEXTURE1D",t[t.DDS_DIMENSION_TEXTURE2D=3]="DDS_DIMENSION_TEXTURE2D",t[t.DDS_DIMENSION_TEXTURE3D=6]="DDS_DIMENSION_TEXTURE3D"}(Ew||(Ew={}));var Fw,Bw,Uw,Gw=((_w={})[827611204]=dw.COMPRESSED_RGBA_S3TC_DXT1_EXT,_w[861165636]=dw.COMPRESSED_RGBA_S3TC_DXT3_EXT,_w[894720068]=dw.COMPRESSED_RGBA_S3TC_DXT5_EXT,_w),zw=((xw={})[Mw.DXGI_FORMAT_BC1_TYPELESS]=dw.COMPRESSED_RGBA_S3TC_DXT1_EXT,xw[Mw.DXGI_FORMAT_BC1_UNORM]=dw.COMPRESSED_RGBA_S3TC_DXT1_EXT,xw[Mw.DXGI_FORMAT_BC2_TYPELESS]=dw.COMPRESSED_RGBA_S3TC_DXT3_EXT,xw[Mw.DXGI_FORMAT_BC2_UNORM]=dw.COMPRESSED_RGBA_S3TC_DXT3_EXT,xw[Mw.DXGI_FORMAT_BC3_TYPELESS]=dw.COMPRESSED_RGBA_S3TC_DXT5_EXT,xw[Mw.DXGI_FORMAT_BC3_UNORM]=dw.COMPRESSED_RGBA_S3TC_DXT5_EXT,xw[Mw.DXGI_FORMAT_BC1_UNORM_SRGB]=dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,xw[Mw.DXGI_FORMAT_BC2_UNORM_SRGB]=dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,xw[Mw.DXGI_FORMAT_BC3_UNORM_SRGB]=dw.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT,xw);var Hw=[171,75,84,88,32,49,49,187,13,10,26,10],Vw=12,jw=16,Xw=24,Ww=28,qw=36,Yw=40,Kw=44,Zw=48,Jw=52,Qw=56,$w=60,tS=((Fw={})[_g.UNSIGNED_BYTE]=1,Fw[_g.UNSIGNED_SHORT]=2,Fw[_g.INT]=4,Fw[_g.UNSIGNED_INT]=4,Fw[_g.FLOAT]=4,Fw[_g.HALF_FLOAT]=8,Fw),eS=((Bw={})[gg.RGBA]=4,Bw[gg.RGB]=3,Bw[gg.RG]=2,Bw[gg.RED]=1,Bw[gg.LUMINANCE]=1,Bw[gg.LUMINANCE_ALPHA]=2,Bw[gg.ALPHA]=1,Bw),nS=((Uw={})[_g.UNSIGNED_SHORT_4_4_4_4]=2,Uw[_g.UNSIGNED_SHORT_5_5_5_1]=2,Uw[_g.UNSIGNED_SHORT_5_6_5]=2,Uw);function iS(t,e,n){void 0===n&&(n=!1);var i=new DataView(e);if(!function(t,e){for(var n=0;n<Hw.length;n++)if(e.getUint8(n)!==Hw[n])return console.error(t+" is not a valid *.ktx file!"),!1;return!0}(t,i))return null;var r=67305985===i.getUint32(Vw,!0),a=i.getUint32(jw,r),o=i.getUint32(Xw,r),s=i.getUint32(Ww,r),l=i.getUint32(qw,r),u=i.getUint32(Yw,r)||1,h=i.getUint32(Kw,r)||1,c=i.getUint32(Zw,r)||1,d=i.getUint32(Jw,r),f=i.getUint32(Qw,r),p=i.getUint32($w,r);if(0===u||1!==h)throw new Error("Only 2D textures are supported");if(1!==d)throw new Error("CubeTextures are not supported by KTXLoader yet!");if(1!==c)throw new Error("WebGL does not support array textures");var v,m=l+3&-4,g=u+3&-4,y=new Array(c),_=l*u;if(0===a&&(_=m*g),void 0===(v=0!==a?tS[a]?tS[a]*eS[o]:nS[a]:pw[s]))throw new Error("Unable to resolve the pixel format stored in the *.ktx file!");for(var x=n?function(t,e,n){var i=new Map,r=0;for(;r<e;){var a=t.getUint32(64+r,n),o=64+r+4,s=3-(a+3)%4;if(0===a||a>e-r){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}for(var l=0;l<a&&0!==t.getUint8(o+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}var u=(new TextDecoder).decode(new Uint8Array(t.buffer,o,l)),h=new DataView(t.buffer,o+l+1,a-l-1);i.set(u,h),r+=4+a+s}return i}(i,p,r):null,b=_*v,w=l,S=u,T=m,M=g,E=64+p,A=0;A<f;A++){for(var P=i.getUint32(E,r),C=E+4,k=0;k<c;k++){var R=y[k];R||(R=y[k]=new Array(f)),R[A]={levelID:A,levelWidth:f>1||0!==a?w:T,levelHeight:f>1||0!==a?S:M,levelBuffer:new Uint8Array(e,C,b)},C+=b}E=(E+=P+4)%4!==0?E+4-E%4:E,b=(T=(w=w>>1||1)+4-1&-4)*(M=(S=S>>1||1)+4-1&-4)*v}return 0!==a?{uncompressed:y.map((function(t){var e=t[0].levelBuffer,n=!1;return a===_g.FLOAT?e=new Float32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4):a===_g.UNSIGNED_INT?(n=!0,e=new Uint32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)):a===_g.INT&&(n=!0,e=new Int32Array(t[0].levelBuffer.buffer,t[0].levelBuffer.byteOffset,t[0].levelBuffer.byteLength/4)),{resource:new b_(e,{width:t[0].levelWidth,height:t[0].levelHeight}),type:a,format:n?rS(o):o}})),kvData:x}:{compressed:y.map((function(t){return new ww(null,{format:s,width:l,height:u,levels:f,levelBuffers:t})})),kvData:x}}function rS(t){switch(t){case gg.RGBA:return gg.RGBA_INTEGER;case gg.RGB:return gg.RGB_INTEGER;case gg.RG:return gg.RG_INTEGER;case gg.RED:return gg.RED_INTEGER;default:return t}}ew.setExtensionXhrType("dds",ew.XHR_RESPONSE_TYPE.BUFFER);var aS=function(){function t(){}return t.use=function(t,e){if("dds"===t.extension&&t.data)try{Object.assign(t,Tw(t.name||t.url,function(t){var e=new Uint32Array(t);if(542327876!==e[0])throw new Error("Invalid DDS file magic word");var n=new Uint32Array(t,0,Aw/Uint32Array.BYTES_PER_ELEMENT),i=n[Pw],r=n[Cw],a=n[kw],o=new Uint32Array(t,Rw*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),s=o[1];if(4&s){var l=o[Iw];if(808540228!==l){var u=Gw[l],h=new Uint8Array(t,128);return[new ww(h,{format:u,width:r,height:i,levels:a})]}var c=new Uint32Array(e.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),d=c[Dw],f=c[Ow],p=c[Lw],v=c[Nw],m=zw[d];if(void 0===m)throw new Error("DDSParser cannot parse texture data with DXGI format "+d);if(4===p)throw new Error("DDSParser does not support cubemap textures");if(f===Ew.DDS_DIMENSION_TEXTURE3D)throw new Error("DDSParser does not supported 3D texture data");var g=new Array;if(1===v)g.push(new Uint8Array(t,148));else{for(var y=pw[m],_=0,x=r,b=i,w=0;w<a;w++)_+=Math.max(1,x+3&-4)*Math.max(1,b+3&-4)*y,x>>>=1,b>>>=1;var S=148;for(w=0;w<v;w++)g.push(new Uint8Array(t,S,_)),S+=_}return g.map((function(t){return new ww(t,{format:m,width:r,height:i,levels:a})}))}if(64&s)throw new Error("DDSParser does not support uncompressed texture data.");if(512&s)throw new Error("DDSParser does not supported YUV uncompressed texture data.");if(131072&s)throw new Error("DDSParser does not support single-channel (lumninance) texture data!");if(2&s)throw new Error("DDSParser does not support single-channel (alpha) texture data!");throw new Error("DDSParser failed to load a texture file due to an unknown reason!")}(t.data),t.metadata))}catch(n){return void e(n)}e()},t.extension=o_.Loader,t}();ew.setExtensionXhrType("ktx",ew.XHR_RESPONSE_TYPE.BUFFER);var oS=function(){function t(){}return t.use=function(t,e){if("ktx"===t.extension&&t.data)try{var n=t.name||t.url,i=iS(n,t.data,this.loadKeyValueData),r=i.compressed,a=i.uncompressed,o=i.kvData;if(r){var s=Tw(n,r,t.metadata);if(o&&s.textures)for(var l in s.textures)s.textures[l].baseTexture.ktxKeyValueData=o;Object.assign(t,s)}else if(a){var u={};a.forEach((function(t,e){var i=new G_(new S_(t.resource,{mipmap:Sg.OFF,alphaMode:Tg.NO_PREMULTIPLIED_ALPHA,type:t.type,format:t.format})),r=n+"-"+(e+1);o&&(i.baseTexture.ktxKeyValueData=o),S_.addToCache(i.baseTexture,r),G_.addToCache(i,r),0===e&&(u[n]=i,S_.addToCache(i.baseTexture,n),G_.addToCache(i,n)),u[r]=i})),Object.assign(t,{textures:u})}}catch(h){return void e(h)}e()},t.extension=o_.Loader,t.loadKeyValueData=!1,t}(),sS=function(t,e){return sS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},sS(t,e)};function lS(t,e){function n(){this.constructor=t}sS(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}!function(t){function e(e,n,i,r){void 0===e&&(e=1500),void 0===i&&(i=16384),void 0===r&&(r=!1);var a=t.call(this)||this;return i>16384&&(i=16384),a._properties=[!1,!0,!1,!1,!1],a._maxSize=e,a._batchSize=i,a._buffers=null,a._bufferUpdateIDs=[],a._updateID=0,a.interactiveChildren=!1,a.blendMode=vg.NORMAL,a.autoResize=r,a.roundPixels=!0,a.baseTexture=null,a.setProperties(n),a._tint=0,a.tintRgb=new Float32Array(4),a.tint=16777215,a}lS(e,t),e.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},e.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,ly(t,this.tintRgb)},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},e.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},e.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null}}(a_);var uS,hS,cS=function(){function t(t,e,n){this.geometry=new Z_,this.indexBuffer=null,this.size=n,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<t.length;++i){var r=t[i];r={attributeName:r.attributeName,size:r.size,uploadFunction:r.uploadFunction,type:r.type||_g.FLOAT,offset:r.offset},e[i]?this.dynamicProperties.push(r):this.staticProperties.push(r)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return t.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new X_(function(t,e){void 0===e&&(e=null);var n=6*t;if((e=e||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+e.length+" and expected "+n);for(var i=0,r=0;i<n;i+=6,r+=4)e[i+0]=r+0,e[i+1]=r+1,e[i+2]=r+2,e[i+3]=r+0,e[i+4]=r+2,e[i+5]=r+3;return e}(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var n=0;n<this.dynamicProperties.length;++n){(o=this.dynamicProperties[n]).offset=e,e+=o.size,this.dynamicStride+=o.size}var i=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(i),this.dynamicDataUint32=new Uint32Array(i),this.dynamicBuffer=new X_(this.dynamicData,!1,!1);var r=0;this.staticStride=0;for(n=0;n<this.staticProperties.length;++n){(o=this.staticProperties[n]).offset=r,r+=o.size,this.staticStride+=o.size}var a=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(a),this.staticDataUint32=new Uint32Array(a),this.staticBuffer=new X_(this.staticData,!0,!1);for(n=0;n<this.dynamicProperties.length;++n){var o=this.dynamicProperties[n];t.addAttribute(o.attributeName,this.dynamicBuffer,0,o.type===_g.UNSIGNED_BYTE,o.type,4*this.dynamicStride,4*o.offset)}for(n=0;n<this.staticProperties.length;++n){o=this.staticProperties[n];t.addAttribute(o.attributeName,this.staticBuffer,0,o.type===_g.UNSIGNED_BYTE,o.type,4*this.staticStride,4*o.offset)}},t.prototype.uploadDynamic=function(t,e,n){for(var i=0;i<this.dynamicProperties.length;i++){var r=this.dynamicProperties[i];r.uploadFunction(t,e,n,r.type===_g.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,r.offset)}this.dynamicBuffer._updateID++},t.prototype.uploadStatic=function(t,e,n){for(var i=0;i<this.staticProperties.length;i++){var r=this.staticProperties[i];r.uploadFunction(t,e,n,r.type===_g.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,r.offset)}this.staticBuffer._updateID++},t.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},t}(),dS=function(t){function e(e){var n=t.call(this,e)||this;return n.shader=null,n.properties=null,n.tempMatrix=new Vy,n.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:n.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:n.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:n.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:n.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:_g.UNSIGNED_BYTE,uploadFunction:n.uploadTint,offset:0}],n.shader=Bx.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),n.state=Ux.for2d(),n}return lS(e,t),e.prototype.render=function(t){var e=t.children,n=t._maxSize,i=t._batchSize,r=this.renderer,a=e.length;if(0!==a){a>n&&!t.autoResize&&(a=n);var o=t._buffers;o||(o=t._buffers=this.generateBuffers(t));var s=e[0]._texture.baseTexture,l=s.alphaMode>0;this.state.blendMode=dy(t.blendMode,l),r.state.set(this.state);var u,h,c,d,f=r.gl,p=t.worldTransform.copyTo(this.tempMatrix);p.prepend(r.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=(u=t.tintRgb,h=t.worldAlpha,c=this.shader.uniforms.uColor,d=l,c=c||new Float32Array(4),d||void 0===d?(c[0]=u[0]*h,c[1]=u[1]*h,c[2]=u[2]*h):(c[0]=u[0],c[1]=u[1],c[2]=u[2]),c[3]=h,c),this.shader.uniforms.uSampler=s,this.renderer.shader.bind(this.shader);for(var v=!1,m=0,g=0;m<a;m+=i,g+=1){var y=a-m;y>i&&(y=i),g>=o.length&&o.push(this._generateOneMoreBuffer(t));var _=o[g];_.uploadDynamic(e,m,y);var x=t._bufferUpdateIDs[g]||0;(v=v||_._updateID<x)&&(_._updateID=t._updateID,_.uploadStatic(e,m,y)),r.geometry.bind(_.geometry),f.drawElements(f.TRIANGLES,6*y,f.UNSIGNED_SHORT,0)}}},e.prototype.generateBuffers=function(t){for(var e=[],n=t._maxSize,i=t._batchSize,r=t._properties,a=0;a<n;a+=i)e.push(new cS(this.properties,r,i));return e},e.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,n=t._properties;return new cS(this.properties,n,e)},e.prototype.uploadVertices=function(t,e,n,i,r,a){for(var o=0,s=0,l=0,u=0,h=0;h<n;++h){var c=t[e+h],d=c._texture,f=c.scale.x,p=c.scale.y,v=d.trim,m=d.orig;v?(o=(s=v.x-c.anchor.x*m.width)+v.width,l=(u=v.y-c.anchor.y*m.height)+v.height):(o=m.width*(1-c.anchor.x),s=m.width*-c.anchor.x,l=m.height*(1-c.anchor.y),u=m.height*-c.anchor.y),i[a]=s*f,i[a+1]=u*p,i[a+r]=o*f,i[a+r+1]=u*p,i[a+2*r]=o*f,i[a+2*r+1]=l*p,i[a+3*r]=s*f,i[a+3*r+1]=l*p,a+=4*r}},e.prototype.uploadPosition=function(t,e,n,i,r,a){for(var o=0;o<n;o++){var s=t[e+o].position;i[a]=s.x,i[a+1]=s.y,i[a+r]=s.x,i[a+r+1]=s.y,i[a+2*r]=s.x,i[a+2*r+1]=s.y,i[a+3*r]=s.x,i[a+3*r+1]=s.y,a+=4*r}},e.prototype.uploadRotation=function(t,e,n,i,r,a){for(var o=0;o<n;o++){var s=t[e+o].rotation;i[a]=s,i[a+r]=s,i[a+2*r]=s,i[a+3*r]=s,a+=4*r}},e.prototype.uploadUvs=function(t,e,n,i,r,a){for(var o=0;o<n;++o){var s=t[e+o]._texture._uvs;s?(i[a]=s.x0,i[a+1]=s.y0,i[a+r]=s.x1,i[a+r+1]=s.y1,i[a+2*r]=s.x2,i[a+2*r+1]=s.y2,i[a+3*r]=s.x3,i[a+3*r+1]=s.y3,a+=4*r):(i[a]=0,i[a+1]=0,i[a+r]=0,i[a+r+1]=0,i[a+2*r]=0,i[a+2*r+1]=0,i[a+3*r]=0,i[a+3*r+1]=0,a+=4*r)}},e.prototype.uploadTint=function(t,e,n,i,r,a){for(var o=0;o<n;++o){var s=t[e+o],l=s._texture.baseTexture.alphaMode>0,u=s.alpha,h=u<1&&l?fy(s._tintRGB,u):s._tintRGB+(255*u<<24);i[a]=h,i[a+r]=h,i[a+2*r]=h,i[a+3*r]=h,a+=4*r}},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},e.extension={name:"particle",type:o_.RendererPlugin},e}(ax);!function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(uS||(uS={})),function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(hS||(hS={}));var fS={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var n=Math.ceil(t/this.maxLength);return n<this.minSegments?n=this.minSegments:n>this.maxSegments&&(n=this.maxSegments),n}},pS=function(){function t(){this.color=16777215,this.alpha=1,this.texture=G_.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=G_.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}(),vS=function(t,e){return vS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},vS(t,e)};function mS(t,e){function n(){this.constructor=t}vS(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function gS(t,e){var n,i;void 0===e&&(e=!1);var r=t.length;if(!(r<6)){for(var a=0,o=0,s=t[r-2],l=t[r-1];o<r;o+=2){var u=t[o],h=t[o+1];a+=(u-s)*(h+l),s=u,l=h}if(!e&&a>0||e&&a<=0){var c=r/2;for(o=c+c%2;o<r;o+=2){var d=r-o-2,f=r-o-1,p=o,v=o+1;n=[t[p],t[d]],t[d]=n[0],t[p]=n[1],i=[t[v],t[f]],t[f]=i[0],t[v]=i[1]}}}}var yS={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var n=t.points,i=t.holes,r=e.points,a=e.indices;if(n.length>=6){gS(n,!1);for(var o=[],s=0;s<i.length;s++){var l=i[s];gS(l.points,!0),o.push(n.length/2),n=n.concat(l.points)}var u=ny(n,o,2);if(!u)return;var h=r.length/2;for(s=0;s<u.length;s+=3)a.push(u[s]+h),a.push(u[s+1]+h),a.push(u[s+2]+h);for(s=0;s<n.length;s++)r.push(n[s])}}},_S={build:function(t){var e,n,i,r,a,o,s=t.points;if(t.type===Ry.CIRC){var l=t.shape;e=l.x,n=l.y,a=o=l.radius,i=r=0}else if(t.type===Ry.ELIP){var u=t.shape;e=u.x,n=u.y,a=u.width,o=u.height,i=r=0}else{var h=t.shape,c=h.width/2,d=h.height/2;e=h.x+c,n=h.y+d,i=c-(a=o=Math.max(0,Math.min(h.radius,Math.min(c,d)))),r=d-o}if(a>=0&&o>=0&&i>=0&&r>=0){var f=Math.ceil(2.3*Math.sqrt(a+o)),p=8*f+(i?4:0)+(r?4:0);if(s.length=p,0!==p){if(0===f)return s.length=8,s[0]=s[6]=e+i,s[1]=s[3]=n+r,s[2]=s[4]=e-i,void(s[5]=s[7]=n-r);var v=0,m=4*f+(i?2:0)+2,g=m,y=p,_=e+(M=i+a),x=e-M,b=n+(E=r);if(s[v++]=_,s[v++]=b,s[--m]=b,s[--m]=x,r){var w=n-E;s[g++]=x,s[g++]=w,s[--y]=w,s[--y]=_}for(var S=1;S<f;S++){var T=Math.PI/2*(S/f);_=e+(M=i+Math.cos(T)*a),x=e-M,b=n+(E=r+Math.sin(T)*o),w=n-E;s[v++]=_,s[v++]=b,s[--m]=b,s[--m]=x,s[g++]=x,s[g++]=w,s[--y]=w,s[--y]=_}var M,E;_=e+(M=i),x=e-M,b=n+(E=r+o),w=n-E;s[v++]=_,s[v++]=b,s[--y]=w,s[--y]=_,i&&(s[v++]=x,s[v++]=b,s[--y]=w,s[--y]=x)}}else s.length=0},triangulate:function(t,e){var n=t.points,i=e.points,r=e.indices;if(0!==n.length){var a,o,s=i.length/2,l=s;if(t.type!==Ry.RREC){var u=t.shape;a=u.x,o=u.y}else{var h=t.shape;a=h.x+h.width/2,o=h.y+h.height/2}var c=t.matrix;i.push(t.matrix?c.a*a+c.c*o+c.tx:a,t.matrix?c.b*a+c.d*o+c.ty:o),s++,i.push(n[0],n[1]);for(var d=2;d<n.length;d+=2)i.push(n[d],n[d+1]),r.push(s++,l,s);r.push(l+1,l,s)}}},xS={build:function(t){var e=t.shape,n=e.x,i=e.y,r=e.width,a=e.height,o=t.points;o.length=0,o.push(n,i,n+r,i,n+r,i+a,n,i+a)},triangulate:function(t,e){var n=t.points,i=e.points,r=i.length/2;i.push(n[0],n[1],n[2],n[3],n[6],n[7],n[4],n[5]),e.indices.push(r,r+1,r+2,r+1,r+2,r+3)}};function bS(t,e,n){return t+(e-t)*n}function wS(t,e,n,i,r,a,o){void 0===o&&(o=[]);for(var s=o,l=0,u=0,h=0,c=0,d=0,f=0,p=0,v=0;p<=20;++p)l=bS(t,n,v=p/20),u=bS(e,i,v),h=bS(n,r,v),c=bS(i,a,v),d=bS(l,h,v),f=bS(u,c,v),0===p&&s[s.length-2]===d&&s[s.length-1]===f||s.push(d,f);return s}var SS={build:function(t){if(zS.nextRoundedRectBehavior)_S.build(t);else{var e=t.shape,n=t.points,i=e.x,r=e.y,a=e.width,o=e.height,s=Math.max(0,Math.min(e.radius,Math.min(a,o)/2));n.length=0,s?(wS(i,r+s,i,r,i+s,r,n),wS(i+a-s,r,i+a,r,i+a,r+s,n),wS(i+a,r+o-s,i+a,r+o,i+a-s,r+o,n),wS(i+s,r+o,i,r+o,i,r+o-s,n)):n.push(i,r,i+a,r,i+a,r+o,i,r+o)}},triangulate:function(t,e){if(zS.nextRoundedRectBehavior)_S.triangulate(t,e);else{for(var n=t.points,i=e.points,r=e.indices,a=i.length/2,o=ny(n,null,2),s=0,l=o.length;s<l;s+=3)r.push(o[s]+a),r.push(o[s+1]+a),r.push(o[s+2]+a);for(s=0,l=n.length;s<l;s++)i.push(n[s],n[++s])}}};function TS(t,e,n,i,r,a,o,s){var l,u;o?(l=i,u=-n):(l=-i,u=n);var h=t-n*r+l,c=e-i*r+u,d=t+n*a+l,f=e+i*a+u;return s.push(h,c),s.push(d,f),2}function MS(t,e,n,i,r,a,o,s){var l=n-t,u=i-e,h=Math.atan2(l,u),c=Math.atan2(r-t,a-e);s&&h<c?h+=2*Math.PI:!s&&h>c&&(c+=2*Math.PI);var d=h,f=c-h,p=Math.abs(f),v=Math.sqrt(l*l+u*u),m=1+(15*p*Math.sqrt(v)/Math.PI>>0),g=f/m;if(d+=g,s){o.push(t,e),o.push(n,i);for(var y=1,_=d;y<m;y++,_+=g)o.push(t,e),o.push(t+Math.sin(_)*v,e+Math.cos(_)*v);o.push(t,e),o.push(r,a)}else{o.push(n,i),o.push(t,e);for(y=1,_=d;y<m;y++,_+=g)o.push(t+Math.sin(_)*v,e+Math.cos(_)*v),o.push(t,e);o.push(r,a),o.push(t,e)}return 2*m}function ES(t,e){t.lineStyle.native?function(t,e){var n=0,i=t.shape,r=t.points||i.points,a=i.type!==Ry.POLY||i.closeStroke;if(0!==r.length){var o=e.points,s=e.indices,l=r.length/2,u=o.length/2,h=u;for(o.push(r[0],r[1]),n=1;n<l;n++)o.push(r[2*n],r[2*n+1]),s.push(h,h+1),h++;a&&s.push(h,u)}}(t,e):function(t,e){var n=t.shape,i=t.points||n.points.slice(),r=e.closePointEps;if(0!==i.length){var a=t.lineStyle,o=new Ly(i[0],i[1]),s=new Ly(i[i.length-2],i[i.length-1]),l=n.type!==Ry.POLY||n.closeStroke,u=Math.abs(o.x-s.x)<r&&Math.abs(o.y-s.y)<r;if(l){i=i.slice(),u&&(i.pop(),i.pop(),s.set(i[i.length-2],i[i.length-1]));var h=.5*(o.x+s.x),c=.5*(s.y+o.y);i.unshift(h,c),i.push(h,c)}var d=e.points,f=i.length/2,p=i.length,v=d.length/2,m=a.width/2,g=m*m,y=a.miterLimit*a.miterLimit,_=i[0],x=i[1],b=i[2],w=i[3],S=0,T=0,M=-(x-w),E=_-b,A=0,P=0,C=Math.sqrt(M*M+E*E);M/=C,E/=C,M*=m,E*=m;var k=a.alignment,R=2*(1-k),I=2*k;l||(a.cap===hS.ROUND?p+=MS(_-M*(R-I)*.5,x-E*(R-I)*.5,_-M*R,x-E*R,_+M*I,x+E*I,d,!0)+2:a.cap===hS.SQUARE&&(p+=TS(_,x,M,E,R,I,!0,d))),d.push(_-M*R,x-E*R),d.push(_+M*I,x+E*I);for(var D=1;D<f-1;++D){_=i[2*(D-1)],x=i[2*(D-1)+1],b=i[2*D],w=i[2*D+1],S=i[2*(D+1)],T=i[2*(D+1)+1],M=-(x-w),E=_-b,M/=C=Math.sqrt(M*M+E*E),E/=C,M*=m,E*=m,A=-(w-T),P=b-S,A/=C=Math.sqrt(A*A+P*P),P/=C,A*=m,P*=m;var O=b-_,L=x-w,N=b-S,F=T-w,B=O*N+L*F,U=L*N-F*O,G=U<0;if(Math.abs(U)<.001*Math.abs(B))d.push(b-M*R,w-E*R),d.push(b+M*I,w+E*I),B>=0&&(a.join===uS.ROUND?p+=MS(b,w,b-M*R,w-E*R,b-A*R,w-P*R,d,!1)+4:p+=2,d.push(b-A*I,w-P*I),d.push(b+A*R,w+P*R));else{var z=(-M+_)*(-E+w)-(-M+b)*(-E+x),H=(-A+S)*(-P+w)-(-A+b)*(-P+T),V=(O*H-N*z)/U,j=(F*z-L*H)/U,X=(V-b)*(V-b)+(j-w)*(j-w),W=b+(V-b)*R,q=w+(j-w)*R,Y=b-(V-b)*I,K=w-(j-w)*I,Z=G?R:I;X<=Math.min(O*O+L*L,N*N+F*F)+Z*Z*g?a.join===uS.BEVEL||X/g>y?(G?(d.push(W,q),d.push(b+M*I,w+E*I),d.push(W,q),d.push(b+A*I,w+P*I)):(d.push(b-M*R,w-E*R),d.push(Y,K),d.push(b-A*R,w-P*R),d.push(Y,K)),p+=2):a.join===uS.ROUND?G?(d.push(W,q),d.push(b+M*I,w+E*I),p+=MS(b,w,b+M*I,w+E*I,b+A*I,w+P*I,d,!0)+4,d.push(W,q),d.push(b+A*I,w+P*I)):(d.push(b-M*R,w-E*R),d.push(Y,K),p+=MS(b,w,b-M*R,w-E*R,b-A*R,w-P*R,d,!1)+4,d.push(b-A*R,w-P*R),d.push(Y,K)):(d.push(W,q),d.push(Y,K)):(d.push(b-M*R,w-E*R),d.push(b+M*I,w+E*I),a.join===uS.ROUND?p+=G?MS(b,w,b+M*I,w+E*I,b+A*I,w+P*I,d,!0)+2:MS(b,w,b-M*R,w-E*R,b-A*R,w-P*R,d,!1)+2:a.join===uS.MITER&&X/g<=y&&(G?(d.push(Y,K),d.push(Y,K)):(d.push(W,q),d.push(W,q)),p+=2),d.push(b-A*R,w-P*R),d.push(b+A*I,w+P*I),p+=2)}}_=i[2*(f-2)],x=i[2*(f-2)+1],b=i[2*(f-1)],M=-(x-(w=i[2*(f-1)+1])),E=_-b,M/=C=Math.sqrt(M*M+E*E),E/=C,M*=m,E*=m,d.push(b-M*R,w-E*R),d.push(b+M*I,w+E*I),l||(a.cap===hS.ROUND?p+=MS(b-M*(R-I)*.5,w-E*(R-I)*.5,b-M*R,w-E*R,b+M*I,w+E*I,d,!1)+2:a.cap===hS.SQUARE&&(p+=TS(b,w,M,E,R,I,!1,d)));var J=e.indices,Q=fS.epsilon*fS.epsilon;for(D=v;D<p+v-2;++D)_=d[2*D],x=d[2*D+1],b=d[2*(D+1)],w=d[2*(D+1)+1],S=d[2*(D+2)],T=d[2*(D+2)+1],Math.abs(_*(w-T)+b*(T-x)+S*(x-w))<Q||J.push(D,D+1,D+2)}}(t,e)}var AS,PS=function(){function t(){}return t.curveTo=function(t,e,n,i,r,a){var o=a[a.length-2],s=a[a.length-1]-e,l=o-t,u=i-e,h=n-t,c=Math.abs(s*h-l*u);if(c<1e-8||0===r)return a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e),null;var d=s*s+l*l,f=u*u+h*h,p=s*u+l*h,v=r*Math.sqrt(d)/c,m=r*Math.sqrt(f)/c,g=v*p/d,y=m*p/f,_=v*h+m*l,x=v*u+m*s,b=l*(m+g),w=s*(m+g),S=h*(v+y),T=u*(v+y);return{cx:_+t,cy:x+e,radius:r,startAngle:Math.atan2(w-x,b-_),endAngle:Math.atan2(T-x,S-_),anticlockwise:l*u>h*s}},t.arc=function(t,e,n,i,r,a,o,s,l){for(var u=o-a,h=fS._segmentsCount(Math.abs(u)*r,40*Math.ceil(Math.abs(u)/Iy)),c=u/(2*h),d=2*c,f=Math.cos(c),p=Math.sin(c),v=h-1,m=v%1/v,g=0;g<=v;++g){var y=c+a+d*(g+m*g),_=Math.cos(y),x=-Math.sin(y);l.push((f*_+p*x)*r+n,(f*-x+p*_)*r+i)}},t}(),CS=function(){function t(){}return t.curveLength=function(t,e,n,i,r,a,o,s){for(var l=0,u=0,h=0,c=0,d=0,f=0,p=0,v=0,m=0,g=0,y=0,_=t,x=e,b=1;b<=10;++b)g=_-(v=(p=(f=(d=1-(u=b/10))*d)*d)*t+3*f*u*n+3*d*(h=u*u)*r+(c=h*u)*o),y=x-(m=p*e+3*f*u*i+3*d*h*a+c*s),_=v,x=m,l+=Math.sqrt(g*g+y*y);return l},t.curveTo=function(e,n,i,r,a,o,s){var l=s[s.length-2],u=s[s.length-1];s.length-=2;var h=fS._segmentsCount(t.curveLength(l,u,e,n,i,r,a,o)),c=0,d=0,f=0,p=0,v=0;s.push(l,u);for(var m=1,g=0;m<=h;++m)f=(d=(c=1-(g=m/h))*c)*c,v=(p=g*g)*g,s.push(f*l+3*d*g*e+3*c*p*i+v*a,f*u+3*d*g*n+3*c*p*r+v*o)},t}(),kS=function(){function t(){}return t.curveLength=function(t,e,n,i,r,a){var o=t-2*n+r,s=e-2*i+a,l=2*n-2*t,u=2*i-2*e,h=4*(o*o+s*s),c=4*(o*l+s*u),d=l*l+u*u,f=2*Math.sqrt(h+c+d),p=Math.sqrt(h),v=2*h*p,m=2*Math.sqrt(d),g=c/p;return(v*f+p*c*(f-m)+(4*d*h-c*c)*Math.log((2*p+g+f)/(g+m)))/(4*v)},t.curveTo=function(e,n,i,r,a){for(var o=a[a.length-2],s=a[a.length-1],l=fS._segmentsCount(t.curveLength(o,s,e,n,i,r)),u=0,h=0,c=1;c<=l;++c){var d=c/l;u=o+(e-o)*d,h=s+(n-s)*d,a.push(u+(e+(i-e)*d-u)*d,h+(n+(r-n)*d-h)*d)}},t}(),RS=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,n){this.reset(),this.style=t,this.start=e,this.attribStart=n},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),IS=((AS={})[Ry.POLY]=yS,AS[Ry.CIRC]=_S,AS[Ry.ELIP]=_S,AS[Ry.RECT]=xS,AS[Ry.RREC]=SS,AS),DS=[],OS=[],LS=function(){function t(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=n,this.fillStyle=e,this.matrix=i,this.type=t.type}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}(),NS=new Ly,FS=function(t){function e(){var e=t.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new $y,e.boundsDirty=-1,e}return mS(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),OS.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),DS.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,n,i){void 0===e&&(e=null),void 0===n&&(n=null),void 0===i&&(i=null);var r=new LS(t,e,n,i);return this.graphicsData.push(r),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var n=new LS(t,null,null,e),i=this.graphicsData[this.graphicsData.length-1];return n.lineStyle=i.lineStyle,i.holes.push(n),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,n=0;n<e.length;++n){var i=e[n];if(i.fillStyle.visible&&(i.shape&&(i.matrix?i.matrix.applyInverse(t,NS):NS.copyFrom(t),i.shape.contains(NS.x,NS.y)))){var r=!1;if(i.holes)for(var a=0;a<i.holes.length;a++){if(i.holes[a].shape.contains(NS.x,NS.y)){r=!0;break}}if(!r)return!0}}return!1},e.prototype.updateBatches=function(){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var t=this.uvs,e=this.graphicsData,n=null,i=null;this.batches.length>0&&(i=(n=this.batches[this.batches.length-1]).style);for(var r=this.shapeIndex;r<e.length;r++){this.shapeIndex++;var a=e[r],o=a.fillStyle,s=a.lineStyle;IS[a.type].build(a),a.matrix&&this.transformPoints(a.points,a.matrix),(o.visible||s.visible)&&this.processHoles(a.holes);for(var l=0;l<2;l++){var u=0===l?o:s;if(u.visible){var h=u.texture.baseTexture,c=this.indices.length,d=this.points.length/2;h.wrapMode=wg.REPEAT,0===l?this.processFill(a):this.processLine(a);var f=this.points.length/2-d;0!==f&&(n&&!this._compareStyles(i,u)&&(n.end(c,d),n=null),n||((n=DS.pop()||new RS).begin(u,c,d),this.batches.push(n),i=u),this.addUvs(this.points,t,u.texture,d,f,u.matrix))}}}var p=this.indices.length,v=this.points.length/2;if(n&&n.end(p,v),0!==this.batches.length){var m=v>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&m===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=m?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native===!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var n=this.graphicsData[t],i=n.fillStyle,r=n.lineStyle;if(i&&!i.texture.baseTexture.valid)return!1;if(r&&!r.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,n=t.length;e<n;e++)for(var i=t[e],r=0;r<i.size;r++){var a=i.start+r;this.indicesUint16[a]=this.indicesUint16[a]-i.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,n=0;n<t.length;n++)if(t[n].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++S_._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),OS.push(this.drawCalls[e]);this.drawCalls.length=0;var n=this.colors,i=this.textureIds,r=OS.pop();r||((r=new xb).texArray=new bb),r.texArray.count=0,r.start=0,r.size=0,r.type=mg.TRIANGLES;var a=0,o=null,s=0,l=!1,u=mg.TRIANGLES,h=0;this.drawCalls.push(r);for(e=0;e<this.batches.length;e++){var c=this.batches[e],d=c.style,f=d.texture.baseTexture;l!==!!d.native&&(u=(l=!!d.native)?mg.LINES:mg.TRIANGLES,o=null,a=8,t++),o!==f&&(o=f,f._batchEnabled!==t&&(8===a&&(t++,a=0,r.size>0&&((r=OS.pop())||((r=new xb).texArray=new bb),this.drawCalls.push(r)),r.start=h,r.size=0,r.texArray.count=0,r.type=u),f.touched=1,f._batchEnabled=t,f._batchLocation=a,f.wrapMode=wg.REPEAT,r.texArray.elements[r.texArray.count++]=f,a++)),r.size+=c.size,h+=c.size,s=f._batchLocation,this.addColors(n,d.color,d.alpha,c.attribSize,c.attribStart),this.addTextureIds(i,s,c.attribSize,c.attribStart)}S_._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,n=this.colors,i=this.textureIds,r=new ArrayBuffer(3*t.length*4),a=new Float32Array(r),o=new Uint32Array(r),s=0,l=0;l<t.length/2;l++)a[s++]=t[2*l],a[s++]=t[2*l+1],a[s++]=e[2*l],a[s++]=e[2*l+1],o[s++]=n[l],a[s++]=i[l];this._buffer.update(r),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?yS.triangulate(t,this):IS[t.type].triangulate(t,this)},e.prototype.processLine=function(t){ES(t,this);for(var e=0;e<t.holes.length;e++)ES(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var n=t[e];IS[n.type].build(n),n.matrix&&this.transformPoints(n.points,n.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds;t.clear(),t.addVertexData(this.points,0,this.points.length),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var n=0;n<t.length/2;n++){var i=t[2*n],r=t[2*n+1];t[2*n]=e.a*i+e.c*r+e.tx,t[2*n+1]=e.b*i+e.d*r+e.ty}},e.prototype.addColors=function(t,e,n,i,r){void 0===r&&(r=0);var a=fy((e>>16)+(65280&e)+((255&e)<<16),n);t.length=Math.max(t.length,r+i);for(var o=0;o<i;o++)t[r+o]=a},e.prototype.addTextureIds=function(t,e,n,i){void 0===i&&(i=0),t.length=Math.max(t.length,i+n);for(var r=0;r<n;r++)t[i+r]=e},e.prototype.addUvs=function(t,e,n,i,r,a){void 0===a&&(a=null);for(var o=0,s=e.length,l=n.frame;o<r;){var u=t[2*(i+o)],h=t[2*(i+o)+1];if(a){var c=a.a*u+a.c*h+a.tx;h=a.b*u+a.d*h+a.ty,u=c}o++,e.push(u/l.width,h/l.height)}var d=n.baseTexture;(l.width<d.width||l.height<d.height)&&this.adjustUvs(e,n,s,r)},e.prototype.adjustUvs=function(t,e,n,i){for(var r=e.baseTexture,a=1e-6,o=n+2*i,s=e.frame,l=s.width/r.width,u=s.height/r.height,h=s.x/s.width,c=s.y/s.height,d=Math.floor(t[n]+a),f=Math.floor(t[n+1]+a),p=n+2;p<o;p+=2)d=Math.min(d,Math.floor(t[p]+a)),f=Math.min(f,Math.floor(t[p+1]+a));h-=d,c-=f;for(p=n;p<o;p+=2)t[p]=(t[p]+h)*l,t[p+1]=(t[p+1]+c)*u},e.BATCHABLE_SIZE=100,e}(Mb),BS=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=hS.BUTT,e.join=uS.MITER,e.miterLimit=10,e}return mS(e,t),e.prototype.clone=function(){var t=new e;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},e.prototype.reset=function(){t.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},e}(pS),US=new Float32Array(3),GS={},zS=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.shader=null,n.pluginName="batch",n.currentPath=null,n.batches=[],n.batchTint=-1,n.batchDirty=-1,n.vertexData=null,n._fillStyle=new pS,n._lineStyle=new BS,n._matrix=null,n._holeMode=!1,n.state=Ux.for2d(),n._geometry=e||new FS,n._geometry.refCount++,n._transformID=-1,n.tint=16777215,n.blendMode=vg.NORMAL,n}return mS(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return this.finishPoly(),new e(this._geometry)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),e.prototype.lineStyle=function(t,e,n,i,r){return void 0===t&&(t=null),void 0===e&&(e=0),void 0===n&&(n=1),void 0===i&&(i=.5),void 0===r&&(r=!1),"number"===typeof t&&(t={width:t,color:e,alpha:n,alignment:i,native:r}),this.lineTextureStyle(t)},e.prototype.lineTextureStyle=function(t){t=Object.assign({width:0,texture:G_.WHITE,color:t&&t.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:hS.BUTT,join:uS.MITER,miterLimit:10},t),this.currentPath&&this.startPoly();var e=t.width>0&&t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._lineStyle,{visible:e},t)):this._lineStyle.reset(),this},e.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new Gy,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new Gy,this.currentPath.closeStroke=!1},e.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},e.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},e.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var n=this.currentPath.points,i=n[n.length-2],r=n[n.length-1];return i===t&&r===e||n.push(t,e),this},e.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},e.prototype.quadraticCurveTo=function(t,e,n,i){this._initCurve();var r=this.currentPath.points;return 0===r.length&&this.moveTo(0,0),kS.curveTo(t,e,n,i,r),this},e.prototype.bezierCurveTo=function(t,e,n,i,r,a){return this._initCurve(),CS.curveTo(t,e,n,i,r,a,this.currentPath.points),this},e.prototype.arcTo=function(t,e,n,i,r){this._initCurve(t,e);var a=this.currentPath.points,o=PS.curveTo(t,e,n,i,r,a);if(o){var s=o.cx,l=o.cy,u=o.radius,h=o.startAngle,c=o.endAngle,d=o.anticlockwise;this.arc(s,l,u,h,c,d)}return this},e.prototype.arc=function(t,e,n,i,r,a){if(void 0===a&&(a=!1),i===r)return this;if(!a&&r<=i?r+=Iy:a&&i<=r&&(i+=Iy),0===r-i)return this;var o=t+Math.cos(i)*n,s=e+Math.sin(i)*n,l=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var h=Math.abs(u[u.length-2]-o),c=Math.abs(u[u.length-1]-s);h<l&&c<l||u.push(o,s)}else this.moveTo(o,s),u=this.currentPath.points;return PS.arc(o,s,t,e,n,i,r,a,u),this},e.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:G_.WHITE,color:t,alpha:e})},e.prototype.beginTextureFill=function(t){t=Object.assign({texture:G_.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var e=t.alpha>0;return e?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:e},t)):this._fillStyle.reset(),this},e.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},e.prototype.drawRect=function(t,e,n,i){return this.drawShape(new Fy(t,e,n,i))},e.prototype.drawRoundedRect=function(t,e,n,i,r){return this.drawShape(new zy(t,e,n,i,r))},e.prototype.drawCircle=function(t,e,n){return this.drawShape(new By(t,e,n))},e.prototype.drawEllipse=function(t,e,n,i){return this.drawShape(new Uy(t,e,n,i))},e.prototype.drawPolygon=function(){for(var t,e=arguments,n=[],i=0;i<arguments.length;i++)n[i]=e[i];var r=!0,a=n[0];a.points?(r=a.closeStroke,t=a.points):t=Array.isArray(n[0])?n[0]:n;var o=new Gy(t);return o.closeStroke=r,this.drawShape(o),this},e.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},e.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},e.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===Ry.RECT&&!t[0].matrix&&!t[0].holes.length&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},e.prototype._render=function(t){this.finishPoly();var e=this._geometry;e.updateBatches(),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},e.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,n=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=n,this.vertexData=new Float32Array(t.points);for(var i=0;i<n;i++){var r=t.batches[i],a=r.style.color,o=new Float32Array(this.vertexData.buffer,4*r.attribStart*2,2*r.attribSize),s=new Float32Array(t.uvsFloat32.buffer,4*r.attribStart*2,2*r.attribSize),l={vertexData:o,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*r.start,r.size),uvs:s,_batchRGB:ly(a),_tintRGB:a,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=l}},e.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,n=this.batches.length;e<n;e++){var i=this.batches[e];i.worldAlpha=this.worldAlpha*i.alpha,t.plugins[this.pluginName].render(i)}}},e.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),n=this._geometry,i=this.tint,r=this.worldAlpha,a=e.uniforms,o=n.drawCalls;a.translationMatrix=this.transform.worldTransform,a.tint[0]=(i>>16&255)/255*r,a.tint[1]=(i>>8&255)/255*r,a.tint[2]=(255&i)/255*r,a.tint[3]=r,t.shader.bind(e),t.geometry.bind(n,e),t.state.set(this.state);for(var s=0,l=o.length;s<l;s++)this._renderDrawCallDirect(t,n.drawCalls[s])},e.prototype._renderDrawCallDirect=function(t,e){for(var n=e.texArray,i=e.type,r=e.size,a=e.start,o=n.count,s=0;s<o;s++)t.texture.bind(n.elements[s],s);t.geometry.draw(i,r,a)},e.prototype._resolveDirectShader=function(t){var e=this.shader,n=this.pluginName;if(!e){if(!GS[n]){for(var i=t.plugins[n].MAX_TEXTURES,r=new Int32Array(i),a=0;a<i;a++)r[a]=a;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new Vy,default:tx.from({uSamplers:r},!0)},s=t.plugins[n]._shader.program;GS[n]=new Bx(s,o)}e=GS[n]}return e},e.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,n=e.minX,i=e.minY,r=e.maxX,a=e.maxY;this._bounds.addFrame(this.transform,n,i,r,a)}},e.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)},e.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=ly(this.tint,US),e=0;e<this.batches.length;e++){var n=this.batches[e],i=n._batchRGB,r=(t[0]*i[0]*255<<16)+(t[1]*i[1]*255<<8)+(0|t[2]*i[2]*255);n._tintRGB=(r>>16)+(65280&r)+((255&r)<<16)}}},e.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,a=e.d,o=e.tx,s=e.ty,l=this._geometry.points,u=this.vertexData,h=0,c=0;c<l.length;c+=2){var d=l[c],f=l[c+1];u[h++]=n*d+r*f+o,u[h++]=a*f+i*d+s}}},e.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0,this.finishPoly()),this},e.prototype.setMatrix=function(t){return this._matrix=t,this},e.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},e.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},e.prototype.destroy=function(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,t.prototype.destroy.call(this,e)},e.nextRoundedRectBehavior=!1,e._TEMP_POINT=new Ly,e}(a_),HS=function(t,e){return HS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},HS(t,e)};var VS,jS=new Ly,XS=new Uint16Array([0,1,2,0,2,3]),WS=function(t){function e(e){var n=t.call(this)||this;return n._anchor=new Hy(n._onAnchorUpdate,n,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),n._texture=null,n._width=0,n._height=0,n._tint=null,n._tintRGB=null,n.tint=16777215,n.blendMode=vg.NORMAL,n._cachedTint=16777215,n.uvs=null,n.texture=e||G_.EMPTY,n.vertexData=new Float32Array(8),n.vertexTrimmedData=null,n._transformID=-1,n._textureID=-1,n._transformTrimmedID=-1,n._textureTrimmedID=-1,n.indices=XS,n.pluginName="batch",n.isSprite=!0,n._roundPixels=ty.ROUND_PIXELS,n}return function(t,e){function n(){this.constructor=t}HS(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=xy(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=xy(this.scale.y)*this._height/this._texture.orig.height)},e.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},e.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,n=e.a,i=e.b,r=e.c,a=e.d,o=e.tx,s=e.ty,l=this.vertexData,u=t.trim,h=t.orig,c=this._anchor,d=0,f=0,p=0,v=0;if(u?(d=(f=u.x-c._x*h.width)+u.width,p=(v=u.y-c._y*h.height)+u.height):(d=(f=-c._x*h.width)+h.width,p=(v=-c._y*h.height)+h.height),l[0]=n*f+r*v+o,l[1]=a*v+i*f+s,l[2]=n*d+r*v+o,l[3]=a*v+i*d+s,l[4]=n*d+r*p+o,l[5]=a*p+i*d+s,l[6]=n*f+r*p+o,l[7]=a*p+i*f+s,this._roundPixels)for(var m=ty.RESOLUTION,g=0;g<l.length;++g)l[g]=Math.round((l[g]*m|0)/m)}},e.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,n=t.orig,i=this._anchor,r=this.transform.worldTransform,a=r.a,o=r.b,s=r.c,l=r.d,u=r.tx,h=r.ty,c=-i._x*n.width,d=c+n.width,f=-i._y*n.height,p=f+n.height;e[0]=a*c+s*f+u,e[1]=l*f+o*c+h,e[2]=a*d+s*f+u,e[3]=l*f+o*d+h,e[4]=a*d+s*p+u,e[5]=l*p+o*d+h,e[6]=a*c+s*p+u,e[7]=l*p+o*c+h},e.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},e.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new $y),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Fy),e=this._localBoundsRect),this._localBounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,jS);var e=this._texture.orig.width,n=this._texture.orig.height,i=-e*this.anchor.x,r=0;return jS.x>=i&&jS.x<i+e&&(r=-n*this.anchor.y,jS.y>=r&&jS.y<r+n)},e.prototype.destroy=function(e){if(t.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"===typeof e?e:e&&e.texture){var n="boolean"===typeof e?e:e&&e.baseTexture;this._texture.destroy(!!n)}this._texture=null},e.from=function(t,n){return new e(t instanceof G_?t:G_.from(t,n))},Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=xy(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=xy(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||G_.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),e}(a_),qS=function(t,e){return qS=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},qS(t,e)};!function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(VS||(VS={}));var YS={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:VS.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},KS=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ZS=function(){function t(t){this.styleID=0,this.reset(),$S(this,t,t)}return t.prototype.clone=function(){var e={};return $S(e,this,YS),new t(e)},t.prototype.reset=function(){$S(this,YS,YS)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=QS(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=QS(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){(function(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0})(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=QS(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"===typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var n=e.length-1;n>=0;n--){var i=e[n].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&KS.indexOf(i)<0&&(i='"'+i+'"'),e[n]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function JS(t){return"number"===typeof t?uy(t):("string"===typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function QS(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=JS(t[e]);return t}return JS(t)}function $S(t,e,n){for(var i in n)Array.isArray(e[i])?t[i]=e[i].slice():t[i]=e[i]}var tT={willReadFrequently:!0},eT=function(){function t(t,e,n,i,r,a,o,s,l){this.text=t,this.style=e,this.width=n,this.height=i,this.lines=r,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=s,this.fontProperties=l}return t.measureText=function(e,n,i,r){void 0===r&&(r=t._canvas),i=void 0===i||null===i?n.wordWrap:i;var a=n.toFontString(),o=t.measureFont(a);0===o.fontSize&&(o.fontSize=n.fontSize,o.ascent=n.fontSize);var s=r.getContext("2d",tT);s.font=a;for(var l=(i?t.wordWrap(e,n,r):e).split(/(?:\r\n|\r|\n)/),u=new Array(l.length),h=0,c=0;c<l.length;c++){var d=s.measureText(l[c]).width+(l[c].length-1)*n.letterSpacing;u[c]=d,h=Math.max(h,d)}var f=h+n.strokeThickness;n.dropShadow&&(f+=n.dropShadowDistance);var p=n.lineHeight||o.fontSize+n.strokeThickness,v=Math.max(p,o.fontSize+n.strokeThickness)+(l.length-1)*(p+n.leading);return n.dropShadow&&(v+=n.dropShadowDistance),new t(e,n,f,v,l,u,p+n.leading,h,o)},t.wordWrap=function(e,n,i){void 0===i&&(i=t._canvas);for(var r=i.getContext("2d",tT),a=0,o="",s="",l=Object.create(null),u=n.letterSpacing,h=n.whiteSpace,c=t.collapseSpaces(h),d=t.collapseNewlines(h),f=!c,p=n.wordWrapWidth+u,v=t.tokenize(e),m=0;m<v.length;m++){var g=v[m];if(t.isNewline(g)){if(!d){s+=t.addLine(o),f=!c,o="",a=0;continue}g=" "}if(c){var y=t.isBreakingSpace(g),_=t.isBreakingSpace(o[o.length-1]);if(y&&_)continue}var x=t.getFromCache(g,u,l,r);if(x>p)if(""!==o&&(s+=t.addLine(o),o="",a=0),t.canBreakWords(g,n.breakWords))for(var b=t.wordWrapSplit(g),w=0;w<b.length;w++){for(var S=b[w],T=1;b[w+T];){var M=b[w+T],E=S[S.length-1];if(t.canBreakChars(E,M,g,w,n.breakWords))break;S+=M,T++}w+=S.length-1;var A=t.getFromCache(S,u,l,r);A+a>p&&(s+=t.addLine(o),f=!1,o="",a=0),o+=S,a+=A}else{o.length>0&&(s+=t.addLine(o),o="",a=0);var P=m===v.length-1;s+=t.addLine(g,!P),f=!1,o="",a=0}else x+a>p&&(f=!1,s+=t.addLine(o),o="",a=0),(o.length>0||!t.isBreakingSpace(g)||f)&&(o+=g,a+=x)}return s+=t.addLine(o,!1)},t.addLine=function(e,n){return void 0===n&&(n=!0),e=t.trimRight(e),e=n?e+"\n":e},t.getFromCache=function(t,e,n,i){var r=n[t];if("number"!==typeof r){var a=t.length*e;r=i.measureText(t).width+a,n[t]=r}return r},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!==typeof e)return"";for(var n=e.length-1;n>=0;n--){var i=e[n];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"===typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e,n){return"string"===typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var n=[],i="";if("string"!==typeof e)return n;for(var r=0;r<e.length;r++){var a=e[r],o=e[r+1];t.isBreakingSpace(a,o)||t.isNewline(a)?(""!==i&&(n.push(i),i=""),n.push(a)):i+=a}return""!==i&&n.push(i),n},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,n,i,r){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var n={ascent:0,descent:0,fontSize:0},i=t._canvas,r=t._context;r.font=e;var a=t.METRICS_STRING+t.BASELINE_SYMBOL,o=Math.ceil(r.measureText(a).width),s=Math.ceil(r.measureText(t.BASELINE_SYMBOL).width),l=Math.ceil(t.HEIGHT_MULTIPLIER*s);s=s*t.BASELINE_MULTIPLIER|0,i.width=o,i.height=l,r.fillStyle="#f00",r.fillRect(0,0,o,l),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText(a,0,s);var u=r.getImageData(0,0,o,l).data,h=u.length,c=4*o,d=0,f=0,p=!1;for(d=0;d<s;++d){for(var v=0;v<c;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f+=c}for(n.ascent=s-d,f=h-c,p=!1,d=l;d>s;--d){for(v=0;v<c;v+=4)if(255!==u[f+v]){p=!0;break}if(p)break;f-=c}return n.descent=d-s,n.fontSize=n.ascent+n.descent,t._fonts[e]=n,n},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},Object.defineProperty(t,"_canvas",{get:function(){if(!t.__canvas){var e=void 0;try{var n=new OffscreenCanvas(0,0),i=n.getContext("2d",tT);if(i&&i.measureText)return t.__canvas=n,n;e=ty.ADAPTER.createCanvas()}catch(r){e=ty.ADAPTER.createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t,"_context",{get:function(){return t.__context||(t.__context=t._canvas.getContext("2d",tT)),t.__context},enumerable:!1,configurable:!0}),t}();eT._fonts={},eT.METRICS_STRING="|\xc9q\xc5",eT.BASELINE_SYMBOL="M",eT.BASELINE_MULTIPLIER=1.4,eT.HEIGHT_MULTIPLIER=2,eT._newlines=[10,13],eT._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var nT={texture:!0,children:!1,baseTexture:!0},iT=function(t){function e(e,n,i){var r=this,a=!1;i||(i=ty.ADAPTER.createCanvas(),a=!0),i.width=3,i.height=3;var o=G_.from(i);return o.orig=new Fy,o.trim=new Fy,(r=t.call(this,o)||this)._ownCanvas=a,r.canvas=i,r.context=i.getContext("2d",{willReadFrequently:!0}),r._resolution=ty.RESOLUTION,r._autoResolution=!0,r._text=null,r._style=null,r._styleListener=null,r._font="",r.text=e,r.style=n,r.localStyleID=-1,r}return function(t,e){function n(){this.constructor=t}qS(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.updateText=function(t){var n=this._style;if(this.localStyleID!==n.styleID&&(this.dirty=!0,this.localStyleID=n.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,a=this.context,o=eT.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),s=o.width,l=o.height,u=o.lines,h=o.lineHeight,c=o.lineWidths,d=o.maxLineWidth,f=o.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,s)+2*n.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,l)+2*n.padding)*this._resolution),a.scale(this._resolution,this._resolution),a.clearRect(0,0,this.canvas.width,this.canvas.height),a.font=this._font,a.lineWidth=n.strokeThickness,a.textBaseline=n.textBaseline,a.lineJoin=n.lineJoin,a.miterLimit=n.miterLimit;for(var p=n.dropShadow?2:1,v=0;v<p;++v){var m=n.dropShadow&&0===v,g=m?Math.ceil(Math.max(1,l)+2*n.padding):0,y=g*this._resolution;if(m){a.fillStyle="black",a.strokeStyle="black";var _=n.dropShadowColor,x=ly("number"===typeof _?_:hy(_)),b=n.dropShadowBlur*this._resolution,w=n.dropShadowDistance*this._resolution;a.shadowColor="rgba("+255*x[0]+","+255*x[1]+","+255*x[2]+","+n.dropShadowAlpha+")",a.shadowBlur=b,a.shadowOffsetX=Math.cos(n.dropShadowAngle)*w,a.shadowOffsetY=Math.sin(n.dropShadowAngle)*w+y}else a.fillStyle=this._generateFillStyle(n,u,o),a.strokeStyle=n.stroke,a.shadowColor="black",a.shadowBlur=0,a.shadowOffsetX=0,a.shadowOffsetY=0;var S=(h-f.fontSize)/2;(!e.nextLineHeightBehavior||h-f.fontSize<0)&&(S=0);for(var T=0;T<u.length;T++)i=n.strokeThickness/2,r=n.strokeThickness/2+T*h+f.ascent+S,"right"===n.align?i+=d-c[T]:"center"===n.align&&(i+=(d-c[T])/2),n.stroke&&n.strokeThickness&&this.drawLetterSpacing(u[T],i+n.padding,r+n.padding-g,!0),n.fill&&this.drawLetterSpacing(u[T],i+n.padding,r+n.padding-g)}this.updateTexture()}},e.prototype.drawLetterSpacing=function(t,n,i,r){void 0===r&&(r=!1);var a=this._style.letterSpacing,o=e.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(0===a||o)return o&&(this.context.letterSpacing=a,this.context.textLetterSpacing=a),void(r?this.context.strokeText(t,n,i):this.context.fillText(t,n,i));for(var s=n,l=Array.from?Array.from(t):t.split(""),u=this.context.measureText(t).width,h=0,c=0;c<l.length;++c){var d=l[c];r?this.context.strokeText(d,s,i):this.context.fillText(d,s,i);for(var f="",p=c+1;p<l.length;++p)f+=l[p];s+=u-(h=this.context.measureText(f).width)+a,u=h}},e.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=function(t){var e,n,i,r=t.width,a=t.height,o=t.getContext("2d",{willReadFrequently:!0}),s=o.getImageData(0,0,r,a).data,l=s.length,u={top:null,left:null,right:null,bottom:null},h=null;for(e=0;e<l;e+=4)0!==s[e+3]&&(n=e/4%r,i=~~(e/4/r),null===u.top&&(u.top=i),(null===u.left||n<u.left)&&(u.left=n),(null===u.right||u.right<n)&&(u.right=n+1),(null===u.bottom||u.bottom<i)&&(u.bottom=i));return null!==u.top&&(r=u.right-u.left,a=u.bottom-u.top+1,h=o.getImageData(u.left,u.top,r,a)),{height:a,width:r,data:h}}(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var n=this._texture,i=this._style,r=i.trim?0:i.padding,a=n.baseTexture;n.trim.width=n._frame.width=t.width/this._resolution,n.trim.height=n._frame.height=t.height/this._resolution,n.trim.x=-r,n.trim.y=-r,n.orig.width=n._frame.width-2*r,n.orig.height=n._frame.height-2*r,this._onTextureUpdate(),a.setRealSize(t.width,t.height,this._resolution),n.updateUvs(),this.dirty=!1},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),t.prototype._render.call(this,e)},e.prototype.updateTransform=function(){this.updateText(!0),t.prototype.updateTransform.call(this)},e.prototype.getBounds=function(e,n){return this.updateText(!0),-1===this._textureID&&(e=!1),t.prototype.getBounds.call(this,e,n)},e.prototype.getLocalBounds=function(e){return this.updateText(!0),t.prototype.getLocalBounds.call(this,e)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},e.prototype._generateFillStyle=function(t,e,n){var i,r=t.fill;if(!Array.isArray(r))return r;if(1===r.length)return r[0];var a=t.dropShadow?t.dropShadowDistance:0,o=t.padding||0,s=this.canvas.width/this._resolution-a-2*o,l=this.canvas.height/this._resolution-a-2*o,u=r.slice(),h=t.fillGradientStops.slice();if(!h.length)for(var c=u.length+1,d=1;d<c;++d)h.push(d/c);if(u.unshift(r[0]),h.unshift(0),u.push(r[r.length-1]),h.push(1),t.fillGradientType===VS.LINEAR_VERTICAL){i=this.context.createLinearGradient(s/2,o,s/2,l+o);var f=n.fontProperties.fontSize+t.strokeThickness;for(d=0;d<e.length;d++){var p=n.lineHeight*(d-1)+f,v=n.lineHeight*d,m=v;d>0&&p>v&&(m=(v+p)/2);var g=v+f,y=n.lineHeight*(d+1),_=g;d+1<e.length&&y<g&&(_=(g+y)/2);for(var x=(_-m)/l,b=0;b<u.length;b++){var w=0;w="number"===typeof h[b]?h[b]:b/u.length;var S=Math.min(1,Math.max(0,m/l+w*x));S=Number(S.toFixed(5)),i.addColorStop(S,u[b])}}}else{i=this.context.createLinearGradient(o,l/2,s+o,l/2);var T=u.length+1,M=1;for(d=0;d<u.length;d++){var E=void 0;E="number"===typeof h[d]?h[d]:M/T,i.addColorStop(E,u[d]),M++}}return i},e.prototype.destroy=function(e){"boolean"===typeof e&&(e={children:e}),e=Object.assign({},nT,e),t.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(e.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=xy(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=xy(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof ZS?t:new ZS(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null===t||void 0===t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.nextLineHeightBehavior=!1,e.experimentalLetterSpacing=!1,e}(WS);ty.UPLOADS_PER_FRAME=4;var rT=function(t,e){return rT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},rT(t,e)};var aT=function(){function t(t){this.maxItemsPerFrame=t,this.itemsLeft=0}return t.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},t.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},t}();function oT(t,e){var n=!1;if(t&&t._textures&&t._textures.length)for(var i=0;i<t._textures.length;i++)if(t._textures[i]instanceof G_){var r=t._textures[i].baseTexture;-1===e.indexOf(r)&&(e.push(r),n=!0)}return n}function sT(t,e){if(t.baseTexture instanceof S_){var n=t.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function lT(t,e){if(t._texture&&t._texture instanceof G_){var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function uT(t,e){return e instanceof iT&&(e.updateText(!0),!0)}function hT(t,e){if(e instanceof ZS){var n=e.toFontString();return eT.measureFont(n),!0}return!1}function cT(t,e){if(t instanceof iT){-1===e.indexOf(t.style)&&e.push(t.style),-1===e.indexOf(t)&&e.push(t);var n=t._texture.baseTexture;return-1===e.indexOf(n)&&e.push(n),!0}return!1}function dT(t,e){return t instanceof ZS&&(-1===e.indexOf(t)&&e.push(t),!0)}var fT=function(){function t(t){var e=this;this.limiter=new aT(ty.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){e.queue&&e.prepareItems()},this.registerFindHook(cT),this.registerFindHook(dT),this.registerFindHook(oT),this.registerFindHook(sT),this.registerFindHook(lT),this.registerUploadHook(uT),this.registerUploadHook(hT)}return t.prototype.upload=function(t,e){var n=this;return"function"===typeof t&&(e=t,t=null),e&&Ty("6.5.0","BasePrepare.upload callback is deprecated, use the return Promise instead."),new Promise((function(i){t&&n.add(t);var r=function(){null===e||void 0===e||e(),i()};n.queue.length?(n.completes.push(r),n.ticking||(n.ticking=!0,f_.system.addOnce(n.tick,n,l_.UTILITY))):r()}))},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var t=this.queue[0],e=!1;if(t&&!t._destroyed)for(var n=0,i=this.uploadHooks.length;n<i;n++)if(this.uploadHooks[n](this.uploadHookHelper,t)){this.queue.shift(),e=!0;break}e||this.queue.shift()}if(this.queue.length)f_.system.addOnce(this.tick,this,l_.UTILITY);else{this.ticking=!1;var r=this.completes.slice(0);this.completes.length=0;for(n=0,i=r.length;n<i;n++)r[n]()}},t.prototype.registerFindHook=function(t){return t&&this.addHooks.push(t),this},t.prototype.registerUploadHook=function(t){return t&&this.uploadHooks.push(t),this},t.prototype.add=function(t){for(var e=0,n=this.addHooks.length;e<n&&!this.addHooks[e](t,this.queue);e++);if(t instanceof a_)for(e=t.children.length-1;e>=0;e--)this.add(t.children[e]);return this},t.prototype.destroy=function(){this.ticking&&f_.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function pT(t,e){return e instanceof S_&&(e._glTextures[t.CONTEXT_UID]||t.texture.bind(e),!0)}function vT(t,e){if(!(e instanceof zS))return!1;var n=e.geometry;e.finishPoly(),n.updateBatches();for(var i=n.batches,r=0;r<i.length;r++){var a=i[r].style.texture;a&&pT(t,a.baseTexture)}return n.batchable||t.geometry.bind(n,e._resolveDirectShader(t)),!0}function mT(t,e){return t instanceof zS&&(e.push(t),!0)}var gT=function(t){function e(e){var n=t.call(this,e)||this;return n.uploadHookHelper=n.renderer,n.registerFindHook(mT),n.registerUploadHook(pT),n.registerUploadHook(vT),n}return function(t,e){function n(){this.constructor=t}rT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.extension={name:"prepare",type:o_.RendererPlugin},e}(fT),yT=(function(){function t(t){this.maxMilliseconds=t,this.frameStart=0}t.prototype.beginFrame=function(){this.frameStart=Date.now()},t.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds}}(),function(){function t(t,e,n){void 0===n&&(n=null),this.linkedSheets=[],this._texture=t instanceof G_?t:null,this.baseTexture=t instanceof S_?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(n||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return t.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,n=ky(t,null);return null===n&&(n=void 0!==e?parseFloat(e):1),1!==n&&this.baseTexture.setResolution(n),n},t.prototype.parse=function(e){var n=this;return e&&Ty("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise((function(i){n._callback=function(t){null===e||void 0===e||e(t),i(t)},n._batchIndex=0,n._frameKeys.length<=t.BATCH_SIZE?(n._processFrames(0),n._processAnimations(),n._parseComplete()):n._nextBatch()}))},t.prototype._processFrames=function(e){for(var n=e,i=t.BATCH_SIZE;n-e<i&&n<this._frameKeys.length;){var r=this._frameKeys[n],a=this._frames[r],o=a.frame;if(o){var s=null,l=null,u=!1!==a.trimmed&&a.sourceSize?a.sourceSize:a.frame,h=new Fy(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);s=a.rotated?new Fy(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):new Fy(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),!1!==a.trimmed&&a.spriteSourceSize&&(l=new Fy(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new G_(this.baseTexture,s,h,l,a.rotated?2:0,a.anchor),G_.addToCache(this.textures[r],r)}n++}},t.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var n=0;n<t[e].length;n++){var i=t[e][n];this.animations[e].push(this.textures[i])}}},t.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},t.prototype._nextBatch=function(){var e=this;this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout((function(){e._batchIndex*t.BATCH_SIZE<e._frameKeys.length?e._nextBatch():(e._processAnimations(),e._parseComplete())}),0)},t.prototype.destroy=function(t){var e;for(var n in void 0===t&&(t=!1),this.textures)this.textures[n].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},t.BATCH_SIZE=1e3,t}()),_T=function(){function t(){}return t.use=function(e,n){var i,r,a=this,o=e.name+"_image";if(e.data&&e.type===ew.TYPE.JSON&&e.data.frames&&!a.resources[o]){var s=null===(r=null===(i=e.data)||void 0===i?void 0:i.meta)||void 0===r?void 0:r.related_multi_packs;if(Array.isArray(s))for(var l=function(t){if("string"!==typeof t)return"continue";var n=t.replace(".json",""),i=ry.resolve(e.url.replace(a.baseUrl,""),t);if(a.resources[n]||Object.values(a.resources).some((function(t){return ry.format(ry.parse(t.url))===i})))return"continue";var r={crossOrigin:e.crossOrigin,loadType:ew.LOAD_TYPE.XHR,xhrType:ew.XHR_RESPONSE_TYPE.JSON,parentResource:e,metadata:e.metadata};a.add(n,i,r)},u=0,h=s;u<h.length;u++){l(h[u])}var c={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},d=t.getResourcePath(e,a.baseUrl);a.add(o,d,c,(function(t){if(t.error)n(t.error);else{var i=new yT(t.texture,e.data,e.url);i.parse().then((function(){e.spritesheet=i,e.textures=i.textures,n()}))}}))}else n()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:ry.resolve(t.url.replace(e,""),t.data.meta.image)},t.extension=o_.Loader,t}(),xT=function(t,e){return xT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},xT(t,e)};function bT(t,e){function n(){this.constructor=t}xT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var wT=new Ly,ST=(function(t){function e(e,n,i){void 0===n&&(n=100),void 0===i&&(i=100);var r=t.call(this,e)||this;return r.tileTransform=new Qy,r._width=n,r._height=i,r.uvMatrix=r.texture.uvMatrix||new Hx(e),r.pluginName="tilingSprite",r.uvRespectAnchor=!1,r}bT(e,t),Object.defineProperty(e.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),e.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},e.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},e.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,n=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,n,i)},e.prototype.getLocalBounds=function(e){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new Fy),e=this._localBoundsRect),this._bounds.getRectangle(e)):t.prototype.getLocalBounds.call(this,e)},e.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,wT);var e=this._width,n=this._height,i=-e*this.anchor._x;if(wT.x>=i&&wT.x<i+e){var r=-n*this.anchor._y;if(wT.y>=r&&wT.y<r+n)return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},e.from=function(t,n){return new e(t instanceof G_?t:G_.from(t,n),n.width,n.height)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0})}(WS),"#version 100\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n"),TT=new Vy,MT=function(t){function e(e){var n=t.call(this,e)||this;return e.runners.contextChange.add(n),n.quad=new Q_,n.state=Ux.for2d(),n}return bT(e,t),e.prototype.contextChange=function(){var t=this.renderer,e={globals:t.globalUniforms};this.simpleShader=Bx.from(ST,"#version 100\n#define SHADER_NAME Tiling-Sprite-Simple-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 texSample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = texSample * uColor;\n}\n",e),this.shader=t.context.webGLVersion>1?Bx.from("#version 300 es\n#define SHADER_NAME Tiling-Sprite-300\n\nprecision lowp float;\n\nin vec2 aVertexPosition;\nin vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nout vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n","#version 300 es\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nin vec2 vTextureCoord;\n\nout vec4 fragmentColor;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0\n\n    fragmentColor = texSample * uColor;\n}\n",e):Bx.from(ST,"#version 100\n#ifdef GL_EXT_shader_texture_lod\n    #extension GL_EXT_shader_texture_lod : enable\n#endif\n#define SHADER_NAME Tiling-Sprite-100\n\nprecision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    vec2 unclamped = coord;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    #ifdef GL_EXT_shader_texture_lod\n        vec4 texSample = unclamped == coord\n            ? texture2D(uSampler, coord) \n            : texture2DLodEXT(uSampler, coord, 0);\n    #else\n        vec4 texSample = texture2D(uSampler, coord);\n    #endif\n\n    gl_FragColor = texSample * uColor;\n}\n",e)},e.prototype.render=function(t){var e=this.renderer,n=this.quad,i=n.vertices;i[0]=i[6]=t._width*-t.anchor.x,i[1]=i[3]=t._height*-t.anchor.y,i[2]=i[4]=t._width*(1-t.anchor.x),i[5]=i[7]=t._height*(1-t.anchor.y);var r=t.uvRespectAnchor?t.anchor.x:0,a=t.uvRespectAnchor?t.anchor.y:0;(i=n.uvs)[0]=i[6]=-r,i[1]=i[3]=-a,i[2]=i[4]=1-r,i[5]=i[7]=1-a,n.invalidate();var o=t._texture,s=o.baseTexture,l=s.alphaMode>0,u=t.tileTransform.localTransform,h=t.uvMatrix,c=s.isPowerOfTwo&&o.frame.width===s.width&&o.frame.height===s.height;c&&(s._glTextures[e.CONTEXT_UID]?c=s.wrapMode!==wg.CLAMP:s.wrapMode===wg.CLAMP&&(s.wrapMode=wg.REPEAT));var d=c?this.simpleShader:this.shader,f=o.width,p=o.height,v=t._width,m=t._height;TT.set(u.a*f/v,u.b*f/m,u.c*p/v,u.d*p/m,u.tx/v,u.ty/m),TT.invert(),c?TT.prepend(h.mapCoord):(d.uniforms.uMapCoord=h.mapCoord.toArray(!0),d.uniforms.uClampFrame=h.uClampFrame,d.uniforms.uClampOffset=h.uClampOffset),d.uniforms.uTransform=TT.toArray(!0),d.uniforms.uColor=py(t.tint,t.worldAlpha,d.uniforms.uColor,l),d.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),d.uniforms.uSampler=o,e.shader.bind(d),e.geometry.bind(n),this.state.blendMode=dy(t.blendMode,l),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},e.extension={name:"tilingSprite",type:o_.RendererPlugin},e}(ax),ET=function(t,e){return ET=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ET(t,e)};function AT(t,e){function n(){this.constructor=t}ET(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var PT=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}(),CT=new Ly,kT=new Gy,RT=function(t){function e(e,n,i,r){void 0===r&&(r=mg.TRIANGLES);var a=t.call(this)||this;return a.geometry=e,a.shader=n,a.state=i||Ux.for2d(),a.drawMode=r,a.start=0,a.size=0,a.uvs=null,a.indices=null,a.vertexData=new Float32Array(1),a.vertexDirty=-1,a._transformID=-1,a._roundPixels=ty.ROUND_PIXELS,a.batchUvs=null,a}return AT(e,t),Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},set:function(t){this._geometry!==t&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=t,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return"tint"in this.shader?this.shader.tint:null},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return"texture"in this.shader?this.shader.texture:null},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),e.prototype._render=function(t){var n=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===mg.TRIANGLES&&n.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},e.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},e.prototype._renderToBatch=function(t){var e=this.geometry,n=this.shader;n.uvMatrix&&(n.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=n._tintRGB,this._texture=n.texture;var i=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[i]),t.plugins[i].render(this)},e.prototype.calculateVertices=function(){var t=this.geometry.buffers[0],e=t.data,n=t._updateID;if(n!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var i=this.transform.worldTransform,r=i.a,a=i.b,o=i.c,s=i.d,l=i.tx,u=i.ty,h=this.vertexData,c=0;c<h.length/2;c++){var d=e[2*c],f=e[2*c+1];h[2*c]=r*d+o*f+l,h[2*c+1]=a*d+s*f+u}if(this._roundPixels){var p=ty.RESOLUTION;for(c=0;c<h.length;++c)h[c]=Math.round((h[c]*p|0)/p)}this.vertexDirty=n}},e.prototype.calculateUvs=function(){var t=this.geometry.buffers[1],e=this.shader;e.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new PT(t,e.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},e.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},e.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,CT);for(var e=this.geometry.getBuffer("aVertexPosition").data,n=kT.points,i=this.geometry.getIndex().data,r=i.length,a=4===this.drawMode?3:1,o=0;o+2<r;o+=a){var s=2*i[o],l=2*i[o+1],u=2*i[o+2];if(n[0]=e[s],n[1]=e[s+1],n[2]=e[l],n[3]=e[l+1],n[4]=e[u],n[5]=e[u+1],kT.contains(CT.x,CT.y))return!0}return!1},e.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},e.BATCHABLE_SIZE=100,e}(a_),IT=function(t){function e(e,n){var i=this,r={uSampler:e,alpha:1,uTextureMatrix:Vy.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(r,n.uniforms),(i=t.call(this,n.program||Fx.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n","varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n"),r)||this)._colorDirty=!1,i.uvMatrix=new Hx(e),i.batchable=void 0===n.program,i.pluginName=n.pluginName,i.tint=n.tint,i.alpha=n.alpha,i}return AT(e,t),Object.defineProperty(e.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(!this.uniforms.uSampler.baseTexture.alphaMode!==!t.baseTexture.alphaMode&&(this._colorDirty=!0),this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;py(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},e}(Bx),DT=function(t){function e(e,n,i){var r=t.call(this)||this,a=new X_(e),o=new X_(n,!0),s=new X_(i,!0,!0);return r.addAttribute("aVertexPosition",a,2,!1,_g.FLOAT).addAttribute("aTextureCoord",o,2,!1,_g.FLOAT).addIndex(s),r._updateId=-1,r}return AT(e,t),Object.defineProperty(e.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),e}(Z_),OT=function(t,e){return OT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},OT(t,e)};var LT=function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]},NT=function(){function t(){}return t.test=function(t){return"string"===typeof t&&0===t.indexOf("info face=")},t.parse=function(t){var e=t.match(/^[a-z]+\s+.+$/gm),n={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(var i in e){var r=e[i].match(/^[a-z]+/gm)[0],a=e[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in a){var l=a[s].split("="),u=l[0],h=l[1].replace(/"/gm,""),c=parseFloat(h),d=isNaN(c)?h:c;o[u]=d}n[r].push(o)}var f=new LT;return n.info.forEach((function(t){return f.info.push({face:t.face,size:parseInt(t.size,10)})})),n.common.forEach((function(t){return f.common.push({lineHeight:parseInt(t.lineHeight,10)})})),n.page.forEach((function(t){return f.page.push({id:parseInt(t.id,10),file:t.file})})),n.char.forEach((function(t){return f.char.push({id:parseInt(t.id,10),page:parseInt(t.page,10),x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xoffset:parseInt(t.xoffset,10),yoffset:parseInt(t.yoffset,10),xadvance:parseInt(t.xadvance,10)})})),n.kerning.forEach((function(t){return f.kerning.push({first:parseInt(t.first,10),second:parseInt(t.second,10),amount:parseInt(t.amount,10)})})),n.distanceField.forEach((function(t){return f.distanceField.push({distanceRange:parseInt(t.distanceRange,10),fieldType:t.fieldType})})),f},t}(),FT=function(){function t(){}return t.test=function(t){return t instanceof XMLDocument&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},t.parse=function(t){for(var e=new LT,n=t.getElementsByTagName("info"),i=t.getElementsByTagName("common"),r=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning"),s=t.getElementsByTagName("distanceField"),l=0;l<n.length;l++)e.info.push({face:n[l].getAttribute("face"),size:parseInt(n[l].getAttribute("size"),10)});for(l=0;l<i.length;l++)e.common.push({lineHeight:parseInt(i[l].getAttribute("lineHeight"),10)});for(l=0;l<r.length;l++)e.page.push({id:parseInt(r[l].getAttribute("id"),10)||0,file:r[l].getAttribute("file")});for(l=0;l<a.length;l++){var u=a[l];e.char.push({id:parseInt(u.getAttribute("id"),10),page:parseInt(u.getAttribute("page"),10)||0,x:parseInt(u.getAttribute("x"),10),y:parseInt(u.getAttribute("y"),10),width:parseInt(u.getAttribute("width"),10),height:parseInt(u.getAttribute("height"),10),xoffset:parseInt(u.getAttribute("xoffset"),10),yoffset:parseInt(u.getAttribute("yoffset"),10),xadvance:parseInt(u.getAttribute("xadvance"),10)})}for(l=0;l<o.length;l++)e.kerning.push({first:parseInt(o[l].getAttribute("first"),10),second:parseInt(o[l].getAttribute("second"),10),amount:parseInt(o[l].getAttribute("amount"),10)});for(l=0;l<s.length;l++)e.distanceField.push({fieldType:s[l].getAttribute("fieldType"),distanceRange:parseInt(s[l].getAttribute("distanceRange"),10)});return e},t}(),BT=function(){function t(){}return t.test=function(t){if("string"===typeof t&&t.indexOf("<font>")>-1){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return FT.test(e)}return!1},t.parse=function(t){var e=(new globalThis.DOMParser).parseFromString(t,"text/xml");return FT.parse(e)},t}(),UT=[NT,FT,BT];function GT(t){for(var e=0;e<UT.length;e++)if(UT[e].test(t))return UT[e];return null}function zT(t,e,n,i,r,a,o){var s=n.text,l=n.fontProperties;e.translate(i,r),e.scale(a,a);var u=o.strokeThickness/2,h=-o.strokeThickness/2;if(e.font=o.toFontString(),e.lineWidth=o.strokeThickness,e.textBaseline=o.textBaseline,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.fillStyle=function(t,e,n,i,r,a){var o,s=n.fill;if(!Array.isArray(s))return s;if(1===s.length)return s[0];var l=n.dropShadow?n.dropShadowDistance:0,u=n.padding||0,h=t.width/i-l-2*u,c=t.height/i-l-2*u,d=s.slice(),f=n.fillGradientStops.slice();if(!f.length)for(var p=d.length+1,v=1;v<p;++v)f.push(v/p);if(d.unshift(s[0]),f.unshift(0),d.push(s[s.length-1]),f.push(1),n.fillGradientType===VS.LINEAR_VERTICAL){o=e.createLinearGradient(h/2,u,h/2,c+u);var m=0,g=(a.fontProperties.fontSize+n.strokeThickness)/c;for(v=0;v<r.length;v++)for(var y=a.lineHeight*v,_=0;_<d.length;_++){var x=y/c+("number"===typeof f[_]?f[_]:_/d.length)*g,b=Math.max(m,x);b=Math.min(b,1),o.addColorStop(b,d[_]),m=b}}else{o=e.createLinearGradient(u,c/2,h+u,c/2);var w=d.length+1,S=1;for(v=0;v<d.length;v++){var T=void 0;T="number"===typeof f[v]?f[v]:S/w,o.addColorStop(T,d[v]),S++}}return o}(t,e,o,a,[s],n),e.strokeStyle=o.stroke,o.dropShadow){var c=o.dropShadowColor,d=ly("number"===typeof c?c:hy(c)),f=o.dropShadowBlur*a,p=o.dropShadowDistance*a;e.shadowColor="rgba("+255*d[0]+","+255*d[1]+","+255*d[2]+","+o.dropShadowAlpha+")",e.shadowBlur=f,e.shadowOffsetX=Math.cos(o.dropShadowAngle)*p,e.shadowOffsetY=Math.sin(o.dropShadowAngle)*p}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0;o.stroke&&o.strokeThickness&&e.strokeText(s,u,h+n.lineHeight-l.descent),o.fill&&e.fillText(s,u,h+n.lineHeight-l.descent),e.setTransform(1,0,0,1,0,0),e.fillStyle="rgba(0, 0, 0, 0)"}function HT(t){return Array.from?Array.from(t):t.split("")}function VT(t){return t.codePointAt?t.codePointAt(0):t.charCodeAt(0)}var jT=function(){function t(t,e,n){var i,r,a=t.info[0],o=t.common[0],s=t.page[0],l=t.distanceField[0],u=ky(s.file),h={};this._ownsTextures=n,this.font=a.face,this.size=a.size,this.lineHeight=o.lineHeight/u,this.chars={},this.pageTextures=h;for(var c=0;c<t.page.length;c++){var d=t.page[c],f=d.id,p=d.file;h[f]=e instanceof Array?e[c]:e[p],(null===l||void 0===l?void 0:l.fieldType)&&"none"!==l.fieldType&&(h[f].baseTexture.alphaMode=Tg.NO_PREMULTIPLIED_ALPHA,h[f].baseTexture.mipmap=Sg.OFF)}for(c=0;c<t.char.length;c++){var v=t.char[c],m=(f=v.id,v.page),g=t.char[c],y=g.x,_=g.y,x=g.width,b=g.height,w=g.xoffset,S=g.yoffset,T=g.xadvance;_/=u,x/=u,b/=u,w/=u,S/=u,T/=u;var M=new Fy((y/=u)+h[m].frame.x/u,_+h[m].frame.y/u,x,b);this.chars[f]={xOffset:w,yOffset:S,xAdvance:T,kerning:{},texture:new G_(h[m].baseTexture,M),page:m}}for(c=0;c<t.kerning.length;c++){var E=t.kerning[c],A=E.first,P=E.second,C=E.amount;A/=u,P/=u,C/=u,this.chars[P]&&(this.chars[P].kerning[A]=C)}this.distanceFieldRange=null===l||void 0===l?void 0:l.distanceRange,this.distanceFieldType=null!==(r=null===(i=null===l||void 0===l?void 0:l.fieldType)||void 0===i?void 0:i.toLowerCase())&&void 0!==r?r:"none"}return t.prototype.destroy=function(){for(var t in this.chars)this.chars[t].texture.destroy(),this.chars[t].texture=null;for(var t in this.pageTextures)this._ownsTextures&&this.pageTextures[t].destroy(!0),this.pageTextures[t]=null;this.chars=null,this.pageTextures=null},t.install=function(e,n,i){var r;if(e instanceof LT)r=e;else{var a=GT(e);if(!a)throw new Error("Unrecognized data format for font.");r=a.parse(e)}n instanceof G_&&(n=[n]);var o=new t(r,n,i);return t.available[o.font]=o,o},t.uninstall=function(e){var n=t.available[e];if(!n)throw new Error("No font found named '"+e+"'");n.destroy(),delete t.available[e]},t.from=function(e,n,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var r=Object.assign({},t.defaultOptions,i),a=r.chars,o=r.padding,s=r.resolution,l=r.textureWidth,u=r.textureHeight,h=function(t){"string"===typeof t&&(t=[t]);for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(Array.isArray(r)){if(2!==r.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+r.length+".");var a=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,l=o;s<=l;s++)e.push(String.fromCharCode(s))}else e.push.apply(e,HT(r))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(a),c=n instanceof ZS?n:new ZS(n),d=l,f=new LT;f.info[0]={face:c.fontFamily,size:c.fontSize},f.common[0]={lineHeight:c.fontSize};for(var p,v,m,g=0,y=0,_=0,x=[],b=0;b<h.length;b++){p||((p=ty.ADAPTER.createCanvas()).width=l,p.height=u,v=p.getContext("2d"),m=new S_(p,{resolution:s}),x.push(new G_(m)),f.page.push({id:x.length-1,file:""}));var w=h[b],S=eT.measureText(w,c,!1,p),T=S.width,M=Math.ceil(S.height),E=Math.ceil(("italic"===c.fontStyle?2:1)*T);if(y>=u-M*s){if(0===y)throw new Error("[BitmapFont] textureHeight "+u+"px is too small (fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+w+"')");--b,p=null,v=null,m=null,y=0,g=0,_=0}else if(_=Math.max(M+S.fontProperties.descent,_),E*s+g>=d){if(0===g)throw new Error("[BitmapFont] textureWidth "+l+"px is too small (fontFamily: '"+c.fontFamily+"', fontSize: "+c.fontSize+"px, char: '"+w+"')");--b,y+=_*s,y=Math.ceil(y),g=0,_=0}else{zT(p,v,S,g,y,s,c);var A=VT(S.text);f.char.push({id:A,page:x.length-1,x:g/s,y:y/s,width:E,height:M,xoffset:0,yoffset:0,xadvance:Math.ceil(T-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0))}),g+=(E+2*o)*s,g=Math.ceil(g)}}if(!(null===i||void 0===i?void 0:i.skipKerning)){b=0;for(var P=h.length;b<P;b++)for(var C=h[b],k=0;k<P;k++){var R=h[k],I=v.measureText(C).width,D=v.measureText(R).width,O=v.measureText(C+R).width-(I+D);O&&f.kerning.push({first:VT(C),second:VT(R),amount:O})}}var L=new t(f,x,!0);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=L,L},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}(),XT=[],WT=[],qT=[],YT=(function(t){function e(n,i){void 0===i&&(i={});var r=t.call(this)||this;r._tint=16777215;var a=Object.assign({},e.styleDefaults,i),o=a.align,s=a.tint,l=a.maxWidth,u=a.letterSpacing,h=a.fontName,c=a.fontSize;if(!jT.available[h])throw new Error('Missing BitmapFont "'+h+'"');return r._activePagesMeshData=[],r._textWidth=0,r._textHeight=0,r._align=o,r._tint=s,r._font=void 0,r._fontName=h,r._fontSize=c,r.text=n,r._maxWidth=l,r._maxLineHeight=0,r._letterSpacing=u,r._anchor=new Hy((function(){r.dirty=!0}),r,0,0),r._roundPixels=ty.ROUND_PIXELS,r.dirty=!0,r._resolution=ty.RESOLUTION,r._autoResolution=!0,r._textureCache={},r}(function(t,e){function n(){this.constructor=t}OT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.updateText=function(){for(var t,e=jT.available[this._fontName],n=this.fontSize,i=n/e.size,r=new Ly,a=[],o=[],s=[],l=HT(this._text.replace(/(?:\r\n|\r)/g,"\n")||" "),u=this._maxWidth*e.size/n,h="none"===e.distanceFieldType?XT:WT,c=null,d=0,f=0,p=0,v=-1,m=0,g=0,y=0,_=0,x=0;x<l.length;x++){var b=VT(z=l[x]);if(/(?:\s)/.test(z)&&(v=x,m=d,_++),"\r"!==z&&"\n"!==z){var w=e.chars[b];if(w){c&&w.kerning[c]&&(r.x+=w.kerning[c]);var S=qT.pop()||{texture:G_.EMPTY,line:0,charCode:0,prevSpaces:0,position:new Ly};S.texture=w.texture,S.line=p,S.charCode=b,S.position.x=r.x+w.xOffset+this._letterSpacing/2,S.position.y=r.y+w.yOffset,S.prevSpaces=_,a.push(S),d=S.position.x+Math.max(w.xAdvance-w.xOffset,w.texture.orig.width),r.x+=w.xAdvance+this._letterSpacing,y=Math.max(y,w.yOffset+w.texture.height),c=b,-1!==v&&u>0&&r.x>u&&(_y(a,1+v-++g,1+x-v),x=v,v=-1,o.push(m),s.push(a.length>0?a[a.length-1].prevSpaces:0),f=Math.max(f,m),p++,r.x=0,r.y+=e.lineHeight,c=null,_=0)}}else o.push(d),s.push(-1),f=Math.max(f,d),++p,++g,r.x=0,r.y+=e.lineHeight,c=null,_=0}var T=l[l.length-1];"\r"!==T&&"\n"!==T&&(/(?:\s)/.test(T)&&(d=m),o.push(d),f=Math.max(f,d),s.push(-1));var M=[];for(x=0;x<=p;x++){var E=0;"right"===this._align?E=f-o[x]:"center"===this._align?E=(f-o[x])/2:"justify"===this._align&&(E=s[x]<0?0:(f-o[x])/s[x]),M.push(E)}var A=a.length,P={},C=[],k=this._activePagesMeshData;h.push.apply(h,k);for(x=0;x<A;x++){var R=(V=a[x].texture).baseTexture.uid;if(!P[R]){if(!(Z=h.pop())){var I=new DT,D=void 0,O=void 0;"none"===e.distanceFieldType?(D=new IT(G_.EMPTY),O=vg.NORMAL):(D=new IT(G_.EMPTY,{program:Fx.from("// Mesh material default fragment\r\nattribute vec2 aVertexPosition;\r\nattribute vec2 aTextureCoord;\r\n\r\nuniform mat3 projectionMatrix;\r\nuniform mat3 translationMatrix;\r\nuniform mat3 uTextureMatrix;\r\n\r\nvarying vec2 vTextureCoord;\r\n\r\nvoid main(void)\r\n{\r\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\r\n\r\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\r\n}\r\n","// Pixi texture info\r\nvarying vec2 vTextureCoord;\r\nuniform sampler2D uSampler;\r\n\r\n// Tint\r\nuniform vec4 uColor;\r\n\r\n// on 2D applications fwidth is screenScale / glyphAtlasScale * distanceFieldRange\r\nuniform float uFWidth;\r\n\r\nvoid main(void) {\r\n\r\n  // To stack MSDF and SDF we need a non-pre-multiplied-alpha texture.\r\n  vec4 texColor = texture2D(uSampler, vTextureCoord);\r\n\r\n  // MSDF\r\n  float median = texColor.r + texColor.g + texColor.b -\r\n                  min(texColor.r, min(texColor.g, texColor.b)) -\r\n                  max(texColor.r, max(texColor.g, texColor.b));\r\n  // SDF\r\n  median = min(median, texColor.a);\r\n\r\n  float screenPxDistance = uFWidth * (median - 0.5);\r\n  float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\r\n  if (median < 0.01) {\r\n    alpha = 0.0;\r\n  } else if (median > 0.99) {\r\n    alpha = 1.0;\r\n  }\r\n\r\n  // NPM Textures, NPM outputs\r\n  gl_FragColor = vec4(uColor.rgb, uColor.a * alpha);\r\n\r\n}\r\n"),uniforms:{uFWidth:0}}),O=vg.NORMAL_NPM);var L=new RT(I,D);L.blendMode=O,Z={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:L,vertices:null,uvs:null,indices:null}}Z.index=0,Z.indexCount=0,Z.vertexCount=0,Z.uvsCount=0,Z.total=0;var N=this._textureCache;N[R]=N[R]||new G_(V.baseTexture),Z.mesh.texture=N[R],Z.mesh.tint=this._tint,C.push(Z),P[R]=Z}P[R].total++}for(x=0;x<k.length;x++)-1===C.indexOf(k[x])&&this.removeChild(k[x].mesh);for(x=0;x<C.length;x++)C[x].mesh.parent!==this&&this.addChild(C[x].mesh);for(var x in this._activePagesMeshData=C,P){var F=(Z=P[x]).total;if(!((null===(t=Z.indices)||void 0===t?void 0:t.length)>6*F)||Z.vertices.length<2*RT.BATCHABLE_SIZE)Z.vertices=new Float32Array(8*F),Z.uvs=new Float32Array(8*F),Z.indices=new Uint16Array(6*F);else for(var B=Z.total,U=Z.vertices,G=4*B*2;G<U.length;G++)U[G]=0;Z.mesh.size=6*F}for(x=0;x<A;x++){var z,H=(z=a[x]).position.x+M[z.line]*("justify"===this._align?z.prevSpaces:1);this._roundPixels&&(H=Math.round(H));var V,j=H*i,X=z.position.y*i,W=P[(V=z.texture).baseTexture.uid],q=V.frame,Y=V._uvs,K=W.index++;W.indices[6*K+0]=0+4*K,W.indices[6*K+1]=1+4*K,W.indices[6*K+2]=2+4*K,W.indices[6*K+3]=0+4*K,W.indices[6*K+4]=2+4*K,W.indices[6*K+5]=3+4*K,W.vertices[8*K+0]=j,W.vertices[8*K+1]=X,W.vertices[8*K+2]=j+q.width*i,W.vertices[8*K+3]=X,W.vertices[8*K+4]=j+q.width*i,W.vertices[8*K+5]=X+q.height*i,W.vertices[8*K+6]=j,W.vertices[8*K+7]=X+q.height*i,W.uvs[8*K+0]=Y.x0,W.uvs[8*K+1]=Y.y0,W.uvs[8*K+2]=Y.x1,W.uvs[8*K+3]=Y.y1,W.uvs[8*K+4]=Y.x2,W.uvs[8*K+5]=Y.y2,W.uvs[8*K+6]=Y.x3,W.uvs[8*K+7]=Y.y3}for(var x in this._textWidth=f*i,this._textHeight=(r.y+e.lineHeight)*i,P){var Z=P[x];if(0!==this.anchor.x||0!==this.anchor.y)for(var J=0,Q=this._textWidth*this.anchor.x,$=this._textHeight*this.anchor.y,tt=0;tt<Z.total;tt++)Z.vertices[J++]-=Q,Z.vertices[J++]-=$,Z.vertices[J++]-=Q,Z.vertices[J++]-=$,Z.vertices[J++]-=Q,Z.vertices[J++]-=$,Z.vertices[J++]-=Q,Z.vertices[J++]-=$;this._maxLineHeight=y*i;var et=Z.mesh.geometry.getBuffer("aVertexPosition"),nt=Z.mesh.geometry.getBuffer("aTextureCoord"),it=Z.mesh.geometry.getIndex();et.data=Z.vertices,nt.data=Z.uvs,it.data=Z.indices,et.update(),nt.update(),it.update()}for(x=0;x<a.length;x++)qT.push(a[x]);this._font=e,this.dirty=!1},e.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},e.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0);var n=jT.available[this._fontName],i=n.distanceFieldRange,r=n.distanceFieldType,a=n.size;if("none"!==r)for(var o=this.worldTransform,s=o.a,l=o.b,u=o.c,h=o.d,c=Math.sqrt(s*s+l*l),d=Math.sqrt(u*u+h*h),f=(Math.abs(c)+Math.abs(d))/2,p=this.fontSize/a,v=0,m=this._activePagesMeshData;v<m.length;v++){m[v].mesh.shader.uniforms.uFWidth=f*i*p*this._resolution}t.prototype._render.call(this,e)},e.prototype.getLocalBounds=function(){return this.validate(),t.prototype.getLocalBounds.call(this)},e.prototype.validate=function(){var t=jT.available[this._fontName];if(!t)throw new Error('Missing BitmapFont "'+this._fontName+'"');this._font!==t&&(this.dirty=!0),this.dirty&&this.updateText()},Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},set:function(t){if(this._tint!==t){this._tint=t;for(var e=0;e<this._activePagesMeshData.length;e++)this._activePagesMeshData[e].mesh.tint=t}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this._fontName},set:function(t){if(!jT.available[t])throw new Error('Missing BitmapFont "'+t+'"');this._fontName!==t&&(this._fontName=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){var t;return null!==(t=this._fontSize)&&void 0!==t?t:jT.available[this._fontName].size},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anchor",{get:function(){return this._anchor},set:function(t){"number"===typeof t?this._anchor.set(t):this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null===t||void 0===t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(t){this._maxWidth!==t&&(this._maxWidth=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){t!==this._roundPixels&&(this._roundPixels=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),e.prototype.destroy=function(e){var n=this._textureCache,i="none"===jT.available[this._fontName].distanceFieldType?XT:WT;i.push.apply(i,this._activePagesMeshData);for(var r=0,a=this._activePagesMeshData;r<a.length;r++){var o=a[r];this.removeChild(o.mesh)}for(var s in this._activePagesMeshData=[],i.filter((function(t){return n[t.mesh.texture.baseTexture.uid]})).forEach((function(t){t.mesh.texture=G_.EMPTY})),n){n[s].destroy(),delete n[s]}this._font=null,this._textureCache=null,t.prototype.destroy.call(this,e)},e.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0}}(a_),function(){function t(){}return t.add=function(){ew.setExtensionXhrType("fnt",ew.XHR_RESPONSE_TYPE.TEXT)},t.use=function(e,n){var i=GT(e.data);if(i)for(var r=t.getBaseUrl(this,e),a=i.parse(e.data),o={},s=function(t){o[t.metadata.pageFile]=t.texture,Object.keys(o).length===a.page.length&&(e.bitmapFont=jT.install(a,o,!0),n())},l=0;l<a.page.length;++l){var u=a.page[l].file,h=r+u,c=!1;for(var d in this.resources){var f=this.resources[d];if(f.url===h){f.metadata.pageFile=u,f.texture?s(f):f.onAfterMiddleware.add(s),c=!0;break}}if(!c){var p={crossOrigin:e.crossOrigin,loadType:ew.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:u},e.metadata.imageMetadata),parentResource:e};this.add(h,p,s)}}else n()},t.getBaseUrl=function(e,n){var i=n.isDataUrl?"":t.dirname(n.url);return n.isDataUrl&&("."===i&&(i=""),e.baseUrl&&i&&"/"===e.baseUrl.charAt(e.baseUrl.length-1)&&(i+="/")),(i=i.replace(e.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},t.dirname=function(t){var e=t.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return e===t?".":""===e?"/":e},t.extension=o_.Loader,t}()),KT=function(t,e){return KT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},KT(t,e)};!function(t){function e(e){void 0===e&&(e=1);var n=t.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}","varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",{uAlpha:1})||this;return n.alpha=e,n}(function(t,e){function n(){this.constructor=t}KT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0})}(Gx);var ZT=function(t,e){return ZT=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},ZT(t,e)};function JT(t,e){function n(){this.constructor=t}ZT(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var QT={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},$T=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");var tM=function(t){function e(e,n,i,r,a){void 0===n&&(n=8),void 0===i&&(i=4),void 0===r&&(r=ty.FILTER_RESOLUTION),void 0===a&&(a=5);var o=this,s=function(t,e){var n,i=Math.ceil(t/2),r="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",a="";n=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var o=0;o<t;o++){var s=n.replace("%index%",o.toString());a+=s=s.replace("%sampleIndex%",o-(i-1)+".0"),a+="\n"}return(r=r.replace("%blur%",a)).replace("%size%",t.toString())}(a,e),l=function(t){for(var e,n=QT[t],i=n.length,r=$T,a="",o=0;o<t;o++){var s="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",o.toString());e=o,o>=i&&(e=t-o-1),a+=s=s.replace("%value%",n[e].toString()),a+="\n"}return(r=r.replace("%blur%",a)).replace("%size%",t.toString())}(a);return(o=t.call(this,s,l)||this).horizontal=e,o.resolution=r,o._quality=0,o.quality=i,o.blur=n,o}return JT(e,t),e.prototype.apply=function(t,e,n,i){if(n?this.horizontal?this.uniforms.strength=1/n.width*(n.width/e.width):this.uniforms.strength=1/n.height*(n.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,n,i);else{var r=t.getFilterTexture(),a=t.renderer,o=e,s=r;this.state.blend=!1,t.applyFilter(this,o,s,Mg.CLEAR);for(var l=1;l<this.passes-1;l++){t.bindAndClear(o,Mg.BLIT),this.uniforms.uSampler=s;var u=s;s=o,o=u,a.shader.bind(this),a.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,s,n,i),t.returnFilterTexture(r)}},Object.defineProperty(e.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),e}(Gx),eM=(function(t){function e(e,n,i,r){void 0===e&&(e=8),void 0===n&&(n=4),void 0===i&&(i=ty.FILTER_RESOLUTION),void 0===r&&(r=5);var a=t.call(this)||this;return a.blurXFilter=new tM(!0,e,n,i,r),a.blurYFilter=new tM(!1,e,n,i,r),a.resolution=i,a.quality=n,a.blur=e,a.repeatEdgePixels=!1,a}JT(e,t),e.prototype.apply=function(t,e,n,i){var r=Math.abs(this.blurXFilter.strength),a=Math.abs(this.blurYFilter.strength);if(r&&a){var o=t.getFilterTexture();this.blurXFilter.apply(t,e,o,Mg.CLEAR),this.blurYFilter.apply(t,o,n,i),t.returnFilterTexture(o)}else a?this.blurYFilter.apply(t,e,n,i):this.blurXFilter.apply(t,e,n,i)},e.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(e.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0})}(Gx),function(t,e){return eM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},eM(t,e)});var nM=function(t){function e(){var e=this,n={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(e=t.call(this,_b,"varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",n)||this).alpha=1,e}return function(t,e){function n(){this.constructor=t}eM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype._loadMatrix=function(t,e){void 0===e&&(e=!1);var n=t;e&&(this._multiply(n,this.uniforms.m,t),n=this._colorMatrix(n)),this.uniforms.m=n},e.prototype._multiply=function(t,e,n){return t[0]=e[0]*n[0]+e[1]*n[5]+e[2]*n[10]+e[3]*n[15],t[1]=e[0]*n[1]+e[1]*n[6]+e[2]*n[11]+e[3]*n[16],t[2]=e[0]*n[2]+e[1]*n[7]+e[2]*n[12]+e[3]*n[17],t[3]=e[0]*n[3]+e[1]*n[8]+e[2]*n[13]+e[3]*n[18],t[4]=e[0]*n[4]+e[1]*n[9]+e[2]*n[14]+e[3]*n[19]+e[4],t[5]=e[5]*n[0]+e[6]*n[5]+e[7]*n[10]+e[8]*n[15],t[6]=e[5]*n[1]+e[6]*n[6]+e[7]*n[11]+e[8]*n[16],t[7]=e[5]*n[2]+e[6]*n[7]+e[7]*n[12]+e[8]*n[17],t[8]=e[5]*n[3]+e[6]*n[8]+e[7]*n[13]+e[8]*n[18],t[9]=e[5]*n[4]+e[6]*n[9]+e[7]*n[14]+e[8]*n[19]+e[9],t[10]=e[10]*n[0]+e[11]*n[5]+e[12]*n[10]+e[13]*n[15],t[11]=e[10]*n[1]+e[11]*n[6]+e[12]*n[11]+e[13]*n[16],t[12]=e[10]*n[2]+e[11]*n[7]+e[12]*n[12]+e[13]*n[17],t[13]=e[10]*n[3]+e[11]*n[8]+e[12]*n[13]+e[13]*n[18],t[14]=e[10]*n[4]+e[11]*n[9]+e[12]*n[14]+e[13]*n[19]+e[14],t[15]=e[15]*n[0]+e[16]*n[5]+e[17]*n[10]+e[18]*n[15],t[16]=e[15]*n[1]+e[16]*n[6]+e[17]*n[11]+e[18]*n[16],t[17]=e[15]*n[2]+e[16]*n[7]+e[17]*n[12]+e[18]*n[17],t[18]=e[15]*n[3]+e[16]*n[8]+e[17]*n[13]+e[18]*n[18],t[19]=e[15]*n[4]+e[16]*n[9]+e[17]*n[14]+e[18]*n[19]+e[19],t},e.prototype._colorMatrix=function(t){var e=new Float32Array(t);return e[4]/=255,e[9]/=255,e[14]/=255,e[19]/=255,e},e.prototype.brightness=function(t,e){var n=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.tint=function(t,e){var n=[(t>>16&255)/255,0,0,0,0,0,(t>>8&255)/255,0,0,0,0,0,(255&t)/255,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.greyscale=function(t,e){var n=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,e){t=(t||0)/180*Math.PI;var n=Math.cos(t),i=Math.sin(t),r=1/3,a=(0,Math.sqrt)(r),o=[n+(1-n)*r,r*(1-n)-a*i,r*(1-n)+a*i,0,0,r*(1-n)+a*i,n+r*(1-n),r*(1-n)-a*i,0,0,r*(1-n)-a*i,r*(1-n)+a*i,n+r*(1-n),0,0,0,0,0,1,0];this._loadMatrix(o,e)},e.prototype.contrast=function(t,e){var n=(t||0)+1,i=-.5*(n-1),r=[n,0,0,0,i,0,n,0,0,i,0,0,n,0,i,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.saturate=function(t,e){void 0===t&&(t=0);var n=2*t/3+1,i=-.5*(n-1),r=[n,i,i,0,0,i,n,i,0,0,i,i,n,0,0,0,0,0,1,0];this._loadMatrix(r,e)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,e,n,i,r){var a=((n=n||16770432)>>16&255)/255,o=(n>>8&255)/255,s=(255&n)/255,l=((i=i||3375104)>>16&255)/255,u=(i>>8&255)/255,h=(255&i)/255,c=[.3,.59,.11,0,0,a,o,s,t=t||.2,0,l,u,h,e=e||.15,0,a-l,o-u,s-h,0,0];this._loadMatrix(c,r)},e.prototype.night=function(t,e){var n=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.predator=function(t,e){var n=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(n,e)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(Gx);nM.prototype.grayscale=nM.prototype.greyscale;var iM=function(t,e){return iM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},iM(t,e)};!function(t){function e(e,n){var i=this,r=new Vy;return e.renderable=!1,(i=t.call(this,"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,i.maskMatrix=r,null!==n&&void 0!==n||(n=20),i.scale=new Ly(n,n),i}(function(t,e){function n(){this.constructor=t}iM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.apply=function(t,e,n,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var r=this.maskSprite.worldTransform,a=Math.sqrt(r.a*r.a+r.b*r.b),o=Math.sqrt(r.c*r.c+r.d*r.d);0!==a&&0!==o&&(this.uniforms.rotation[0]=r.a/a,this.uniforms.rotation[1]=r.b/a,this.uniforms.rotation[2]=r.c/o,this.uniforms.rotation[3]=r.d/o),t.applyFilter(this,e,n,i)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0})}(Gx);var rM=function(t,e){return rM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},rM(t,e)};!function(t){function e(){return t.call(this,"\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputSize;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n')||this}(function(t,e){function n(){this.constructor=t}rM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t)}(Gx);var aM=function(t,e){return aM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},aM(t,e)};!function(t){function e(e,n){void 0===e&&(e=.5),void 0===n&&(n=Math.random());var i=t.call(this,_b,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",{uNoise:0,uSeed:0})||this;return i.noise=e,i.seed=n,i}(function(t,e){function n(){this.constructor=t}aM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),Object.defineProperty(e.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(t){this.uniforms.uNoise=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(t){this.uniforms.uSeed=t},enumerable:!1,configurable:!0})}(Gx);var oM=new Vy;n_.prototype._cacheAsBitmap=!1,n_.prototype._cacheData=null,n_.prototype._cacheAsBitmapResolution=null,n_.prototype._cacheAsBitmapMultisample=kg.NONE;var sM=function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null};Object.defineProperties(n_.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(t){t!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(t){t!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=t,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var e;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new sM),(e=this._cacheData).originalRender=this.render,e.originalRenderCanvas=this.renderCanvas,e.originalUpdateTransform=this.updateTransform,e.originalCalculateBounds=this.calculateBounds,e.originalGetLocalBounds=this.getLocalBounds,e.originalDestroy=this.destroy,e.originalContainsPoint=this.containsPoint,e.originalMask=this._mask,e.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((e=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=e.originalRender,this.renderCanvas=e.originalRenderCanvas,this.calculateBounds=e.originalCalculateBounds,this.getLocalBounds=e.originalGetLocalBounds,this.destroy=e.originalDestroy,this.updateTransform=e.originalUpdateTransform,this.containsPoint=e.originalContainsPoint,this._mask=e.originalMask,this.filterArea=e.originalFilterArea))}}}),n_.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},n_.prototype._initCachedDisplayObject=function(t){var e;if(!this._cacheData||!this._cacheData.sprite){var n=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var r=this.filters[0].padding;i.pad(r)}i.ceil(ty.RESOLUTION);var a=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),s=t.renderTexture.destinationFrame.clone(),l=t.projection.transform,u=z_.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:null!==(e=this.cacheAsBitmapMultisample)&&void 0!==e?e:t.multisample}),h="cacheAsBitmap_"+wy();this._cacheData.textureCacheId=h,S_.addToCache(u.baseTexture,h),G_.addToCache(u,h);var c=this.transform.localTransform.copyTo(oM).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:u,clear:!0,transform:c,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=l,t.renderTexture.bind(a,o,s),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var d=new WS(u);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-i.x/i.width,d.anchor.y=-i.y/i.height,d.alpha=n,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)}},n_.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},n_.prototype._initCachedDisplayObjectCanvas=function(t){if(!this._cacheData||!this._cacheData.sprite){var e=this.getLocalBounds(null,!0),n=this.alpha;this.alpha=1;var i=t.context,r=t._projTransform;e.ceil(ty.RESOLUTION);var a=z_.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+wy();this._cacheData.textureCacheId=o,S_.addToCache(a.baseTexture,o),G_.addToCache(a,o);var s=oM;this.transform.localTransform.copyTo(s),s.invert(),s.tx-=e.x,s.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:s,skipUpdateTransform:!1}),t.context=i,t._projTransform=r,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=n;var l=new WS(a);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-e.x/e.width,l.anchor.y=-e.y/e.height,l.alpha=n,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)}},n_.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},n_.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},n_.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,S_.removeFromCache(this._cacheData.textureCacheId),G_.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},n_.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)},n_.prototype.name=null,a_.prototype.getChildByName=function(t,e){for(var n=0,i=this.children.length;n<i;n++)if(this.children[n].name===t)return this.children[n];if(e)for(n=0,i=this.children.length;n<i;n++){var r=this.children[n];if(r.getChildByName){var a=r.getChildByName(t,!0);if(a)return a}}return null},n_.prototype.getGlobalPosition=function(t,e){return void 0===t&&(t=new Ly),void 0===e&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};var lM=function(){function t(){}return t.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame((function(){return e.resize()})))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){var t,n;if(e.cancelResize(),e._resizeTo===globalThis.window)t=globalThis.innerWidth,n=globalThis.innerHeight;else{var i=e._resizeTo;t=i.clientWidth,n=i.clientHeight}e.renderer.resize(t,n)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},t.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},t.extension=o_.Application,t}(),uM=function(){function t(e){var n=this;this.stage=new a_,e=Object.assign({forceCanvas:!1},e),this.renderer=function(t){return yb.create(t)}(e),t._plugins.forEach((function(t){t.init.call(n,e)}))}return t.registerPlugin=function(t){Ty("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),h_.add({type:o_.Application,ref:t})},t.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(t.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),t.prototype.destroy=function(e,n){var i=this,r=t._plugins.slice(0);r.reverse(),r.forEach((function(t){t.destroy.call(i)})),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null},t._plugins=[],t}();h_.handleByList(o_.Application,uM._plugins),h_.add(lM);var hM=function(t,e){return hM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},hM(t,e)};function cM(t,e){function n(){this.constructor=t}hM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var dM=function(t){function e(e,n,i,r){void 0===e&&(e=100),void 0===n&&(n=100),void 0===i&&(i=10),void 0===r&&(r=10);var a=t.call(this)||this;return a.segWidth=i,a.segHeight=r,a.width=e,a.height=n,a.build(),a}return cM(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],n=[],i=[],r=this.segWidth-1,a=this.segHeight-1,o=this.width/r,s=this.height/a,l=0;l<t;l++){var u=l%this.segWidth,h=l/this.segWidth|0;e.push(u*o,h*s),n.push(u/r,h/a)}var c=r*a;for(l=0;l<c;l++){var d=l%r,f=l/r|0,p=f*this.segWidth+d,v=f*this.segWidth+d+1,m=(f+1)*this.segWidth+d,g=(f+1)*this.segWidth+d+1;i.push(p,v,m,v,g,m)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint16Array(i),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(DT),fM=function(t){function e(e,n,i){void 0===e&&(e=200),void 0===i&&(i=0);var r=t.call(this,new Float32Array(4*n.length),new Float32Array(4*n.length),new Uint16Array(6*(n.length-1)))||this;return r.points=n,r._width=e,r.textureScale=i,r.build(),r}return cM(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),n=this.getBuffer("aTextureCoord"),i=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),n.data=new Float32Array(4*t.length),i.data=new Uint16Array(6*(t.length-1)));var r=n.data,a=i.data;r[0]=0,r[1]=0,r[2]=0,r[3]=1;for(var o=0,s=t[0],l=this._width*this.textureScale,u=t.length,h=0;h<u;h++){var c=4*h;if(this.textureScale>0){var d=s.x-t[h].x,f=s.y-t[h].y,p=Math.sqrt(d*d+f*f);s=t[h],o+=p/l}else o=h/(u-1);r[c]=o,r[c+1]=0,r[c+2]=o,r[c+3]=1}var v=0;for(h=0;h<u-1;h++){c=2*h;a[v++]=c,a[v++]=c+1,a[v++]=c+2,a[v++]=c+2,a[v++]=c+1,a[v++]=c+3}n.update(),i.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,n=t[0],i=0,r=0,a=this.buffers[0].data,o=t.length,s=0;s<o;s++){var l=t[s],u=4*s;r=-((e=s<t.length-1?t[s+1]:l).x-n.x),i=e.y-n.y;var h=Math.sqrt(i*i+r*r),c=this.textureScale>0?this.textureScale*this._width/2:this._width/2;i/=h,r/=h,i*=c,r*=c,a[u]=l.x+i,a[u+1]=l.y+r,a[u+2]=l.x-i,a[u+3]=l.y-r,n=l}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(DT),pM=(function(t){function e(e,n,i){void 0===i&&(i=0);var r=this,a=new fM(e.height,n,i),o=new IT(e);return i>0&&(e.baseTexture.wrapMode=wg.REPEAT),(r=t.call(this,a,o)||this).autoUpdate=!0,r}cM(e,t),e.prototype._render=function(e){var n=this.geometry;(this.autoUpdate||n._width!==this.shader.texture.height)&&(n._width=this.shader.texture.height,n.update()),t.prototype._render.call(this,e)}}(RT),function(t){function e(e,n,i){var r=this,a=new dM(e.width,e.height,n,i),o=new IT(G_.WHITE);return(r=t.call(this,a,o)||this).texture=e,r.autoResize=!0,r}return cM(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry,e=this.shader.texture,n=e.width,i=e.height;!this.autoResize||t.width===n&&t.height===i||(t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build())},Object.defineProperty(e.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),t.prototype._render.call(this,e)},e.prototype.destroy=function(e){this.shader.texture.off("update",this.textureUpdated,this),t.prototype.destroy.call(this,e)},e}(RT)),vM=(function(t){function e(e,n,i,r,a){void 0===e&&(e=G_.EMPTY);var o=this,s=new DT(n,i,r);s.getBuffer("aVertexPosition").static=!1;var l=new IT(e);return(o=t.call(this,s,l,null,a)||this).autoUpdate=!0,o}cM(e,t),Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype._render=function(e){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),t.prototype._render.call(this,e)}}(RT),function(t){function e(e,n,i,r,a){void 0===n&&(n=10),void 0===i&&(i=10),void 0===r&&(r=10),void 0===a&&(a=10);var o=t.call(this,G_.WHITE,4,4)||this;return o._origWidth=e.orig.width,o._origHeight=e.orig.height,o._width=o._origWidth,o._height=o._origHeight,o._leftWidth=n,o._rightWidth=r,o._topHeight=i,o._bottomHeight=a,o.texture=e,o}return cM(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,n=this._topHeight+this._bottomHeight,i=this._height>n?1:this._height/n;return Math.min(e,i)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var n=1/this._origWidth,i=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=n*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-n*this._rightWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(pM)),mM=function(t,e){return mM=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},mM(t,e)};!function(t){function e(e,n){void 0===n&&(n=!0);var i=t.call(this,e[0]instanceof G_?e[0]:e[0].texture)||this;return i._textures=null,i._durations=null,i._autoUpdate=n,i._isConnectedToTicker=!1,i.animationSpeed=1,i.loop=!0,i.updateAnchor=!1,i.onComplete=null,i.onFrameChange=null,i.onLoop=null,i._currentTime=0,i._playing=!1,i._previousFrame=null,i.textures=e,i}(function(t,e){function n(){this.constructor=t}mM(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)})(e,t),e.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(f_.shared.remove(this.update,this),this._isConnectedToTicker=!1))},e.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(f_.shared.add(this.update,this,l_.HIGH),this._isConnectedToTicker=!0))},e.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},e.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},e.prototype.update=function(t){if(this._playing){var e=this.animationSpeed*t,n=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var r=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*r,this._currentTime+=r;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):n!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<n||this.animationSpeed<0&&this.currentFrame>n)&&this.onLoop(),this.updateTexture())}},e.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},e.prototype.destroy=function(e){this.stop(),t.prototype.destroy.call(this,e),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},e.fromFrames=function(t){for(var n=[],i=0;i<t.length;++i)n.push(G_.from(t[i]));return new e(n)},e.fromImages=function(t){for(var n=[],i=0;i<t.length;++i)n.push(G_.from(t[i]));return new e(n)},Object.defineProperty(e.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textures",{get:function(){return this._textures},set:function(t){if(t[0]instanceof G_)this._textures=t,this._durations=null;else{this._textures=[],this._durations=[];for(var e=0;e<t.length;e++)this._textures.push(t[e].texture),this._durations.push(t[e].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(f_.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(f_.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0})}(WS);h_.add(Lb,Xb,Vb,dS,gT,Cb,MT,YT,Sw,aS,oS,_T,p_,lw);var gM=Tp.registerPlugin(Vv)||Tp,yM=(gM.core.Tween,function t(){var e=0,n=document.createElement("div");function i(t){return n.appendChild(t.dom),t}function r(t){for(var i=0;i<n.children.length;i++)n.children[i].style.display=i===t?"block":"none";e=t}n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(t){t.preventDefault(),r(++e%n.children.length)}),!1);var a=(performance||Date).now(),o=a,s=0,l=i(new t.Panel("FPS","#0ff","#002")),u=i(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=i(new t.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:n,addPanel:i,showPanel:r,begin:function(){a=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(u.update(t-a,200),t>=o+1e3&&(l.update(1e3*s/(t-o),100),o=t,s=0,h)){var e=performance.memory;h.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){a=this.end()},domElement:n,setMode:r}});yM.Panel=function(t,e,n){var i=1/0,r=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,l=48*o,u=3*o,h=2*o,c=3*o,d=15*o,f=74*o,p=30*o,v=document.createElement("canvas");v.width=s,v.height=l,v.style.cssText="width:80px;height:48px";var m=v.getContext("2d");return m.font="bold "+9*o+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=n,m.fillRect(0,0,s,l),m.fillStyle=e,m.fillText(t,u,h),m.fillRect(c,d,f,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(c,d,f,p),{dom:v,update:function(l,g){i=Math.min(i,l),r=Math.max(r,l),m.fillStyle=n,m.globalAlpha=1,m.fillRect(0,0,s,d),m.fillStyle=e,m.fillText(a(l)+" "+t+" ("+a(i)+"-"+a(r)+")",u,h),m.drawImage(v,c+o,d,f-o,p,c,d,f-o,p),m.fillRect(c+f-o,d,o,p),m.fillStyle=n,m.globalAlpha=.9,m.fillRect(c+f-o,d,o,a((1-l/g)*p))}}};var _M=yM,xM={rotateSpeed:.008*Math.PI,keyRotateSpeed:2,shieldKeyCode:67,arrowKeyCode:66,happyTimeShowed:!1,startedBestScore:0,ambientLightColor:"#999999",ambientLightIntensity:.8,directLightLightColor:"#ffffff",directLightIntensity:.6,pointLightLightColor:"#ffffff",pointLightIntensity:1.2,pointLightDistance:20,cameraX:0,cameraY:7,cameraZ:-11,lookAtY:-5,cameraFov:67,cameraZoom:1.2,initialXScale:.6,initialYScale:.6,bounceYPos:2.4,movementCircleDurationLimit:.17,initMovementCircleDuration:.38,movementCircleDuration:.38,movementCircleDurationAccCoef:2e-5,gravitationalAccelerationLimit:50,initGravitationalAcceleration:8,gravitationalAcceleration:8,gravitationalAccelerationAccCoef:1.0002,initialVelocity:10,timeForMaxVelocity:2,timeForShield:10,oldSkinNameList:["Angle","BigBall","Dad","Devil","Mask","Spike","Torus"],basicSkinList:[{name:"Barrel",scale:.5},{name:"Basketball",scale:.3},{name:"Beachball",scale:.17},{name:"ChickenBucket",scale:.2},{name:"DinoEgg",scale:.2},{name:"HumanEye",scale:.3},{name:"Football",scale:.3},{name:"LegoHead",scale:.25},{name:"Shield",scale:.4}],rareSkinList:[{name:"Baseball",scale:.3},{name:"Cube",scale:.25},{name:"Gyroscope",scale:.15},{name:"Mandalorian",scale:.3},{name:"Minion",scale:.3},{name:"Mushroom",scale:.3},{name:"Powerball",scale:.18},{name:"Smiley",scale:.25},{name:"Planet",scale:.17}],funkySkinList:[{name:"Apple",scale:.2},{name:"Bottle",scale:.5},{name:"Chest",scale:.25},{name:"RubberDuck",scale:.12},{name:"Fish",scale:.14},{name:"Gem",scale:.3},{name:"Pacman",scale:.3},{name:"Pokeball",scale:.3},{name:"Pumpkin",scale:.35}],epicSkinList:[{name:"SprinkleBall",scale:.26},{name:"Frame",scale:.17},{name:"MoonMeteor",scale:.15},{name:"Gear",scale:.3},{name:"Fog",scale:.3},{name:"Rainbow",scale:.27},{name:"Skull",scale:.28},{name:"Spiral",scale:.15},{name:"Star",scale:.15}],chestSkinList:[{name:"Bone",scale:.2},{name:"Dice",scale:.4},{name:"Heart",scale:1},{name:"Steve",scale:.25},{name:"Shoe",scale:.11},{name:"Teddy",scale:.2},{name:"Tennisball",scale:.25},{name:"Volleyball",scale:.25},{name:"Wheel",scale:.17}],chunkSplitMin:6,chunkSplitMax:12,losePiece:10,normalPiece:11,platformPieceType:[{type:10},{type:11}],platformOffset:4,platformYScale:1.4,loopIndexLimitId:2,levelGenerator:[{level:0,count:5},{level:1,count:6},{level:2,count:2},{level:1,count:8},{level:2,count:9},{level:3,count:2},{level:1,count:5},{level:2,count:6},{level:0,count:8},{level:3,count:3},{level:1,count:4},{level:2,count:8},{level:1,count:2},{level:3,count:4},{level:1,count:2},{level:2,count:10},{level:1,count:2},{level:3,count:12},{level:0,count:8},{level:2,count:8},{level:3,count:20}],gameColors:[{losePlatformColor:"#EC4428",losePlatformSpecularColor:"#FF6D6D",normalPlatformColor:"#313131",normalPlatformSpecularColor:"#989898",tubeColor:"#E7E7E7",tubeSpecularColor:"#FFFFFF",ballColorNormal:"#ECBE28",ballSpecularColorNormal:"#FFC46D",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFFFFF, #2D2D2D)"},{losePlatformColor:"#EC6D28",losePlatformSpecularColor:"#FFAC6D",normalPlatformColor:"#596392",normalPlatformSpecularColor:"#92FAFF",tubeColor:"#D4D29F",tubeSpecularColor:"#FAFFCA",ballColorNormal:"#3BB6DF",ballSpecularColorNormal:"#81D2EC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFF0BF, #4F34A5)"},{losePlatformColor:"#FF6C1A",losePlatformSpecularColor:"#FF6335",normalPlatformColor:"#FFDE57",normalPlatformSpecularColor:"#FDFF9D",tubeColor:"#FCED97",tubeSpecularColor:"#FFF8D1",ballColorNormal:"#BFCD40",ballSpecularColorNormal:"#DCEC2D",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#F8FFBC, #97A92B)"},{losePlatformColor:"#D83C60",losePlatformSpecularColor:"#FF358D",normalPlatformColor:"#893D6B",normalPlatformSpecularColor:"#853F52",tubeColor:"#DF8A78",tubeSpecularColor:"#FFBDAC",ballColorNormal:"#FF583D",ballSpecularColorNormal:"#FF8948",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFBA94, #267070)"},{losePlatformColor:"#FBD91A",losePlatformSpecularColor:"#FFD54B",normalPlatformColor:"#8AC10B",normalPlatformSpecularColor:"#B2FF94",tubeColor:"#A8E5CC",tubeSpecularColor:"#CEFFE7",ballColorNormal:"#6955D6",ballSpecularColorNormal:"#868CFD",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#F6A5FF, #178779)"},{losePlatformColor:"#F6583D",losePlatformSpecularColor:"#FD6565",normalPlatformColor:"#453F3D",normalPlatformSpecularColor:"#706363",tubeColor:"#D28449",tubeSpecularColor:"#FFE692",ballColorNormal:"#D0DADD",ballSpecularColorNormal:"#FFFFFF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#E0E188, #4E988C)"},{losePlatformColor:"#FB92C0",losePlatformSpecularColor:"#FFC5DE",normalPlatformColor:"#4BBEF8",normalPlatformSpecularColor:"#74D8E1",tubeColor:"#CFE9FB",tubeSpecularColor:"#DAF3FF",ballColorNormal:"#1F2772",ballSpecularColorNormal:"#33518B",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#F8D6FF, #422F8E)"},{losePlatformColor:"#F05E00",losePlatformSpecularColor:"#FF9E60",normalPlatformColor:"#FFBA26",normalPlatformSpecularColor:"#FFEF70",tubeColor:"#FBF3CF",tubeSpecularColor:"#FDFFDA",ballColorNormal:"#1F2122",ballSpecularColorNormal:"#303335",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFF287, #AC5F42)"},{losePlatformColor:"#F96B1D",losePlatformSpecularColor:"#FD9A65",normalPlatformColor:"#FFE4B4",normalPlatformSpecularColor:"#FFF7CC",tubeColor:"#40295C",tubeSpecularColor:"#523C81",ballColorNormal:"#CB94F6",ballSpecularColorNormal:"#C596FF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#201751, #FBBC83)"},{losePlatformColor:"#BC8EFF",losePlatformSpecularColor:"#FF8FF3",normalPlatformColor:"#A7E5F9",normalPlatformSpecularColor:"#FFFBF2",tubeColor:"#FBF3CF",tubeSpecularColor:"#FDFFDA",ballColorNormal:"#383838",ballSpecularColorNormal:"#C515151",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFF0BF, #C6F5F9)"},{losePlatformColor:"#6CCBF2",losePlatformSpecularColor:"#6CCBF2",normalPlatformColor:"#493A78",normalPlatformSpecularColor:"#FFFBF2",tubeColor:"#7961C5",tubeSpecularColor:"#AA96EA",ballColorNormal:"#D4E7F2",ballSpecularColorNormal:"#FFFFFF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#C7BFFF, #FDEBC5)"},{losePlatformColor:"#F27A6C",losePlatformSpecularColor:"#F27A6C",normalPlatformColor:"#FFFFFF",normalPlatformSpecularColor:"#FFFBF2",tubeColor:"#F2D68D",tubeSpecularColor:"#FFEAB4",ballColorNormal:"#51A8DB",ballSpecularColorNormal:"#75BFEA",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#6C2A76, #78B0DF)"}],gameColorsAsmr:[{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#FFDC40",normalPlatformSpecularColor:"#F19D35",tubeColor:"#F5F2F2",tubeSpecularColor:"#F8F8F8",ballColorNormal:"#00ABFF",ballSpecularColorNormal:"#66E2FF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#A4CAE0, #ED98F3)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#F85651",normalPlatformSpecularColor:"#FF9C96",tubeColor:"#FFFFFF",tubeSpecularColor:"#FFFFFF",ballColorNormal:"#FF753D",ballSpecularColorNormal:"#FFAFAC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFF0BF, #4F34A5)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#FFAC40",normalPlatformSpecularColor:"#F8B25C",tubeColor:"#FFFFFF",tubeSpecularColor:"#FFFFFF",ballColorNormal:"#26D5F3",ballSpecularColorNormal:"#66E2FF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFFFFF, #4DD9D9)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#5CA7FF",normalPlatformSpecularColor:"#7D5FFF",tubeColor:"#FFFFFF",tubeSpecularColor:"#FFFFFF",ballColorNormal:"#FFBF3D",ballSpecularColorNormal:"#FFE4AC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFFFFF, #E9CFF5)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#FF9955",normalPlatformSpecularColor:"#FFB896",tubeColor:"#C98FFF",tubeSpecularColor:"#E3C4FF",ballColorNormal:"#FFBF3D",ballSpecularColorNormal:"#FFE4AC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#FFFDFB, #FFF6C4)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#6AF851",normalPlatformSpecularColor:"#9BFF96",tubeColor:"#8FD2FF",tubeSpecularColor:"#C4FAFF",ballColorNormal:"#FF753D",ballSpecularColorNormal:"#FFAFAC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#E7E7E7, #FFDFF7)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#519BF8",normalPlatformSpecularColor:"#96DCFF",tubeColor:"#8FD2FF",tubeSpecularColor:"#C4FAFF",ballColorNormal:"#FF753D",ballSpecularColorNormal:"#FFAFAC",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#E7E7E7, #FFDFF7)"},{losePlatformColor:"#B02A2A",losePlatformSpecularColor:"#E75D5D",normalPlatformColor:"#FFAC40",normalPlatformSpecularColor:"#F8D25C",tubeColor:"#F5F2F2",tubeSpecularColor:"#F8F8F8",ballColorNormal:"#00ABFF",ballSpecularColorNormal:"#66E2FF",ballColorFire:"#ff0000",backgroundGradient:"linear-gradient(#ED98F3, #A4CAE0)"}]},bM={level_00:[{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],level:3,randomRotation:.6},{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],level:3,randomRotation:.3},{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],level:3,randomRotation:.4},{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],level:3,randomRotation:.2}],level_01:[{count:23,rotation:[0,1,2,3,4,5,6,7,8,9,10,16,17,18,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0],level:0,randomRotation:5.6},{count:21,rotation:[1,2,3,4,5,6,7,8,9,10,16,17,18,19,20,21,22,23,24,25,26],type:[1,1,1,1,0,0,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0],level:0,randomRotation:5.1},{count:20,rotation:[1,2,3,4,5,6,7,8,9,10,16,17,18,19,20,21,22,23,24,25],type:[1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1,1,1,1],level:0,randomRotation:0},{count:24,rotation:[0,1,2,3,4,5,6,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26],type:[1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0],level:0,randomRotation:.3},{count:25,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,19,20,21,22,23,24,25,26,27],type:[1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1],level:0,randomRotation:12.4},{count:25,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,19,20,21,22,23,24,25,26,27],type:[1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,1],level:0,randomRotation:11.4},{count:23,rotation:[0,1,2,3,4,8,9,10,11,12,13,14,15,16,17,18,22,23,24,25,26,27,28],type:[1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1,1],level:0,randomRotation:22.3},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1],level:2,randomRotation:8.9}],level_02:[{count:24,rotation:[0,1,2,3,4,5,6,7,8,9,10,16,17,18,19,20,21,22,23,24,25,26,27,28],type:[0,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0],level:1,randomRotation:1.6},{count:24,rotation:[0,1,2,3,4,5,6,7,8,9,10,16,17,18,19,20,21,22,23,24,25,26,27,28],type:[0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0],level:1,randomRotation:2.3},{count:23,rotation:[0,1,2,3,4,5,6,7,8,12,13,14,15,16,17,18,19,20,24,25,26,27,28],type:[1,1,1,1,0,0,1,1,1,1,1,1,0,0,1,1,1,0,1,1,1,0,0],level:1,randomRotation:5.3},{count:25,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,19,20,21,22,23,24,25,26,27],type:[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,1,0,0],level:1,randomRotation:22.4},{count:25,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,19,20,21,22,23,24,25,26,27],type:[1,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,1,1,1],level:1,randomRotation:12.9},{count:23,rotation:[0,1,2,3,4,5,9,10,11,12,13,14,15,16,17,18,19,23,24,25,26,27,28],type:[0,0,0,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,0,1,1,0],level:1,randomRotation:7.3},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],level:2,randomRotation:8.9},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0],level:2,randomRotation:3.7}],level_03:[{count:21,rotation:[0,1,2,3,4,5,6,7,12,13,14,15,20,21,22,23,24,25,26,27,28],type:[0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1],level:2,randomRotation:10.3},{count:21,rotation:[0,1,2,3,4,5,6,7,12,13,14,15,20,21,22,23,24,25,26,27,28],type:[0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1],level:2,randomRotation:1.5},{count:24,rotation:[0,1,2,3,4,5,6,7,12,13,14,15,20,21,22,23,24,25,26,27,28,29,30,31],type:[0,0,1,1,1,1,0,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1],level:2,randomRotation:2.8},{count:24,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,20,21,22,23,24,25,26,27,28],type:[0,1,1,1,0,0,1,1,1,0,0,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,1,1,1],level:2,randomRotation:1.7},{count:24,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,20,21,22,23,24,25,26,27,28],type:[0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,1,1,1,0,0,1,1,1,1,1,1,1,1],level:2,randomRotation:10.3},{count:24,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,20,21,22,23,24,25,26,27,28],type:[0,1,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0],level:2,randomRotation:7.3},{count:27,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],type:[0,0,1,1,1,0,0,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1,0,0,1,1,1,1],level:2,randomRotation:2.79},{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,0,0,1,1,1,0,0,0,1,1],level:2,randomRotation:1.9},{count:28,rotation:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],type:[0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,0,0,1,1,1,0,0,0,1,1],level:2,randomRotation:17.3},{count:18,rotation:[0,1,2,3,4,5,10,11,12,13,14,15,20,21,22,23,24,25],type:[0,0,0,1,1,1,0,0,0,1,1,1,0,0,0,1,1,1],level:2,randomRotation:0},{count:18,rotation:[0,1,2,3,4,5,10,11,12,13,14,15,20,21,22,23,24,25],type:[1,1,1,0,0,0,1,1,1,0,0,0,1,1,1,0,0,0],level:2,randomRotation:.8},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],level:2,randomRotation:.3},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0],level:2,randomRotation:2.5},{count:16,rotation:[0,1,2,3,8,9,10,11,16,17,18,19,24,25,26,27],type:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],level:2,randomRotation:2.2}]},wM=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this))._setupHelpers(),i}return s(n,[{key:"build",value:function(){this._createAmbientLight(),this._createDirectionalLight(),this._addToScene()}},{key:"_createAmbientLight",value:function(){this._aLight=new eu(new ve(xM.ambientLightColor),xM.ambientLightIntensity),this._aLight.position.x=10,this._aLight.position.y=10,this._aLight.position.z=10}},{key:"_createDirectionalLight",value:function(){this._pointLight=new Ql(new ve(xM.pointLightLightColor),xM.pointLightIntensity,xM.pointLightDistance),this._pointLight.position.set(0,-10,-15),this._directLight=new tu(new ve(xM.directLightLightColor),xM.directLightIntensity),this._directLight.position.set(-1,6,-3)}},{key:"_setupHelpers",value:function(){}},{key:"_addToScene",value:function(){this.add(this._aLight,this._pointLight,this._directLight)}},{key:"update",value:function(t){}}]),n}(Cn),SM=function(t){d(n,t);var e=m(n);function n(t){return a(this,n),e.call(this)}return s(n,[{key:"build",value:function(){var t=new Ps(1.2,1.2,180,20,1),e=new cl({side:2,color:JM.gameColors.tubeColor,emissive:JM.gameColors.tubeColor,emissiveIntensity:.3});this._tube=new bi(t,e),this._tube.position.set(0,0,0),this.add(this._tube)}},{key:"changeColor",value:function(){}},{key:"updateColor",value:function(){this._tube.material.color.set(JM.gameColors.tubeColor)}},{key:"update",value:function(t){}}]),n}(Cn),TM=function(){function t(){a(this,t),this.DEG2RAD=.0174533,this.RAD2DEG=57.2958}return s(t,[{key:"rand",value:function(t,e){return Math.random()*(e-t)+t}},{key:"randomNum",value:function(t,e){switch(arguments.length){case 1:return parseInt(Math.random()*t+1,10);case 2:return parseInt(Math.random()*(e-t+1)+t,10);default:return 0}}},{key:"randChunkSplit",value:function(t,e,n){t=t.slice();var i=[],r=1;for(e=e||1,n=n||e||1;t.length>0;)r=Math.min(n,Math.floor(Math.random()*n+e)),i.push(t.splice(0,r));return i}},{key:"mod",value:function(t,e){return(t%e+e)%e}},{key:"clamp",value:function(t,e,n){return Math.min(Math.max(t,e),n)}},{key:"inverseLerp",value:function(t,e,n){return((n=(n=n<t?t:n)>e?e:n)-t)/(e-t)}},{key:"lerp",value:function(t,e,n){return t+(e-t)*(n=(n=n<0?0:n)>1?1:n)}},{key:"remapPortion",value:function(t,e,n,i,r){var a=this.lerp(t,e,n);return this.inverseLerp(i,r,a)}},{key:"remapValue",value:function(t,e,n,i,r){var a=this.inverseLerp(t,e,n);return this.lerp(i,r,a)}},{key:"simplifyRad",value:function(t){var e=null;return(e=Math.atan(Math.tan(t)))<0&&(e=2*Math.PI+e),e}},{key:"getClonedModel",value:function(t){var e=this.cloneGltf(t),n=this.isModelAnimated?e.scene.getObjectByName("ctrl_catapult"):e.scene.children[0];return{clonedGltf:e,clonedMesh:n}}},{key:"isFunc",value:function(t){return"undefined"!==typeof t}},{key:"clean",value:function(t){if(t)if(t.isMesh)t.parent&&t.parent.remove(t),t.geometry.dispose(),t.material.dispose();else for(;t.children.length>0;){var e=t.children[0];e.isMesh?(t.remove(e),e.geometry.dispose(),e.material.dispose()):e.children&&e.children.length>0?this.clean(e):t.remove(e)}}},{key:"hashtagToHexa",value:function(t){return"0x"+t.split("#")[1]}},{key:"shuffle",value:function(t){for(var e=t.length-1;e>0;e--){var n=Math.floor(Math.random()*(e+1)),i=[t[n],t[e]];t[e]=i[0],t[n]=i[1]}}},{key:"loadFont",value:function(t,e){this.fonts=t,this.callback=e,this.strTest="giItTWQy01234&@=-i?0",this._noFont=document.createElement("div"),document.body.appendChild(this._noFont),this._noFont.innerText=this.strTest,this._noFont.style.display="inline",this._noFont.style.visibility="hidden",this._noFont.style.position="fixed",this._myFont=document.createElement("div"),document.body.appendChild(this._myFont),this._myFont.innerText=this.strTest,this._myFont.style.display="inline",this._myFont.style.visibility="hidden",this._myFont.style.position="fixed",this.tryLoad(),this.id=0}},{key:"tryLoad",value:function(){var t=this;this.timer=setInterval((function(){t._myFont.style.fontFamily=t.fonts[t.id],t._noFont.getBoundingClientRect().width!==t._myFont.getBoundingClientRect().width&&(console.log(t.fonts[t.id]+" loaded"),t.id>=t.fonts.length-1?(clearInterval(t.timer),document.body.removeChild(t._noFont),document.body.removeChild(t._myFont),setTimeout((function(){t.callback()}),100)):t.id++),console.log("fonts loading")}),100)}}]),t}(),MM=new TM,EM=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),(i=e.call(this))._scoreAdd=document.querySelector(".js-score-add"),i.wordings={perfect:document.querySelector(".wording-perfect"),good:document.querySelector(".wording-good"),bad:document.querySelector(".wording-bad")},JM.SCORE=0,i.update=i.update.bind(h(i)),i.restart=i.restart.bind(h(i)),i.retry=i.retry.bind(h(i)),i._destroyAllPlatforms=i._destroyAllPlatforms.bind(h(i)),i._setupRespawnPlatform=i._setupRespawnPlatform.bind(h(i)),i._setupRandomPlatforms=i._setupRandomPlatforms.bind(h(i)),i._setupBoostArrow=i._setupBoostArrow.bind(h(i)),i._renderInstance=i._renderInstance.bind(h(i)),i.pauseElapsedTime=null,i.clock=new ru,i._ballVelocity=null,i._droppingBeginTime=0,i._rotationValue=.786,i._platformArr=[],i._platformPiecesData=[],i._platformTotalLayerNum=null,i._platformInstanceObject=null,i._invincibleCollisionEffect=null,i._splashMeshes=[],i._currentSplashMeshed=[],i._droppingDistance=0,i._scoreBoostMultiplier=0,i._scoreBoost=0,i._scoreBoostEventDispatchedL1=!1,i._scoreBoostEventDispatchedL2=!1,i._lastBoostArrowLevel=0,i._detuneSoundValue=0,i._isBallInvincible=!1,i._isFirstGoingDownAfterRetry=!1,i._platformLevelIndex=0,i._platfromLevelDestroyedList=[],i._clockLevelDestroy=new ru,i._isBoostAnimationPlaying=!1,i._boostArrow=null,i._boostArrowsArray=[],i._ballBox=null,i._isGoingDown=!1,i}return s(n,[{key:"build",value:function(){var t=this;this._ballVelocity=xM.velocityNormal,this._normalPlatform=$M.models.PieMin.scene.clone(),this._normalPlatformMaterial=new ll({color:new ve(JM.gameColors.normalPlatformColor)}),this._normalPlatform.traverse((function(e){e.isMesh&&(e.material=t._normalPlatformMaterial)})),this._bonusPlatformMaterial=new ll({color:new ve(JM.gameColors.ballColorNormal)}),this._losePlatform=$M.models.PieMin.scene.clone(),this._losePlatformMaterial=new ll({side:2,color:new ve(JM.gameColors.losePlatformColor)}),this._losePlatform.traverse((function(e){e.isMesh&&(e.material=t._losePlatformMaterial)})),this._losePlatform.scale.set(1.01,1.01,1.01),this.loopIndexLimit=0,this.loopIndexLimitId=xM.loopIndexLimitId;for(var e=0;e<xM.levelGenerator.length-this.loopIndexLimitId;e++)this.loopIndexLimit+=xM.levelGenerator[e].count;this._setupRespawnPlatform(),this._setupRandomPlatforms(),this._setupBoostArrow(),this._setupInvincibleCollisionEffect();for(var n=0;n<3;n++)this._setupSplashTextures(n);this._renderInstance()}},{key:"update",value:function(){var t=this.clock.getDelta();if(this._isGoingDown){var e=this.clock.elapsedTime-this._droppingBeginTime;this._ballVelocity=xM.initialVelocity+xM.gravitationalAcceleration*e;var n=xM.initialVelocity+xM.timeForMaxVelocity*xM.gravitationalAcceleration;this._ballVelocity>n&&(this._ballVelocity=n);var i=t*this._ballVelocity;this.position.y+=i,this._droppingDistance+=i;var r=Math.floor((this._droppingDistance-.47223)/xM.platformOffset);-1==r&&(r=0),r>this._scoreBoostMultiplier&&(this._detuneSoundValue+=.4,this.goingDown()),this._scoreBoostMultiplier=r,r>0&&!this._scoreBoostEventDispatchedL1&&!this._isBallInvincible&&(JM.EVENT_DISPATCHER.dispatchEvent({type:"ballStatusChange",data:"fire"}),this._scoreBoostEventDispatchedL1=!0),r>1&&!this._scoreBoostEventDispatchedL2&&(JM.EVENT_DISPATCHER.dispatchEvent({type:"ballStatusChange",data:"superFire"}),this._scoreBoostEventDispatchedL2=!0,this._isBallInvincible=!0,this.invinsibleCheck())}else(this._scoreBoostEventDispatchedL1||this._scoreBoostEventDispatchedL2)&&(JM.EVENT_DISPATCHER.dispatchEvent({type:"ballStatusChange",data:"normal"}),this._scoreBoostEventDispatchedL1=!1,this._scoreBoostEventDispatchedL2=!1);this._detectAABBCollision()}},{key:"detectCollision",value:function(t){var e=this;if(!u.losePlatformTouched){JM.EVENT_DISPATCHER.dispatchEvent({type:"bounce"});var n=this._platformPiecesData[t.instanceId].layer;if(this._platfromLevelDestroyedList.includes(n))return"error";this._droppingDistance=0,this._scoreBoostMultiplier=0,this._detuneSoundValue=0,this._isGoingDown=!1;var i=this.position.y;this.position.y=Math.round(i/xM.platformOffset)*xM.platformOffset;var r=t.instanceId;this._platformLevelIndex=this._platformPiecesData[r].layer;for(var a=1;a<this._platformLevelIndex-1;a++)this._platfromLevelDestroyedList.includes(a)||this.destroyPlatform(a);var o=this._platformPiecesData[t.instanceId].type;if(this._isBallInvincible)this.destroyPlatform(this._platformLevelIndex,"changeToYellow"),this._invincibleCollisionEffect.position.y=-this.position.y,gM.fromTo(this._invincibleCollisionEffect.scale,{x:0,y:0,z:0},{x:1,y:1,z:1,duration:1,ease:"power2"}),gM.fromTo(this._invincibleCollisionEffect.material,{opacity:1},{opacity:0,duration:1,ease:"power2"}),JM.ball.emitBigParticleEffect();else{"losePlatform"!==o||JM.ball.isShielded||(console.log("losePlatform touched"),u.losePlatformTouched=!0,JM.ball.emitBigParticleEffect(),JM.ball.stopAnimation((function(){JM.GAME.isFirstLose?(JM.uiManager.showTryAgain(),JM.EVENT_DISPATCHER.dispatchEvent({type:"gameFirstLose",data:""})):JM.EVENT_DISPATCHER.dispatchEvent({type:"gameNormalLose",data:""})})),u.losePlatformTouched=!0);var s=this._splashMeshes[MM.randomNum(0,2)].clone(),l=s.material.clone();s.material=l,s.material.color.set(new ve(JM.gameColors.ballColorNormal)),s.position.copy(this.worldToLocal(t.point)),s.position.y+=.03,s.rotation.z=Math.PI*Math.random(),this._currentSplashMeshed.push(s),this.add(s),gM.to(s.material,{opacity:0,duration:1,delay:1}),gM.delayedCall(2,(function(){e.remove(s)}))}this._isBallInvincible=!1,JM.ball.isBooster=!1,JM.GAME.isFirstClick&&JM.soundManager.playSound({name:"Splash",volume:.005,loop:!1,detuneValue:0}),JM.GAME.isDebug||JM.hapticManager&&JM.hapticManager.isHapticEnabled()&&JM.H5SDK.getHapticModule().performHapticFeedBack(100),this._scoreBoost=0,this._ballVelocity=xM.initialVelocity}}},{key:"goingDown",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._isGoingDown=!0,t||(this._ballVelocity=xM.initialVelocity,this._droppingBeginTime=this.clock.elapsedTime);for(var n=0;n<this._currentSplashMeshed.length;n++)this._currentSplashMeshed[n].visible=!1;!this._isFirstGoingDownAfterRetry&&e&&this.destroyPlatform(this._platformLevelIndex,"normal"),this._isFirstGoingDownAfterRetry&&e&&(this.destroyPlatform(0,"normal"),this._isFirstGoingDownAfterRetry=!1),this._platformLevelIndex+=1,this._setupBoostArrow()}},{key:"destroyPlatform",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"normal";if(JM.EVENT_DISPATCHER.dispatchEvent({type:"destoryPlatform"}),!this._platfromLevelDestroyedList.includes(t)&&(this._platfromLevelDestroyedList.push(t),JM.GAME.isFirstClick&&JM.soundManager.playSound({name:"Platform",volume:.01,loop:!1,detuneValue:this._detuneSoundValue}),!JM.GAME.isLose)){JM.SCORE+=20,this._scoreBoost+=20,JM.EVENT_DISPATCHER.dispatchEvent({type:"score"}),JM.COIN+=2,JM.hapticManager&&JM.hapticManager.isHapticEnabled(),JM.uiManager.addScore(this._scoreBoost);for(var i=[],r=0;r<this._platformPiecesData.length;r++){var a=this._platformPiecesData[r];a.layer==t&&i.push(this._platformPiecesData.indexOf(a))}if("changeToRed"==n)for(var o=0;o<i.length;o++){var s=i[o];this._platformInstanceObject.setColorAt(s,new ve(16711680)),this._platformInstanceObject.instanceColor.needsUpdate=!0}if("changeToYellow"==n){for(var l=0;l<i.length;l++){var u=i[l];this._platformInstanceObject.setColorAt(u,new ve(16187136)),this._platformInstanceObject.instanceColor.needsUpdate=!0}JM.uiManager.showPraises()}for(var h=MM.randChunkSplit(i,xM.chunkSplitMin,xM.chunkSplitMax),c=MM.rand(-Math.PI,Math.PI),d=function(n){for(var i=h[n],r=MM.rand(-90,90),a=MM.rand(-120,0),o=Math.floor(i.length/2),s=e._platformPiecesData[i[o]].rotation.y-e.rotation.y,l=15*-Math.cos(s),u=-e.position.y-30,d=15*Math.sin(s),f=new Ee(l,u,d),p=e.localToWorld(f),v=function(n){var o=new Cn,s=i[n],l=e._platformPiecesData[s].position.y;o.position.set(e._platformPiecesData[s].position.x,e._platformPiecesData[s].position.y,e._platformPiecesData[s].position.z),o.rotation.set(e._platformPiecesData[s].rotation.x,e._platformPiecesData[s].rotation.y,e._platformPiecesData[s].rotation.z),o.scale.set(e._platformPiecesData[s].scale.x,e._platformPiecesData[s].scale.y,e._platformPiecesData[s].scale.z),gM.to(o.rotation,{x:r*MM.DEG2RAD,z:a*MM.DEG2RAD,duration:2,delay:.3,ease:"none"}),gM.to(o.position,{x:p.x,z:p.z,duration:2,delay:.1,ease:"none"}),gM.to(o.position,{y:u,duration:1.5,delay:.1,ease:"power1.in"}),gM.to(o.scale,{x:0,y:0,z:0,duration:2,delay:.1,ease:"power4.in",onUpdate:function(t,n){n.updateMatrix(),e._platformInstanceObject.setMatrixAt(t,n.matrix),e._platformInstanceObject.instanceMatrix.needsUpdate=!0},onUpdateParams:[s,o]}),gM.delayedCall(3,(function(){if(xM.movementCircleDuration-xM.movementCircleDurationAccCoef>=xM.movementCircleDurationLimit?xM.movementCircleDuration-=xM.movementCircleDurationAccCoef:xM.movementCircleDuration=xM.movementCircleDurationLimit,xM.gravitationalAcceleration*xM.gravitationalAccelerationAccCoef<=xM.gravitationalAccelerationLimit?xM.gravitationalAcceleration*=xM.gravitationalAccelerationAccCoef:xM.gravitationalAcceleration=xM.gravitationalAccelerationLimit,t>e.loopIndexLimit){var r=i[n];e._platformPiecesData[r].layer+=e._platformTotalLayerNum+1-e.loopIndexLimit-1,e._platformPiecesData[r].position.y=l-(e._platformTotalLayerNum+1-e.loopIndexLimit-1)*xM.platformOffset,e._platformPiecesData[r].rotation.y+=c,o.position.set(e._platformPiecesData[r].position.x,e._platformPiecesData[r].position.y,e._platformPiecesData[r].position.z),o.rotation.set(e._platformPiecesData[r].rotation.x,e._platformPiecesData[r].rotation.y,e._platformPiecesData[r].rotation.z),o.scale.set(e._platformPiecesData[r].scale.x,e._platformPiecesData[r].scale.y,e._platformPiecesData[r].scale.z),"normalPlatform"===e._platformPiecesData[r].type?e._platformInstanceObject.setColorAt(r,new ve(JM.gameColors.normalPlatformColor)):"losePlatform"===e._platformPiecesData[r].type?e._platformInstanceObject.setColorAt(r,new ve(JM.gameColors.losePlatformColor)):console.error("Invalid element type: "+r+" of this._platformPiecesData"),e._platformInstanceObject.instanceColor.needsUpdate=!0,o.updateMatrix(),e._platformInstanceObject.setMatrixAt(r,o.matrix),e._platformInstanceObject.instanceMatrix.needsUpdate=!0}}))},m=0;m<i.length;m++)v(m)},f=0;f<h.length;f++)d(f)}}},{key:"pause",value:function(){this.pauseElapsedTime=this.clock.elapsedTime,this.clock.stop()}},{key:"resume",value:function(){this.clock.start(),this.clock.elapsedTime=this.pauseElapsedTime}},{key:"restart",value:function(){console.log("Platform restart"),this._droppingDistance=0,this._scoreBoostMultiplier=0,this._scoreBoost=0,this._platformLevelIndex=0,this._lastBoostArrowLevel=0,this._isBoostAnimationPlaying=!1,this._platfromLevelDestroyedList=[],this.position.y=0,this.rotation.y=0,this._destroyAllPlatforms(),this._setupRespawnPlatform(),this._setupRandomPlatforms(),this._setupBoostArrow(),this._renderInstance(),JM.SCORE=0,xM.happyTimeShowed=!1,xM.startedBestScore=JM.BEST_SCORE}},{key:"retry",value:function(){console.log("Platform retry"),this._platfromLevelDestroyedList.splice(0,1),this.rotation.y=0;var t=1;this._platformLevelIndex-=1,this._isFirstGoingDownAfterRetry=!0;var e=this.position.y;this.position.y=Math.round(e/xM.platformOffset)*xM.platformOffset;for(var n=0;n<28;n++){var i=new Cn;t-=.75;var r=new Ee(0,-.47223+xM.platformOffset,0),a=this.worldToLocal(r),o=new Ee(0,t/4+2.5,0),s=new Ee(1,1,1);i.position.set(a.x,a.y,a.z),i.rotation.set(o.x,o.y,o.z),i.scale.copy(s),i.updateMatrix(),this._platformInstanceObject.setMatrixAt(n,i.matrix),this._platformInstanceObject.instanceMatrix.needsUpdate=!0,this._platformPiecesData[0]={position:a.clone(),rotation:o.clone(),scale:s.clone()}}this.translateY(-xM.platformOffset);for(var l=0;l<this._currentSplashMeshed.length;l++)this._currentSplashMeshed[l].visible=!1;u.losePlatformTouched=!1}},{key:"touchBoostArrow",value:function(){var t=this;if(console.log("touchBoostArrow"),!u.losePlatformTouched){JM.ball.isBooster=!0,JM.EVENT_DISPATCHER.dispatchEvent({type:"useBooster"});var e=[];JM.uiManager.showPraises();for(var n=4*xM.gravitationalAcceleration,i=[],r=0;r<4;r++)if(0===r)i.push(0);else{var a=(-this._ballVelocity+Math.sqrt(Math.pow(this._ballVelocity,2)+2*n*xM.platformOffset*r))/n;i.push(a)}JM.EVENT_DISPATCHER.dispatchEvent({type:"ballStatusChange",data:"superFire"});for(var o=0;o<this._currentSplashMeshed.length;o++)this._currentSplashMeshed[o].visible=!1;for(var s=this._platformLevelIndex,l=0;l<4;l++)e.push(s),s+=1;for(var h=function(n){gM.delayedCall(i[n],(function(){t.destroyPlatform(e[n],"changeToRed")}))},c=0;c<e.length;c++)h(c);this._isBallInvincible=!0,this.invinsibleCheck(),JM.ball.stopBounceAnimation(),this._isGoingDown||this.goingDown(!1,!1)}}},{key:"invinsibleCheck",value:function(){this.checkTimer&&clearTimeout(this.checkTimer),this.checkTimer=setTimeout((function(){JM.ball.isBooster=!1}),2e3)}},{key:"changeSkin",value:function(t){}},{key:"_detectAABBCollision",value:function(){var t=new Ee(-.1,.4,-2.5),e=new Ee(.1,.5,-2);this._ballBox=new Ce(t,e);for(var n=0;n<this._boostArrowsArray.length;n++){var i=this._boostArrowsArray[n],r=(new Ce).setFromObject(i);this._ballBox.intersectsBox(r)&&(this.remove(i),this.touchBoostArrow())}}},{key:"_setupInvincibleCollisionEffect",value:function(){var t=new sl(2.5,1,16,30),e=new hl({color:12189696,opacity:.5,transparent:!0,depthWrite:!1});this._invincibleCollisionEffect=new bi(t,e),this._invincibleCollisionEffect.rotation.x+=Math.PI/2,this._invincibleCollisionEffect.position.set(0,0,0),this._invincibleCollisionEffect.scale.set(0,0,0),this.add(this._invincibleCollisionEffect)}},{key:"_setupSplashTextures",value:function(t){var e="splash_".concat(t),n=new hl({map:$M.texturesThree[e],transparent:!0,depthWrite:!1}),i=new Vi(1.3,1.3),r=new bi(i,n);r.rotation.x-=Math.PI/2,this._splashMeshes.push(r)}},{key:"_setupRespawnPlatform",value:function(){var t=1;this._colliderGroupRespawn=[];for(var e=0;e<28;e++){t-=.75;var n=new Ee(0,-.47223,0),i=new Ee(0,t/4+2.5,0),r=new Ee(1,1,1),a="normalPlatform";this._platformPiecesData.push({position:n.clone(),rotation:i.clone(),scale:r.clone(),type:a,layer:0,layerIndex:e})}}},{key:"_setupRandomPlatforms",value:function(){for(var t=0,e=0;e<xM.levelGenerator.length;e++)for(var n=0;n<xM.levelGenerator[e].count;n++){t+=1,this._platGroupArr=[];for(var i="level_0".concat(xM.levelGenerator[e].level),r=bM[i][Math.floor(Math.random()*bM[i].length)],a=r.type,o=void 0,s=0;s<r.count;s++){var l=-.47223-t*xM.platformOffset,u=new Ee(0,l,0),h=new Ee(0,r.rotation[s]/4*this._rotationValue+r.randomRotation,0),c=void 0,d=void 0;xM.platformPieceType[a[s]].type===xM.losePiece?(c=new Ee(1.02,1.02,1.02),d="losePlatform"):(c=new Ee(1,1,1),d="normalPlatform"),o={position:u.clone(),rotation:h.clone(),scale:c.clone(),type:d,layer:t,layerIndex:s},this._platformPiecesData.push(o)}this._platformArr[t]=o}this._platformTotalLayerNum=t}},{key:"_setupBoostArrow",value:function(){var t=this;if(this._platformLevelIndex===this._lastBoostArrowLevel+2){var e=8;JM.GAME.isDebug&&(e=1);for(var n=0;n<this._boostArrowsArray.length;n++){var i=this._boostArrowsArray[n];this.remove(i)}this._boostArrowsArray=[];for(var r=function(n){var i=$M.models.BoostArrow.scene.clone(),r=t._platformLevelIndex+3+e*n;r>=t._lastBoostArrowLevel&&(t._lastBoostArrowLevel=r);var a=t._platformPiecesData.filter((function(t){return t.layer===r&&"normalPlatform"===t.type}));if(a.length>0){var o=180*(a[MM.randomNum(0,a.length-1)].rotation.y-Math.PI/2+Math.PI/36)/Math.PI,s=Wv.angle2pos({x:0,y:0},1.95,o);i.position.z=s.x,i.position.x=s.y,i.position.y=.47223-r*xM.platformOffset,gM.to(i.rotation,{y:2*Math.PI,repeat:-1,ease:"none",duration:4}),t.add(i),t._boostArrowsArray.push(i)}},a=0;a<3;a++)r(a)}}},{key:"_renderInstance",value:function(){var t=$M.models.PieMin.scene.children[0].geometry,e=new ll({side:2,metalness:.05});this._platformInstanceObject=new zo(t,e,this._platformPiecesData.length),this._platformInstanceObject.receiveShadow=!0,this._platformInstanceObject.castShadow=!0,this._platformInstanceObject.name="platformInstance",this.dummy=new Cn;for(var n=0;n<this._platformPiecesData.length;n++){var i=this._platformPiecesData[n];this.dummy.position.copy(i.position),this.dummy.rotation.set(i.rotation.x,i.rotation.y,i.rotation.z),i.scale.y=xM.platformYScale,this.dummy.scale.copy(i.scale),this.dummy.updateMatrix(),this._platformInstanceObject.setMatrixAt(n,this.dummy.matrix),"normalPlatform"===i.type?this._platformInstanceObject.setColorAt(n,new ve(JM.gameColors.normalPlatformColor)):"losePlatform"===i.type?this._platformInstanceObject.setColorAt(n,new ve(JM.gameColors.losePlatformColor)):console.error("Invalid element type: "+n+" of this._platformPiecesData")}this.add(this._platformInstanceObject)}},{key:"_destroyAllPlatforms",value:function(){this._platformPiecesData=[],this.remove(this._platformInstanceObject);for(var t=0;t<this._boostArrowsArray.length;t++){var e=this._boostArrowsArray[t];this.remove(e)}this._boostArrowsArray=[]}},{key:"updateColor",value:function(){this._normalPlatformMaterial.color.set(JM.gameColors.normalPlatformColor),this._bonusPlatformMaterial.color.set(JM.gameColors.ballColorNormal),this._losePlatformMaterial.color.set(JM.gameColors.losePlatformColor)}}]),n}(Cn),AM=function(t){d(i,t);var n=m(i);function i(t){var e;return a(this,i),(e=n.call(this)).beginBounceAnimation=e.beginBounceAnimation.bind(h(e)),e.stopBounceAnimation=e.stopBounceAnimation.bind(h(e)),e._ballInitialPosition=new Ee(0,.24,-2),e._isBallDropping=!1,e._isBallBeenCalled=!1,e._isBallSuperFire=!1,e._ball=null,e._ballColor=null,e._trail=null,e._boostTrail=null,e._boostTrailInstanceCount=8,e._boostTrailInstanceData=[],e._particleMesh=null,e._particleMeshesArray=[],e._bigParticleMesh=null,e.raycasterLeft=new pu,e.raycasterRight=new pu,e.timeAnim=.08,e}return s(i,[{key:"build",value:function(){this._setupBall(),this._setupBallTrail(),this._setupBoostSphere(),this._setupBoostTrail(),this._setupParticleEffect(),gM.delayedCall(.1,this.beginBounceAnimation)}},{key:"update",value:function(){if(!u.losePlatformTouched){if(this._ball.position.y<.72){var t=this._raycast2Below();if(t&&0==t.length)return;if(this._isBallDropping){if(this._trail.material.uniforms.uVelocity.value=JM.platforms._ballVelocity/3.5,t&&t[0].distance<.72)if(!this._isBallBeenCalled)console.log("detectCollision"),"error"!=JM.platforms.detectCollision(t[0])&&this.beginBounceAnimation()}else this._isBallDropping||(t&&t[0].distance>xM.platformOffset?this._isBallBeenCalled||(JM.platforms.goingDown(!1),console.log("going down"),this.stopBounceAnimation()):this._isBallBeenCalled||(t&&JM.platforms.detectCollision(t[0]),this._isBallBeenCalled=!0))}else this._isBallBeenCalled=!1;this._shieldHallo.visible&&(this._shieldHallo.position.y=this._ball.position.y)}}},{key:"_raycast2Below",value:function(){var t=this._ball.position,e=new Ee(t.x-.2,.24,t.z),n=new Ee(t.x+.2,.24,t.z),i=new Ee(0,-1,0);this.raycasterLeft.set(e,i),this.raycasterRight.set(n,i);var r=this.raycasterLeft.intersectObject(JM.platforms._platformInstanceObject),a=this.raycasterRight.intersectObject(JM.platforms._platformInstanceObject),o=null;if(r[0]&&a[0])if(Math.abs(r[0].distance-a[0].distance)<.24){var s=JM.platforms._platformPiecesData,l=s[r[0].instanceId].type,u=s[a[0].instanceId].type;o="losePlatform"==l?r:"losePlatform"==u?a:r}else r[0].distance<a[0].distance?o=r:r[0].distance>a[0].distance&&(o=a);return o==r?o[0].point.x+=.2:o==a&&(o[0].point.x-=.2),o}},{key:"beginBounceAnimation",value:function(){if(console.log("beginBounceAnimation"),!u.losePlatformTouched){this._ball.position.copy(this._ballInitialPosition),this._ball.rotation.set(0,0,0),this._ball.scale.set(1,1,1),this._isBallDropping=!1,this._isBallBeenCalled=!0,this.bouncePosTween&&this.bouncePosTween.kill(),this.bouncePosTween=gM.to(this._ball.position,{duration:xM.movementCircleDuration,y:xM.bounceYPos,ease:"power1.out",yoyo:!0,repeat:-1}),this.bounceRotateTween&&this.bounceRotateTween.kill(),this.bounceRotateTween=gM.to(this._ball.rotation,{z:2*Math.PI,duration:2*xM.movementCircleDuration,ease:"none",repeat:-1}),this._ball.scale.set(xM.initialXScale,xM.initialYScale,1),this.bounceScaleYTween&&this.bounceScaleYTween.kill(),this.bounceScaleYTween=gM.to(this._ball.scale,{duration:xM.movementCircleDuration,y:1,ease:"power1.out",yoyo:!0,repeat:-1}),this.bounceScaleXTween&&this.bounceScaleXTween.kill(),this.bounceScaleXTween=gM.to(this._ball.scale,{duration:xM.movementCircleDuration,x:1,delay:xM.movementCircleDuration/2,ease:"power1.out",yoyo:!0,repeat:-1}),this.trailTween&&this.trailTween.kill(),this.trailTween=gM.fromTo(this._trail.material.uniforms.uVelocity,{value:-2},{value:2,duration:2*xM.movementCircleDuration,ease:"none",repeat:-1}),this.trailPosTween&&this.trailPosTween.kill(),this.trailPosTween=gM.to(this._trail.position,{y:xM.bounceYPos,duration:xM.movementCircleDuration,ease:"power1.out",yoyo:!0,repeat:-1});var t=MM.randomNum(0,2);this._particleMesh=this._particleMeshesArray[t],this._particleMesh.position.copy(this._ballInitialPosition),this._particleMesh.position.z=-3,this.particle1Tween&&this.particle1Tween.kill(),this.particle1Tween=gM.fromTo(this._particleMesh.scale,{x:0,y:0,z:0},{x:1.5,y:2,z:2,duration:2*xM.movementCircleDuration,ease:"power1",repeat:-1});var e=this._particleMesh.position;this.particle2Tween&&this.particle2Tween.kill(),this.particle2Tween=gM.fromTo(this._particleMesh.position,{x:e.x,y:e.y,z:e.z},{x:e.x,y:e.y-3,z:e.z-1,duration:2*xM.movementCircleDuration,ease:"back.in(1.4)",repeat:-1}),this.particle3Tween&&this.particle3Tween.kill(),this.particle3Tween=gM.fromTo(this._particleMesh.material,{opacity:1},{opacity:0,duration:2*xM.movementCircleDuration,ease:"power3.in",repeat:-1})}}},{key:"stopAnimation",value:function(t){console.log("stopAniamtion"),this.bouncePosTween.kill(),this.bounceRotateTween.kill(),this.particle1Tween.kill(),this.particle2Tween.kill(),this.particle3Tween.kill(),this.trailPosTween.kill(),this.trailTween.kill(),this.bounceScaleXTween.kill(),this.bounceScaleYTween.kill();for(var e=0;e<this._particleMeshesArray.length;e++)this._particleMeshesArray[e].scale.x=0;gM.to(this._trail.material.uniforms.uVelocity,{duration:.2,value:0}),gM.to(this._ball.position,{duration:.5,y:.25,ease:"bounce.out"}),gM.to(this._ball.scale,{duration:.65,x:1,y:1,z:1,ease:"elastic.out(1, 0.3)",onComplete:function(){t()}})}},{key:"stopBounceAnimation",value:function(){console.log("stopBounceAnimation"),this._isBallDropping=!0,this._isBallBeenCalled=!1,gM.killTweensOf(this._ball.position),gM.killTweensOf(this._ball.scale),gM.killTweensOf(this._ball.rotation),gM.killTweensOf(this._trail.material.uniforms.uVelocity),gM.killTweensOf(this._trail.position),this._particleMesh.material.opacity=0,gM.killTweensOf(this._particleMesh.scale),gM.killTweensOf(this._particleMesh.position),gM.killTweensOf(this._particleMesh.material),gM.to(this._ball.position,{x:this._ballInitialPosition.x,y:this._ballInitialPosition.y,z:this._ballInitialPosition.z,duration:this.timeAnim,ease:"power1.in"}),this._ball.rotation.set(0,0,0),this._ball.scale.set(1,1,1),gM.to(this._trail.position,{x:this._ballInitialPosition.x,y:this._ballInitialPosition.y,z:this._ballInitialPosition.z,duration:this.timeAnim,ease:"power1.in"}),this._trail.material.uniforms.uVelocity.value=JM.platforms._ballVelocity/3.5}},{key:"changeSkin",value:function(){var t=r(e().mark((function t(n,i){var r,a,o,s;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==n){t.next=6;break}for(;this._ball.children.length;)this._ball.remove(this._ball.children[0]);this._ball.material.transparent=!0,this._ball.material.opacity=1,t.next=15;break;case 6:return i&&i.loadingSkin(),t.next=9,$M.getModelByName(n);case 9:for(r=t.sent;this._ball.children.length;)this._ball.remove(this._ball.children[0]);this._ball.material.transparent=!0,this._ball.material.opacity=0,i&&i.skinLoaded(),r&&(a=r.scene.clone(),o=[].concat(xM.basicSkinList,xM.rareSkinList,xM.funkySkinList,xM.epicSkinList,xM.chestSkinList),s=o.find((function(t){return t.name===n})),a.scale.set(s.scale,s.scale,s.scale),this._ball.add(a));case 15:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"emitBigParticleEffect",value:function(){this._bigParticleMesh.position.copy(this._ballInitialPosition),this._bigParticleMesh.position.z=-3,gM.fromTo(this._bigParticleMesh.scale,{x:0,y:0,z:0},{x:1.5,y:2,z:2,duration:2*xM.movementCircleDuration,ease:"power1",repeat:-1});var t=this._bigParticleMesh.position;gM.fromTo(this._bigParticleMesh.position,{x:t.x,y:t.y,z:t.z},{x:t.x,y:t.y-3,z:t.z-1,duration:2*xM.movementCircleDuration,ease:"back.in(1.4)"}),gM.fromTo(this._bigParticleMesh.material,{opacity:1},{opacity:0,duration:2*xM.movementCircleDuration,ease:"power3.in"})}},{key:"_setupBall",value:function(){var t=this;this._ballColor=JM.gameColors.ballColorNormal;var e=new ol(.24,16,16),n=new hl({color:this._ballColor,transparent:!0,opacity:1});this._ball=new bi(e,n),this._ball.position.copy(this._ballInitialPosition),this._ball.scale.set(xM.initialXScale,xM.initialYScale,1),this.add(this._ball),JM.EVENT_DISPATCHER.addEventListener("ballStatusChange",(function(e){t._updateBallStatus(e.data)}))}},{key:"_setupBallTrail",value:function(){var t={uVelocity:{value:0},uColor:{value:new ve(this._ballColor)}},e=new Vi(.2,1),n=new Ai({side:2,vertexShader:"varying vec2 vUv;\n        uniform float uVelocity;\n        void main() {\n            vUv = uv;\n            vec3 transformed = position.xyz;\n            transformed.x *= 1.0 - uv.y + 0.1;\n            transformed.y *= uVelocity;\n            transformed.y += uVelocity / 2.;\n            gl_Position = projectionMatrix* modelViewMatrix * vec4(transformed.xyz, 1.0);\n        }\n        ",fragmentShader:"uniform vec3 uColor;\n        uniform float uVelocity;\n        varying vec2 vUv;\n        void main() {\n            gl_FragColor = vec4(uColor, 1.0 - vUv.y - 0.2 );\n        }",uniforms:t,transparent:!0,depthWrite:!0});this._trail=new bi(e,n),this._trail.position.z=-2,this.add(this._trail)}},{key:"_setupBoostSphere",value:function(){var t=new Vi(2*xM.initialXScale,2*xM.initialYScale),e=new Vn({color:16711680,side:2,map:$M.texturesThree.BoostCircle,transparent:!0,opacity:.8});this._boostSphere=new bi(t,e),this._boostSphere.rotation.z+=Math.PI/2,this._boostSphere.position.copy(this._ballInitialPosition),this._boostSphere.scale.set(0,0,0),this.add(this._boostSphere);var n=new Vn({color:4128767,side:2,map:$M.texturesThree.shieldHallo,transparent:!0});this._shieldHallo=new bi(t,n),this._shieldHallo.scale.set(0,0,0),this._shieldHallo.visible=!1,this._shieldHallo.material.depthTest=!1,this._shieldHallo.rotation.x+=45*Oy,this._shieldHallo.position.copy(this._ballInitialPosition),this.add(this._shieldHallo)}},{key:"_animateHallo",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this._boostSphere.scale.set(1,1,1),this._boostSphere.material.opacity=1,gM.to(this._boostSphere.scale,{duration:e,x:1.5,y:1.5,z:1.5}),gM.to(this._boostSphere.material,{delay:.5*e,duration:2*e,opacity:0,onComplete:function(){t._animeHallo&&t._animateHallo(e)}})}},{key:"animateShield",value:function(t){var e=this;t?(this._shieldHallo.visible=!0,this._shieldHallo.scale.set(0,0,0),gM.to(this._shieldHallo.scale,{duration:.5,x:1,y:1,z:1,ease:"back.out(1)"})):gM.to(this._shieldHallo.scale,{duration:.25,x:0,y:0,z:0,onComplete:function(){e._shieldHallo.visible=!1}})}},{key:"wiggleShield",value:function(t,e){for(var n=this,i=t/.1,r=0;r<i;r++)gM.delayedCall(.1*r,(function(t){n._shieldHallo.material.opacity=n._shieldHallo.material.opacity>.2?.2:1,t>=i-1&&e&&e()}),[r])}},{key:"_setupBoostTrail",value:function(){for(var t=this,e=new ll({opacity:.2,transparent:!0,side:2}),n=new Ps(.65,.65,.2,20,1),i=0;i<this._boostTrailInstanceCount;i++){var r;r={position:new Ee(0,0,0),rotation:new Ee(0,0,0),scale:new Ee(1,1,1)},this._boostTrailInstanceData.push(r)}this._boostTrail=new zo(n,e,this._boostTrailInstanceCount),this._boostTrail.receiveShadow=!0,this._boostTrail.castShadow=!0,this._boostTrail.name="boostTrail";for(var a=new Cn,o=0;o<this._boostTrailInstanceCount;o++){var s=this._boostTrailInstanceData[o];a.position.copy(s.position),a.rotation.set(s.rotation.x,s.rotation.y,s.rotation.z),a.scale.copy(s.scale),a.updateMatrix(),this._boostTrail.setMatrixAt(o,a.matrix)}this._boostTrail.position.z=this._ballInitialPosition.z,this._boostTrail.position.y=0,this._boostTrail.scale.set(1,1,1),this.add(this._boostTrail),this._boostTrail.position.z=-this._ballInitialPosition.z;for(var l=.6/this._boostTrailInstanceCount,u=0;u<this._boostTrailInstanceCount;u++){var h=new Cn,c=u;h.position.set(this._boostTrailInstanceData[u].position.x,this._boostTrailInstanceData[u].position.y,this._boostTrailInstanceData[u].position.z),h.rotation.set(this._boostTrailInstanceData[u].rotation.x,this._boostTrailInstanceData[u].rotation.y,this._boostTrailInstanceData[u].rotation.z),h.scale.set(0,0,0),gM.to(h.position,{y:4,duration:.6,delay:l*u,ease:"none",repeat:-1}),gM.to(h.scale,{x:1,y:1,z:1,duration:.6,delay:l*u,ease:"none",repeat:-1,onUpdate:function(e,n){n.updateMatrix(),t._boostTrail.setMatrixAt(e,n.matrix),t._boostTrail.instanceMatrix.needsUpdate=!0},onUpdateParams:[c,h]})}}},{key:"_beginBoostTrail",value:function(t){this._boostTrail.position.z=this._ballInitialPosition.z;for(var e=0;e<this._boostTrailInstanceCount;e++)this._boostTrail.setColorAt(e,t),this._boostTrail.instanceColor.needsUpdate=!0}},{key:"_stopBoostTrail",value:function(){this._boostTrail.position.z=-this._ballInitialPosition.z}},{key:"_setupParticleEffect",value:function(){for(var t=0;t<3;t++){var e="ParticleEffect"+t,n=new hl({map:$M.texturesThree[e],transparent:!0,depthWrite:!1,side:2}),i=new Vi(2,2);this._particleMeshesArray[t]=new bi(i,n),this._particleMeshesArray[t].position.copy(this._ballInitialPosition),this._particleMeshesArray[t].position.z=-3,this._particleMeshesArray[t].material.opacity=0,this._particleMeshesArray[t].material.color.set(JM.gameColors.ballColorNormal),this.add(this._particleMeshesArray[t])}var r=new hl({map:$M.texturesThree.ParticleEffect3,transparent:!0,depthWrite:!1,side:2}),a=new Vi(6,2);this._bigParticleMesh=new bi(a,r),this._bigParticleMesh.position.copy(this._ballInitialPosition),this._bigParticleMesh.position.z=-3,this._bigParticleMesh.material.opacity=0,this._bigParticleMesh.material.color.set(JM.gameColors.losePlatformColor),this.add(this._bigParticleMesh)}},{key:"_updateBallStatus",value:function(t){var e;switch(this._ballPos=JM.ball.position.y,t){case"normal":this.particlesBounceStartTime=-1,this._ballColor=JM.gameColors.ballColorNormal,e=new ve(this._ballColor),this._ball.material.color.set(e),this._trail.material.uniforms.uColor.value.set(e),this._animeHallo=!1,gM.to(this._shieldHallo.scale,{duration:.5,x:1,y:1,z:1,ease:"power4.out"}),this._boostSphere.material.color=new ve(16711680),gM.to(this._boostSphere.scale,{x:0,y:0,z:0,repeat:0,duration:.2,ease:"back"}),this._isBallSuperFire=!1,this._stopBoostTrail();break;case"fire":this._ballColor=JM.gameColors.ballColorNormal,e=new ve(this._ballColor),this._ball.material.color.set(e),this._trail.material.uniforms.uColor.value.set(e),this._isBallSuperFire=!0,gM.to(this._shieldHallo.scale,{duration:.5,x:0,y:0,z:0,ease:"power4.in"}),this._beginBoostTrail(e);break;case"superFire":this._ballColor=JM.gameColors.ballColorFire,e=new ve(this._ballColor),this._ball.material.color.set(e),this._trail.material.uniforms.uColor.value.set(e),gM.to(this._shieldHallo.scale,{duration:.5,x:0,y:0,z:0,ease:"power4.in"}),this._animeHallo=!0,this._animateHallo(.25),this._beginBoostTrail(e)}}},{key:"updateColor",value:function(){this._ball.material.color.set(JM.gameColors.ballColorNormal),this._trail.material.uniforms.uColor.value.set(JM.gameColors.ballColorNormal);for(var t=0;t<3;t++)this._particleMeshesArray[t].material.color.set(JM.gameColors.ballColorNormal);this._bigParticleMesh.material.color.set(JM.gameColors.losePlatformColor)}}]),i}(Cn),PM=Math.PI/180;Math.PI;var CM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this))._ball=null,t._platformGroup=null,t}return s(n,[{key:"setup",value:function(){var t=new wM,e=new SM,n=new AM,i=new EM;for(var r in this.sceneEntities={},this.sceneEntities.lights=t,this.sceneEntities.tube=e,this.sceneEntities.ball=n,this.sceneEntities.platforms=i,JM.ball=this.sceneEntities.ball,JM.platforms=this.sceneEntities.platforms,JM.tube=this.sceneEntities.tube,this.sceneEntities)this.sceneEntities[r].build(this._models),JM.scene.add(this.sceneEntities[r]);console.log(">>>",JM.camera),this._wall=this.wall(),this._wall.position.z=20,this._wall.position.y=0,this._wall.rotation.z=180*PM,this._wall.rotation.x=45*PM,JM.scene.add(this._wall)}},{key:"wall",value:function(){this.object=new Cn;var t=new Vn;t.color=new ve(16777215);var e=new bi(new Vi(2,2),t);e.material.map=$M.texturesThree.ParticleCircle,e.material.depthWrite=!1,e.material.opacity=.2,e.material.side=2,e.rotation.y=180*PM,e.scale.set(.5,.5,.5),e.material.transparent=!0;for(var n=[],i=0;i<70;i++){var r=.4*Math.random(),a=12*Math.random()-6;n.push({position:{x:a,y:32*Math.random(),z:0},rotation:{x:0,y:0,z:0},scale:{x:r,y:r,z:r},randomx:Wv.range(-.004,.004),initx:a})}var o=e.material,s=e.geometry;s.computeVertexNormals();var l=new Cn,u=new zo(s,o,n.length);u.instanceMatrix.setUsage(35048),this.object.add(u);var h=0;return this.object.update=function(){h+=.012;for(var t=0,e=0;e<n.length;e++){var i=n[e].position.y+h;i>32&&(n[e].position.y-=28.8,n[e].position.x=n[e].initx),n[e].position.x+=n[e].randomx,l.position.set(n[e].position.x,i,n[e].position.z),l.rotation.set(n[e].rotation.x*PM,n[e].rotation.y*PM,n[e].rotation.z*PM),n[e].scale&&l.scale.set(n[e].scale.x,n[e].scale.y,n[e].scale.z),l.updateMatrix(),u.setMatrixAt(t,l.matrix),t++}u.instanceMatrix.needsUpdate=!0},this.object}},{key:"update",value:function(){for(var t in this.sceneEntities)this.sceneEntities[t].update();this._wall&&this._wall.update()}},{key:"restart",value:function(){}}]),n}(Cn),kM=new(function(){function t(){a(this,t),this.allWords=["best","newbest","titleword1","titleword2","titleword3","tuto","try","tryagain","notry","play","score","bestscore","share","invite","nice","godlike","perfect","wow","loading","basicTutorial","rareTutorial","funkyTutorial","epicTutorial","chestTutorial","unlock1","playWith","currentscore","mybestcore","playFriends","leaderPlay","myscore","canyoudobetter","mission","bounce","times","pass","platforms","scoreDaily","points","use","boosters","surpassFriend","leaderboard"],this._words={},this._wordLoaded=0}return s(t,[{key:"init",value:function(t){var e=this;console.log("init localisaion...");for(var n=0;n<this.allWords.length;n++)this.getWord(this.allWords[n]);this.interval=setInterval((function(){e._wordLoaded>=e.allWords.length&&(clearInterval(e.interval),e.translate(),t())}),200)}},{key:"getWord",value:function(t){var e=this;JM.H5SDK.getI18nModule().getTranslation(t).then((function(n){e._words[t]=n,e._wordLoaded++}))}},{key:"translate",value:function(){var t=document.getElementById("title_word1");t.innerText=this._words.titleword1;var e=document.getElementById("title_word2");e.innerText=this._words.titleword2;var n=document.getElementById("title_word3");n.innerText=this._words.titleword3,t.getBoundingClientRect().width+e.getBoundingClientRect().width+n.getBoundingClientRect().width>286&&(t.style.fontSize="22px",e.style.fontSize="22px",n.style.fontSize="22px"),document.getElementById("title_word2").innerText=this._words.titleword2,document.getElementById("title_word3").innerText=this._words.titleword3;var i=document.getElementById("tuto");if(i.innerText=this._words.tuto,i.style["text-align"]="center",i.style.width="200px",Wv.setupIs().desktop){var r=document.getElementById("tuto2");r.innerText="or use AD / arrow keys",r.style["text-align"]="center",r.style.width="200px"}document.getElementById("try").innerText=this._words.try,document.getElementById("notry").innerText=this._words.notry,document.getElementById("score_text").innerText=this._words.score,document.getElementById("score_text").style.fontSize="26px",document.getElementById("play_text").innerText=this._words.play,document.getElementById("share").innerText=this._words.share,document.getElementById("invite").innerText=this._words.invite}},{key:"words",get:function(){return this._words}}]),t}()),RM=function(t){d(n,t);var e=m(n);function n(t){var i;return a(this,n),i=e.call(this),Wv.autobind(h(i)),i._domElement=t,i.isDown=!1,i.isMoving=!1,i._viewX=100,i._viewY=100,i._velocityY=0,i._contentY=0,i._lastPoint=new Ly,i._bg=new zS,i._container=new a_,i.__mask=new zS,i._init(),i}return s(n,[{key:"_init",value:function(){this._bg.beginFill(255,.001),this._bg.drawRect(0,0,1,1),this._bg.endFill(),this.addChild(this._container),this.__mask.beginFill(16711680,.4),this.__mask.drawRect(0,0,1,1),this.__mask.endFill(),this.__mask.scale.set(this.viewX,this.viewY),this.__mask.isMask=!0,this._container.mask=this.__mask,this.addChild(this.__mask),this._initEvents()}},{key:"_initEvents",value:function(){this.interactive=!0,this.on("pointerdown",this._onDragStart).on("pointerup",this._onDragEnd).on("pointerupoutside",this._onDragEnd).on("pointermove",this._onDragMove),this._domElement.addEventListener("mouseup",this._onDragEnd,!1),this._domElement.addEventListener("wheel",this._onWheel)}},{key:"_onDragStart",value:function(t){this.scrollTween&&this.scrollTween.kill(),this._velocityY=0,this.data=t.data,this.localPosition=this.data.getLocalPosition(this._container),this.newPosition=this.data.getLocalPosition(this),this.isDown=!0,this.isMoving=!1}},{key:"_onDragEnd",value:function(){this.isDown=!1,this.isMoving=!1}},{key:"_onDragMove",value:function(t){this.isDown&&(this.newPosition=this.data.getLocalPosition(this)),this.isMoving=!0}},{key:"_onWheel",value:function(t){if(this.visible){var e=this._container.y;e-=2.5*t.deltaY,this.scrollTween&&this.scrollTween.kill(),this.scrollTween=gM.to(this._container,{duration:.4,y:e,onUpdate:this._checkPosition})}}},{key:"_checkPosition",value:function(){this._container.y>0||this._viewY>=this._container.height?(this._container.y*=.5,this.scrollTween&&this.scrollTween.kill()):this._container.y<this.viewY-this._container.height&&(this.scrollTween&&this.scrollTween.kill(),this._container.y=this.viewY-this._container.height-.5*(this.viewY-this._container.height-this._container.y))}},{key:"_back",value:function(){this._container.y>0||this._viewY>=this._container.height?this._container.y*=.7:this._container.y<this.viewY-this._container.height&&(this._container.y=this.viewY-this._container.height-.7*(this.viewY-this._container.height-this._container.y))}},{key:"_getMovement",value:function(t,e){return t.y1=t.y2,t.y2=e.y,(e.y>t.y1?1:-1)*Wv.distance({x:0,y:t.y1},{x:0,y:t.y2})}},{key:"viewX",get:function(){return this._viewX},set:function(t){this._viewX=t,this.__mask.scale.x=this._viewX}},{key:"viewY",get:function(){return this._viewY},set:function(t){this._viewY=t,this.__mask.scale.y=this._viewY}},{key:"axe",set:function(t){this._axe=t}},{key:"contentY",get:function(){return this._contentY},set:function(t){this._contentY=t,this._container.y=this._contentY}},{key:"goToDown",value:function(){this._container.y=this.viewY-this._container.height}},{key:"add",value:function(t){this._container.addChild(this._bg),this._container.addChild(t),this._bg.scale.set(this._container.width,this._container.height)}},{key:"clear",value:function(){this.isDown=!1,this.isMoving=!1,this._bg.scale.set(1,1),this._container.removeChildren(),this._container.position.set(0,0)}},{key:"update",value:function(){this.visible&&(this.isDown?(this.newPosition&&(this._container.y=this.newPosition.y-this.localPosition.y),this._velocityY=this._getMovement(this._lastPoint,this._container.position),this._checkPosition()):(this._velocityY*=.96,this._container.y+=this._velocityY,this._back()))}},{key:"dispose",value:function(){this.off("pointerdown",this._onDragStart).off("pointerup",this._onDragEnd).off("pointerupoutside",this._onDragEnd).off("pointermove",this._onDragMove),this.destroy(!0)}}]),n}(a_),IM=function(t){d(n,t);var e=m(n);function n(t,i,r,o,s){var l,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{width:350,height:80},c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;a(this,n),(l=e.call(this)).onDown=l.onDown.bind(h(l)),l.onUp=l.onUp.bind(h(l)),l.onOut=l.onOut.bind(h(l)),l._label=t,l._scale=c,l._point=new Ly;var d=$M.texturesPixi.basicWhiteBg;l.btn=new vM(d,30,30,30,30),l.btn.tint=o,l.btn.width=u.width,l.btn.height=u.height,l.btn.x=-u.width/2,l.btn.y=-u.height/2,l.interactive=!0,l.buttonMode=!0,l.on("pointerdown",l.onDown),l.on("pointerup",l.onUp),l.on("pointerupoutside",l.onOut),l.on("pointermove",l._update),l.content=new a_,l.addChild(l.content),l.content.addChild(l.btn);var f=new ZS({fontFamily:"voodoo_casual-bold",fontSize:i,align:"center",fill:r,dropShadow:!0,dropShadowAlpha:1,dropShadowAngle:90*Oy,dropShadowBlur:4,dropShadowColor:"0x000000",dropShadowDistance:6});if(l._text=new iT(t,f),l._text.anchor.set(.5),l.content.addChild(l._text),s){var p=new WS(s);p.anchor.set(.5),l._text.x=-p.width/2+5,p.x=l._text.x+(l._text.width+.5*p.width)>>1,p.y=-2,l.content.addChild(p)}return l.scale.set(l._scale),l}return s(n,[{key:"onDown",value:function(t){console.log(t),this._down||(this._down=!0,gM.to(this.scale,{duration:.2,x:this._scale-.2,y:this._scale-.2}))}},{key:"onUp",value:function(t){this._down&&(gM.to(this.scale,{duration:.2,x:this._scale,y:this._scale}),this._callBack&&this._callBack()),this._down=!1}},{key:"onOut",value:function(t){this._down=!1,gM.to(this.scale,{duration:.2,x:this._scale,y:this._scale})}},{key:"_getMovement",value:function(t,e){var n,i;return t.x1=t.x2,t.x2=e.x,n=e.x>t.x1?1:-1,t.y1=t.y2,t.y2=e.y,i=e.y>t.y1?1:-1,{x:n*Wv.distance({x:t.x1,y:0},{x:t.x2,y:0}),y:i*Wv.distance({x:0,y:t.y1},{x:0,y:t.y2})}}},{key:"_update",value:function(){this._pos=this._getMovement(this._point,u.mouse),(Math.abs(this._pos.x)>1||Math.abs(this._pos.y)>1)&&this.onOut()}},{key:"animate",value:function(){gM.to(this.content.scale,{duration:.35,x:1.05,y:1.05,repeat:-1,yoyo:!0,yoyoEase:"none"})}},{key:"click",set:function(t){this._callBack=t}},{key:"text",set:function(t){this._text.text=t}}]),n}(a_),DM=function(t){d(n,t);var e=m(n);function n(t,i,r,o,s,l,u){var c;return a(this,n),c=e.call(this),Wv.autobind(h(c)),c._id=t,c._rank=i,c._name=r,c._img=o,c._color=s,c._score=l,c._invite=u,c._init(),c}return s(n,[{key:"_init",value:function(){var t="You"==this._name?$M.texturesPixi.yellowBg:$M.texturesPixi.basicWhiteBg;this.bg=new vM(t,30,30,30,30),this.bg.tint=Wv.hashtagToHexa(this._color),this.bg.scale.set(.42),this.bg.width=1250,this.bg.height=200,this.bg.x=-this.bg.width/2*.42,this.addChild(this.bg);var e=new ZS({fontFamily:"voodoo_casual-bold",fontSize:30,letterSpacing:2,align:"left",fill:16777215});this.text=new iT(this._rank,e),this.text.anchor.x=.5,this.text.anchor.y=.5,this.text.x=-202.5,this.text.y=40,this.addChild(this.text);var n=WS.from(this._img);n.height=54,n.width=54,n.anchor.y=.5,n.y=39,n.x=-142.5;var i=new zS;i.beginFill(8452351),i.drawRoundedRect(0,.5*-(n.height+10),n.height+10,n.height+10,15),i.endFill(),i.y=n.y,i.x=n.x-5,this.addChild(i);var r=new zS;r.beginFill(16711680),r.drawRoundedRect(0,.5*-n.height,n.height,n.height,15),r.endFill(),r.y=n.y,r.x=n.x,r.isMask=!0,this.addChild(n),this.addChild(r),n.mask=r;var a=new ZS({fontFamily:"voodoo_casual-bold",fontSize:"You"==this._name?34:26,letterSpacing:2,align:"left",fill:16777215,stroke:"You"==this._name,strokeThickness:3});this.nameText=new iT(this._name,a),this.nameText.anchor.y=.5,this.nameText.x=n.x+.5*n.width+40,this.nameText.y=40,this.addChild(this.nameText);var o=new ZS({fontFamily:"voodoo_casual-bold",fontSize:28,letterSpacing:2,align:"left",fill:16777215});this.scoreText=new iT(this._score,o),this.scoreText.anchor.x=1,this.scoreText.anchor.y=.5,this.scoreText.x=247.5,this.scoreText.y=40,this.addChild(this.scoreText),this.inviteBtn=new IM(kM.words.playWith,20,16777215,3944353,$M.texturesPixi.friendsPicto,{width:190,height:80},.8),this.inviteBtn.click=this._inviteClick,this.inviteBtn.x=165,this.inviteBtn.y=40,this.inviteBtn.visible=!1,this.addChild(this.inviteBtn),this.enableInvite=this._invite}},{key:"_inviteClick",value:function(){var t=this;console.log(this._id),JM.H5SDK.getFriendsModule().playWithFriend(this._id,$M.base64Picture).then((function(e){console.log("onPlay:",e),e?(console.log("play"),t.emit("invite")):console.log("close")}))}},{key:"enableInvite",set:function(t){this.inviteBtn.visible=t,this.scoreText.visible=!t}}]),n}(a_),OM=u.view.x,LM=u.view.y,NM=function(t){d(n,t);var e=m(n);function n(t){var i;a(this,n),i=e.call(this),Wv.autobind(h(i)),i._domElement=t;var r=new zS;return r.beginFill(5009033,.9),r.drawRect(-.5,-.5,1,1),r.endFill(),r.scale.set(4*OM,LM),i.addChild(r),i._init(),i._initEvents(),i}return s(n,[{key:"_init",value:function(){this.coupe=new WS($M.texturesPixi.coupe),this.coupe.anchor.set(.5),this.coupe.y=-310,this.addChild(this.coupe);var t=new ZS({fontFamily:"voodoo_casual-bold",fontSize:20,align:"left",fill:16777215});this.titleText=new iT(kM.words.currentscore,t),this.titleText.anchor.x=.5,this.titleText.x=0,this.titleText.y=-535,this.addChild(this.titleText);var e=new ZS({fontFamily:"voodoo_casual-bold",fontSize:30,fill:["#ffffff","#d9f7fc"],stroke:"#000000",strokeThickness:3});this.scoreText=new iT(0,e),this.scoreText.anchor.x=.5,this.scoreText.x=0,this.scoreText.y=this.titleText.y+this.titleText.height-9,this.addChild(this.scoreText),this.rect=new zS,this.rect.beginFill(11566362,.5),this.rect.drawRoundedRect(-105,-45,210,90,10),this.rect.endFill(),this.rect.y=-432,this.addChild(this.rect),this.bestScoreLabel=new iT(kM.words.mybestcore,t),this.bestScoreLabel.anchor.x=.5,this.bestScoreLabel.x=0,this.bestScoreLabel.y=-470;var n=new ZS({fontFamily:"voodoo_casual-bold",fontSize:44,fill:["#ffffff","#d9f7fc"],stroke:"#000000",strokeThickness:3});this.bestScoreText=new iT(300,n),this.bestScoreText.x=0,this.bestScoreText.y=this.bestScoreLabel.y+this.bestScoreLabel.height-5,this.bestScoreText.anchor.x=.5,this.container=new a_,this.container.x=OM/2,this.scroll=new RM(this._domElement),this.scroll.axe="y",this.scroll.viewY=600,this.scroll.viewX=OM,this.scroll.y=-300,this.scroll.x=-OM/2,this.scroll.visible=!1,this.scroll.add(this.container),this.addChild(this.scroll);var i=new WS($M.texturesPixi.gradient);i.tint=5009033,i.anchor.set(.5,1),i.rotation=Math.PI,i.y=-380,i.scale.y=.5,i.width=OM,this.addChild(i);var r=new WS($M.texturesPixi.gradient);r.tint=5009033,r.anchor.set(.5,0),r.y=230,r.scale.y=.5,r.width=OM,this.addChild(r),this.addChild(this.bestScoreLabel),this.addChild(this.bestScoreText),this.inviteBtn=new IM(kM.words.playFriends,25,16777215,3944353,$M.texturesPixi.friendsPicto,{width:350,height:100},.8),this.inviteBtn.click=this._invite,this.inviteBtn.x=-145,this.inviteBtn.y=370,this.inviteBtn.animate(),this.inviteBtn.visible=!1,this.addChild(this.inviteBtn),this.playBtn=new IM(kM.words.leaderPlay,40,16777215,7532926,null,{width:300,height:100},.8),this.playBtn.click=this.closePopin,this.playBtn.x=145,this.playBtn.y=340,this.playBtn.visible=!1,this.addChild(this.playBtn);var a=new ZS({fontFamily:"voodoo_casual-bold",fontSize:38,fill:["#ffffff","#d9f7fc"],stroke:"#000000",strokeThickness:3});this.banner=new vM($M.texturesPixi.banner,250,250,300,4),this.banner.x=-350,this.banner.y=-396,this.banner.tint=15151718,this.banner.width=1400,this.banner.scale.set(.5,.4),this.addChild(this.banner),this.bannerText=new iT(kM.words.leaderboard,a),this.bannerText.anchor.set(.5),this.bannerText.y=-350,this.addChild(this.bannerText),this.visible=!1,this.scale.set(.02)}},{key:"_initEvents",value:function(){this.interactive=!0}},{key:"_onDown",value:function(){this._isDown||(this._isDown=!0,this.tween=gM.to(this.close.scale,{duration:.2,x:.43,y:.43}))}},{key:"_onUp",value:function(){this._isDown&&(this._isDown=!1,this.tween&&this.tween.kill(),this.tween=gM.to(this.close.scale,{duration:.2,x:.5,y:.5}),this.hide())}},{key:"_onOut",value:function(){this._isDown=!1,this.tween&&this.tween.kill(),this.tween=gM.to(this.close.scale,{duration:.2,x:.5,y:.5})}},{key:"_invite",value:function(){var t=this;JM.H5SDK.getFriendsModule().inviteFriends($M.b64Picture,kM.words.myscore+this.score+"!"+kM.words.canyoudobetter).then((function(){console.log("retour de la popin"),t.closePopin(),u.inviteFriend=!0}))}},{key:"size",get:function(){return{width:OM,height:LM}}},{key:"closePopin",value:function(){var t=this;this._isCloseClicked||(JM.H5SDK.getPlatform().getAdsModule().hideBanner(),JM.H5SDK.getPlatform().getModule("AdReloadModule").clean({name:"Banner",id:6}),JM.H5SDK.getAdsModule().requestInterstitialAd().then((function(){t._isCloseClicked=!0,t.hide(),console.log(JM),JM.restart()})))}},{key:"show",value:function(){JM.H5SDK.getPlatform().getAdsModule().requestBannerAd(),JM.H5SDK.getPlatform().isFacebook()||(this.playBtn.x=0),this.height=window.innerHeight;var t=this.scale.y;this.height=0,this.scroll.visible=!0,this.visible=!0,gM.to(this.scale,{delay:.3,duration:.5,x:t,y:t,ease:"power4.out",onComplete:function(){}}),this.inviteBtn.visible=!1,this.playBtn.visible=!1,this.showLeaderboardInfos();var e=this.score;this.score=0,gM.to(this,{duration:1,score:e})}},{key:"hide",value:function(){var t=this;gM.to(this.scale,{duration:.4,x:.02,y:.02,ease:"power2.in",onComplete:function(){for(t.visible=!1,t.scroll&&t.scroll.clear(),t.scrollAccess=!1,t.scroll.visible=!1;t.container.children.length>0;){t.container.getChildAt(0).destroy()}t._isCloseClicked=!1}})}},{key:"showLeaderboardInfos",value:function(){var t=this;for(console.log("showLeaderboardInfos"),u.playersReady=!1;this.container.children.length>0;){this.container.getChildAt(0).destroy()}this.scroll.add(this.container);var e=0,n=[],i=[],r=[],a=null;if(u.currentleaderboard){for(var o=0;o<u.currentleaderboard.length;o++)if("You"==u.currentleaderboard[o].name){(a=u.currentleaderboard[o]).score=JM.BEST_SCORE,a.ID=o,u.currentleaderboard.splice(o,1);break}console.log("you:",a);for(var s,l=0,h=0;h<u.friends.length;h++)a&&u.friends[h].score>a.score||!u.friends[h].isRealScore?(i.push(u.friends[h]),l=u.friends[h].score>l?u.friends[h].score:l,u.friends[h].isRealScore||(u.friends[h].invite=!0)):r.push(u.friends[h]);for(var c=i.length>=5?i.length:5,d=r.length>=10?r.length:10,f=0,p=a.score,v=l>a.score?l:a.score,m=!0,g=parseInt(Wv.range(30,100)),y=c;y>=0;y--)(s=i[y]?i[y]:$M.players[y])&&(s.color=s.color?s.color:"#40cbe4",s.isFriend?(s.isRealScore?s.rank=parseInt(a.rank/(s.score/a.score)):(s.rank=a.rank-y-g,s.rank=Wv.switchChars(s.rank,"?")),v=s.score,n.push(s)):(v+=Math.random()*(.2*v),s.score=v,s.rank=parseInt(a.rank/(v/a.score)),Wv.insert(n,0,s)),$M.players.splice(y,1),f++);n[0].id="added1",n.push(n[0]),v+=Math.random()*(.2*v),n[0].score=v,n[0].rank=a.rank-1,n.splice(0,1),n.push(a),f++,v=a.score,n[0].id="added2",n.push(n[0]),n[0].score=p-Math.random()*(.2*a.score),n[0].rank=a.rank+1,v=n[0].score,n.splice(0,1);for(var _=0;_<d;_++)(s=r[_]?r[_]:$M.players[_])&&(s.color=s.color?s.color:"#72bbf1",s.isFriend?(Wv.insert(n,f,s),m&&(v=s.score,s.rank=parseInt(a.rank*(a.score/s.score)),m=!1),s.isRealScore?s.rank=parseInt(a.rank*(a.score/s.score)):(s.rank=parseInt(a.rank*(a.score/s.score)),s.rank=Wv.switchChars(s.rank,"?"))):(v-=Math.random()*(.2*v),"added1"!=s.id&&"added1"!=s.id&&(s.score=v),s.rank=parseInt(a.rank*(a.score/v)),n.push(s)),$M.players.splice(_,1));console.log("rankingArrayTop >>>>> ",i),console.log("rankingArrayBottom >>>>> ",r),console.log("rankingArray >>>>> ",n);var x=a.rank,b=a.score;if(u.friends.length>0){for(var w=0;w<n.length;w++)("You"==n[w].name||n[w].isFriend)&&(x=parseInt(n[w].rank)+(n[w].isRealScore?0:parseInt(Wv.range(10,50)))),x&&!n[w].isFriend&&(n[w].rank=++x);x=null;for(var S=n.length-1;S>=0;S--)("You"==n[S].name||n[S].isFriend)&&(x=parseInt(n[S].rank)-(n[S].isRealScore?0:parseInt(Wv.range(10,50)))),x&&!n[S].isFriend&&"You"!=n[S].name&&("added1"==n[S].id?(n[S].rank=a.rank-1,n[S].score=a.score+Wv.range(2,8)):"added2"==n[S].id?n[S].rank=a.rank+1:n[S].rank=--x)}else{for(var T=0;T<n.length;T++)"You"==n[T].name&&(x=parseInt(n[T].rank)),x&&(n[T].rank=++x,b-=Math.random()*(.2*v),"You"!=n[T].name&&(n[T].score=b));x=null,b=a.score;for(var M=n.length-1;M>=0;M--)"You"==n[M].name&&(x=parseInt(n[M].rank)),x&&(n[M].rank=x--,b+=Math.random()*(.2*v),"You"!=n[M].name&&(n[M].score=b))}for(var E,A=n.length>=10?n.length:10,P=0;P<A;P++){s=n[P]?n[P]:$M.players[P];var C=new DM(s.id,s.rank,s.name,s.img||s.imguri,s.color,parseInt(s.score),s.invite);C.on("invite",(function(){console.log("invite (play with)"),t.closePopin(),u.inviteFriend=!0})),C.scale.set(.9),"added1"==s.id?(n[P-1]&&n[P-1].isFriend&&((E=new WS($M.texturesPixi.basicInter)).anchor.x=.5,E.tint=7519217,E.scale.set(.5,.2),E.y=e,e+=E.height+5,this.container.addChild(E)),C.y=e,e+=C.height+10,this.container.addChild(C)):"added2"==s.id?(C.y=e,e+=C.height+10,this.container.addChild(C),n[P+1]&&n[P+1].isFriend&&((E=new WS($M.texturesPixi.basicInter)).anchor.x=.5,E.tint=7519217,E.scale.set(.5,.2),E.y=e,e+=E.height+5,this.container.addChild(E))):(C.y=e,e+=C.height+10,this.container.addChild(C)),"You"==s.name&&(this.playerPosY=e-5*(C.height+10)+52,this.youElement=C)}}this.scroll.contentY=-2e3,gM.to(this.scroll,{delay:.5,duration:1.5,contentY:-this.playerPosY,ease:"power4.out",onStart:function(){t.scrollAccess=!0},onComplete:function(){JM.H5SDK.getPlatform().isFacebook()&&(t.inviteBtn.visible=!0,t.inviteBtn.scale.set(0),gM.to(t.inviteBtn.scale,{duration:.5,x:.8,y:.8,ease:"back.out(2)"})),t.playBtn.visible=!0,t.playBtn.scale.set(0),gM.to(t.playBtn.scale,{duration:.5,x:.8,y:.8,ease:"back.out(2)"})}}),this.youElement.parent.addChild(this.youElement),gM.to(this.youElement.scale,{delay:1.6,duration:.3,x:1.1,y:1.1,ease:"none"}),gM.to(this.youElement.scale,{delay:1.9,duration:1,x:.95,y:.95,ease:"back.out(2)"}),gM.to(this.youElement,{delay:1.9,duration:1,y:this.youElement.y-3,ease:"back.out(2)"})}},{key:"bestScoreValue",set:function(t){this.bestScoreText.text=t}},{key:"score",get:function(){return this.scoreText.text},set:function(t){this.scoreText.text=parseInt(t)}},{key:"resize",value:function(){console.log("resize"),this.height=window.innerHeight,this.scale.x=this.scale.y,this.x=window.innerWidth/2,this.y=window.innerHeight/2}},{key:"update",value:function(){this.scrollAccess&&this.scroll&&this.scroll.update()}}]),n}(a_),FM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this)).coinBackground=null,t.coinIcon=null,t.coinNumberText=null,t.coinNumber=0,t.initCoin(),t}return s(n,[{key:"initCoin",value:function(){var t=$M.texturesPixi.coinBackground;this.coinBackground=new WS(t),this.coinBackground.scale.set(.45),this.coinBackground.anchor.set(1,0),this.coinBackground.y=0,this.addChild(this.coinBackground);var e=$M.texturesPixi.coinsGold;this.coinIcon=new WS(e),this.coinIcon.scale.set(.13),this.coinIcon.anchor.set(.5,.5),this.coinIcon.y=56,this.addChild(this.coinIcon);var n=new ZS({fontFamily:"voodoo_casual-bold",fontSize:23,fill:"#ffffff"});this.coinNumberText=new iT(this.coinNumber,n),this.coinNumberText.y=56,this.coinNumberText.anchor.set(1,.5),this.addChild(this.coinNumberText)}},{key:"resize",value:function(t,e,n){this.coinBackground.x=t,this.coinIcon.x=t-95,this.coinNumberText.x=t-5,n<1?this.y=55*n:(this.y=70,this.scale.set(1))}},{key:"updateCoin",value:function(t){var e=this,n=t-this.coinNumber;this.coinNumber=t,gM.to(this.coinNumberText,{duration:n>10?.5:.1,text:this.coinNumber,onUpdate:function(){e.coinNumberText.text=parseInt(e.coinNumberText.text),e.coinNumber>=1e4&&(e.coinNumberText.width=70,e.coinNumberText.scale.y=e.coinNumberText.scale.x)}}),this.coinIcon.scale.set(.2),this.scaleTween&&this.scaleTween.kill(),this.scaleTween=gM.to(this.coinIcon.scale,{delay:.1,duration:.3,x:.13,y:.13})}},{key:"notEnoughCoin",value:function(){var t=this;this.coinBackground.tint=16711680,gM.delayedCall(.3,(function(){t.coinBackground.tint=16777215}));var e=this.coinBackground.y;gM.fromTo(this.coinBackground,{y:this.coinBackground.y-5},{y:this.coinBackground.y,duration:.1,repeat:3,ease:"elastic.out(1, 0.3)",onComplete:function(){t.coinBackground.y=e}})}},{key:"coinPos",get:function(){return{x:this.coinIcon.x-20,y:this.coinIcon.y+this.y}}}]),n}(a_),BM=function(t){d(n,t);var e=m(n);function n(t,i,r){var o,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:88,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return a(this,n),(o=e.call(this)).path=t,o.color=i,o.score=r,o._rank=s,o.mainPlayer=l,o.build(),o}return s(n,[{key:"build",value:function(){var t,e=new WS($M.texturesPixi.cadre);e.tint=Wv.hashtagToHexa(this.color),e.anchor.set(.5),e.y=-e.height/2,this.addChild(e),t=this.path?WS.from(this.path):new WS(new G_(new S_));var n=new WS;n.texture=this.path?t.texture:$M.texturesPixi.you,n.anchor.set(.5);var i=setInterval((function(){n.width>5&&(n.width=128,n.scale.y=n.scale.x,clearInterval(i))}),100);e.addChild(n);var r=new zS;if(r.beginFill(16711680),r.drawRoundedRect(-65,-65,130,130,15),r.endFill(),r.y=-4,n.mask=r,e.addChild(r),this.score){var a=new ZS({fontFamily:"voodoo_casual-bold",fontSize:42,fill:"#000000"}),o=new iT(parseInt(this.score),a);o.anchor.set(.5,.9),this.addChild(o),e.y-=.7*o.height}this._picto=n,this._cadre=e;var s=new ZS({fontFamily:"voodoo_casual-bold",fontSize:40,fill:"#000000",stroke:e.tint,strokeThickness:4});this.textRank=new iT(this._rank,s)}},{key:"picto",get:function(){return this._picto}},{key:"cadre",get:function(){return this._cadre}},{key:"texture",get:function(){return this._picto.texture}},{key:"rank",get:function(){return this.textRank.text},set:function(t){this.textRank.text=t}},{key:"img",get:function(){return this.path}}]),n}(a_),UM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),t=e.call(this),u.challengers=t.challengers=[],t.initPlayerPos=.237*window.innerWidth,t.chalengersBaseScale=.3,t.scoreScale=100*u.scoreHeaderCoef,t.posLimit=window.innerWidth-50,t.scoreSegment=t.posLimit-t.initPlayerPos,t.rank=parseInt(Wv.range(u.scoreRangeMin,u.scoreRangeMax)),t.id=u.playersNumber,t.i=0,t.posY=60,t.initBackground=t.initBackground.bind(h(t)),t.initBackground(),t.initPlayer(),t.initPlayers(),t}return s(n,[{key:"initBackground",value:function(){var t=$M.texturesPixi.progressBar;this._barre=new WS(t),this._barre.y=this.posY,this._barre.width=window.innerWidth,this._barre.scale.y=1,this.addChild(this._barre)}},{key:"initPlayer",value:function(){var t=JM.H5SDK.getPlatform().getPlayerInfo()?JM.H5SDK.getPlatform().getPlayerInfo().playerPic:null;u.player=this.player=new BM(t,u.cadreP1Color,null,this.rank,!0),this.player.scale.set(.3),this.player.y=this.posY,this.player.x=this.initPlayerPos,this.addChild(this.player)}},{key:"initPlayers",value:function(t){var e=this;console.log("initPlayers");for(var n=0;n<this.challengers.length;n++)this.challengers[n].tween&&this.challengers[n].tween.kill(),this.challengers[n].visible=!1,this.challengers[n].destroy();this.challengers=[],this.player.rank=this.rank,this.i=0,this.id=0,$M.resetProfiles((function(n){console.log("players:",n),e.initFriends(),e.initLeaderboardInfos();for(var i=0;i<u.playersNumber;i++)e.addNewChallenger(i);console.log("challengers >> ",e.challengers),e.updateScore(0,0),JM.pixiManager.setObjectifDatas(),u.gameover=!1,t&&t()}))}},{key:"initFriends",value:function(){var t;for(this.firstTime=!0,u.friendsArray=[],t=0;t<$M.players.length;t++)$M.players[t].isFriend?($M.players[t].color=$M.players[t].isRealScore?"#ffce0a":"#72f17e",$M.players[t].leaderColor="#72f17e",$M.players[t].img=$M.players[t].imguri,u.friendsArray.push($M.players[t])):($M.players[t].color="#72bbf1",$M.players[t].leaderColor="#5a7bc3");var e=0;for(t=0;t<u.friendsArray.length;t++){u.friendsArray[t].isRealScore||(this.firstTime?(u.friendsArray[t].score=2e3+500*Math.random(),this.firstTime=!1):(u.friendsArray[t].score=u.profilesScoreBarStep*(e+1)+500*Math.random(),e++));for(var n=0;n<$M.players.length;n++)$M.players[n]==u.friendsArray[t]&&$M.players.splice(n,1)}Wv.shortByKey(u.friendsArray,"score"),u.friends=b(u.friendsArray)}},{key:"initLeaderboardInfos",value:function(){u.currentleaderboard=[],u.leaderboardInfos=[];for(var t=0;t<u.playersNumber;t++){var e={rank:this.rank-t+u.playersNumber,score:0,name:$M.players[t].name,img:$M.players[t].imguri,color:"#5a7bc3"};u.leaderboardInfos.push(e)}u.leaderboardInfos.push({rank:this.rank,score:JM.BEST_SCORE,name:"You",img:u.player.texture.baseTexture.resource,color:"#ffffff"}),console.log("leaderboardInfos:",u.leaderboardInfos)}},{key:"addNewChallenger",value:function(t){this.scoreScale=100*u.scoreHeaderCoef;var e=(t+1)*this.scoreScale*.45+Wv.range(0,.2*this.scoreScale)+.25*this.scoreScale,n=this.rank-t-1;n<=0&&(n="");for(var i=null,r=0;r<u.friendsArray.length;r++)if(e>=u.friendsArray[r].score-100&&e<u.friendsArray[r].score)e-=100;else if(e>=u.friendsArray[r].score){i=u.friendsArray[r],u.friendsArray[r].isRealScore&&(e=u.friendsArray[r].score),u.friendsArray.splice(r,1);break}i||((i=$M.players[this.id]).color="#72bbf1",i.leaderColor="#5a7bc3");var a=new BM(i.imguri,i.color,e,n);a.name=i.name,a.color=i.leaderColor,a.scale.set(this.chalengersBaseScale),a.x=this.initPlayerPos+e/this.scoreScale*this.scoreSegment,a.score=e,a.isFriend=i.isFriend,a.isRealScore=i.isRealScore,a.killed=!1,a.id=t,this.i=t,a.y=this.posY+5,this.id<$M.players.length-1?this.id++:this.id=0,a.x>this.posLimit&&(a.visible=!1),""!=n&&(this.challengers.push(a),u.challengers.push(a),u.leaderboardInfos.push(a),this.addChild(a)),console.log("config.challengers:",u.challengers)}},{key:"resize",value:function(){this._barre.width=window.innerWidth,this.initPlayerPos=.237*window.innerWidth,this.player.x=this.initPlayerPos}},{key:"updateScore",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;if(!u.gameover){var i,r;console.log("updateScore"),this.playerScore=t;for(var a=0;a<this.challengers.length;a++)if(0==n&&(this.challengers[a].killed=!1,this.challengers[a].picto.visible=!0,this.challengers[a].scale.set(this.chalengersBaseScale)),i=this.initPlayerPos+(this.challengers[a].score-t)/this.scoreScale*this.scoreSegment,!(r=this.challengers[a]).killed)if(i>=this.posLimit)r.visible=!1,r.scale.set(0);else if(i>this.initPlayerPos){r.visible=!0;var o=.3;r.scale.x<o&&gM.to(r.scale,{delay:.5,duration:.4,x:o,y:o}),r.tween=gM.to(r,{duration:n,x:i,ease:"none"})}else r.tween&&r.tween.kill(),r.killed=!0,gM.to(r,{duration:n,x:this.initPlayerPos,ease:"none",onComplete:function(t){gM.to(t.scale,{duration:.3,x:.1*t.scale.x,y:2*t.scale.y,ease:"back.in(3)"}),gM.to(t.scale,{delay:.3,duration:.2,x:0,y:0,onComplete:function(t){var n=Math.random();n>=.4?(console.log("+4 Coins",t),e.addCoins()):n<.4&&n>=.2?(console.log("+1 Arrow Item Bonus"),e.addBooster()):(console.log("+1 Shield Item Bonus"),e.addShield()),e.i++,t.visible=!1,e.player.rank=t.rank,e.challengers.splice(0,1),e.addNewChallenger(e.i),console.log("challengers:",e.challengers),u.leaderboardInfos.splice(0,1);for(var i=0;i<u.leaderboardInfos.length;i++)if("You"==u.leaderboardInfos[i].name){u.leaderboardInfos[i].score=JM.BEST_SCORE,u.leaderboardInfos[i].color="#ffffff";var r=u.leaderboardInfos[i].rank;u.leaderboardInfos[i].rank=u.leaderboardInfos[i+1].rank,u.leaderboardInfos[i+1].rank=r;var a=u.leaderboardInfos[i+1];u.leaderboardInfos[i+1]=u.leaderboardInfos[i],u.leaderboardInfos[i]=a,i++}u.currentleaderboard=b(u.leaderboardInfos)},onCompleteParams:[t]})},onCompleteParams:[r]});u.currentleaderboard=b(u.leaderboardInfos)}}},{key:"addCoins",value:function(){JM.pixiManager.rewardEffect.add("coins",JM.pixiManager.header.playerIco.position,JM.pixiManager.coin.coinPos,(function(){JM.COIN+=4}))}},{key:"addShield",value:function(){JM.pixiManager.rewardEffect.add("shield",JM.pixiManager.header.playerIco.position,JM.pixiManager.shieldItems.getBtn.position,(function(){JM.pixiManager.shieldItems.add()}))}},{key:"addBooster",value:function(){JM.pixiManager.rewardEffect.add("booster",JM.pixiManager.header.playerIco.position,JM.pixiManager.arrowItems.getBtn.position,(function(){JM.pixiManager.arrowItems.add()}))}},{key:"restart",value:function(){console.log("restart"),this.initPlayers()}},{key:"playerIco",get:function(){return this.player}}]),n}(a_),GM=function(t){d(n,t);var e=m(n);function n(t,i,r){var o;return a(this,n),(o=e.call(this)).skinName=t,o.skinIndex=i,o.skinContainer=r,o.skinBackground=null,o.skinIcon=null,o.maskContainer=null,o.selectionRing=null,o.distanceBetweenSkins=80,o.isSkinSelectionEnabled=!1,o.onClickSkin=o.onClickSkin.bind(h(o)),o.initSkin(),o}return s(n,[{key:"initSkin",value:function(){this.skinContainer.addChild(this);var t=Math.floor(this.skinIndex/3),e=(this.skinIndex-3*t-1)*this.distanceBetweenSkins,n=(t-1)*this.distanceBetweenSkins-280;this.x=e,this.y=n;var i=$M.texturesPixi.holeBackground;this.skinBackground=new WS(i),this.skinBackground.scale.set(.2),this.skinBackground.anchor.set(.5),this.addChild(this.skinBackground);var r=this.skinName+"Icon",a=$M.texturesPixi[r];this.skinIcon=new WS(a),this.skinIcon.scale.set(.18),this.skinIcon.anchor.set(.5),this.addChild(this.skinIcon),this.maskContainer=new a_,this.addChild(this.maskContainer);var o=new zS;o.beginFill(0),o.drawCircle(0,0,24),o.alpha=.5,o.endFill(),this.maskContainer.addChild(o);var s=$M.texturesPixi.skinLock,l=new WS(s);l.scale.set(.09),l.anchor.set(.5),this.maskContainer.addChild(l),this.selectionRing=new zS,this.selectionRing.lineStyle(6,4252926,1),this.selectionRing.drawCircle(0,0,25),this.selectionRing.endFill(),this.selectionRing.visible=!1,this.addChild(this.selectionRing)}},{key:"enableSelection",value:function(){var t=this;this.isSkinSelectionEnabled||(gM.to(this.scale,{x:1.5,y:1.5,duration:.5}),this.selectionRing.visible=!0,gM.delayedCall(.5,(function(){gM.to(t.scale,{x:1,y:1,duration:.5}),t.skinName!=u.currentSkin&&(t.selectionRing.visible=!1)})),this.maskContainer.visible=!1,this.skinIcon.interactive=!0,this.skinIcon.buttonMode=!0,this.skinIcon.on("pointerdown",this.onClickSkin),this.isSkinSelectionEnabled=!0)}},{key:"onClickSkin",value:function(){u.changeSkinReady&&(console.log("this.selectionRing.visible",this.selectionRing.visible),1==this.selectionRing.visible?JM.CURRENT_SKIN="":JM.changeSkinByBtn(this.skinName,this),JM.uploadPlayerData())}},{key:"blinkSelection",value:function(){var t=this;this.selectionRing.visible=!0,gM.delayedCall(.2,(function(){t.selectionRing.visible=!1}))}},{key:"selectSkin",value:function(){this.selectionRing.visible=!0}},{key:"deselectSkin",value:function(){this.selectionRing.visible=!1}},{key:"loadingSkin",value:function(){console.log("loadingSkin"),u.changeSkinReady=!1,this.scaleTween&&this.scaleTween.kill(),this.scaleTween=gM.to(this.selectionRing.scale,{duration:.1,x:.82,y:.82,yoyo:!0,repeat:-1,yoyoEase:"none"})}},{key:"skinLoaded",value:function(){console.log("skinLoaded"),u.changeSkinReady=!0,this.scaleTween&&this.scaleTween.kill(),this.scaleTween=gM.to(this.selectionRing.scale,{duration:.1,x:1,y:1})}}]),n}(a_),zM=function(t){d(i,t);var n=m(i);function i(){var t;return a(this,i),(t=n.call(this)).buttonOpenSkinShop=null,t.alertSkinShop=null,t.skinShopContainer=null,t.skinShopBackground=null,t.buttonCloseSkinShop=null,t.leftButton=null,t.rightButton=null,t.rarityBackground=null,t.rarityButton=null,t.rarityText=null,t.rarityTabList=[{positionX:-90,text:"BASIC",tabContainer:t.basicSkinContainer},{positionX:0,text:"RARE",tabContainer:t.rareSkinContainer},{positionX:90,text:"FUNKY",tabContainer:t.funkySkinContainer}],t.rarityTabIndex=0,t.basicSkinContainer=null,t.basicSkinList=[],t.basicSkinUnpurchasedList=[],t.basicSkinPurchasePrice=100,t.basicSkinPriceText=null,t.basicSkinPurchaseButton=null,t.basicSkinWatchAdButton=null,t.rareSkinContainer=null,t.rareSkinList=[],t.rareSkinUnpurchasedList=[],t.rareSkinPurchasePrice=100,t.rareSkinPriceText=null,t.rareSkinPurchaseButton=null,t.rareSkinWatchAdButton=null,t.funkySkinContainer=null,t.funkySkinList=[],t.funkySkinUnpurchasedList=[],t.funkySkinWatchAdButton=null,t.isSkinShopOpen=!1,t.skinShopHeight=515,t.onClickOpenSkinShop=t.onClickOpenSkinShop.bind(h(t)),t.onClickCloseSkinShop=t.onClickCloseSkinShop.bind(h(t)),t.onClickLeftButton=t.onClickLeftButton.bind(h(t)),t.onClickRightButton=t.onClickRightButton.bind(h(t)),t.onClickBasicPurchase=t.onClickBasicPurchase.bind(h(t)),t.onClickRarePurchase=t.onClickRarePurchase.bind(h(t)),t.onClickWatchAdAddCoin=t.onClickWatchAdAddCoin.bind(h(t)),t.onClickWatchAdFunky=t.onClickWatchAdFunky.bind(h(t)),t.updateRarityButton=t.updateRarityButton.bind(h(t)),t.initSkinShop(),t}return s(i,[{key:"initSkinShop",value:function(){var t=this,e=$M.texturesPixi.buttonSkin;this.buttonOpenSkinShop=new WS(e),this.buttonOpenSkinShop.interactive=!0,this.buttonOpenSkinShop.buttonMode=!0,this.buttonOpenSkinShop.on("pointerdown",this.onClickOpenSkinShop),this.buttonOpenSkinShop.scale.set(.3),this.buttonOpenSkinShop.anchor.set(1,1),this.addChild(this.buttonOpenSkinShop);var n=$M.texturesPixi.alertIcon;this.alertSkinShop=new WS(n),this.alertSkinShop.scale.set(2),this.alertSkinShop.anchor.set(.5),this.alertSkinShop.position.set(-190,-190),this.alertSkinShop.visible=!1,this.buttonOpenSkinShop.addChild(this.alertSkinShop),this.skinShopContainer=new a_,this.addChild(this.skinShopContainer);var i=$M.texturesPixi.skinShopBackground;this.skinShopBackground=new WS(i),this.skinShopContainer.addChild(this.skinShopBackground),this.skinShopBackground.anchor.set(.5,1);var r=$M.texturesPixi.skinShopClose;this.buttonCloseSkinShop=new WS(r),this.buttonCloseSkinShop.interactive=!0,this.buttonCloseSkinShop.buttonMode=!0,this.buttonCloseSkinShop.on("pointerdown",this.onClickCloseSkinShop),this.buttonCloseSkinShop.scale.set(.4),this.buttonCloseSkinShop.anchor.set(1,1),this.skinShopContainer.addChild(this.buttonCloseSkinShop);var a=$M.texturesPixi.leftButton;this.leftButton=new WS(a),this.leftButton.interactive=!0,this.leftButton.buttonMode=!0,this.leftButton.on("pointerdown",this.onClickLeftButton),this.leftButton.scale.set(.18),this.leftButton.anchor.set(1,0),this.skinShopContainer.addChild(this.leftButton);var o=$M.texturesPixi.rightButton;this.rightButton=new WS(o),this.rightButton.interactive=!0,this.rightButton.buttonMode=!0,this.rightButton.on("pointerdown",this.onClickRightButton),this.rightButton.scale.set(.18),this.rightButton.anchor.set(0,0),this.skinShopContainer.addChild(this.rightButton);var s=$M.texturesPixi.rarityBackground;this.rarityBackground=new WS(s),this.rarityBackground.anchor.set(.5),this.rarityBackground.width=270,this.skinShopContainer.addChild(this.rarityBackground);var l=new ZS({fontFamily:"voodoo_casual-bold",fontSize:20,fill:"#a7a6a7"}),u=new iT("BASIC",l);u.anchor.set(.5),u.x=this.rarityTabList[0].positionX,this.rarityBackground.addChild(u);var h=new iT("RARE",l);h.anchor.set(.5),h.x=this.rarityTabList[1].positionX,this.rarityBackground.addChild(h);var c=new iT("FUNKY",l);c.anchor.set(.5),c.x=this.rarityTabList[2].positionX,this.rarityBackground.addChild(c);var d=$M.texturesPixi.orangeButton;this.rarityButton=new WS(d),this.rarityButton.scale.set(.35,.35),this.rarityButton.anchor.set(.5),this.rarityButton.x=this.rarityTabList[0].positionX,this.rarityBackground.addChild(this.rarityButton);var f=new ZS({fontFamily:"voodoo_casual-bold",fontSize:20,fill:"#ffffff"});this.rarityText=new iT(this.rarityTabList[0].text,f),this.rarityText.anchor.set(.5),this.rarityText.x=this.rarityTabList[0].positionX,this.rarityBackground.addChild(this.rarityText),this.blueButtonTexture=$M.texturesPixi.blueButton,this.greyButtonTexture=$M.texturesPixi.greyButton;var p=$M.texturesPixi.blueButton,v=$M.texturesPixi.greenButton,m=$M.texturesPixi.coinsGold,g=$M.texturesPixi.playIcon,y=new ZS({fontFamily:"voodoo_casual-bold",fontSize:25,fill:"#ffffff"}),_=new ZS({fontFamily:"voodoo_casual-bold",fontSize:18,fill:"#ffffff"}),x=new ZS({fontFamily:"voodoo_casual-bold",fontSize:12,fill:"#a7a6a7"});this.basicSkinContainer=new a_,this.skinShopContainer.addChild(this.basicSkinContainer);for(var b=xM.basicSkinList,w=0;w<b.length;w++){var S=b[w].name,T=w,M=this.basicSkinContainer,E=new GM(S,T,M);this.basicSkinList.push(E)}var A=new iT(kM.words.basicTutorial,x);A.anchor.set(.5,1),A.x=0,A.y=-130,this.basicSkinContainer.addChild(A),this.basicSkinPurchaseButton=new WS(p),this.basicSkinPurchaseButton.interactive=!0,this.basicSkinPurchaseButton.buttonMode=!0,this.basicSkinPurchaseButton.on("pointerdown",this.onClickBasicPurchase),this.basicSkinPurchaseButton.scale.set(.5,.35),this.basicSkinPurchaseButton.anchor.set(1,1),this.basicSkinPurchaseButton.x=-20,this.basicSkinPurchaseButton.y=-50,this.basicSkinContainer.addChild(this.basicSkinPurchaseButton),this.basicSkinPriceText=new iT(this.basicSkinPurchasePrice,y),this.basicSkinPriceText.anchor.set(1,1),this.basicSkinPriceText.x=-65,this.basicSkinPriceText.y=-80,this.basicSkinContainer.addChild(this.basicSkinPriceText),(O=new WS(m)).scale.set(.13),O.anchor.set(1,1),O.x=-30,O.y=-80,this.basicSkinContainer.addChild(O),this.basicSkinWatchAdButton=new WS(v),this.basicSkinWatchAdButton.interactive=!0,this.basicSkinWatchAdButton.buttonMode=!0,this.basicSkinWatchAdButton.on("pointerdown",this.onClickWatchAdAddCoin),this.basicSkinWatchAdButton.scale.set(.5,.35),this.basicSkinWatchAdButton.anchor.set(0,1),this.basicSkinWatchAdButton.x=20,this.basicSkinWatchAdButton.y=-50,this.basicSkinContainer.addChild(this.basicSkinWatchAdButton),(L=new WS(g)).scale.set(.05),L.anchor.set(0,1),L.x=75,L.y=-75,this.basicSkinContainer.addChild(L),(D=new iT("+500",y)).anchor.set(0,1),D.x=40,D.y=-85,this.basicSkinContainer.addChild(D),(O=new WS(m)).scale.set(.13),O.anchor.set(0,1),O.x=110,O.y=-80,this.basicSkinContainer.addChild(O),this.rarityTabList[0].tabContainer=this.basicSkinContainer,this.rareSkinContainer=new a_,this.skinShopContainer.addChild(this.rareSkinContainer);for(var P=xM.rareSkinList,C=0;C<P.length;C++){var k=P[C].name,R=C,I=this.rareSkinContainer;E=new GM(k,R,I);this.rareSkinList.push(E)}var D,O,L,N=new iT(kM.words.rareTutorial,x);N.anchor.set(.5,1),N.x=0,N.y=-130,this.rareSkinContainer.addChild(N),this.rareSkinPurchaseButton=new WS(p),this.rareSkinPurchaseButton.interactive=!0,this.rareSkinPurchaseButton.buttonMode=!0,this.rareSkinPurchaseButton.on("pointerdown",this.onClickRarePurchase),this.rareSkinPurchaseButton.scale.set(.5,.35),this.rareSkinPurchaseButton.anchor.set(1,1),this.rareSkinPurchaseButton.x=-20,this.rareSkinPurchaseButton.y=-50,this.rareSkinContainer.addChild(this.rareSkinPurchaseButton),this.rareSkinPriceText=new iT(this.rareSkinPurchasePrice,y),this.rareSkinPriceText.anchor.set(1,1),this.rareSkinPriceText.x=-65,this.rareSkinPriceText.y=-80,this.rareSkinContainer.addChild(this.rareSkinPriceText),(O=new WS(m)).scale.set(.13),O.anchor.set(1,1),O.x=-30,O.y=-80,this.rareSkinContainer.addChild(O),this.rareSkinWatchAdButton=new WS(v),this.rareSkinWatchAdButton.interactive=!0,this.rareSkinWatchAdButton.buttonMode=!0,this.rareSkinWatchAdButton.on("pointerdown",this.onClickWatchAdAddCoin),this.rareSkinWatchAdButton.scale.set(.5,.35),this.rareSkinWatchAdButton.anchor.set(0,1),this.rareSkinWatchAdButton.x=20,this.rareSkinWatchAdButton.y=-50,this.rareSkinContainer.addChild(this.rareSkinWatchAdButton),(L=new WS(g)).scale.set(.05),L.anchor.set(0,1),L.x=75,L.y=-75,this.rareSkinContainer.addChild(L),(D=new iT("+500",y)).anchor.set(0,1),D.x=40,D.y=-85,this.rareSkinContainer.addChild(D),(O=new WS(m)).scale.set(.13),O.anchor.set(0,1),O.x=110,O.y=-80,this.rareSkinContainer.addChild(O),this.rarityTabList[1].tabContainer=this.rareSkinContainer,this.funkySkinContainer=new a_,this.skinShopContainer.addChild(this.funkySkinContainer);for(var F=xM.funkySkinList,B=0;B<F.length;B++){var U=F[B].name,G=B,z=this.funkySkinContainer;E=new GM(U,G,z);this.funkySkinList.push(E)}this.funkyExplicationText=new iT(kM.words.funkyTutorial,x),this.funkyExplicationText.anchor.set(.5,1),this.funkyExplicationText.x=0,this.funkyExplicationText.y=-130,this.funkySkinContainer.addChild(this.funkyExplicationText),this.funkySkinWatchAdButton=new WS(v),this.funkySkinWatchAdButton.interactive=!0,this.funkySkinWatchAdButton.buttonMode=!0,this.funkySkinWatchAdButton.on("pointerdown",this.onClickWatchAdFunky),this.funkySkinWatchAdButton.scale.set(.5,.35),this.funkySkinWatchAdButton.anchor.set(.5,1),this.funkySkinWatchAdButton.x=0,this.funkySkinWatchAdButton.y=-50,this.funkySkinContainer.addChild(this.funkySkinWatchAdButton),(L=new WS(g)).scale.set(.05),L.anchor.set(0,1),L.x=0,L.y=-75,this.funkySkinContainer.addChild(L);var H=new iT(kM.words.unlock1,_);H.anchor.set(.5,1),H.scale.set(.85),H.x=0,H.y=-90,this.funkySkinContainer.addChild(H),this.rarityTabList[2].tabContainer=this.funkySkinContainer,this.isSkinShopOpen?this.skinShopContainer.scale.set(1):this.skinShopContainer.scale.set(0),this.updateRarityButton(),gM.delayedCall(.1,(function(){var e=setInterval((function(){JM.PURCHASED_SKINS&&(e&&clearInterval(e),t.updateSkinPurchased())}),60)}))}},{key:"resize",value:function(t,e,n){this.buttonOpenSkinShop.x=80,this.buttonOpenSkinShop.y=200,this.skinShopContainer.x=t/2,this.skinShopContainer.y=e-15,this.isSkinShopOpen&&(n<=.9?this.skinShopContainer.scale.set(n):this.skinShopContainer.scale.set(.9)),this.skinShopContainerScale=this.skinShopContainer.scale.x,this.skinShopBackground.height=this.skinShopHeight+15,this.skinShopBackground.y=15,this.skinShopBackground.width=this.skinShopHeight,this.buttonCloseSkinShop.y=86-this.skinShopHeight,this.buttonCloseSkinShop.x=t/2<250?t/2+this.buttonCloseSkinShop.width/2:250,this.leftButton.x=-140,this.leftButton.y=40-this.skinShopHeight,this.rightButton.x=140,this.rightButton.y=40-this.skinShopHeight,this.rarityBackground.x=0,this.rarityBackground.y=63-this.skinShopHeight}},{key:"onClickOpenSkinShop",value:function(){var t=this;u.skinOpen=!0,JM.H5SDK.getPlatform().getAdsModule().requestBannerAd(),gM.fromTo(this.skinShopContainer.scale,{x:0,y:0},{x:.9,y:.9,duration:.3});var e=setInterval((function(){JM.PURCHASED_SKINS&&(e&&clearInterval(e),t.updateSkinPurchased())}),60)}},{key:"updateSkinPurchased",value:function(){var t=JM.PURCHASED_SKINS;this.funkySkinUnpurchasedList=[];for(var e=0;e<this.funkySkinList.length;e++){var n=this.funkySkinList[e];t.includes(n.skinName)?n.enableSelection():this.funkySkinUnpurchasedList.push(n)}0==this.funkySkinUnpurchasedList.length&&(this.funkySkinWatchAdButton.visible=!1,this.funkyExplicationText.visible=!1);for(var i=0;i<xM.oldSkinNameList.length;i++){var r=xM.oldSkinNameList[i];t.includes(r)&&(t.splice(t.indexOf(r),1),this.unlockFunkySkin(),t=JM.PURCHASED_SKINS)}this.basicSkinUnpurchasedList=[];for(var a=0;a<this.basicSkinList.length;a++){var o=this.basicSkinList[a];t.includes(o.skinName)?o.enableSelection():this.basicSkinUnpurchasedList.push(o)}this.rareSkinUnpurchasedList=[];for(var s=0;s<this.rareSkinList.length;s++){var l=this.rareSkinList[s];t.includes(l.skinName)?l.enableSelection():this.rareSkinUnpurchasedList.push(l)}this.updateSkinPrice(),this.updateCoin(JM.COIN)}},{key:"onClickCloseSkinShop",value:function(){gM.fromTo(this.skinShopContainer.scale,{x:1,y:1},{x:0,y:0,duration:.3,onComplete:function(){u.skinOpen=!1}}),JM.H5SDK.getPlatform().getAdsModule().hideBanner(),JM.H5SDK.getPlatform().getModule("AdReloadModule").clean({name:"Banner",id:6})}},{key:"onClickLeftButton",value:function(){0==this.rarityTabIndex?(this.rarityTabIndex=this.rarityTabList.length-1,this.updateRarityButton()):(this.rarityTabIndex-=1,this.updateRarityButton())}},{key:"onClickRightButton",value:function(){this.rarityTabIndex==this.rarityTabList.length-1?(this.rarityTabIndex=0,this.updateRarityButton()):(this.rarityTabIndex+=1,this.updateRarityButton())}},{key:"onClickBasicPurchase",value:function(){var t=this;if(JM.COIN>=this.basicSkinPurchasePrice&&0!=this.basicSkinUnpurchasedList.length){JM.COIN-=this.basicSkinPurchasePrice;var e=MM.randomNum(0,this.basicSkinUnpurchasedList.length-1);JM.PURCHASED_SKINS.push(this.basicSkinUnpurchasedList[e].skinName),JM.uploadPlayerData(),this.updateSkinPrice();for(var n=this.basicSkinUnpurchasedList.length,i=0;i<n;i++)gM.delayedCall(.2*i,(function(){var e=MM.randomNum(0,t.basicSkinUnpurchasedList.length-1);t.basicSkinUnpurchasedList[e].blinkSelection()}));gM.delayedCall(.2*n,(function(){t.basicSkinUnpurchasedList[e].enableSelection(),t.basicSkinUnpurchasedList.splice(e,1)}))}else JM.notEnoughCoin()}},{key:"onClickRarePurchase",value:function(){var t=this;if(JM.COIN>=this.rareSkinPurchasePrice&&0!=this.rareSkinUnpurchasedList.length){JM.COIN-=this.rareSkinPurchasePrice;var e=MM.randomNum(0,this.rareSkinUnpurchasedList.length-1);JM.PURCHASED_SKINS.push(this.rareSkinUnpurchasedList[e].skinName),JM.uploadPlayerData(),this.updateSkinPrice();for(var n=this.rareSkinUnpurchasedList.length,i=0;i<n;i++)gM.delayedCall(.2*i,(function(){var e=MM.randomNum(0,t.rareSkinUnpurchasedList.length-1);t.rareSkinUnpurchasedList[e].blinkSelection()}));gM.delayedCall(.2*n,(function(){t.rareSkinUnpurchasedList[e].enableSelection(),t.rareSkinUnpurchasedList.splice(e,1)}))}else JM.notEnoughCoin()}},{key:"onClickWatchAdAddCoin",value:function(){this.requestRewarded((function(t){t&&(JM.COIN+=500,JM.uploadPlayerData())}))}},{key:"onClickWatchAdFunky",value:function(){var t=this;0!=this.funkySkinUnpurchasedList.length&&this.requestRewarded((function(e){e&&t.unlockFunkySkin()}))}},{key:"unlockFunkySkin",value:function(){var t=this;if(0!=this.funkySkinUnpurchasedList.length){var e=MM.randomNum(0,this.funkySkinUnpurchasedList.length-1);JM.PURCHASED_SKINS.push(this.funkySkinUnpurchasedList[e].skinName),JM.uploadPlayerData();for(var n=this.funkySkinUnpurchasedList.length,i=0;i<n;i++)gM.delayedCall(.2*i,(function(){var e=MM.randomNum(0,t.funkySkinUnpurchasedList.length-1);t.funkySkinUnpurchasedList[e].blinkSelection()}));gM.delayedCall(.2*n,(function(){t.funkySkinUnpurchasedList[e].enableSelection(),t.funkySkinUnpurchasedList.splice(e,1)}))}}},{key:"updateRarityButton",value:function(){gM.to(this.rarityButton,{x:this.rarityTabList[this.rarityTabIndex].positionX,duration:.2}),gM.to(this.rarityText,{x:this.rarityTabList[this.rarityTabIndex].positionX,duration:.2}),this.rarityText.text=this.rarityTabList[this.rarityTabIndex].text;for(var t=0;t<this.rarityTabList.length;t++){var e=this.rarityTabList[t];t==this.rarityTabIndex?gM.to(e.tabContainer.scale,{x:1,y:1,duration:.2}):gM.to(e.tabContainer.scale,{x:0,y:0,duration:.2})}}},{key:"requestRewarded",value:function(){var t=r(e().mark((function t(n){var i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,JM.H5SDK.getAdsModule().requestRewardedAd();case 2:i=t.sent,n(i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"updateSkinPrice",value:function(){for(var t=JM.PURCHASED_SKINS,e=0,n=0;n<this.basicSkinList.length;n++){var i=this.basicSkinList[n];t.includes(i.skinName)&&(e+=1)}for(var r=0,a=0;a<this.rareSkinList.length;a++){var o=this.rareSkinList[a];t.includes(o.skinName)&&(r+=1)}var s=e+r;this.basicSkinPurchasePrice=100+500*s,this.basicSkinPriceText.text=this.basicSkinPurchasePrice,this.rareSkinPurchasePrice=100+500*s,this.rareSkinPriceText.text=this.rareSkinPurchasePrice}},{key:"changeSkin",value:function(t){for(var e=0;e<this.basicSkinList.length;e++){var n=this.basicSkinList[e];n.skinName==t?(u.currentSkin=t,n.selectSkin()):n.deselectSkin()}for(var i=0;i<this.rareSkinList.length;i++){var r=this.rareSkinList[i];r.skinName==t?(u.currentSkin=t,r.selectSkin()):r.deselectSkin()}for(var a=0;a<this.funkySkinList.length;a++){var o=this.funkySkinList[a];o.skinName==t?(u.currentSkin=t,o.selectSkin()):o.deselectSkin()}}},{key:"updateCoin",value:function(t){t>=this.basicSkinPurchasePrice?(this.alertSkinShop.visible=!0,this.basicSkinPurchaseButton.texture=this.blueButtonTexture,this.rareSkinPurchaseButton.texture=this.blueButtonTexture):(this.alertSkinShop.visible=!1,this.basicSkinPurchaseButton.texture=this.greyButtonTexture,this.rareSkinPurchaseButton.texture=this.greyButtonTexture)}},{key:"notifyLevelStart",value:function(){this.buttonOpenSkinShop.visible=!1,this.alertSkinShop.visible=!1,this.basicSkinPurchaseButton.texture=this.greyButtonTexture,this.rareSkinPurchaseButton.texture=this.greyButtonTexture,JM.GAME.isDebug&&(this.buttonOpenSkinShop.visible=!0)}},{key:"restart",value:function(){this.buttonOpenSkinShop.visible=!0}}]),i}(a_),HM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),t=e.call(this),Wv.autobind(h(t)),t._heightView=JM.heightView,t.dailyChallengeData=null,t.lastFinishDailyTime=null,t.currentDifficulty=null,t.currentDailyIndex=null,t.currentChallenge=null,t.currentProgress=null,t.challengeFinished=null,t.friendsSurpassed=null,t.missionNameText=null,t.missionDetailTextLength=57,t.missionDetailText=null,t.missionRewardText=null,t.missionCountText=null,t.arcBackground=null,t.arcProgress=null,t.friendBg=null,t.friendImg=null,t.missionRewardCoins=null,t.isLevelStarted=!1,t.isChallengeLoaded=!1,t.friendSurpass=null,t.finishChallengeCount=null,t.currentChallengeCount=0,t._coefY=.7,t.initDailyChallenge=t.initDailyChallenge.bind(h(t)),t._onBounce=t._onBounce.bind(h(t)),t._onDestoryPlatform=t._onDestoryPlatform.bind(h(t)),t._onScore=t._onScore.bind(h(t)),t._onUseBooster=t._onUseBooster.bind(h(t)),t.contextChallengerContainer=new a_,t.contextChallengerContainer.visible=!1,t.addChild(t.contextChallengerContainer),t.challengerContainer=new a_,t.challengerContainer.visible=!1,t.addChild(t.challengerContainer),t.initDailyChallenge(),t}return s(n,[{key:"default",get:function(){return this._default},set:function(t){this._default=t,this.contextChallengerContainer.visible=!t,this.challengerContainer.visible=t,t?(this.challengerContainer.addChild(this.background),this.challengerContainer.addChild(this.missionDetailText),this.challengerContainer.addChild(this.coinIcon),this.challengerContainer.addChild(this.missionRewardText),this.challengerContainer.addChild(this.missionNameText),this.challengerContainer.addChild(this.sphere),this.challengerContainer.addChild(this.arcBackground),this.challengerContainer.addChild(this.missionCountText),this.challengerContainer.addChild(this.checkMarkBackground),this.challengerContainer.addChild(this.checkMark)):(this.contextChallengerContainer.addChild(this.background),this.contextChallengerContainer.addChild(this.missionCountText),this.contextChallengerContainer.addChild(this.missionDetailText),this.contextChallengerContainer.addChild(this.coinIcon),this.contextChallengerContainer.addChild(this.missionRewardText),this.contextChallengerContainer.addChild(this.missionNameText),this.contextChallengerContainer.addChild(this.sphere),this.contextChallengerContainer.addChild(this.checkMarkBackground),this.contextChallengerContainer.addChild(this.checkMark),this._createContextChallenger())}},{key:"opponent",get:function(){return this._opponent},set:function(t){this._opponent=t}},{key:"realScore",get:function(){return this._realScore},set:function(t){this._realScore=t}},{key:"notifyLevelStart",value:function(){this.isLevelStarted=!0,gM.to(this.scale,{duration:.3,x:1.2,y:1.2})}},{key:"initDailyChallenge",value:function(){this.position.set(-200,window.innerHeight*this._coefY);var t=$M.texturesPixi.challengeBackground;this.background=new WS(t),this.background.position.set(-10,2),this.background.scale.set(.2),this.background.anchor.set(0,.5),this.challengerContainer.addChild(this.background);var e=$M.texturesPixi.challengeSphere;this.sphere=new WS(e),this.sphere.position.set(90,0),this.sphere.scale.set(.25),this.sphere.anchor.set(.5),this.challengerContainer.addChild(this.sphere);var n=new ZS({fontFamily:"voodoo_casual-bold",fontSize:20,fill:"#ffffff"});this.missionNameText=new iT("MISSION 1",n),this.missionNameText.scale.set(.5),this.missionNameText.anchor.set(.5),this.missionNameText.position.set(35,-30),this.challengerContainer.addChild(this.missionNameText),this.missionRewardText=new iT("100",n),this.missionRewardText.scale.set(.5),this.missionRewardText.anchor.set(.5),this.missionRewardText.position.set(37,30),this.challengerContainer.addChild(this.missionRewardText);var i=$M.texturesPixi.coinsGold;this.coinIcon=new WS(i),this.coinIcon.position.set(15,30),this.coinIcon.scale.set(.07),this.coinIcon.anchor.set(.5),this.challengerContainer.addChild(this.coinIcon),this.missionDetailText=new iT("BOUNCE\n100 TIMES",n),this.missionDetailText.scale.set(.5),this.missionDetailText.anchor.set(0,.5),this.missionDetailText.position.set(5,0),this.challengerContainer.addChild(this.missionDetailText);var r=new ZS({fontFamily:"voodoo_casual-bold",fontSize:20,fill:"#0068fc "});this.missionCountText=new iT("100",r),this.missionCountText.scale.set(.6),this.missionCountText.anchor.set(.5),this.missionCountText.position.set(90,0),this.challengerContainer.addChild(this.missionCountText),this.arcBackground=new zS,this.arcBackground.lineStyle(9,4671303,1),this.arcBackground.drawCircle(0,0,18),this.arcBackground.position.set(90,0),this.challengerContainer.addChild(this.arcBackground),this._setupProgressArc(.7);var a=$M.texturesPixi.challengeCheckMark;this.checkMark=new WS(a),this.checkMark.anchor.set(.5),this.checkMark.scale.set(.3),this.checkMark.position.set(90,0),this.checkMark.visible=!1,this.challengerContainer.addChild(this.checkMark),this.checkMarkBackground=new zS,this.checkMarkBackground.lineStyle(9,7791372,1),this.checkMarkBackground.drawCircle(0,0,18),this.checkMarkBackground.position.set(90,0),this.checkMarkBackground.visible=!1,this.challengerContainer.addChild(this.checkMarkBackground)}},{key:"updateDailyChallenge",value:function(t){if(this.dailyChallengeData=t,this.lastFinishDailyTime=t.lastFinishDailyTime,this.currentDifficulty=t.currentDifficulty,this.currentDailyIndex=t.currentDailyIndex,this.currentChallenge=t.currentChallenge<=3?t.currentChallenge:0,this.currentProgress=t.currentProgress,this.challengeFinished=t.challengeFinished,this.friendsSurpassed=t.friendsSurpassed,console.log("this.isChallengeLoaded:",this.isChallengeLoaded),this.isChallengeLoaded){var e=this.currentProgress/this.finishChallengeCount;this._setupProgressArc(e)}else this._createChallenge(),this.isChallengeLoaded=!0}},{key:"restart",value:function(){this.isLevelStarted=!1,this.scale.set(1.5),this.position.set(-200,window.innerHeight*this._coefY),this.isChallengeLoaded=!1,console.log("this.dailyChallengeData:",this.dailyChallengeData),JM.DAILY_CHALLENGE_DATA=this.dailyChallengeData}},{key:"_createChallenge",value:function(){if(this.position.y=window.innerHeight*this._coefY,gM.fromTo(this.position,{x:-200},{x:0,duration:.5}),this.missionRewardCoins=200+100*this.currentDifficulty,this.default){this.missionNameText.text=kM.words.mission+" "+(this.dailyChallengeData.missionIndex+1);switch(this.currentChallenge){case 0:JM.EVENT_DISPATCHER.addEventListener("bounce",this._onBounce),this.finishChallengeCount=100*(this.currentDifficulty+1),JM.GAME.isDebug&&(this.finishChallengeCount=5*(this.currentDifficulty+1)),this._setupProgressArc(0),this.missionDetailText.text=kM.words.bounce+"\n"+this.finishChallengeCount+" "+kM.words.times,this.missionDetailText.width>this.missionDetailTextLength&&(this.missionDetailText.width=this.missionDetailTextLength,this.missionDetailText.scale.y=this.missionDetailText.scale.x),this.missionRewardText.text=this.missionRewardCoins;break;case 1:JM.EVENT_DISPATCHER.addEventListener("destoryPlatform",this._onDestoryPlatform),this.finishChallengeCount=100*(this.currentDifficulty+1),JM.GAME.isDebug&&(this.finishChallengeCount=5*(this.currentDifficulty+1)),this._setupProgressArc(0),this.missionDetailText.text=kM.words.pass+" "+this.finishChallengeCount+"\n"+kM.words.platforms,this.missionDetailText.width>this.missionDetailTextLength&&(this.missionDetailText.width=this.missionDetailTextLength,this.missionDetailText.scale.y=this.missionDetailText.scale.x),this.missionRewardText.text=this.missionRewardCoins;break;case 2:JM.EVENT_DISPATCHER.addEventListener("score",this._onScore),this.finishChallengeCount=500*(this.currentDifficulty+1),JM.GAME.isDebug&&(this.finishChallengeCount=30*(this.currentDifficulty+1)),this._setupProgressArc(0),this.missionDetailText.text=kM.words.scoreDaily+"\n"+this.finishChallengeCount+" "+kM.words.points,this.missionDetailText.width>this.missionDetailTextLength&&(this.missionDetailText.width=this.missionDetailTextLength,this.missionDetailText.scale.y=this.missionDetailText.scale.x),this.missionRewardText.text=this.missionRewardCoins;break;case 3:JM.EVENT_DISPATCHER.addEventListener("useBooster",this._onUseBooster),this.finishChallengeCount=this.currentDifficulty+3,JM.GAME.isDebug&&(this.finishChallengeCount=this.currentDifficulty+1),this._setupProgressArc(0),this.missionDetailText.text=kM.words.use+" "+this.finishChallengeCount+"\n"+kM.words.boosters,this.missionDetailText.width>this.missionDetailTextLength&&(this.missionDetailText.width=this.missionDetailTextLength,this.missionDetailText.scale.y=this.missionDetailText.scale.x),this.missionRewardText.text=this.missionRewardCoins}this.missionCountText.visible=!0,this.arcBackground.visible=!0,this.checkMark.visible=!1,this.checkMarkBackground.visible=!1}}},{key:"_finishChallenge",value:function(){var t=this;switch(this._addCoins(this.missionRewardCoins),this.currentChallenge){case 0:JM.EVENT_DISPATCHER.removeEventListener("bounce",this._onBounce);break;case 1:JM.EVENT_DISPATCHER.removeEventListener("destoryPlatform",this._onDestoryPlatform);break;case 2:JM.EVENT_DISPATCHER.removeEventListener("score",this._onScore);break;case 3:JM.EVENT_DISPATCHER.removeEventListener("useBooster",this._onUseBooster)}this.checkMark.visible=!0,this.checkMarkBackground.visible=!0,this.missionCountText.visible=!1,this.arcBackground.visible=!1,this.arcProgress.visible=!1,null!=this.friendBg&&(this.friendBg.visible=!1),null!=this.friendImg&&(this.friendImg.visible=!1),gM.to(this.position,{x:-80,duration:.5}),gM.to(this.position,{y:-200,duration:1,delay:2}),gM.delayedCall(3.5,(function(){t.challengeFinished.push(t.currentChallenge);for(var e=[0,1,2,3],n=0;n<t.challengeFinished.length;n++){var i=t.challengeFinished[n];e.splice(e.indexOf(i),1)}console.log("availableChallenges",e),0===e.length&&(t.currentDifficulty+=1,t.challengeFinished=[],e=[0,1,2,3]),t.currentChallenge>=3?t.currentChallenge=0:t.currentChallenge++,t.dailyChallengeData.currentChallenge=t.currentChallenge,t.dailyChallengeData.currentProgress=0,t.isChallengeLoaded=!1,t.currentDailyIndex+=1,t.dailyChallengeData.currentDailyIndex=t.currentDailyIndex,t.dailyChallengeData.missionIndex+=1,t.dailyChallengeData.currentDifficulty=t.currentDifficulty,t.dailyChallengeData.challengeFinished=t.challengeFinished,JM.DAILY_CHALLENGE_DATA=t.dailyChallengeData,console.log("finish challenge",t.dailyChallengeData)}))}},{key:"_finishContextChallenge",value:function(){JM.EVENT_DISPATCHER.removeEventListener("score",this._onContextReachScore),this._addCoins(this.missionRewardCoins),this.checkMark.visible=!0,this.checkMarkBackground.visible=!0,this.missionCountText.visible=!1,this.friendBg.visible=!1,this.friendImg.visible=!1,gM.to(this.position,{x:-80,duration:.5}),gM.to(this.position,{y:-200,duration:1,delay:2})}},{key:"_onBounce",value:function(){this.isLevelStarted&&this.default&&(this.currentProgress+=1,this.currentProgress<this.finishChallengeCount?(this.dailyChallengeData.currentProgress=this.currentProgress,JM.DAILY_CHALLENGE_DATA=this.dailyChallengeData):this._finishChallenge())}},{key:"_onDestoryPlatform",value:function(){this.isLevelStarted&&this.default&&(this.currentProgress+=1,this.currentProgress<this.finishChallengeCount?(this.dailyChallengeData.currentProgress=this.currentProgress,JM.DAILY_CHALLENGE_DATA=this.dailyChallengeData):this._finishChallenge())}},{key:"_onScore",value:function(){this.isLevelStarted&&this.default&&(this.currentProgress+=20,this.currentProgress<this.finishChallengeCount?(this.dailyChallengeData.currentProgress=this.currentProgress,JM.DAILY_CHALLENGE_DATA=this.dailyChallengeData):this._finishChallenge())}},{key:"_onUseBooster",value:function(){this.isLevelStarted&&this.default&&(this.currentProgress+=1,this.currentProgress<this.finishChallengeCount?(this.dailyChallengeData.currentProgress=this.currentProgress,JM.DAILY_CHALLENGE_DATA=this.dailyChallengeData):this._finishChallenge())}},{key:"_onContextReachScore",value:function(){this.isLevelStarted&&(console.log(JM.SCORE,">=",this.opponent.score),JM.SCORE>=this.opponent.score&&(this._finishContextChallenge(),-1==u.beatenOpponent.indexOf(u.currentContext)&&(u.beatenOpponent+=u.currentContext+",")))}},{key:"_setupProgressArc",value:function(t){null!=this.currentProgress&&(this.missionCountText.text=this.currentProgress),null!=this.arcProgress&&this.challengerContainer.removeChild(this.arcProgress),this.arcProgress=new zS,this.arcProgress.lineStyle(9,1274367,1),this.arcProgress.arc(0,0,18,-.5*Math.PI,2*Math.PI*t-.5*Math.PI),this.arcProgress.position.set(90,0),this.arcProgress.visible=!0,this.challengerContainer.addChild(this.arcProgress)}},{key:"_createContextChallenger",value:function(){var t=this;console.log("_createContextChallenger"),this.position.y=window.innerHeight*this._coefY,gM.fromTo(this.position,{x:-200},{x:0,duration:.5}),this.missionRewardCoins=300+100*this.currentDifficulty,JM.EVENT_DISPATCHER.removeEventListener("score",this._onContextReachScore),JM.EVENT_DISPATCHER.addEventListener("score",this._onContextReachScore),null!=this.friendBg&&this.contextChallengerContainer.removeChild(this.friendBg),null!=this.friendImg&&this.contextChallengerContainer.removeChild(this.friendImg);var e=$M.texturesPixi.challengerBackground;this.friendBg=new WS(e),this.friendBg.visible=!0,this.contextChallengerContainer.addChild(this.friendBg),this.friendBg.anchor.set(.5),this.friendBg.scale.set(.35),this.friendBg.position.set(90,0),this.friendSurpass=this.opponent,console.log("friend seleted: ",this.friendSurpass);var n=this.friendSurpass.imguri;this.friendImg=WS.from(this.realScore?n:$M.texturesPixi.friendsPicto),this.friendImg.visible=!0,this.contextChallengerContainer.addChild(this.friendImg),this.friendImg.anchor.set(.5),this.friendImg.position.set(90,0);var i=setInterval((function(){t.friendImg.width>5&&(t.friendImg.width=48,t.friendImg.scale.y=t.friendImg.scale.x,clearInterval(i))}),100),r=new zS;r.beginFill(1),r.drawCircle(0,0,22),r.position.set(90,0),r.endFill(),this.friendBg.mask=r,this.friendImg.mask=r,this.contextChallengerContainer.addChild(r),this.missionNameText.text=this.realScore?this.friendSurpass.name.toUpperCase():"GOAL",this.missionDetailText.text=this.realScore?"BEAT YOUR\nFRIEND'S SCORE\n"+this.opponent.score:"MAKE THE HIGHEST\nSCORE TO CHALLENGE\nYOUR FRIEND\n"+this.opponent.score,this.missionDetailText.width=this.missionDetailTextLength,this.missionDetailText.scale.y=this.missionDetailText.scale.x,this.missionRewardText.text=this.missionRewardCoins}},{key:"_addCoins",value:function(t){JM.pixiManager.rewardEffect.add("coins",{x:this.position.x+50,y:this.position.y},JM.pixiManager.coin.coinPos,(function(){JM.COIN+=t}),1)}},{key:"resize",value:function(t,e){this.position.y=e*this._coefY,this._heightView=e}}]),n}(a_),VM=function(t){d(i,t);var n=m(i);function i(){var t;return a(this,i),t=n.call(this),Wv.autobind(h(t)),t._cpt=0,t._scale=.6,t._down=!1,t._access=!0,t._init(),t._initEvents(),t}return s(i,[{key:"_init",value:function(){this.btn=new WS.from($M.texturesPixi.arrowBtn),this.btn.scale.set(this._scale),this.btn.anchor.set(.5),this.addChild(this.btn),this.rv=new WS.from($M.texturesPixi.boosterRv),this.rv.anchor.set(.5,1.3),this.rv.scale.set(.75),this.rv.y=this.btn.height,this.btn.addChild(this.rv);var t=new ZS({fontFamily:"voodoo_casual-bold",fontSize:35,fill:"#ffffff",stroke:"#000000",strokeThickness:4});this.cptText=new iT(this._cpt,t),this.cptText.anchor.set(.5),this.cptText.y=this.btn.height-42,this.cptText.visible=!1,this.btn.addChild(this.cptText),Wv.setupIs().desktop&&(this.controlText=new iT("B",t),this.controlText.anchor.set(1,.5),this.controlText.y=0,this.controlText.x=-this.btn.height/2-2,this.btn.addChild(this.controlText)),this.visible=!1}},{key:"_initEvents",value:function(){this.btn.interactive=!0,this.btn.buttonMode=!0,this.btn.on("pointerdown",this.onDown),this.btn.on("pointerup",this.onUp),this.btn.on("pointerupoutside",this.onOut)}},{key:"onDown",value:function(t){!u.gameStarted||!this._access||this._down||JM.ball.isBooster||JM.ball.isShielded||JM.GAME.isLose||(this._down=!0,gM.to(this.btn.scale,{duration:.2,x:this._scale-.07,y:this._scale-.07}))}},{key:"onUp",value:function(t){var e=this;u.losePlatformTouched||(this._down&&(gM.to(this.btn.scale,{duration:.2,x:this._scale,y:this._scale}),this._cpt>0?(this._cpt--,this.cptText.text=this._cpt,this._cpt<=0&&(this.cptText.visible=!1,this.rv.visible=!0),this._access=!1,gM.delayedCall(2,(function(){e._access=!0})),JM.platforms.touchBoostArrow()):(JM.pause(),this.requestRewarded((function(t){t&&e.add(),JM.resume()})))),this._down=!1)}},{key:"cpt",set:function(t){this._cpt=t,this.cptText.text=this._cpt,this._cpt>0&&(this.cptText.visible=!0,this.rv.visible=!1)}},{key:"getBtn",get:function(){return this.btn}},{key:"onOut",value:function(t){this._down=!1,gM.to(this.btn.scale,{duration:.2,x:this._scale,y:this._scale})}},{key:"add",value:function(){this._cpt++,this.cptText.text=this._cpt,this.cptText.visible=!0,this.rv.visible=!1,gM.to(this.btn.scale,{duration:.2,x:this._scale+.2,y:this._scale+.2}),gM.to(this.btn.scale,{delay:.3,duration:.2,x:this._scale,y:this._scale}),gM.to(this.cptText.scale,{duration:.2,x:2,y:2}),gM.to(this.cptText.scale,{delay:.3,duration:.3,x:1,y:1})}},{key:"save",value:function(){JM.H5SDK.getStoreModule().save("arrowBooster",this._cpt)}},{key:"notifyLevelStart",value:function(){this.visible=!0,this.btn.scale.set(0),gM.to(this.btn.scale,{delay:.1,duration:.6,x:this._scale,y:this._scale,ease:"back.out(2)"})}},{key:"requestRewarded",value:function(){var t=r(e().mark((function t(n){var i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,JM.H5SDK.getAdsModule().requestRewardedAd();case 2:i=t.sent,n(i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"resize",value:function(t,e,n){this.btn.x=t-this.btn.width/2-5,this.btn.y=n<1?e/2+this.btn.height+14:e/2+this.btn.height}},{key:"update",value:function(){}}]),i}(a_),jM=function(t){d(i,t);var n=m(i);function i(){var t;return a(this,i),t=n.call(this),Wv.autobind(h(t)),t._cpt=0,t._scale=.6,t._down=!1,t._access=!0,t._init(),t._initEvents(),t}return s(i,[{key:"_init",value:function(){this.btn=new WS.from($M.texturesPixi.shieldBtn),this.btn.scale.set(this._scale),this.btn.anchor.set(.5),this.addChild(this.btn),this.rv=new WS.from($M.texturesPixi.boosterRv),this.rv.anchor.set(.5,1.3),this.rv.scale.set(.75),this.rv.y=this.btn.height,this.btn.addChild(this.rv);var t=new ZS({fontFamily:"voodoo_casual-bold",fontSize:35,fill:"#ffffff",stroke:"#000000",strokeThickness:4});this.cptText=new iT(this._cpt,t),this.cptText.anchor.set(.5),this.cptText.y=this.btn.height-42,this.cptText.visible=!1,this.btn.addChild(this.cptText),Wv.setupIs().desktop&&(this.controlText=new iT("C",t),this.controlText.anchor.set(1,.5),this.controlText.y=0,this.controlText.x=-this.btn.height/2-4,this.btn.addChild(this.controlText)),this.visible=!1}},{key:"_initEvents",value:function(){this.btn.interactive=!0,this.btn.buttonMode=!0,this.btn.on("pointerdown",this.onDown),this.btn.on("pointerup",this.onUp),this.btn.on("pointerupoutside",this.onOut)}},{key:"onDown",value:function(t){console.log(t),!u.gameStarted||!this._access||this._down||JM.ball.isBooster||JM.ball.isShielded||JM.GAME.isLose||(this._down=!0,gM.to(this.btn.scale,{duration:.2,x:this._scale-.07,y:this._scale-.07}))}},{key:"onUp",value:function(t){var e=this;u.losePlatformTouched||(this._down&&(gM.to(this.btn.scale,{duration:.2,x:this._scale,y:this._scale}),this._cpt>0?(this._cpt--,this.cptText.text=this._cpt,this._cpt<=0&&(this.cptText.visible=!1,this.rv.visible=!0),this._access=!1,JM.ball.isShielded=!0,JM.ball.animateShield(!0),gM.delayedCall(xM.timeForShield-2,(function(){JM.ball.wiggleShield(2,(function(){JM.ball.isShielded=!1,JM.ball.animateShield(!1),e._access=!0}))}))):(JM.pause(),this.requestRewarded((function(t){t&&e.add(),JM.resume()})))),this._down=!1)}},{key:"showHallo",value:function(){}},{key:"hideHallo",value:function(){}},{key:"getBtn",get:function(){return this.btn}},{key:"cpt",set:function(t){this._cpt=t,this.cptText.text=this._cpt,this._cpt>0&&(this.cptText.visible=!0,this.rv.visible=!1)}},{key:"onOut",value:function(t){this._down=!1,gM.to(this.btn.scale,{duration:.2,x:this._scale,y:this._scale})}},{key:"add",value:function(){this._cpt++,this.cptText.text=this._cpt,this.cptText.visible=!0,this.rv.visible=!1,gM.to(this.btn.scale,{duration:.3,x:this._scale+.1,y:this._scale+.1}),gM.to(this.btn.scale,{delay:.3,duration:.2,x:this._scale,y:this._scale}),gM.to(this.cptText.scale,{duration:.2,x:2,y:2}),gM.to(this.cptText.scale,{delay:.3,duration:.3,x:1,y:1})}},{key:"save",value:function(){JM.H5SDK.getStoreModule().save("shieldBooster",this._cpt)}},{key:"notifyLevelStart",value:function(){this.visible=!0,this.btn.scale.set(0),gM.to(this.btn.scale,{duration:.5,x:this._scale,y:this._scale,ease:"back.out(2)"})}},{key:"requestRewarded",value:function(){var t=r(e().mark((function t(n){var i;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,JM.H5SDK.getAdsModule().requestRewardedAd();case 2:i=t.sent,n(i);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"resize",value:function(t,e,n){this.btn.x=t-this.btn.width/2-5,this.btn.y=n<1?.5*e:e/2-20}},{key:"update",value:function(){}}]),i}(a_),XM=function(t){d(n,t);var e=m(n);function n(){return a(this,n),e.call(this)}return s(n,[{key:"add",value:function(t,e,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;switch(t){case"coins":this.texture=$M.texturesPixi.coinsGold,this.color=15518464,this.time=r>0?r:.6,this.scaleVal=.15;break;case"booster":this.texture=$M.texturesPixi.arrow,this.color=9829124,this.time=1,this.scaleVal=.24;break;case"shield":this.texture=$M.texturesPixi.shield,this.color=4128767,this.time=.8,this.scaleVal=.2}this.coins=new WS(this.texture),this.coins.scale.set(this.scaleVal),this.coins.anchor.set(.5),this.coins.x=e.x,this.coins.y=e.y,this.circle=new WS($M.texturesPixi.circle),this.circle.scale.set(0),this.circle.anchor.set(.5),this.circle.tint=this.color,this.coins.addChild(this.circle),gM.to(this.coins,{duration:this.time,x:n.x,y:n.y,onComplete:function(t,e){gM.to(e,{duration:.6,alpha:0,onComplete:function(){e.destroy(),t.destroy()}}),gM.to(e.scale,{duration:.2,x:2,y:2}),t.texture=null,i&&i()},onCompleteParams:[this.coins,this.circle]}),this.addChild(this.coins)}}]),n}(a_),WM=function(){function t(){a(this,t),this._header=null,this._coin=null,this._skinShop=null,this._isFacebook=JM.H5SDK.getPlatform().isFacebook()}return s(t,[{key:"setup",value:function(){this.view=document.getElementById("pixi"),this.view.style.width="100%",this.view.style.height="100%",this.view.style.position="absolute",this.view.style.top="0px",this.view.style.left="0px",this.view.style["z-index"]="200",this.view.addEventListener("touchstart",(function(t){t.preventDefault()})),this.app=new uM({view:this.view,width:1,height:1,backgroundAlpha:0,resolution:window.devicePixelRatio,autoDensity:!0,antialias:!0}),this._header=new UM,this.app.stage.addChild(this._header),this._coin=new FM,this.app.stage.addChild(this._coin),this._dailyChallenge=new HM,this._dailyChallenge.scale.set(1.5),this.app.stage.addChild(this._dailyChallenge),this._dailyChallenge.default=!0,this._arrowItems=new VM,this.app.stage.addChild(this._arrowItems),this._shieldItems=new jM,this.app.stage.addChild(this._shieldItems),this._skinShop=new zM,this.app.stage.addChild(this._skinShop),this._leaderBoard=new NM(this.view),this.app.stage.addChild(this._leaderBoard),this._rewardEffect=new XM,this.app.stage.addChild(this._rewardEffect)}},{key:"leaderBoard",get:function(){return this._leaderBoard}},{key:"header",get:function(){return this._header}},{key:"arrowItems",get:function(){return this._arrowItems}},{key:"shieldItems",get:function(){return this._shieldItems}},{key:"rewardEffect",get:function(){return this._rewardEffect}},{key:"coin",get:function(){return this._coin}},{key:"update",value:function(){this._leaderBoard&&this._leaderBoard.update()}},{key:"notifyLevelStart",value:function(){this._skinShop.notifyLevelStart(),this._dailyChallenge&&this._dailyChallenge.notifyLevelStart(),0==JM._nbGamePlayed&&(this._arrowItems.notifyLevelStart(),this._shieldItems.notifyLevelStart())}},{key:"restart",value:function(){this._header.restart(),this._skinShop.restart(),this._dailyChallenge&&this._dailyChallenge.restart()}},{key:"resize",value:function(t,e,n){this._header.resize(t,e,n),this._coin.resize(t,e,n),this._skinShop.resize(t,e,n),this._arrowItems.resize(t,e,n),this._shieldItems.resize(t,e,n),this._leaderBoard&&this._leaderBoard.resize(t,e),this._dailyChallenge&&this._dailyChallenge.resize(t,e),this.app.renderer.resize(t,e),console.log("PixiManager resize:")}},{key:"updateScore",value:function(t){this._header.updateScore(t)}},{key:"updateCoin",value:function(t){this._skinShop.updateCoin(t),this._coin.updateCoin(t)}},{key:"changeSkin",value:function(t){this._skinShop.changeSkin(t)}},{key:"notEnoughCoin",value:function(){this._coin.notEnoughCoin()}},{key:"updateDailyChallenge",value:function(t){this._dailyChallenge&&this._dailyChallenge.updateDailyChallenge(t)}},{key:"changeChallenger",value:function(){}},{key:"setObjectifDatas",value:function(){var t;console.log("setObjectifDatas"),console.log("UI setObjectifDatas (reconnected):",u.reconnected),console.log("UI setObjectifDatas (invite friend):",u.inviteFriend);for(var e=0;e<u.friends.length;e++)u.friends[e].isOpponent&&(t=!0);console.log("opponentExist in config.friends:",t),u.reconnected||u.inviteFriend||u.currentContext||t?(u.inviteFriend=!1,this.getOpponent()):(console.log("no context, start classic objectif"),this._dailyChallenge&&(this._dailyChallenge.default=!0))}},{key:"getOpponent",value:function(){var t=this;JM.H5SDK.getProfileModule().getOpponent().then((function(e){if(console.log("retour de getOpponent :",e),t.currentContext=JM.H5SDK.getContextModule().getCurrentContext().id,t.currentContext=1e4*Math.random(),console.log("currentContext:",u.currentContext),console.log("new currentContext:",t.currentContext),e){e=e.length>0?e[0]:e;if(t._dailyChallenge.opponent=e,e.isRealScore){if(console.log("===== isRealScore true ======="),console.log("this.currentContext:",t.currentContext),console.log("beatenOpponent:",u.beatenOpponent),console.log("=============================="),-1!=u.beatenOpponent.indexOf(t.currentContext))return void(t._dailyChallenge.default=!0);t._dailyChallenge.realScore=!0,t._dailyChallenge.default=!1}else{if(u.currentContext==t.currentContext)return void(t._dailyChallenge.default=!0);t._dailyChallenge.realScore=!1,t._dailyChallenge.default=!1}}else t._dailyChallenge.default=!0;u.currentContext=t.currentContext}))}}]),t}(),qM=function(){function t(){a(this,t),this._audioSources=[],this._soundPlaying=!0,this.setAudioEnabled(!0),window.document.addEventListener("visibilitychange",this._visibilityHandler)}return s(t,[{key:"playSound",value:function(t){this._soundPlaying&&($M.sounds[t.name].rate(t.detuneValue+1),$M.sounds[t.name].play())}},{key:"pauseAllSounds",value:function(){for(var t=0;t<this._audioSources.length;t++){if(this._audioSources[t])this._audioSources[t].stop()}}},{key:"_visibilityHandler",value:function(){if("visible"===document.visibilityState){console.log("UNMUTE VISIBILITYCHANGE CALL ------------"),qv.Howler.mute(!1);var t=qv.Howler.ctx;t&&setTimeout((function(){t.resume(),qv.Howler.mute(!1)}),100)}}},{key:"resetSound",value:function(){}},{key:"setAudioEnabled",value:function(t){this._soundPlaying=t}},{key:"toggleSound",value:function(){this._setAudioEnabled(!this._soundPlaying)}}]),t}(),YM=function(){function t(){a(this,t),this._hapticEnabled=!0,this.setHapticEnabled(!0)}return s(t,[{key:"isHapticEnabled",value:function(){return this._hapticEnabled}},{key:"setHapticEnabled",value:function(t){this._hapticEnabled=t}},{key:"toggleHaptic",value:function(){this._setHapticEnabled(!this._hapticEnabled)}}]),t}(),KM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),(t=e.call(this))._addScoreUI=null,t._addScoreUITime=1,t._showPraises=null,t._showPraisesTime=1,t._showTryAgainTime=1.5,document.onselectstart=function(t){return!1},t._setupAddScore(),t._setupShowPraises(),t}return s(n,[{key:"_setupAddScore",value:function(){this._addScoreUI=document.createElement("p"),this._addScoreUI.id="this._addScoreUI",this._addScoreUI.style.position="absolute",this._addScoreUI.style.top="calc(26%)",this._addScoreUI.style.left="calc(50%)",this._addScoreUI.style.zIndex="99",this._addScoreUI.style.fontSize="50px",this._addScoreUI.style.fontWeight="bolder",this._addScoreUI.style.fontFamily="sans-serif",this._addScoreUI.style.transform="translate(-50%, -50%)",this._addScoreUI.style.opacity="0",this._addScoreUI.style.pointerEvents="none",this._addScoreUI.style.color="gold"}},{key:"_setupShowPraises",value:function(){this._showPraises=document.createElement("div"),this._showPraises.id="this._showPraises",this._showPraises.style.position="absolute",this._showPraises.style.top="26%",this._showPraises.style.left="calc(50% + 58px",this._showPraises.style.opacity="0",this._showPraises.style.fontFamily="sans-serif",this._showPraises.style.fontSize="24px",this._showPraises.style.fontWeight="bolder",this._showPraises.style.zIndex="99",this._showPraises.style.color="#00e63d",this._showPraises.style.textTransform="uppercase"}},{key:"addScore",value:function(t){t>=40&&(this._addScoreUI.innerText="+"+t,gM.fromTo(this._addScoreUI.style,{opacity:"1"},{delay:.5,opacity:"0",duration:this._addScoreUITime}),gM.fromTo(this._addScoreUI.style,{top:"calc(30%)"},{top:"calc(15%)",duration:this._addScoreUITime}))}},{key:"showPraises",value:function(){var t=[kM.words.wow,kM.words.perfect,kM.words.nice,kM.words.godlike][MM.randomNum(0,3)];this._showPraises.innerText=t;var e=24,n=this._showPraises.getBoundingClientRect().width;for(this._showPraises.style.fontSize=e+"px";n>180;)e--,this._showPraises.style.fontSize=e+"px",n=this._showPraises.getBoundingClientRect().width;gM.timeline();gM.fromTo(this._showPraises.style,{opacity:"1"},{delay:.2,opacity:"0",duration:this._showPraisesTime}),gM.fromTo(this._showPraises.style,{top:"calc(30%)"},{top:"calc(15% - 10px)",duration:this._showPraisesTime})}},{key:"showTryAgain",value:function(){var t=document.createElement("p");t.id="showTryAgain",t.innerText=kM.words.tryagain,t.style.position="absolute",t.style.top="calc(20%)",t.style.left="calc(50%)",t.style.transform="translate(-50%, -50%)",t.style.fontFamily="sans-serif",t.style.fontSize="32px",t.style.fontWeight="bolder",t.style.textAlign="center",t.style.zIndex="99",t.style.color="gold",t.style.textTransform="uppercase";var e=gM.timeline();e.to(t.style,{opacity:"1",duration:.6*this._showTryAgainTime,ease:"power2.out"}),e.to(t.style,{opacity:"0",duration:.4*this._showTryAgainTime}),gM.delayedCall(this._showTryAgainTime,(function(){t.remove()}))}}]),n}(Cn),ZM=function(){function t(){a(this,t),this._gameStatus={FPS:60,isDebug:!1,isPaused:!1,isLose:!1,isFirstLose:!0,isFirstClick:!1,isRetryClick:!1},this._nbGamePlayed=0,this._onMove=this._onMove.bind(this),this._onDown=this._onDown.bind(this),this.setup=this.setup.bind(this),this.update=this.update.bind(this),this._keydown=this._keydown.bind(this),this._keyup=this._keyup.bind(this),this._rewardHandler=this._rewardHandler.bind(this),this._noAdHandler=this._noAdHandler.bind(this),this.changeColor=this.changeColor.bind(this),this._canvas=document.querySelector(".canvas"),this._scoreUi=document.querySelector(".js-score"),this._bestScoreUi=document.querySelector(".js-best-score"),this._newBestScore=document.querySelector(".js-new-best-score"),this._newBestText=document.querySelector(".js-new-best-text"),this._startScreen=document.querySelector(".start-screen"),this._retryScreen=document.querySelector(".retry-screen"),this._endScreen=document.querySelector(".end-screen"),this._playText=document.querySelector(".play-text"),this._noVideoCTA=document.querySelector(".js-no-video"),this._retryVideo=document.querySelector(".video-replay"),this._circleSvg=document.querySelector(".js-circle-svg"),this._privacyIcon=document.querySelector(".js-privacy"),this._scoreContainer=document.querySelector(".score-container"),this._bestScoreGame=document.querySelector(".best-score"),this._bestScoreEndScreen=document.querySelector(".new-best-score"),this._backgroundGradient=document.querySelector(".background-gradient")}return s(t,[{key:"H5SDK",get:function(){return window.H5SDK}},{key:"GAME",get:function(){return this._gameStatus}},{key:"EVENT_DISPATCHER",get:function(){return this._eventDispatcher}},{key:"SCORE",get:function(){return this._score},set:function(t){this._score=t,this._scoreUi.innerHTML=this._score,this._score>this.BEST_SCORE&&(this.BEST_SCORE=this._score,console.log("happyTimeShowed : ",xM.happyTimeShowed),!xM.happyTimeShowed&&xM.startedBestScore>0&&(xM.happyTimeShowed=!0,console.log("*** happyTime ***"),this.H5SDK.getPlatform().happyTime())),this.pixiManager&&this.pixiManager.updateScore(this._score)}},{key:"BEST_SCORE",get:function(){return this._bestScore},set:function(t){this._bestScore=t,this._bestScoreUi.innerHTML=this._bestScore,this._newBestScore.innerHTML=this._score,this._bestScoreGame.innerText=kM.words.best+this._bestScore}},{key:"COIN",get:function(){return this._coin},set:function(t){this._coin=null==t||""==t?0:parseInt(t),this.pixiManager&&this.pixiManager.updateCoin(this._coin)}},{key:"CURRENT_SKIN",get:function(){return this._currentSkin},set:function(t){this._currentSkin=t,this.changeSkin(this._currentSkin)}},{key:"changeSkinByBtn",value:function(t,e){this._currentSkin=t,this.changeSkin(this._currentSkin,e)}},{key:"PURCHASED_SKINS",get:function(){return this._purchasedSkins},set:function(t){this._purchasedSkins=t}},{key:"DAILY_CHALLENGE_DATA",get:function(){return this._dailyChallengeData},set:function(t){this._dailyChallengeData=t,this.updateDailyChallenge(this._dailyChallengeData)}},{key:"setup",value:function(){this._eventDispatcher=new Ut,this.gameColors=xM.gameColors[Math.floor(Math.random()*xM.gameColors.length)],this._backgroundGradient.style.background=this.gameColors.backgroundGradient,this._touchValues={mousePosition:{x:0,y:0},oldPos:{x:0,z:0},isPlayerTouch:!1,lastTouch:{x:0,y:0},swipeSpeed:0},this.renderer=this._setupRenderer(),this.scene=new bo,this.camera=this._setupCamera(),this.soundManager=new qM,this.hapticManager=new YM,this.uiManager=new KM,this.ball=null,this.platforms=null,this.stageManager=new CM,this.stageManager.setup(),this._gameStatus.isDebug&&this._setupStats(),this.resize(),this._setupEventListeners(),gM.ticker.fps(this.GAME.FPS),gM.ticker.add(this.update),this.deltaTime=0}},{key:"setDatas",value:function(){this.downloadPlayerData(),this.pixiManager=new WM,this.pixiManager.setup(),this.resize()}},{key:"update",value:function(t,e,n){if(this.deltaTime=e,this.pixiManager&&this.pixiManager.update(),!this.GAME.isPaused&&!this.GAME.isLose&&(this.renderer.render(this.scene,this.camera),this.stageManager.update(),this._touchValues.isPlayerTouch&&this._keyPressed)){if(console.log("direction:",this._direction),this._acc+=.3,this._acc>5&&(this._acc=5),this.GAME.isLose||this.GAME.isPaused||u.losePlatformTouched)return;this.platforms.rotation.y+=("left"==this._direction?1:-1)*(xM.keyRotateSpeed+this._acc)*xM.rotateSpeed}}},{key:"resume",value:function(){this.platforms.resume(),this.GAME.isPaused=!1}},{key:"pause",value:function(){this.platforms.pause(),this.soundManager&&this.soundManager.pauseAllSounds(),this.GAME.isPaused=!0}},{key:"restart",value:function(){var t=this;console.log("restart"),this.changeColor(),xM.movementCircleDuration=xM.initMovementCircleDuration,xM.gravitationalAcceleration=xM.initGravitationalAcceleration,this.SCORE=0,this._touchEndHandler(),this.stageManager.restart(),this.platforms.restart(),this.pixiManager.restart(),this._circleSvg.classList.remove("active"),this.GAME.isLose=!1,this.GAME.isRetryClick=!1,this.GAME.isFirstLose=!0,clearTimeout(this._retryTimeOut),setTimeout((function(){t.GAME.isFirstClick=!1,t._scoreContainer.style.display="block"}),300),u.losePlatformTouched=!1,this.ball.beginBounceAnimation()}},{key:"resize",value:function(){this._width=window.innerWidth,this._height=window.innerHeight,this._canvas.width=this._width,this._canvas.height=this._height,this.pixiManager&&this.pixiManager.resize(this._width,this._height,this._height/770),this.camera&&(this.camera.aspect=this._width/this._height,this.camera.updateProjectionMatrix()),this.renderer&&this.renderer.setSize(this._width,this._height)}},{key:"downloadPlayerData",value:function(){var t=r(e().mark((function t(){var n,i,r,a=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=u.savedData,i=u.bestScore,console.log("Data downloaded",i,n.coin,n.currentSkin,n.purchasedSkins,n.dailyChallengeData),null==i?console.log("Error reading the best score"):(xM.startedBestScore=i,this.BEST_SCORE=i),null==n.coin?this.COIN=0:this.COIN=n.coin,null==n.currentSkin?this.CURRENT_SKIN="":this.CURRENT_SKIN=n.currentSkin,null==n.purchasedSkins?this.PURCHASED_SKINS=[]:this.PURCHASED_SKINS=n.purchasedSkins,null==n.dailyChallengeData?this.DAILY_CHALLENGE_DATA={currentDifficulty:0,currentDailyIndex:0,missionIndex:0,currentChallenge:0,currentProgress:0,challengeFinished:[],friendsSurpassed:[]}:(this.DAILY_CHALLENGE_DATA=n.dailyChallengeData,null==this.DAILY_CHALLENGE_DATA.missionIndex&&(this.DAILY_CHALLENGE_DATA.missionIndex=0)),r=setInterval((function(){a.pixiManager&&(r&&clearInterval(r),n.arrowBooster?a.pixiManager.arrowItems.cpt=n.arrowBooster:a.pixiManager.arrowItems.cpt=0,n.shieldBooster?a.pixiManager.shieldItems.cpt=n.shieldBooster:a.pixiManager.shieldItems.cpt=0,null==n.coin?a.COIN=0:a.COIN=n.coin)}),60);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"uploadPlayerData",value:function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(">>> uploadPlayerData "),t.next=3,this.H5SDK.getScoreModule().setBestScore(this._bestScore);case 3:return t.next=5,this.H5SDK.getStoreModule().save("coin",this._coin);case 5:return t.next=7,this.H5SDK.getStoreModule().save("currentSkin",this._currentSkin);case 7:return t.next=9,this.H5SDK.getStoreModule().save("purchasedSkins",this._purchasedSkins);case 9:return t.next=11,this.H5SDK.getStoreModule().save("dailyChallengeData",this._dailyChallengeData);case 11:console.log("Data uploaded",this._bestScore,this._coin,this._currentSkin,this._purchasedSkins,this._dailyChallengeData),this.pixiManager&&this.pixiManager.arrowItems.save(),this.pixiManager&&this.pixiManager.shieldItems.save();case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"uploadEmptyPlayerData",value:function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(">>> uploadEmptyPlayerData "),t.next=3,this.H5SDK.getScoreModule().setBestScore(0);case 3:return t.next=5,this.H5SDK.getStoreModule().save("coin",0);case 5:return t.next=7,this.H5SDK.getStoreModule().save("currentSkin","");case 7:return t.next=9,this.H5SDK.getStoreModule().save("purchasedSkins",[]);case 9:return t.next=11,this.H5SDK.getStoreModule().save("dailyChallengeData",{currentDifficulty:0,currentDailyIndex:0,currentChallenge:0,currentProgress:0,challengeFinished:[],friendsSurpassed:[]});case 11:return t.next=13,this.H5SDK.getStoreModule().save("arrowBooster",0);case 13:console.log("Empty data uploaded");case 14:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"changeSkin",value:function(t,e){var n=this;if(null!=t&&null!=this.ball){this.ball.changeSkin(t,e),this.platforms.changeSkin(t);var i=setInterval((function(){n.pixiManager&&(i&&clearInterval(i),n.pixiManager.changeSkin(t))}),60)}}},{key:"updateDailyChallenge",value:function(t){var e=this,n=setInterval((function(){e.pixiManager&&(n&&clearInterval(n),e.pixiManager.updateDailyChallenge(t))}),60)}},{key:"notEnoughCoin",value:function(){var t=this,e=setInterval((function(){t.pixiManager&&(e&&clearInterval(e),t.pixiManager.notEnoughCoin())}),60)}},{key:"_setupRenderer",value:function(){var t=new _o({canvas:this._canvas,antialias:!0,alpha:!0});return t.setPixelRatio(window.devicePixelRatio),t}},{key:"_setupCamera",value:function(){var t=new Ci(xM.cameraFov,this._canvas.width/this._canvas.height,.01,300);return t.zoom=xM.cameraZoom,t.position.x=xM.cameraX,t.position.y=xM.cameraY,t.position.z=xM.cameraZ,t.lookAt(0,xM.lookAtY,0),t}},{key:"_setupEventListeners",value:function(){var t=this;this._eventDispatcher.addEventListener("gameFirstLose",(function(){return t._gameFirstLose()})),this._eventDispatcher.addEventListener("gameNormalLose",(function(){return t._gameNormalLose()})),this._retryVideo.addEventListener("click",(function(){return t._showPreloaded()})),this._playText.addEventListener("click",(function(){return t._endScreenHandler()})),this._noVideoCTA.addEventListener("click",(function(){return t._abortBonusHandler()})),document.body.addEventListener("touchstart",(function(e){return t._touchStartHandler(e)}),!1),document.body.addEventListener("touchmove",(function(e){return t._touchMoveHandler(e)}),!1),document.body.addEventListener("touchend",(function(e){return t._touchEndHandler(e)}),!1),document.body.addEventListener("mousedown",(function(e){return t._touchStartHandler(e)}),!1),document.body.addEventListener("mousemove",(function(e){return t._touchMoveHandler(e)}),!1),document.body.addEventListener("mouseup",(function(e){return t._touchEndHandler(e)}),!1),document.body.addEventListener("mouseleave",(function(e){return t._touchEndHandler(e)}),!1),document.body.addEventListener("mousedown",this._onDown,!1),document.body.addEventListener("mousemove",this._onMove,!1),document.addEventListener("keydown",this._keydown,!1),document.addEventListener("keyup",this._keyup,!1),window.focus(),document.body.addEventListener("click",(function(t){window.focus()}),!1)}},{key:"_onDown",value:function(t){t.preventDefault(),this._setMouse(t)}},{key:"_onMove",value:function(t){this._setMouse(t)}},{key:"_setMouse",value:function(t){t.touches?(u.mouse.x=t.touches[0].clientX,u.mouse.y=t.touches[0].clientY):(u.mouse.x=t.clientX,u.mouse.y=t.clientY)}},{key:"_keydown",value:function(t){this._currentCode!=t.keyCode&&(this._currentCode=t.keyCode,65==t.keyCode&&(this._acc=0,this._touchStartHandler(),this._keyPressed=!0,this._direction="left"),68==t.keyCode&&(this._acc=0,this._touchStartHandler(),this._keyPressed=!0,this._direction="right"),t.keyCode==xM.shieldKeyCode&&this.pixiManager.shieldItems.onDown(),t.keyCode==xM.arrowKeyCode&&this.pixiManager.arrowItems.onDown(),37==t.keyCode&&(this._acc=0,this._touchStartHandler(),this._keyPressed=!0,this._direction="left"),39==t.keyCode&&(this._acc=0,this._touchStartHandler(),this._keyPressed=!0,this._direction="right"))}},{key:"_keyup",value:function(t){this._currentCode=null,65==t.keyCode&&(this._acc=0,this._touchEndHandler(),this._keyPressed=!1,this._direction=!1),68==t.keyCode&&(this._acc=0,this._touchEndHandler(),this._keyPressed=!1,this._direction=!1),t.keyCode==xM.shieldKeyCode&&this.pixiManager.shieldItems.onUp(),t.keyCode==xM.arrowKeyCode&&this.pixiManager.arrowItems.onUp(),37==t.keyCode&&(this._acc=0,this._touchEndHandler(),this._keyPressed=!1,this._direction=!1),39==t.keyCode&&(this._acc=0,this._touchEndHandler(),this._keyPressed=!1,this._direction=!1)}},{key:"_touchStartHandler",value:function(t){var e=this;if(!u.skinOpen){if(console.log("_touchStartHandler"),!this.GAME.isFirstClick){this.GAME.isFirstClick=!0,this._startScreen.classList.add("hidden");var n=setInterval((function(){e.pixiManager&&(n&&clearInterval(n),e.pixiManager.notifyLevelStart())}),60);this.H5SDK.getPlatform().notifyLevelStart(0)}u.gameStarted=!0,this._touchValues.isPlayerTouch=!0,t&&(this._touchValues.mousePosition.x=t.touches?t.touches[0].pageX:t.clientX,this._touchValues.mousePosition.y=t.touches?t.touches[0].pageY:t.clientY,this._touchValues.oldPos.x=t.touches?t.touches[0].pageX:t.pageX,this._touchValues.oldPos.y=t.touches?t.touches[0].pageY:t.pageY)}}},{key:"_touchMoveHandler",value:function(t){this._touchValues.isPlayerTouch&&(this._touchValues.mousePosition.x=t.touches?t.touches[0].pageX:t.pageX,this._touchValues.mousePosition.y=t.touches?t.touches[0].pageY:t.pageY,(this._touchValues.mousePosition.x<this._touchValues.oldPos.x&&this._touchValues.isPlayerTouch||this._touchValues.mousePosition.x>this._touchValues.oldPos.x&&this._touchValues.isPlayerTouch)&&(this._touchValues.swipeSpeed=this._touchValues.mousePosition.x-this._touchValues.oldPos.x),this._touchValues.oldPos.x=this._touchValues.mousePosition.x,this._touchValues.oldPos.y=this._touchValues.mousePosition.y,this.GAME.isLose||this.GAME.isPaused||u.losePlatformTouched||(this.platforms.rotation.y+=this._touchValues.swipeSpeed*xM.rotateSpeed))}},{key:"_touchEndHandler",value:function(){this._touchValues.isPlayerTouch=!1,this._touchValues.oldPos.x=0,this._touchValues.oldPos.y=0,this._touchValues.mousePosition.x=0,this._touchValues.mousePosition.y=0,this._touchValues.swipeSpeed=0}},{key:"_gameFirstLose",value:function(){console.log("game first Lose"),this._touchEndHandler(),this.GAME.isFirstLose=!1,this.GAME.isLose=!0,u.gameStarted=!1,this.uploadPlayerData(),this._retry()}},{key:"_retry",value:function(){var t=r(e().mark((function t(){var n=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this._touchEndHandler(),this.H5SDK.getPlatform().adTimeout=1500,this.H5SDK.getAdsModule().hasPreloadedRewardedAd()?(this._retryScreen.classList.remove("hidden"),this._circleSvg.classList.add("active"),this._retryTimeOut=setTimeout(this._noAdHandler,9e3)):this.H5SDK.getAdsModule().preloadRewardedAd().then((function(t){t?(n._retryScreen.classList.remove("hidden"),n._circleSvg.classList.add("active"),n._retryTimeOut=setTimeout(n._noAdHandler,9e3)):n._noAdHandler()})).catch((function(){n._noAdHandler()}));case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_gameNormalLose",value:function(){console.log("game normal Lose"),this._touchEndHandler(),this._isGameOver=!0,clearTimeout(this._retryTimeOut),this.GAME.isFirstLose=!0,this.GAME.isLose=!0,u.gameover=!0,u.gameStarted=!1,this._newBestScore.innerHTML=this._score,this.H5SDK.getPlatform().notifyLevelEnd(0,this.SCORE,!1),this.uploadPlayerData(),this._showLeadeBoard(),this._nbGamePlayed++,this._circleSvg.classList.remove("active")}},{key:"_rewardHandler",value:function(t){console.log("_rewardHandler"),t?(this.GAME.isRetryClick=!0,this.GAME.isLose=!1,this.platforms.retry(),this._retryScreen.classList.add("hidden"),u.losePlatformTouched=!1,this.ball.beginBounceAnimation()):this._abortBonusHandler()}},{key:"_abortBonusHandler",value:function(){console.log("_abortBonusHandler"),this.GAME.isRetryClick||(this._retryScreen.classList.add("hidden"),this.platforms.retry(),this._gameNormalLose())}},{key:"_showPreloaded",value:function(){clearTimeout(this._retryTimeOut),this.H5SDK.getAdsModule().showPreloadedRewardedAd().then(this._rewardHandler).catch(console.log)}},{key:"_noAdHandler",value:function(){this.GAME.isRetryClick||(this._retryScreen.classList.add("hidden"),this.platforms.retry(),this._gameNormalLose())}},{key:"_showInterstitialAd",value:function(){var t=this;console.log("_showInterstitialAd"),this.H5SDK.getAdsModule().requestInterstitialAd().then((function(){t.H5SDK.getPlatform().isFacebook()?t.H5SDK.getTournamentModule().showTournamentCreatorPopup().then((function(){t._showLeadeBoard()})):t._showLeadeBoard()}))}},{key:"_showRewardedInterstitialAd",value:function(){var t=r(e().mark((function t(){var n=this;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("_showRewardedInterstitialAd"),t.next=3,this.H5SDK.getAdsModule().requestRewardedInterstitialAd();case 3:t.sent?(1==Math.floor(2*Math.random())?this.pixiManager.arrowItems.add():this.pixiManager.shieldItems.add(),this.pixiManager.updateCoin(this.COIN+60),setTimeout((function(){n.H5SDK.getPlatform().isFacebook()?n.H5SDK.getTournamentModule().showTournamentCreatorPopup().then((function(){n._showLeadeBoard()})):n._showLeadeBoard()}),1500)):this.H5SDK.getPlatform().isFacebook()?this.H5SDK.getTournamentModule().showTournamentCreatorPopup().then((function(){n._showLeadeBoard()})):this._showLeadeBoard();case 5:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"_showLeadeBoard",value:function(){var t=this;this._endScreen.classList.add("hidden"),this._scoreContainer.style.display="none",console.log("Leader board here"),console.log(this._score,this._bestScore);var e=setInterval((function(){t.pixiManager&&(e&&clearInterval(e),t.pixiManager.leaderBoard.score=t._score,t.pixiManager.leaderBoard.bestScoreValue=t._bestScore,t.pixiManager.leaderBoard.show())}),60)}},{key:"_endScreenHandler",value:function(){console.log("_endScreenHandler"),this._endScreen.classList.add("hidden"),this._scoreContainer.classList.remove("variant-end-screen"),this._circleSvg.classList.remove("active"),this._startScreen.classList.remove("hidden"),this.restart()}},{key:"_setupStats",value:function(){this.stats=new _M,this.stats.showPanel(0),this.stats.dom.style.position="absolute",this.stats.dom.style.left="100px",document.body.appendChild(this.stats.dom),this.nbpolyDiv=document.createElement("div"),this.nbpolyDiv.style.position="absolute",this.nbpolyDiv.style.bottom="100px",this.nbpolyDiv.style["font-family"]="arial",this.nbpolyDiv.style["text-shadow"]="0px 1px black, 1px 0px black, 1px 1px black, 0px 0px black",document.body.appendChild(this.nbpolyDiv),this.drawDiv=document.createElement("div"),document.body.appendChild(this.drawDiv),this.drawDiv.style.position="absolute",this.drawDiv.style.bottom="80px",this.drawDiv.style["font-family"]="arial",this.drawDiv.style["text-shadow"]="0px 1px black, 1px 0px black, 1px 1px black, 0px 0px black"}},{key:"_addFacebookButtons",value:function(){var t=this,e=this.H5SDK.getPlatform().isFacebook(),n=document.querySelector(".invite-friends-button"),i=document.querySelector(".share-friends-button");e&&(n.style.display="flex",i.style.display="flex",i.addEventListener("click",(function(){t.H5SDK.getPlatform().shareWithFriends($M.base64Picture,"My best score is ".concat(t.SCORE,". Try to beat me !"))})),n.addEventListener("click",(function(){t.H5SDK.getPlatform().inviteFriends($M.base64Picture,"My best score is ".concat(t.SCORE,". Can you do better ?"))})))}},{key:"changeColor",value:function(){this.gameColors=xM.gameColors[Math.floor(Math.random()*xM.gameColors.length)],this._backgroundGradient.style.background=this.gameColors.backgroundGradient,this.ball.updateColor(),this.platforms.updateColor(),this.tube.updateColor(),console.log("changeColor")}}]),t}(),JM=new ZM,QM=function(t){d(n,t);var e=m(n);function n(){var t;return a(this,n),t=e.call(this),Wv.autobind(h(t)),t.base64Picture="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/7AARRHVja3kAAQAEAAAAZAAA/+EDnmh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4NCgk8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPg0KCQk8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmRhMWNlMTEwLWZiYjQtZTc0ZC04OGUwLTkzMDdlMTc3NTYwYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpGRURBRjcwNjlFOEMxMUVBQjkzMUUwQjM0QzRCMjJEOCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpGRURBRjcwNTlFOEMxMUVBQjkzMUUwQjM0QzRCMjJEOCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNSAoV2luZG93cykiPg0KCQkJPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDJiNDQzOWMtYzQ3Ni02YzRkLTkxOGEtMGUwYjQzOTMzMGM2IiBzdFJlZjpkb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6NDk4N2NhZWItOWRkMC0xMWVhLTg4NTgtZTJjYjkxODFiNjNiIi8+DQoJCTwvcmRmOkRlc2NyaXB0aW9uPg0KCTwvcmRmOlJERj4NCjwveDp4bXBtZXRhPg0KPD94cGFja2V0IGVuZD0ndyc/Pv/bAEMAAgEBAgEBAgICAgICAgIDBQMDAwMDBgQEAwUHBgcHBwYHBwgJCwkICAoIBwcKDQoKCwwMDAwHCQ4PDQwOCwwMDP/bAEMBAgICAwMDBgMDBgwIBwgMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDP/AABEIAgACAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/AODVcj2p6rkfSlVKkVc/Sv8AT6Uj/LqUgVc1IqcelCp/9YVIq1jKRlKQIvFSon/6qVI+ff8AlUiJj+prJyMJSBU596kWPNOSPj2qRU/zmspSMJSERKlSPgf5zSxpUyRcf1rGUjGUhkcXtUypn3/CnpAW6d6sxwbe341jKdjGVSxDHbMe351Ktqc9RU6xc10Hw5+HOofE3xXa6Rpse6a4bLyN9y3jH3pHP91R+ZIA5IB5a+KhSg6lR2SV230RNGnVrVI0qKcpSdklu2y38F/gtqXxj8UCxtc29nb4kvbxlylsh6fV2wQq98E8AEj7R8EeBdL+Hnhq30rSbVba0tx9Xlbu7t/E57n6AYAADfh58OtN+GXhS30jSo9sEOWkkYfvLmQ43SP6scfgAAOAK2yn1r8N4k4kqZlV5Y3VKOy7+b8+3ZfNv+juEeE6WUUOadpVpL3n2/uryXV9XrtZJOgoAJNOVQB/9enBcivlnI+u5iPytw5qNrb+farW3Hqap+IfEVj4R0K61PUp1tbGzTfLIfyAA6licAAdScUQ5pSUYK7fQxqzhGDnNpJK7b2SXVmr4BFvbfETw+LiaOHzdShSPc2PMk3blUepO0nA7AnoDXqPib4uXWl+ILi1jghaOFioLdTj8a+Of2a/ibefHH9t/wAGzXG6202ynupLK0zkQKlrM+5uxdigyfoBwBX0h4lm+0eJ7xvWQ/zr4zxIy6eCxlGjWfvOmpNdrykrevu6/wBM/SPBTOqWaZbisVh17kazgn/Nywg27dF72nW2r7Lro/i7dS/etYf1/wAasR/FGY/etov1/wAa4m3OMVciP6V+byP2g7BfiLI3Jto/wNTR+PWYc24/76rlI/u1ag4NSBv3Pjj96B5GOP71Nj8aK3/LH/x6uZuJ912/scflTlmI7/pWMpanoU6Puo6pPFSyf8sW/wC+qcviZT/yzYf8Crm4psHrU8U+O4o5ivYs6FfEKsf9W351IutKf4W/OsBJ+P8A61SpcYHX9KOYPYm6urqezU7+1c/3qxUuMdMVKtzjHIo5g9ibH2tiucN+VH29aJ/Fiy6DHZCKEeW27eB8x/zmstZ/pRzExpdzore9EkKt6jmphc/X8KydGm82Bhx8rfz/AMmrma1WqOGpHlk0W/tX1/Kl+1KP4TVTdil3HNMkuC8UD+L8RTlvAP71URJTg9UkB5D/AMFFbJdU/ZF8RSbsf2fcWNyB65uo4v8A2p+lfmpNH81fqN+15pn9t/sueOrcru26W1xj/rk6y5/DZmvzBljzX9QeCOIvk1ak/s1X9zhD9Uz+FfpQYdw4jw1dbSoJfONSp+jRQdMH8ahmj5X6elXpI+KgmTmv22Mj+bYzKsSZZqSWPip/L+f9KXZk1fMaqZY8GeEbrxx4osdHsvI+1ahMIYzNII4wT3J+npknGACcA/Xfw00nSf2ddPg0vSFSbU7plGo6nImJbk5+6OuyMdlH1JJJr5A0y6m0nUbe6tZGhubWRZoZFPMbqQVI+hANfUur6jH4v8O6X4jtV2W+sW4mKjJEUgO2RMnrtcMue+3NfxJ9NXMuIcNkmEhg6jjgaknGqlo3Ne9BTd9YtKTUdFeN3d8vL/fv0Ecp4YzDO8asxpqWOpxUqTlqlTfuzcY20km4py3tJJW96/ruq+PNU0nUHhkdwRhh7g8g/lVf/hZ2pZ/1jfnSylPHnwa0jxFDhrzSpP7L1IDqD1jc/UcZ9TXNBsV/lpnmBnhMTywbcZJSi+8ZK6+a1i/NM/0gw+Fw84uM4Lmi3Fq3Vf56NeTR0w+KGpAf6w+/NPX4pakMfvGrmlXJrL8X+NtL8AaO19q15FZw8hQxzJOePlRRyx5HTpnJwOavI8nzLNMXTwOXU5VatR2jCCcpSfZJas58znlWXYWeNx7hSpQV5Tk1GMV3bdkl6nep8UtUzgSMfavLvjJ+33H8OVnsdLkj1nW4wV2o+bW2b/powPJB6ovPBBKmvBfi/wDtPat4+E1jpXnaLo7bkYK3+k3Sn/no4+6CP4FOPmIJYYx5LPhRhRxX+k3gn9DNUPZ5tx7Lmlo1hoS0X/X2cXr/AIIO215tXif5/eMP0tsNLnyrgSmktniJR/8ATUJL/wAnmu9obSNT4r/FfxH8Z/E7at4k1S41G6+7GrHbFbL/AHI0HyovHQDk8nJJJ5KWIrmr8i7RVSUZFf6F5fg8Pg6EMLg4Rp04JKMYpRjFLZJKySXZH8KYzMMRjMRPFYubqVJu8pSbcm3u23q36lR0wahZatumaidMmvTjIzjIqsmf8KjZcfSrLLUTpitYyN4yK7JtNRldoqw6Y+lRsu01tGRvGRIiZ+lSKmR/KhI+fapFWsZSMZSALU0aEfWiNKlRKzlI55SBEqVI+PShEwP6VMi4/wA9KxlIwlIRE5/zxUsaU5U/CpUTLVjKRhKQiJ/9arEVtv8AvdKdbwZ5/wAmrSR1zyqdjnlLsNji9qmig31JBbbq9G+AH7O/iD9oLxguk6HbgRwgSXl7NkW2nxH+ORvfBwo5Yg44BI8fNs2wmXYWpjcdUVOlTTlKUnaMUt22zpy7LsVj8TDB4Km6lSbtGMVdt9kv6stXoYPwp+D+ufGTxja6D4e0+TUNRuucDiOFAQGkkboqLkZY+oAySAft/wCHX7Ien/s7+F5VsNUt9c1aZFfVpVTY8ZA+7GO8KnJ/vZO4jAG3o/Cfh7w3+yx4Fbw34RUzX10A+parKo+0X7gHBYj7qDJ2IOFBPVmZmwbLxVeWOrreRzyLOrbgwbBB9q/zV8UPpkV8RnkcJkNNPAU3aXNpKt533glvBb31mn8K/wBF/Cf6JtPC5S8fnc7Y2a922qpX6JbSb2k/lGy96VlottBiBHNbbva+K7dryzSOC5Ubri2QbVPq6DoB6qOnUccLltDtP1FfuPCPGWW8SZfHMsrnzRejT+KMusZLo19zWqbTTPz/AIn4Zx+RY6WAx8OWS2fSS6OL6p/hs7PQrhdtG0+lTHkf54puw7sdfSvqFI+abILq5h020luLiSOGC3RpJZHbakSqMliewAGc18lfH/41zfFzxCIbVpIdB09z9liPymZuhmcf3iOgP3QcdSxPV/tU/G7/AISS9k8MaTMTp9o+L6ZDxdyqfuD1RCPxYeignxhUr9R4S4f9hBY7Er338K7J9fV/gvXT+fvEbjT6zN5Xgpfu4v32vtNdF/dX4vySb90/4Jx6Yt1+1Jps7D/jxsL2cH0JgaP/ANnr6Z1B/N1m4b/bNeAf8Ez7VW+OOuzsPmtPDV1IhP8ACxmtl/kzV70z7r6Zv9okV+H+MNbn4gt/LTivxk/1P6q+jRh1T4O5/wCetUl+EI/+2ly24Oau23NUoPu/jV6DivymR/Qhcj+7VqDrVWPgfjUk8v2eymf+6jH9KkcVd2Rmi682Rm/vEk1YsnV5lDdOKyIZ9o/+vU8VztPX/wCtXDzH0vseh3HivRNP0ixtXtboXDSrlwGBx0546fQ1hRXH+c1nLeswwWP4mpI7jFNzJjh2lqa0YcLu2nFL5+PWtOz8a2sPhGTTzZQNNI+8XB++vTjp/XvXPtc7n3fN1ougjTb3RoLPk96mFxz/APWrNS4xVi0uVWdS2cUuYr2JeExB5/WlE/FWvFer6bemEafbtbxrGA5Z9zSN3NZC3FPm1JjTur2N7w9cYu2Q/wAa8fUf5NbVchpV99n1KFz/AHwCfQHg/wA66/oa6KMro8nMKfJUT7gDRRRWpwh1ooJxRVRAwfi5pba98H/F+nr96+0K+t1+r20ij+dflOY9yK3qM1+vEVtHet5Mo3RTgxuPVW4I/I1+SDWjWo8qRSJIyUcHsRwf5V/QngfiP3eMo9nB/epr9D+M/pW4blrZbif5lVj/AOAum/8A25lCSOoJY/n9OKvyR7j61BKmGr9/pyP5DjMpNHx0/GmlM/WrLRUwptOf8mt1I2jMjCY5r3H9lfxIuveG9a8KzsPMjB1SwyR1GEmQdyceWwA7Bz614lwBWz8PfGVx8OvGmm61aqZJNPmEjR7tvnRnIkjJxwHQspPo1fn/AIpcFUuLOF8Xkc7c1SLcG+lSPvQfkuZJP+62up+peDviFV4M4uwXEEG+SnNKol1py92at191tpfzJH17+zR4iitPF194W1BxHpviyA2LFvuxXA5hk/BuPxp13ps2mX89pcRslxayNFIp/hZTg/rXl/xU+JXh7wfra3djqkd79oVLq2WzYPIoYbkLc4Q9DhiGGehrzz4//tQa58dddnupI4tFs7xEE9paOf8ASHChWaVuC24jO0AL04JGT/mlwP8ARi4r4uhSp4yk8JRpSa9rVi03B6tQhpKTUk3H4YPml7+iT/1Y8VPpPcE8KTlWweIjjMRUgn7KlJO0klZzmrwgnFpNazSjG0Hc7v4p/tRaf4UEljoKw6xqAGGn3ZtIDn1H+sPspC8j5iQVr558VeJtQ8X6vJqGqXk19eSDBeQ/dGSdqqOFXk4CgAelQSHHTioJE59a/wBH/C3wZ4Y4Dwnsclo/vZK0607OpP1lb3Y/3YpR6tN6n+Yvih43cT8d4r2ub1uWjF3hRhdU4+dt5S/vSblq0rLQqzEuePyqvIvH07+lWpRj+lVZhv8ApX7BA/Ko1GyrP85/2arsn/16uSJULpXTFm8ZFN03DP6VG6cf54q06f59aheP/wDV61tGRtGRVdMf41G61aZMD2/lULx/NW0ZHRGRWdcGomXb9KtMlQstaxkbxkSKtTRpmkjTP/6qlROf51lKRhKQqLz0+tTIu3mkROKmRcH/ADxWUpHPKQInNTJHhaI48f4VKiZFYSkYSkKkeTU8MO8+3Wkjjq1bxYUe/NYTnY55SHRxcVat7fefb+dJBBvP617j+yF+ybcftEeILm6vriTSvCeisp1K+UDzJCeRBDkY8wjkk5CAgkElVb5fibibL8hy2rm2aVVTo0leUn9ySW7bdkktW2ktT1OH8hx+d5hSyvLKbqVqjtFL8W+iSWrb0SRm/sw/sqa1+0X4ikFuf7N0Cwcf2jq0qZith12IP45SOig8ZBYgEZ+1rWbQfg14CXw14Ps1s9GsTiSU4M2pXBAy8rjBdzgEngBQFAVQqh1/rdrHZ2Hg3wbY2+k6LZr5MEEXyxxoMlpHY8nuzOxLE5JJJJPG+JNThurpYLMs1jagpCzDBlP8Uh92PPsMDtX+Q/j59InM+NqsqWGvRwEJWp076zkvt1LaNpWdtYxukrtuT/1c8Cvo95fwdRjisYlVxs1eU7aRT+zC+qTfXRys27WUVTubuS7naSRmZ3O4k9zUYbP8VN3YoZ+P61/JLxDcrs/qbltoi1p2pzaZdLNDIyOpBBBxXY2t5D4zg8yFVj1BRmSFRgXH+0o/v+o/i7fN97hM4p9pfSWE6yxsVZTwRX6Z4c+IeZ8LZjHGYGV4uynBv3Zx7Pz7PdPyun8TxvwTl/EmBeExkbSXwyXxRfdeXdbNHUvFt9G968n/AGoPjMfh/oP9j6bMya1qkZzIhw1lCcgvns7YIXuBubghc+mePPizpWl/DrUPEGoMkep6YgLRZ2/2ozEKgHpJuI3HuoZjyrbviXxTr954w8QXmqahJ515fSGSRugHYADsoAAA7AAdq/1k8IcywXF+Bp57h0/Yp2cXupq14vvy3TfR3XRs/wAsfHSpjODcTLh+b/fzV1Jf8+3dKa7OVml1Vm90m8lI8CpEiNSCP5qekW3mv6DlLQ/kSUz6V/4JsWgj8R+OLzvDoyQg+m+XP/slewWx3TSN6sT9K80/4J1QeR4N+JNww/g0+JT/AOBJI/8AQa9Ks+X/ABNfyN4oVufiTELtyL/ySL/U/wBJvo9UFDgTBT/mdV/+VZx/Q0oOgq7bcf4VSg4Aq7b1+dn7YXEHAqv4in8jRJP9sqo/PP8AQ1YT7orJ8c3XlWdrH/z0ct+Qx/7NWdaVoNnZgKfPiIR8/wAtTNhuNp6kVNFLubjn6VlxXP8AkV2Hwq1LRLTWC2uRyTWuw4VD/F27jj8a8+Lu7H11SnyRcrXMmObHcipknx603xNfWs+tzNZK0dszkxqx3FVJ4BP0qmk+KTkVGjdXsasdxg1MG/dbty5Jxt71lR3NW9NuFF5H5n3c880uYHRsi6C4XO1setOFxxXpXjC+8Kt4BUWfkfbNihAqkSA8Z3H868nNx8/fbmrn7pz4WTqxb5WvU0Uuaetxms2OfJA967TSfhNeap4TbVUaERqrOFLfMwXrj8j3pRvLY0q8lNXm7HP+f7j8K77T7r7dYwzD/lqit9CRzXmcsnlSsvHymu48AXv2vw+qfxQSMn4fe/r+lb4aXvWPMzrD/ulUXR/mbWaM0dqO1dp80FBNFJnNVEB8L+XKh9Dmvy3+L2jf2H8V/FVj1+w61eQf98zuv9K/UYdq/OH9rDR/7I/aQ8bQ7WXzNUkuMH/priX9d+fxr9p8FsRy5hiKXeCf3St/7cfyr9KzC3yXBYn+Wq4/+BQb/wDbDzCWLLfhUEsfzf41ekj3dvrUEkeT68V/SMJH8LqZTdOKjaPHT9atvHUTR/8A666IzNozK2zB/mKa3J/oe1TumRUbp61opGsahE/T/wCt0qGQYqZkqNlrSJvGZBJj6VBK3FWHQCoXStonRGRVkTmoJFyelW3j4qJ0rojI3jMpyR55qJ48H/PNXHTn3/nUMiZFbxkdEJFOSPJ/pULpz/Krjx81C6ZFbRkdEZFN0qNk/KrTp/8Ar9ahkXmtYyN4yKskfNQstW3XjFQyLit4yOiMiVE59zUyJ+QpqLn+tTKufpWUpGMpAqf/AKsVYRcU1EzU0a//AFqxlI55SFROanjTFJHHxUyJk/yFYykcspCxR5/H9KuRR1DDH/Or0KVy1JGEpHWfBb4S6t8aPiFpnhvRo1e91KTaZH4jtoxy8rnsiLljjk9ACxAP3zrVrpPwV+HuneB/DQ22OmpiefGJLyY8yTP6szZPoBgDCgAecfskW/hn4B/s/r4jtry01XxR4qQrdXVqPMOmxAgizB6q44aQYGWIHzBEarFn+0FaeHtZjv7XQItTvI3EiS6nMWjU+0SY/VjX+WP0sPFavxBnL4Ww1T2ODw0rTbUrzqLRvlSu1HVQukm7yvZq3+pf0S/A+eV5RHivFUvaYjERThZxtGm9Uk27Xlo5Wv0Vvdd+21yH/hXfhQae3y65rkSyXh/itLY8rF7M/wB5vYAVx+a1dR8TWvxde81/T2dNQkJn1LTpH3SW57yRnq8P6p0PHNY+/nP+RX8N8TN/WeSmv3UVan2cU9795O7ls1JtWVrL+ysDSnTg1W0qX95Po+3olpHo1Z3d7jycUjNTScmkBr5yEXc65DnbFABdgByc8Ypm7FeffHn4i/8ACOaJ/ZNnIP7Q1JD5jL963h6E+xfkD23Hg4NfqXhfwBmHF2fUMjy9e9UfvStdQgvinLyivS7tFatHwfiNx5lvB2QYjiDNH7lJaRvZzm9Iwj/ek9PJXk9E2uA+OnxG/wCE58Q/Y7WXdpOmsVjKt8txJ0aTjqOoXrxkj7xFcIyfrU7LhcDgUgTdX+33CPDGA4cyihkuWR5aNGKiu7e7k+8pO8pPq2z/AAi444zzHinO8Rnuaz5qtaXM+0VtGMe0YRSjFdkr66kKx81IkfNSLHzUiRZ96+glI+O5j6u/YRtDZfAXxlc4/wCPnU4Ydw77Ig36b/1ruLAf/rrl/wBjuBrL9lHUmZdv2rxBMyn1UQQL/NTXUWIwPwr+PuPKntM/xUv71vuSX6H+pPgtQ9jwRlsP+nd//ApSl+ppQDgVetxk1Sh6Vdt+K+NP1ItRn7tcr8Q7zGr28P8Azzh3H6kn+gFdVH1WvPfGl/5/iq89I2WMfgoB/XNcuMlaB73DtHnxV+yb/JfqJDcYH+FSpdEHqazop91SrPzXl8x9t7A0orvjrVhLnNVdBtBq2oRW/nQw+YwXfK21Ez3J7CnXqfYrp496vsYruQ5VsdwfSnfQn2a5uUux3WB3608XOKzkuKk+0Y9aXMV7E04riSYbcyN7U77QUPPFXPh74psfDmsrcX9lHqEChgYXOAeOOx6Vn6xqUd5qEkkKCONiSEB4Uen4VV1a5nGm3Nx5dO5Ml1g1t2fxD1C00hrGO4mW1f70Yc7T68VyyT5PapI5izrz3pKpbYqWFUviVzQN35j5PXNdV8KtRze3dsf+WiCUD6HB/wDQh+Vcvqelpp+nWsy3NvM1wpYxo2WiwcYYds9an8Aap9g8XWRY4WV/JPvuG0f+PEVrRny1EcOYYZVcJNR7P8Nf0PV6AKB0pc4r2D87E7UhP1pW4FMNVEB44FfBP7eWlNZ/tP69MT8t7bWc6j0xbRx/zjNfeo5NfFv/AAUc04W3x10yZVb/AEzQoXYnuyzzqf8Ax0LX6h4S1/Z57y/zU5L8Yy/9tP52+k7hfa8G+0/591qcvwnD/wBvPnJ4uaimjyfWrrR5qGaPmv6ijI/zu5tSi8eD/Wo3jq48eDUbxeldEZFKZTaPFRNHjpVxouP6GonjrSMjaMymyZ/rmo3jz/npVt46idM1tGR0RkU3Sonjz2q3JHzUTx//AK62jI3jIpvH/wDWPpUTx5/wq5JHn/PWoZI/8+lbRkdMZFJ04qJ0/P8AnVx0z9ahkjyP88V0RkdEZFORM9qhZOattHUUiZreMjojIpyJULpz71bdP/r1BInpW0ZHVGRVZOPaoWXP1q06YP8AOoXTA/lW8ZHRGRseLvDw8M+JbuzjfzIYZD5Mh6un8JPbOOvvmqaL+dY8HxWt/F/xB1PS3YR3kRaVImOWH94D1XuD2we5rcRO1fH8G8RLOMqp4p/Gvdmv7y3+/SS8mfYeInC8sgzurgl/DfvU33hLb/wHWL80xY0z9BU8Sc01FyasItfSSkfn85AiZqaNKRE/P+VTxp/9asJSOaUh0ac1chGagjTj+dWYF2n8a5pyOaUjqfhx8RtQ+HeptLaMJLe42rdWsh/dXKjpn0Yc4YcjJ6gkH2nQ9Y0/x5ox1DSWbKAfabRz+9tGPY+qnsw4I9DlR88Qjitfw14hvfC+qR3mn3MlrdRHh0P3hxlWHRlOOVIII6iv538bPAXJ+PMM8RG1HHRXu1UtJW2jUS+KPRP4o9Lq8X/SPgF9JnPPDjFrC1L4jLpP36LesbvWdJvSMurj8E9b2k1Ne6aZqd1oWoxXdnNJbXVu26OSNtrKf8/ga9A0Pxlb+MP4I7TVMZkhQbY7k92jHZu5T8R6DzLwh40sfierRxxx2OtKhd7UH93cAfeMRPJx1Kn5gOfmAJFl0a2l/iVlP0INf5K8c8AZxwzmFTJ86ouE469010nCWzT6Nej1TS/2V4P4y4e46yinnmQV1Upy0uvii+sJxeqa6xdt7rRpv04N9OfahjXO+HPHIu2WG/bbM3CznjzP970Pv3788noHdYUZ5GWNUBLOx2qoHUkngAe9fn9HLKrqqnFXb0Wmr+XfyN8ZTeHv7bRLW/S3e/YzPGfi228D+HptRuvmWP5IowcGaQglUB98HnnABPavnDWtYufEWrXF/eSGS6un3yMenoAPQAAADsABW/8AFT4gN8QfEXmRbl02zylqpBG4d5CPVv0AA65zzBOa/wBgvo4+DMOCMi+s46H+3YlJ1O9OO8aSflvO289NVGLP8XPpSeOkuOc+/s/LJ/8ACfhW1TttUntKq/J7U77Q10c5IjC7zShPWnqmKcowK/o7mP5RlUGhNo5qRUyP6U9Ez/WnrHzWcpGPNqfYX7O1qdO/ZD0fP/L7f3U3TriVk/8AZK2rHrVT4V2zaX+yh4It2PzSR3E34PcyuP8A0Krtl/Wv4z4nqe0zjFT/AOnk/u5nb8D/AFu8NsP7HhPLKdv+Yejf1dOLf4tl+HtV2DjFU4hk/hVy2NfPn2xbiGWUV5Ffal9v1K4nz/rpWk/76JNeo67e/wBm6DeXH/PG3dx9Qpx+teOQy4A/xrzMxlblR9twjh7qpU9F+d/0NSOepI58VnxTVMkn69K8zmPtPZGlFclenf1qRbnceTWerMoBwfyqRJsUczD2J03gi0g1bxBa29zIIoZJFVnP8IJ5P4V6V8d/h1ong3SbOTT5j50mQyFw5IGMNx2rxe3vGgfcpw3tVq51i4vExIzMuK2jVSi1bU4a2AqTrwqxnZLddyRZ6kE4rPWb/OKkWXNY8x3exLwuMVItzj2rPWdl708S4o5g9iaIu2YfeNLDevbSrIhw8bBl9iORWx8LvAEvxG1r7JFLHFhS7M/RQP8AIqD4jeDZPAHiCWwlkjd48cqflIIBB/I1pyy5efocvtaLrfV7+9a9vI9ktLpb+0iuI/8AVzoJV+jDI/nUnSud+FWqf2p4FsyeXt91u3ttPH/jpWuiPSvfpy5oqXc/J8VQdGtOi/str7mNPIoJ/nQxxTe1aLc5xwOa+Uf+ClellPEXg2+wuJ7S6t88ZPlvG3/tX9a+rQMGvnL/AIKR6WJ/BnhG+28219cQbv7okjVsfj5Q/KvufDmt7PiHDt7PmX3wlb8bH434/wCF9vwHj0t4qnJfKrBv8Lnx68fP4/lUU0XP4VcljwxqGaPB9a/rKMj/ADAlLUptH/8AqqJo81cePn+VQsn/AOuuiMioyKrR5qJ48VbdMn/61RtHg1tGRtGRTkSoXi4/pVx49o9vSonTFbRkbxmVHTBqF48irjx1Cyce1axkdEZFN0zUMkdXJI+tQOmP89K3jI6IyKkif59KhePP1q5Imf8APWoJExW0ZHVGRTkSoXSrjrn/AAqCRP8A61dMZHRCRTlT0qF149quOKgePn+dbxkdUJFSRM1A61ddMD/PFQSR47VtGR1QkcAP2f2m+MX/AAk1zqrxi1m8y3gs/vSEH+Nzxt7EAHcD1HSvSUXJ6fWmIv8AgKsRpxXzuQ8O4LJqDoYNPXdt3ba6vp9ySPoeLOMsy4gxKxOYST5bqMUrRin0XX5tt+Y6OP0qaJKaifnViNM160pHxs5Cxrip40pqLU0cf/1655SOaUh0cfA/zmrESU2Jc1NEmKwlI5ZSJoBk+9WIahjTAqxEM/yrlmc8pFuynktZ45I3aOSMh0dGwykcgg+oODn2r0C3+OU1zpkceoafHeXkeQbpJfJMo7b12kFhzyMZGOM5J88jGf5VYjXDfSviuLuBsg4lowoZ7hYV4wd48yd03vZppq/VJ2dlfZH2nA/ihxTwZiJ4rhnGzw8qitLls1JLa8ZKUW10bV1d2au79ufi6zN8umoo958/+y0niP4yah4g8MNpKxJa28jDewcs7IM/Jn+6TjPfjHTIrjkHFSqOPWvj8p8EeBcrxlPH4HLacatNqUZXlLlktmuaTV09U7aPVao+v4i+kv4l55gKuWZpm1SdGrFxnHlpx5ovRq8YRdmtHZ6q6ejY4cjaPxpyjaPelVcU4e33fWv1I/BZ1BMfjTgn4+9OVOPQVIqc+lZykc8pCRJUqxc+lEUfP4d6lKYU/wCcVhKRHNqfaulWn9mfAbwDb/3tHt5uP+miB/8A2aizXir3iG0/srwR4Psf+fPRbSH/AL5hUf0qjZjiv4qzKp7TF1aneUn97bP9kuHMP9XyrDULW5acI/dFIvQ9V+lXYDkVSh7fhV6GvPPaMf4oXv2LwPdD+KYpEPxYE/oDXlKS9P8AGu++OV95Oi6fb/8APacyY/3Fx/7PXncb4rwswlerbsj9S4Rw/LgOf+aTf6foXkl4q5pMwlvY1kb5c4wT0FZsYKjNPSQg9a4uZn0zp3Pa/inonhDT/AllNpE0cl823O2UszDHJYfwnOPSvJllzVT7dI4Cs7FfenJLiqqVOZ3tY58FgZUYckpOWu7L0cvI/Wu3OqeHR8OliFvdHXjNkylh5Sx+mM9fw/HtXnomp4uc/wD1zUxqWNq2E9pa7as76f1sXvNw3HSr2jaY+sSyLG0atHG0h3yBBhRk4J7+1Y4lyOtSJP5f3TSUjSVF2si6DmXaPpzWpq3ha+0TTrW6uLeaG3vl8yB3XCyqOpH5/rWClwQ27P41futautQtY45ZJJI4RtjVnJCD0Hp+FOMlbUidOd1y2t1/4Be8N+L7zwreLcWc0kEy9GRtpFN17xPdeI71ri6meaaQ5Z3bLMfrWRvwetKJcUcztYX1WHP7S2vc9T/Z/wBW3wapYt/AyXCD6gq3/oKV6NivFPgtqf8AZ3j23X7qXkbwH8RuX82QfnXtX1r3cvnzUbdtD8u4sw3sswcl9pJ/p+gNxTWoIxQOa7T5oVeTXiX/AAUE05r34DWsygf6HrdvK3qFMU6fzdfyr2wda8x/bR05dQ/Zp8QttLNaPazrgd/tMSn/AMdZq+k4TreyzrCy/wCnkV97S/U+A8VML9Y4PzOn/wBOKsv/AAGDl+h8Gyx5dv5VBImeelXJE+Y/zqKaPjp+Vf2BCR/kpKVmUnj5/pUZjq06Z/pUTpzzXVGQKRVdMdqidMH2q26c1G8f4VpGRtGRUZMfSonj5q06Y/wqOROK2jI6IyKbLj/PSoZI8VcePngVC6VtGRvGRTdMfSoZE5q5ImB0qF0xW8ZHTCRTdOKglTFW5EqGRPzrojI6YyKckfP/ANaoZEzVuRP8+lRGHf8A/WreMjqhIptF6VG9vz/ga0GiwOKheHJrWNQ64O5RaEL/AI1BPHuOK2dM0C713UobOxtbi8vLhgkUFvE0ksrHsqqCST7Cvcvht/wTq8YeKkiufElzY+C7CXBxdjz7xge4gQjHuJHQj09PmuKOO8g4aw/1rPcXChHpzS1l/hiryk/KKbPseF+DM84hr/V8lws60uvKtF/ik7Rj/wBvNHztEuanRcimxpxU0a5NfVykfISkPjXjpU6Jimxp/wDWqaNMVzSkcs5EkaZPpU0aZx+lNjXH9asRR+3/ANasJSOWcgjTn+dWIo/8ikjTpU8ce7tXNKRyykORM1MicURw8VPHD/nFc8pHPKQRAg1PHj3pEg4qVY8CsJSTOaUhUPtUqdaSOPAqVVz/AE96xkznlIFGakRMdvoKciZNSInNZSkYSkIq8/yqRUwv9KVEwakRTWMmYOQRR/MKk2YRu3HrQkeDWp4V04ar4k061YfLc3UUR4/vOBXLWqKEXN9NS8PTlVqxpR3k0l89D7Y+Lluthr1rZr92zgSEfRVArDtBhK2vjDN5/juf/Z/Tise0PSv4n5m9Wf7WRio+7HZF2L71XIOKpw/eq5DxWZR5z8cL3zfENlbjpDal/oWY/wBFFccpxit34lXH9qfEG+X+GNkhXnptQA/rmuh1r4BapoXgK38QSrH9kmVWAD/OoboSPevnK/NOrNo/YspqUsLgaFOo7OSVvV6/qcm+stLpcdr5cIWJ2cOIwJGLYBBbqQMcDoOarq2zrTUiVLaa4mmhtLO1/wBfcztthh6kZPqdpwoyxwcA4NfPfx//AOCh2i/DZptP8JqLy+A2tezKrOG77F5CD0OS3vzgeBmmc4bAQ58RLXourPv+G+E8xzqt7DLqd+8tor1f6avyPofWbu38LWH2rVru20u3Zd4a6fazjttT7xB6g4wfWvKfHn7dPgHwIWjt2utZnjbu3kwt7YXLde4Ycdga+D/iD+0D4m+KOoyT6hqFwyyEnG81yybpWLOzMx6knNfmeZ8f4uo3HCpQX3v8T+i+HvAfAUoqea1XUl2j7sf83959heJP+CoFx5xGk6Lp8MYbK7ofOx+L7s/Q8Vy9x/wUo8aSSM0LRQKx+7HEiD8gMV83wRgdqtRR818fiOJMyqO8q0vvZ+nYTwy4ZoRssHB+qu/xPoqy/wCCkXjWGZXl+z3GMjEsEcg5BHRgR3P0+orrvDH/AAU5u43RdW0PT7lVG3IjMJHXn92Vz+Oen4V8mrHx0pypgelZ0eJs0pO8K0vvDGeGfDGIjyywkF5pWf3o/QrwJ+3V4D8ayLHcSXmizSHA84iePn1ICsoHqAxPpxz7d4Y8bWeqeGLn+zZtP1S1n2s1xAwkMQzxnumf9oA1+RCgxnKsVx3Brrfh18b/ABJ8MdUhutL1S7tpITlSkrKR26g19blfiRi6TUcZFTXdaP8Ay/D5n5fxH4A4CvFzymq4PdRl70fv3X3v0P1EY7z9aEf/ADmvnP4Cft/6V44MWn+Kkj0u+I2rewx4ikI/vxjpn+8np905JH0fpTwXkkLmaNrabDLNEwlRkzjcpHDDg9Dg4r9TynOsJmNP2mFlfuuq9V+u3mfzvxFwvmOR1/YZjTcX0e8Zej6/n3SLmja7Lod7bzozbbeeO4Kg/eKHNfRe5X5VtytyCOhHavm7UYoYbyRYZDJCrEI5XaXXscduO1e7fDbVf7Z8B6XNncywCFj7plDn67c/jX1eWz1lBn5Dxthk6dLERXVp/NXX5M2+oooHFFeufnYZ5rkf2hdMbVvgJ4whA+ZdKmnwR/zzXzD/AOg11xNZvjjTV1vwFr1i3zLe6ZdQEeoeJl/rXfl1b2WKpVf5ZRf3NM8fiHB/W8rxOFtfnpzj/wCBRa/U/NuRQecf/WqORPkqwBmJfpUbpge1f2fGR/jNKWpVeP8A/VULj/PpVp0/Soyua6IyEpFVkxUckfFWilROlbRkbRkVHXionT/9VW3T8qhkjrWMjeMiq6ZqGSPmrbpj+tQyLzW8ZHTGRTkTmoJU/wDr1ekjxVeRa3jI6ISKbrULp/j9KuSR5qB1zW8ZHVCRTkjpvk8e1WTHk/1ppjwK2UjqhI6T4TfAbxX8cdUntfDGj3GpG1CtczZWO3tQc4MkrkIucEgZ3HacA4r6E8Df8E+fDvhBY7rx14k/tG4X5jpujHy4sg5w87jcwI4IVEI7N3rg/wBiDxzeeG/FfiDSre7ktv7Y03zFCH/XSwtuUEd8I8p/CvWLLxedauWinYrdKcbSeH+n+FfwL9KPx44y4Xzt8PZPKNClKEZqpGN6klJNP3pXUUpKSTilLT4j/RP6LP0fOEuK+HlxNmilXqRnKEqbfuRcXde6rN3i4t8za1+HZvttD17w/wDCzTpLHwboOnaDDIuySS3jzPOAePMlbMkmM8bmNZNz4mvNWv0aaZmyw71l7s0+1bN1H/vCv84c54lzDNMVLF5jWlVqS3lOTlJ+rbbfzP8AQ3J+G8tynDLC5dQjThFWSjFJL0SSSPgyNcfjU8Uf+fSo41yf5VYjTiv+iaUj/ntnIeif/WqeNKZGlWY0rmlI5ZSHxx8VYiiyOaSGL2/+tVuGLH+NctSocspBFFzViKCnQ2+a9L/Z+/Zt1z4/+JFtrBRZ6TbuBqGqzr+4slOPcb5CPuxg5JIyVXLDxM4zrB5ZhJ47MKsadKmrylJ2SXr+CW7ei1OvKcnx2a4ynl+XUnUq1HaMYq7b/RLdt6JatpI85jh46VMsfP8AOvWfjD+yF4n+Es11cRpH4g0S3JP9o6eN4RRnmWPl48AZJOUGcbzXma2mR6jtg15uR8TZXneEjjsprwrUn9qEk1fs7bNdU7NdUPiLhnNcjxbwOb4eVGqvsyTWnddGuzTafRldE/8A1VNGlSC2xTlj29vwr1XI+ZmNWLNSLHj609I+f88VLHHk1lKRyyZGkeP61KseTxT/ACuflpwTB9KzlI55SGrHz/WpFTHQfjTlXNSKufasZSMZSEVcD+ddZ8FLJb/4x+EYHXcs2tWaMPUGdM/pXMIuT/SvQf2X9P8A7Q/aB8Ix7d23UEl/74Bf9Nua8jOqvs8BXqdoSf3RZ9BwdQ+sZ/gcP/NWpR++cUfSvxIkM3ji874YjiqNqMAVY8ZP5/jC9b/pq386it05r+OpH+y6LcJy361ctxlh9aqwIDTNbvv7L0K+uM4NvbvID7hSR+uKzbsrsunBzkoR3eh4xqmptfa9dXin/XXDyj8WJre8U/H640v4eNHr2qSW/h3TQNwG3e+OiJnq2PXheCewPLW/kwwTT3U32axsojPdT4B8mJcAkAkAsSQqjIyzKMjOa/PX9vH9tS7+Lvik6Do8v2fRNOH2eKOJsLtBJPPckkkk8kk1+d55nawFK8fjlsv1fkf1dwNwE+IcZGnJWo0rc0uq7KP95/gte19n9r/9vbUPizqkmj6Cx0/Q7dmWKKFjtHTJJ/iY4GWPJx7Yr54heS5lMkjM7NySx61jaaM8tzn1ratOn41+H5li6uIqOrVd2z+1sjyjCZbhoYTBQUYR2S/Nvq31bNC1XAUdavQrVK2PAq7B0rw6h9JTLUAzirUK8fzqrbD5q0bWLNczidHNoLHFnpUqwcVbtLJnA/Or0OhSSL91vTpVxw0pbI5amIit2Y32fI/wphhxx7VuTaI0Y+6fTOKoz2pQnipqYeUd0EMRGWzM8bo33KSrLzmvfv2Uf2zb34V6jDpOvPcX3h+ZsMgbMlqT/wAtI8nGR3U4DAYJB2svg08WBUDpg/TpW2X5hXwNdV8PLlkv617o87PMhwOcYSWCx8FKMvvT7p9Gu5+s+l6rZ+INLtr/AE+7hv8AT76MS29zCcpMh4yM8ggggqcFSCCAQa9h/Z91pLjQr6x37mtJ1kAIwQrr0/NG/Ovyz/Yy/atn+FOvR6HrFxNJ4d1CT5wfm+yuRtEqj2+XcB95QB1Clfuz4H/EttC+LZikkH2e9haP5TlWxh1YHoQVyQRwQciv6O4P4kpZnBVY6SWkl2b7eT6fd0P4E8YOAMVkMamGqe9C3NCXdJ63/vJb+qfWx9RBs0HmobWdbu3WSNgVYZBFTbK/RD+ZZB3qaxUPcxqwVlZgCD3FRCPBqW3G2ZT/ABZ4qt1Ylb3PzRv9Nk0q8mtJP9ZayNC31UlT/Kq0i5PT2rq/jDpi6R8WvFVog2x2+s3kaD/ZE74/SuZlTFf2hg6/taMKv8yT+9XP8V84wv1THVsL/wA+5yj/AOAtr9Cmy4pjpmrLLj6VG6V3RkefFlVlqNkx9f51adM1Cy561tGRrGRVePH0qJ0q2y1G6Yz/AJzW0ZG8ZFORP/1VC6cf54q48efpUbw/pWsZHTGRRkjzULp7ZFXniAFRyR5/z1raNQ6YSM94jmoXgrQeH2/+tVeWLFbxkdUWU3i7YqOROKtNHg8ioXX9f51tGR1QkdF8EvEv/CHfFvw/fvIIoUu0inY9Fil/dSH/AL4dq908c2DaP4nuI+VZXJBHGOa+ZTHng98j6V9O+IdWPjPwjoPiDczvqdnG8zYxmYDbL/5EVhX8D/Tk4Yc8Ll3EFNfC5UZP19+C/Cof6Yfs9uLlHFZnwzVfxKNaC9PcqP8A9N/1Yu+GfFYvStvdMqTHhJDwH9j7+/eugtsi9jU5UhhkGvMnrq/BfjRGnhtNSY7QwWG57x+iv6r79R/L/NOeHjUlZaS/B/5Pz2723P8ASzMMvai6lFadV/l/l9x8cxJmpo1yf5VHEvy1ahTNf9GspH/NlOQ+Jat28WT79PpUUEe4/XpV2BMGuSpKxyTkSQx1ctbfdxUdrBuI/Svpv9lX9l3S5vC8PjvxxF5mjsWOlaUxx/aJU486bv5IYHanG8jJ+TAk+D4847ynhLKamcZxPlpx0SWspSe0YrrJ2fVJJNtpJs+s4F4Dzbi7N6eTZPT5qktW38MYq15Setkr+bbaSTbSOd/Zt/ZEuvifZr4i8RTTaH4QjbibG241LHVYAw+72MpG3PChiG2++618QrLSrSz8OeGLOHR9DsBsht7cYGB1LHOWY4yWYlmOSSSSayfiH8U7rxhc+WpENpGAkUSDaiKOAAOgAHauf8Or5l5LJ/cXr7nA/wAa/wAifGnx+znjjFuM37LCwbcKUXov70npzSt1astVFJN3/wBhvBP6O+ScA4D2ziquLkvfqSWr8orXljf7K7K7bVzqtK8V32j3QmguJEcHOQcVl+NfhV4N+LzSTXlr/wAI/rMuT/aGnxhVkY95YeEfk5JG1j3anbuKUNX4/wAI+I2e8M4xY7JMVOjPryvSS7Si7xkvKSa8j9E4x8P+H+KcG8DnuFhWg9uZap94yXvRfnFp+Z4p8Sv2ZvEnw4tpL1rePV9HQbv7Q0/Msca9cyrjfFjuWG3PAY15+1rx9a+vND8UX3h+5WS1nkjZTkYOKzPFnws8HfFQtJcWv/COavJz9t0+ICORvWSDhW7kldjEnlj0r++fDP6amCxXJg+MaPspaL21NNwfnOGso+bhzXe0Ej/PXxU+g7jcPz47gmt7WO/sajSl6QqaRfkp8vnNs+VRDj2709EwK9I+JP7OHiL4d2sl60UeqaOvJv7AmSKMf9NF+9H1GSw25OAxrgjbED+Rr+2cl4jy7OcJHHZVXjWpS2lCSkvTTZrqnquqP4H4i4ZzTI8ZLL83w86NWO8ZxcX6q+6fRq6fRkCx5HNOWHHNS+VinLHXqc3Y+ZldEYTBqRE45/KnqlOWPJ6Co5jnkxqLj+lesfsWWn2j9pXw58u5YxdSN7YtZsfrivLVXBr239gfT/tHx3aX/nz0q6mJ9OFT/wBmr5ziypyZNin/ANO5r74tfqffeE2HdfjXKoL/AKCKL/8AAZxk/wAj1bW1M3iC5bPWQ/zqSGLFOuId+qTt/tmrUMHHFfyTI/1+Ehj46frWH8VLz7B4CvueZtkQ/Fxn9Aa6aO3/ADrzv9qXx3b/AAz+GkmsXMiRx6cWvRuON7ouEHvhnDY7hTXJjKip0JzeyTPa4cwc8VmmHw9NXcpqy7u9z4b/AOCmn7Ug+F/g4eCdKuFGo3hEt+y8Mr4ICfRASP8AeZ+oxX552E7XEzSSMWaQ5bPernxx+LN18YvitqerXErSCSZtmT0Ge1Z+mScCv5+zvFTxFd1Jf8Mj/TrgrJ6OV5fTwlHort9W3u36/gtDpdObAFa9m3NYOny4Qfka2LWTGK+PxET9DoyNa3kzV6E1mW0mTV+3fj9a8ycTvhI0rT7361tabB5hUVh2TV0nh5d0y/XFOjS5pJE1qvLG51nhfw0bvadtegaJ8L5L2P5YifwqH4YaQt3cRLjjPpX3b+yB+yxa/EyDfNtjhjTc7EdBX6Zw/wAPrEWilqz8V4846p5LRliK7tFHwxr3wqms4SWhb8RXn3ifwobNmIXbiv1W/ad/Yls/CXhWTULFluLdflY7drKcV+ffxa8Irpd5Mu37pIq+IuGPq8bSWpyeH/iRh89h7XDyutjwC8t/Jc5qjOldD4jtfKuGH9Kwrgc1+TYmjySaP3fDVOeKZV3NG+5flYcg+lfYP7EvxuHijSbPTbyT/iZeHXVkcnma1LYYf7ybuOpKuegjGfj5zxXQfCD4h3Hwv+Imn6tb4byZcSRnhZUPyujezKSp9mNevwxnU8sx8MQvh2ku6/4G680fK+InB9LiPI62Akvfs3B9pW/Jq6fkz9pfhH46KONPum9o2b+VenLHkf8A16+Z/Butx614f0vVLKczQ3ltFcwyjrIrKGDY7E55B5B4PIr6F+G+vjxN4bikJ/fRjZIPcV/XdOopxUo7M/yNxWHnQqyo1VaUW012admvvNUQ1LFDhhVhbbIqaK2wa2icp8BftX6WdJ/aK8WRFQN92s/HpJEkn/s1ecOnb0r2r9u3Rxpf7R2pSjd/p9la3Bz7RCPj/v3XjLrk81/XHDNb2mU4Wf8A07h9/Kr/AIn+PfihhXheMM0oWsliK1vR1JNfg0VSnFRsuPpVlkz/AFqN0/8A1V9FFnw8ZFZlxUbLkcVadfwqN4a0jI1iysYcmomjxVp46a6ZrSMzeJTkTj+dROnFXRbbj/hVzQPCmoeKNVjsdMsbvUL2UEpBawtNK2OpCqCePXtVTxEKcHOo0ktW3okvM7sPRqVZqnTTcnokldt9kuphtbsTTfsuMcd8D619A+Df2J7yFUuvGmrWvh21HzG0gZbq9ccEjg+XHkZw25yD1Su/0LUvBfwXCr4T0OD+0Ixgand/6ReMemQ7cJnPIjCA+lfz3x59KDg3hxSo4er9brL7NJpxv51Ph/8AAedrqj+qfDT6JHHXFTjWxFH6nQf2qqalbyp6Sv5TcPU8M8CfsX+OvH1j9q/s2HQ7d1zC2rym0a5bHCpGQX+bjDMoQ5+9jmvK9b0O40TVLmyvIJbW8s5XgnhkGHhkUlWUjsQQRX1brPxP1bX7zzZrqTcrbhz0PWj4+fBaP46aGur6XDGviu1iHAIX+1oQOEbt5ij7jHqPlPG0r+T+Gv0xoZrxH/Z3EdKGHw9ZqNOabtTl0VRyesZbc6UVF2bXK24/tvix9CaeQcNxzHhytPEYmkm6kJWvOOl/ZqK0lHVqOrkrpNyST+QJItpqvInP861b6zaCRkdWVkJDKwwykcEEdj7VnzR7T/nmv70pzvqfwHytOzKbJzXvnwL1T/hJfgPcWbNvm0G/dQuPuQyjev5v5vvxXg7jB/lW/wDDb4nX3wz1p57YfaLO7UR3tm7bUuox0552uOSrdjkcgsp/KvG/w/rcZcIYnJsJb2/uzp8zsueLva/TmjzRTeibu3a5+6fR38TKHAvHGEzzG3+r+9Cryq75Jq17deWSjJpXbUXZN2PWWWlsx/pkf+8Kmtbyx8VaSNU0mZp7F22kOu2SBv7jjJwwz6kdwSOabZoftcYx/EK/xYz/AIexuVY6pl+YUpU6tN2lGSs013X9XVmro/3wyXPsBnGX08zyyrGrRqR5ozi04yT6pr+k9HqfMsaZ96swpuNQovH8quQJX/QfJn/NPORNBHt5q5bRbm9hUMKY/Diug8D+E7zxp4p03RrBFe+1S6itLdWOFMkjBFyewyQSew5rzMVXhThKrUdopXbeyS3bM6VGdaoqVNXlJpJLdt6JL1PTv2SP2el+NHjKW61ZWi8K6CFuNUkyV+0c/JbKRghnwckEbUDHIO3P0B8WPH58T6p9nt0jt7G1URQQxKEjiRRhVVRwFA4AHQCtDxTBpfwU8C2fgnw7hbWxG65uAu2S+nIAkmfr8zYHGTtUKo4UY89Zy5y1f41fSP8AGmtxpnjp4WTWDoXjSjtfvNrvO3yikt7t/wC0X0ZfA+jwRkSxOMinjK6Uqku3aCf8sb/NtvrZLuxWz4ag2aJNMf8AlrOIx/wFST/6EKw2bIP04rrI7T7B4P0VCMNcpLdH6M5QfpHX8xOblTqz/lj+cox/U/pbHS5YRj/M7fg3+hH+Apc5pnT+I07Irwfas4BwegNTcZozitqeIaYrGpofiu98P3KyW08kbKcjBrO8VfC/wf8AFBWeS3HhzVn/AOXuxjHkyHjmSDhW78psYk5JPSkDYpQ/P61+gcF+JGfcMYtYzJMTKjLS9n7srdJRd4yXlJNHwvG3hzw7xZg3gc/wsK0Ol170W+sZK0ovzi0/M8i+I3wB1/4cQtdT26X2lr01CzJltwOPv8bozyB84AJ6E9a4o22D/SvqTQ/Fd7oEwe3mZR3GetZfiX4V+EfiQGkWH/hGdUb/AJbWcYNtIePvwZCj6oU5JJzX9+eGf0zMuxqhg+LqXsZ7e1ppuD85Q1lHzceZN9Io/wA6fFj6C+ZYPnx/BNb28N/Y1GlNeUJ6Rl5KXLZLWUmfN3k5P+eacsdd18QfgRr3w7ha5urZLzS16X9mxmt+33jgNH1A+cLk9M1xzW+w1/aGT59gM1wscbltaNWlLaUJKUX81fVdVuup/A/EHDeZ5LjJYDNaE6NWO8ZxcX62e6fRrR7pkCrivoD/AIJ42jt8TPE11j93B4dmQn0LTQkf+gGvBdu3tX0n/wAE7rA+V8QL7/nhp9vDn08xpT/7JXi8dVFDIcRLyS++SX6n6F4B4R1+P8tpr+eUv/Aac5fodusG67k9Sxq9Db80lpBukb3Y9qvwW1fy0z/WDlIVtsDn+Vfnr/wXb/aFHgbwNZ+FLWfbcXFuJ51BH/LRmCj1BATOOAQ6nnjH6MLbV+B//Bc344v42/bg8SaOtwZIdJkhs0XJxGIlKEYPT5g2e2cnnrXk55f6hUt2X5o+88MOX/WnBqfeT+6Ev11PmnQbje2T8xbkn1rqtNm4FcT4duv3a/1rrNMnyB/nNfg2Op6s/wBJcorJwR02nz42498Vs2kvA/KubsJ+nPatmxuOnUV87iKZ9ZRnob1tJxV62lzWLbT8LzWhby8V5dSB305G1ZTYYV0mg3OyVefauRt5s/8A162NMv8AYy8kVNN8skxVlzRse9/C/wAQLazwtu6Gvvj9i79qK1+HgEdzte3mTbIucHHtX5heE/FX2Jl+bH9K9S8JfFWXT4l2TEenNfpXD2efV7ST1R+LcfcE086w8sNWWjP1C/aT/a70XxH4Fl0/T87ZuXZiM/55r84/jTrsepX8zqwO4mqmrfGae8tyrTNtxjk1554t8Z/aS2WLE+9d3EHECxMbyZ4nhz4cUshXs6F9XfU5TxTKGuWrmrhgT71oarf+exO6sm4myePWvx7GS5pto/ovB0+WCTI5GqrcvtOfSpJZciq871xRjqel0P0u/wCCavjWb4n/ALOVvZ5Mt14bunsiOrCJsSRkn6tIoHYRjtwPsv4GaNdaZcXSzKyxyAHB7Gvz0/4IJeNFX44eK/DNwy+Rq2jG6jQsfnmgmjK4HQkRyzHJ6AHHU5/V600qK3+7Ht/Cv6r4Dx7xeSUZS3iuV/8Abui/Cx/lj4+ZDHKuNsZCmrRqNVV/2+ry/wDJ+Yrraf7NSx2tWxBUiQ7a+yifjLR8V/8ABSLS2tvjHod1txHcaGkQOOrJPNn9HWvndlzX1d/wU+0xYtR8D3Sj95NDewscdAjQEf8AobflXyqVzX9S8B1faZFh5eTX3Sa/Q/yh+kBg/q3H+ZU+8oy/8Dpwl+pXZaa6CpmTIpvlZP8A9avsFI/HYplcoQajMWV+tXPIwvPA9a9D8BfsueKvG0Ed1JapoemON32zUyYVZcZyiYLvkHghdp/vCvLzniHLcowzxeZ14Uaa+1OSivRXer7JXb6I+k4c4WzbPcWsFk+HnXqv7MIuT9XZaLzdkurPMBb5rovh/wDBrxH8UJ2XQ9JuryJDtkuMCO2hPXDSthAcc4zk9ga9y0j4XfD34UbZLrzPF2qR87rtdlopz2gBIb0xIzg+gp3ir456lrNutrblbOzhXZFDCBHHGvYKo4A9hX8m8ffTFyTLlLD8N0niKn887xprzUdJy+fJ6n90eF/0DeIs05MVxXWWFpvV04WlUt2ctYRfp7QyPDn7K3hjwNGtx4x1v+1Llfm/s/TGMcIPo8xG9gemECYI+8a6OX4xWfhLSX0zwrpdjodi2A62sYRpscAu33nbH8TEn3rz+71Ga9ctNIzMx7moS9fxBx9458VcVSazPFS9n0px92C7e6tG13leXmf6JeG/0duCuC4ReVYSPtUtakvem+/vSu0n2Vo9kaWr+J73W5me4uJHLe9Z5b9aj30bjX49Ux0pO7Z+406MYLlgrIkibD16d4SvWbRrKZWIbylGfcfL/SvLYjtevRPAUvm+Fbf/AKZySRfqG/8AZqXtm4uS6Wf4pfqeRnlO9FPz/Q4P9rb4NWer6HceNNJiW3vYWX+2IF4W43MFW4Udn3EB8cMDu4Ict803MODj8q+8o7eDUra4s7pfMs7+F7a4TOPMjdSrD8QTXxX8RfBNx8P/ABjqWi3WTNps5i3lceanBSQD0dCrD2YV/q39DbxZxHEWRVeHszqc+IwduRt3lKi9Eu79nJct+kZQXQ/yH+mB4U4fh/OqXEWV0uShi7qaStGNZat9l7SPvWW8ozfU5ORcCq8gwMCrtwmGzVSVK/tiDP44jI0vBPj3UPh9qzXVi0bLKuyaCUExTr6MMjp2III9eoPuPhLV7Dx9pcWqaUWCo6pdWzNmSzc87W9VODtYcMAehDKPnV0x/I1c8J+L9Q8C67DqWmzGG4iOGHOyZcglHH8SnA49h3ANfhPjb4C5Xx7g/rFO1HHU17lS2kkvsVLauPZ6uD1V1eL/AKh+jz9JLN/DnG/Va/NXy6o/fpX1i3/y8pX0Uu8dIzWjs7SWPBH+VXbdOarxjI/WrkKcV+/1JaH8x1GT2yZavoL9gHweupfFu61+dM23hXTpbtWYZX7RIPKiU++GkcHsY/XFeBWkef8AgWBX2B+zFo6eAv2WZ9U2qLrxZfySFwOTBATCin1xIJj/AMDPvX4B9I7i55BwFja8HadZexj61NJfdDna80fuP0beD/8AWPxAwOGkrwpP20vSnZx/8ncF6DvFeqtrGv3EzNu3OSDWa3PHr3oZt3JPfNMJzX+IeOrOUm2f7pUaahBQWyVhJXyrdfpmvRviFZ/2Tqljp4H/ACD9NtYGGOjeWHb9XNcV4Q0c+IvF+k6eoyby7ihIHozAH9M12vxV1BdS+JOuSL9z7ZIi/wC6p2j+VROPJk9Ws95VIRXoozlL8eQ8jMKl8XTpdoyf4xS/9uMIcClBUCm7wW60vSvk+YVhTjt8v1pwyo9ajpVJH+FNTYuUeOaCeaaWBPIpy8962jVJt3FBxShufSmhwfaiuqniWhOJqaJ4tvvD8+63mkUdxnqKzfEnwt8J/EZWkji/4RnVG5820jDWsh/2ocgD6oV65Iam5pQ201+h8E+J3EHC2K+t5JipUnpdJ3jK3SUXeMl6p26HwPHXhjw1xhg/qXEOEhWjrZtWlFvrGStKL84tM8q+IPwV134co1xeWy3GnZAW/tW821bPAy3BQnoA4Untmvdv2AdONr8NviJeZ+Wd7OAfVBK3/tSqOi+LrzQnPlSN5bAqyHlXB4II966LwZ8TdN8DaNqVjp+iWtjb6xMs92tqPLG8DblU+6owB8qgDjPBzX9m5V9L7BZ3k08q4ko+xry5f3kLum7ST96OsoPTpzp/3UfyBkn0N58KcaYbiLIMT7XDU/aXp1NKkXKnKKtJJRmve6qLS6yZ01lDxn1q/FBjsRVPw1qtj4hi/wBDuEkdRloj8sifVev4jI9610typr63A5lhsZRWIwtRThLZxaafzR+0YrA1aE3TrRcWuj0Y23h3Sxj1YV/LD/wUg8dSah/wUR8Xia483zry5UNu3eYwlJznvkbjmv6p7ZGS5jPow/nX8jH/AAVMibwX+3H4jeJWVLPUpRGpPOxZCMZ78cV0Yqj7ahOn3RvkWZPLs1w+N6Qld+l1f8LnV+Gb7fGvNdjpV3gCvK/AuvJe2cUiMGV1DA+oNd9o99levFfiGZYVxm0z/SPhvM41qEZxejR2djccAfjWvY3OMdq5ewu//wBda9nc5I9a+Xr0j9Cwte6OntLrgdfbFaFtcbfwrnbO73D0+talrd15FalY9WnM3ba44/Wr9tdYwawYLnFXILrB61xShY6VI6ew1byz1281t2PiZoh979a4mG74q3DfFe9OFaUNmZyoxnudu3i2Rl++f5VQu9Zabq1c8uocdaDen1pVMROWjZdHDRi9DSnvssapy3PNVjcbmppnzXBKNz0YaE7TZNV5pMCmNL71BNPxSjAqUz6u/wCCK3iCbTP+CgfhW3jkKR6hBfwTAAHev2G4cD/vpEORzx9Qf29RM81+GH/BF63kvv8Agov4IaNGZYEv5JCOiL9guRn8yB+NfupGOK/orwtusonf/n5L/wBJh+tz/PD6Vij/AK3UHHd4eF//AAZW/Qb5fHSnRpz0qQdKFXFfpPMfzLys+bf+Cm+jed8MfC+obV/0XVXts9/3kLtj/wAhfyr4zaKvvT9v7w43i74J2NjbtC2pLq8FxbQNKsbTfLJG2NxHAWQk+lfPvhz9mzQfC1tHd+LdcW5k+9/Z+m/KvqA8zDPsQqj2av1LJ/FXhrhjII/21i4wlFytBe9Ud3dWgruzvu7R8z+HPGLwN4u4v4+nPh/AyqQqQpt1H7tNNLld5uybXKrxjzStZ21PFdJ0O61zUYrOytbm+u5jiOCCJpJJD7KoJP4CvVvCv7JGoC3W78Vala+G7UjcLcYuLxxwcbVO1MjIyzFgeqV2Unxe0/wXpz2HhTS7PRrVhtYwJ+8lHbfIcu592JNcTrXiy+12VnuJ3bd6mv5w4++mXi6vNhuFqCpR/wCflS0p+qjrCPz5z9+8Lv2fuBocuL40xLrS0bpU7wh6OWk5eq9n5o7TS9X8F/B8/wDFN6QlxqEZBXUb7FxdKR0KkgLGfeNVz3rnfFPxU1bxTMzXFzJtY5xmuZaTP/16azc1/GvFHH2cZ7iXis1xM6s31lJu3kr7LyVkf39wf4c8O8M4SODyTCQowXSMUte7stX3bu31ZJLO0rbmYse+TUZemk0Z/wAK+KqYxs+4jGwu7ikzxTS1G7muSVcqw480Hr1puaAeaz9oA7O1q7/4YN53hbUB/wA+11G3PYOjD+aCvPmOK9A+CH+mReIrXqTp63K49YpUJ/8AHWavVy2PtqkqXeM/vUXJfikeTnmmEcuzX5q/4XOkhOK8Z/ba8HRy2uh+JYY9skpOmXjY4YgGSE9PvbRKCT2VfSvYoG4+lcn+0vow1z4D6u2N0mmywXkYCg8iQIx9sI7nI7D3Nfuf0YeKquS+IuW1IStGtNUZLpJVfcSfpNxkvOKP5d+khwxTzrw+zKlKN5UYOtHunS99283FSj5ptdT4+ukwff8AnVKUZzWldr1rPlXn9a/3Cpy0P8V76lOc5zVWXJq3KMAmqkvWuynsdEGTQLl6tRr/AIVBAMAetWoV6fnWdSRnJl6yXBXt65r7Tv8AT/8AhEvgX4G0hVaNo9Ht7iVCu0rJMvnOCPUNI1fHPhrRZNf1i00+HaJr6ZLaMt0DOwQZ9smvtb4/3UP/AAmLW1uojt7UCKJAT8iqMAfgK/gv6c2d+yyTL8sT/iVJza/wRUV/6cdvmf3t9AnI/b8QZhmkl/Cpwgn/AI5OT/8ASFf5HBMcH9BVnRdEvPEmpw2VjA9xdTHCouOg6kk8ADqSeBVN5gpUFlXcQo3HAJqr4t+J66do0uh6C7RW9wAuoX6/LLqB/uKeqwj06t1PYV/l/GnSk3VxDtCPRfFJ9o9PVvSK1s3aL/1W9jXqNQoLV9XsvN/olq32V2ut/wCFlaD8C9es59Njt/FHiKxlDyTM7LY2hHVUxgyN1G88eg71u2fxb+HXxTuHe9+3eB9XuGLu5zdWEjnkkkfMuT7YFfPBbFNL5NL/AFsqQg8K6FOVC9/ZyjdJ2tdTTVRSaWslNN6LZJLoq8H4aqlUlOaq2tzqWve3LrC3Zcunrdn0vq/wl1bT9O/tCx+z67pfVb3TJRcRY99vK/iK5kSc4/CvI/CPjvWPAWpC60XVL7S7gHlreUpu+o6EexzXpul/tTw+ItsfjLw9aaox4Oo6fizvR7sB8kh+oFcFSnkuM1oTlh5/yzvOn8pxXOvJOEvOZ4+IyPMsNqkq0f7vuy/8Bb5X6qS8omiGxRWppWnaB47Knwv4itbyZ+mnajizvQfRdx2SH/daqGsaRe+HL5re/tbizuF/5ZzIVP4Z6j3FebjcnxeFh7WpG8HopxalB+SlFuN/K911SPOjWg5+zd1L+Vpxl9zs7edrDMY/pTaar804P/k15nMzUcH4pdwpgo61cZi5SQdfWkDgnrSBsUbuK0VQXKO5ozn/APVTTzQSe4raNZisOjmaCVXjZo3Q5VlO1lPqD2Ndl4Y+NF5pgWLUo/7Qh6eYCFnUfXo348+9cVmkFfU8N8XZpktf22W1nB9VvF/4ou6fzWnQ4sdleGxkPZ4mCkvxXo90e+6PrFv4g0yK+s2ZoZM7SylWBBwQR7EY9K/lo/4OE/h2/gP/AIKF+Nl8uNI7jVbidNibUCSOZFwMDGFYDAGPTIwa/qC+E67fhxp3qxmP/kZ/8K/CX/g7H+AU2jfHjSPG0MJa18QWETNKOf3sKiF0+oVIz6fOO+a/0P4XzCrjsow2Nrpc9SnCbtoryim7LXS77n8755hoYfG1KNP4YylFX30f/APy/wDgN42/dNp8z/vLfmPJ6p/9b+RFe6aDq29F+b/61fH+javNoWpQ3UDbZIjn2I7g/Wvob4ceN4td0uGaNvvDlT1U9wfpXgcTZT73t4bP8/8Agn9MeC3HSqYdZXiJe/TWnnHp923pY9k0y/8AlHP/ANatuyvPlHP1rhNI1XzFX5u3510Wn3+cc1+aYrDWP6uy/HKaVjrLW76Vp2t7n6/yrmLS+AVee351pW13/npXi1qJ9NRxCZ01te5HtV2C5wK5y2vvu/lV+3vcGvNqUT0IVDfiu8VYju6xYbzgc1YiuuK45UjojM2EuuKkW65rJW7wM57VIt1j1rGVM2jURp/ac96T7TzWeLrAFBuuO/pUezZp7QuyXHvmq1zc8Gq8l1z/AI1Tvb/ap5rWnRbZM6x94f8ABvv4Km8Uftp6prC5Fv4c8P3UzNjILyNHAqdeMiR2zg/cx3FftMi/LX5p/wDBt58JZNM+EHxA8dXFvt/t3UoNJtJmAyUt0aSXaeu0tPHnnBKDutfpcg4r+kOBcH9XyanfeV5fe9PwSP8ANP6QmcRzDjbERg7xoxhTT9I80vulKS+RxvxC+Pvhb4aGSPUNSWa8jH/HnaDzp8+hAOE/4GVrwn4h/tq694gDwaDBDoVsePNOJ7pv+BEbV/BSR/erh/j7C1p8aPFCHvqMr/8AfR3D+dcW7c1/OfHPiznlTF1sDh5exhCUo+5pJ2bWst1t9nlPX4b4EyulQp4qrH2kpJP3tUrpPSO333L2peI7zVtTkvbu8uLq8k+/PPIZJG9Msef1qpdajLeMTJIzfU1Az4FRlq/DsRmFSpJynJtvV3P0WFGEbKKWg5pPp1pucmms3NITmvMqYhs25R2abmkprNXJKsXGI7NI3/68UhbdTc49KwlUKsO34oLGmM+P89KQSVHMPQkD8UBsn0qNHLuqgbmY4AHJJrp7H4U6o9mt1qTWfh+xbkXGqTC33D1VD87fgprsweDxGKbWHg5W3stF5t7JebsjGviKVHWrJK+3d+i3b8kc4x7V3n7N1wsnxOt7V/8AV39pc2r8dN0TYz+IFYU3iHwH4Q/i1Txhdr2jH2GyB+pzIw+m2ql7+0n4gFs1toi6f4XsW/5ZaXAI2b/ekOXb8TX0uUU8Ll+Kp4rGVk3CSfJD327PZyuoJNaNqcmux5+Mw+Kx+Hnh6FJpSTXNP3UrrdKzldecUvM9Mh3KdrAhl+VgR0p2taO3ivwlrOlKu6TVLCe1QYB+d42VSM9wxBHuKq+Gfira/GWwWWdYrXxVbJm6jUBY9URRzNGO0gH3lHUfMO4GppN15F5G3owNaZfWqZLmlDHYSXOqco1Kctr8slJXWtmmrSXR7Nqzf59nWVvFYSvl+Njy88ZQkvKSadn1TT0f5O6XwfcHfHu/vLmqEwxXW/FPw8nhT4h6/psS7YbHUJ4YVwP9WHbZ0/2dvHvXK3A4xX/QrlmMpYvDU8VRd4VIqS9JJNfgz/n6zDB1MHi6mDrfHTlKL9Ytp/ijPuV4qrMOP1q5P8zVVmGP5V7NMzgyxEtWoB8/41Xi61ct1wRWEyZHqP7Ivh//AISH9orwhCeBb34vs5xj7MjXH/tL8a90+Kuuo/ia9uJG+VWP8685/YI0tR8TNc1aRWEWjaHcSrJtyFkkeOMD2yjSnj+6an8c+Im17W7iTJEQc7B6+9f5ZfTezj6xxVhsvi9KNFX/AMU5Sb/8l5T/AFm+gFw048L4vMZL+LWev92MYxS/8C5jN1jV5NWuCz/KvRF7KKz5DT5Tn86ilPFfwVimf6MUqaiuWOw124prHmhu1NY14NY6IoA2BTqYx/z6UpNcUgHhq7Xwp8f/ABN4Vs1s2vF1bTE6WOpp9qgA9F3fMn/ACK4YvSh8f4V0YXMMRhZ8+Gm4t6Oztddn3Xk9DlxWX0MTDkrwUl5q/wA12fmtT2XS/iz4U8UYW6hu/C923UjdeWJP/o1B+D4rbk0Sb7F9rtnt9Qsf+fqykE8Q/wB4ryv0YA14DvyauaNr994evludPu7myuFHEkEhjb6ZH9a7JZjRr/7xTSf80LR++PwP0ioX6s+dxHDKWuGm15S95ff8S9W5eh7OkuRTg4ridJ+Oc0/y6zp9vfetzb4t7j6nA2N+Kgn1rp9I8S6T4hI+w6hGZG4FvcgQTD2GTtb/AICxPsKydCMtaMuby2f3Pd/4XI8PEZfiKGtWGndar7+nzSNDvRmmuklvKUkVo2XqrDB/WlDZrDVOzOMcRSZ96GPFMLYFVEB7tgelV59Rjth8zAVkeKPE6aXbsFb564bUvFM9/L98124eN5HrYHKaldcz0R9XeEvE0WmfDPSdjbmkhZhj3dj/AFr4j/4Lefs0S/tW/sX63JBALjVvCW/VYRt3ObfaROF9MKEkPPSI9TivqTwTMx8AaHubP+gxN+ag/wBasalYwapYzW11FHcW1zG0U0MgysqMCrKR6EEg/Wv9MeFaXssnwlP+WlTX3QSP5Z4iV8wxCX88v/Smfxu69pMug6zc2cysslvIUII5GDWn4C8bS+D9TDZLWshHmp6f7Q/zz+VfV/8AwWn/AGGbz9j39qjVobeGRtB1Q/b9NnxxLbSE7CT6qQyN/tRtjIwT8Y171ajGpF05q6Z5+XZhXwdeGLw0uWcXdP8AR/k0fUHg/wAWxajaRyxSK6SAMpHQ122l6vuA+bmvk3wD8QZ/B10EbdJZsfmXPKe4/wAK928H+N4dWtI5oZlkjccEGvzXO8ilRlzLWPRn9m+HPiXh81oqnN8tWPxR/Vd1+XU9ZsdS7571rWl/XCaXre8D5v1rcsNV/wBqvicRhGj97wOZxklqdhb3uP51cgvRjhuOlcxaajkelX7bUM968mphz6KjjEzpYdRwev8AjVqG/wCnNc5De5HrVmK+wM7q4Z4c9GniEdHFfcj8DUi3w9/xrn0v8DqfzqQagfX8K55YY3VZG/8AbsDr+VNa+APX8KxP7S6/WmPqXv8AWksMV7ZGvNqOM/5zVBpZtWvYbW3jlmmncRxxopd5GJACqBySScAdTmsy61Xap5r7o/4ICfsaTftFftTL8QtYs2k8I/DJ0vUZx+7utVPNrF/2z5nJHQxRA8PXs5Nks8ZioYeHV79l1fyR8nxlxdhcgymvmuJelOLaV7c0toxXnJ2S9b7H6/fsG/s6f8Mp/sleB/A8kax6hpWniXVMENuvpiZrjkEhtsjsoOSNqLjjFewDrTUXingZNf0fSowpU1SpqyikkvJKyP8AK7H5hXx2Lq43Eu9SpJzk+8pNtv5tnxf+1Za/ZPj14gG3asjQSDjrut4if1zXm7nmvXf20LT7N8a5n/5+rG3l+vDJ/wCyV5DKea/gLxEo+y4hxsf+ns398m/1P6i4Xqe0ynDS/wCncV90UiNvvU0tiikc81+d1JH0MQLbj+tIx2mgnioyd1cspM0Q4/N1pM8UjNg/Wn29hNdoWSM7F6u3yov1Y4H61kuaTtFXG5JK7GEntzSOQvU0lxqel6aP9IvGuZP+eVou7PsXbgfgDVOf4lSWvy6ZY2tjj/ls486f67m4U/7oFPkhH+LNLyWr/DT72i4Uas/4cX6vRfjr9yZu2XhW/vrf7QYVtbU/8vFy4gh/Bmxn/gOTTJtU8L+H/wDj5vrvXJh/yxsF8mH8ZXGT/wABT8a4fVdautbuWmvLq4upT1eVy5qqX4oWOo0/4NO77y1+ajpH5S5kdUcqnL+NPTtHT8dX81yncXHx01HT1aPQbPT/AA7Gwx5lrHvumHvM+X/LA9q5HU9XudYvGnvLm4up5DlpJpDIxP1PNU+hoLfNis8RmWJxCUa024rZbRXpFWS+SR34XL8PQfNSgk3u+r9W9X82TbuKcr4/rVcSY4zUGra7Z6Bp8l3f3VtY2cIzJPcSrFGg92YgD860w/NKSjFXb6HTO0VzS2Rs2OoS2NzHNDJJDNCwdHQ7WRh0IPqK9a+HfxXXxJPHb3xSK/bow+VZz7Dsx9Onp6V8XfEH9vjwD4I3xWd3deIrtCV2afHmIHtmV9qEe6b/AKV4h46/4KU+MNWm/wCKft9P8MxoQ0ciD7VdKQc53uNn5R5HrX7Dw54W8S5pBWoOnB681T3V62fvfNRs18j834o4o4fhBwq1VKa25Pea+fw+qbPt39rPw3NF8arqWGCST+17SC8RY03Z+TymOB6tEx57k15JqlnNYXDRzxyQyL1R12kV8a6r+15421vVpL7U/EWrareyLtEt3dPMyLknau4naoJPAwOTxzWh4J/bN8ReHrrbeTfbrUnLRTfOvPpnofcYNf6p+HPihVyjJMBk+ZUef6vSp0pTjLWThFR5kmluls3vrfof5T+JH0Z45rmuOzrK8by1K9WdWMJwtFc7cnFyUm929VFq2nL1Pqmfkmq0owc1yfw//aH8M/EiJVW5XTL1gMxTN+7Y+zdR9G4/2q6+5gMWGblWG5WByrj1B6Ee4r+kMi4ky7NafPgaql3W0l6p6/Pbsz+ReKOBc84crexzfDygukt4S9Jq8X6XuuqRNCMVctxzVWLg/lVu1+9XrVD5GR9H/soW58P/AAN8c6swVTqd1badE2DuAjR5JAPr5sefoK5y4fdIx/vHNdN8LbmOz/ZUto4es2q3Us/zf8tMRrn2+RUH4Vy8o/lX+MH0oMznjfEHMZz+zJQXpCEYfjy3+Z/vB9D7JaeXeF+WqH/LyLqP1nKUvwvb5ELDH51G55qR/wCtRMc1/LmKR/UkRjU1+KcwprfMK8OtE0iNfhvpQ5xQDuFBbn1NcMkUJijbSfdp2azaKAHFO34NNpOhqQJVelzgVEDmpAa0M+U3tC+ImqaFGscdy09uvSCceZGPpnlf+AkV1mj/ABYsL0Kt3DJYyHgsv7yL/wCKH/j31rzXdijf81dEasmrPX1PMxOT4atq42fdaf8AAfzR7bZ3sN9b+bbyxTx5+/GwZR9cdPxqvrWofYLFpD2Ga8istQn02fzbeaSGT+9G201q3vju+1Ky8m42SDH+sC7W/HHH6VtCKex4suH5wqJxd4/cytrurvqV4zbjtzxVHOOfSmscnP8AkUE4RvpXpYWLvc+np01GKitj6S8Kw/ZfCGkx8/urGBT+EairT8mmafF5Gl2kfQxwIvHsoFPc81/p5ltH2eFp0+0Yr7kj+F8yqe0xVSfeTf4nzX/wU+/YG039vr9nO80NYoI/FmjpJc6DcyNtBlIG63YkgBZdqjceFYKcgbgf5i/jJ8JdY+CnxB1Tw/rVncWN9ptxJbyxTIVeJ0YqykHkEEEEHoRiv7BGHFfn5/wWj/4JBW37a/habxx4Js4Y/iJpsH+lWqKFOvRqMAqen2hFGBn/AFigLncqhvSWqseXJcrutuv+f+f39z+dQc1reFvGF54TuxJbtujY5eNvut/9f3qb4gfD7Vvhp4nvNI1iyuLG+sZWhlimjMbxupKspBwQQQQQRkEVh1nUpxnFwmro6sHjK2GqxxGGk4yWqaPevAXxYtdfRVWTZMo+aJjhh/j9a9B0rxIsgXDfrXyRBcSWsyyRu0cinIZTgqfY123hL413mlMsd8vnRrx5iDDD6jof0r47M+GVL3sP9x/RHBfjUoKOHzf3X/Otn6ro/wAPQ+nrLWgR96tS11XpzXj/AIX+J1nrMQaC4jkOOmfmH1HUfjXWWHilXC/N+tfDYrKZ03aSP6Uyfi7C4qmqlGopJ9U7nokGq7u/H1q1DqeT1rh7XxEpAO6r0Gvcfez7V5FTAs+uoZxB9Tso9SwBzUi6kAOtcimvAr9786cNfHrXNLAs745tC251jarwearzayFH3q5WfxMqJ9/6c1pfCrwX4m/aC+J+i+CvBej3viHxN4guPsthYWq7pJnwWPsqKqszOxCoqMxIAJrfD5TUqzUIRu32ODMeKMLg6Mq+IqKMYptttJJLdtvZHoP7OXwK8V/tdfGzQ/APguxbUNa1ycRqSD5NpEMeZPKwHyRRrlmb0GACSFP9L/7GX7Jnhv8AYp/Z80P4f+GU8y30tDLe3zx7ZtVvHwZrmT3YgADJ2oqIOFFeLf8ABJf/AIJXaD/wTl+E7TXzWmufE3xFAg1/WUXckK5DCytSQCsCtgluDKyhiAAip9fou2v1/hvh+GXUuaetSW77Lsv17v0ufwp4t+KVTinFLC4RtYWm7xT0c5bc7XRWuop6pNt2bshRTicUBeKDX0kj8ejufLP7dFmY/idpdx/DNpKJ+KzTZ/8AQhXhkg5r6I/b0s9ur+GLjvNBcxf98NGf/Z6+eJuTX8J+LmH9nxPi4+af3wi/1P6g4Fqc+R4eXk190mv0IM8/jTHOKjvNSt7M/NIob+6OT+VZd54o6iGMf7zn+gr8jqxPt6VCc/hRrFS54XPf6VWu9UtbP/WTqSv8MY3n/D9a5691S4vVxJKxX+70X8hVVmx/9avPqStsd9PAX+N/d/X6G1c+M/Lz9lt419JJv3jfl939DWXqes3WqNm4nkmx0DNwPoOgqsKQ81y1K02rN6HoU8LSpu8Vr36i7sfhTGb/AD60FsVV1DUbfSbOS6up4bW3jGXllkEaIPdiQB+NYxjKUlGKu2baJXZYL5pC/vXjXxF/bp8A+BRJHbahN4hulBxFpieZHntmViI8e6luO3TPg/xI/wCCj3irxB5kOgWVh4dtyeJSPtl1jp95wEHr9w49fX9M4f8AB/inNrShh3Sg/tVPcX3P32vNRaPkc248yTL7qpWU5LpD3n9/wr5tH2pqmrWuiae91e3NvZ2sPLzTyLHHGOnLMcD868f+Iv7efgDwV5kVneXHiK8XK7NOj3RA9syvtQg+qFvp6/CnjL4ka148v/tOtatqGqzrwrXU7S7PZQThRyeBgcmsKa+J71+68O/RvwFG1TN8RKq/5YLkj6Nu8mvNcp+YZv4xYid45fSUF3l7z+7RL58x9IfET/go74u8Q74tBtdP8OQN92QKLy5H/A3Gzn/rnketeG+MfiVrHju/F1rWqahq1wudj3U7SlAey7jhR7DArmnuc1G0/FfuuQcF5Lk0bZbhoU33SvJ+sneT+bZ+XZtxTmWYv/bK0pLtey/8BVkvuL8moM3eoXvTnrVMzU3zc19XTppHzs67ZYNxxTHucfy4qAvk03dlq7aehxVJXNKy1OWymVopGRgcgg19cfsj+O9W8Y/DWa21O8ubuHS5glmsshZYI33kqoPQFgzcdzXyDpFlJq+qW9rHzJdSpEvHdjj+tfWH7H8awaPr0Mf3I5LfA9sS1+meFtR/6yYZf4//AE3I/EvHyF+Bcc+3sv8A09TPa4T8tXLY/MPyqlENhq5Ccr+Nf1lUP83Zbn0F8CZ0v/2dtXtQuZbTWWmZs/wyQRKOPrG35+1Y8oxWP+zl47/sXXZ9BupNum+I9sJ3dIrhc+U/TuWKHoPnBJ+Wul1zS5NJ1GW3kUhkYjpX+RX0t+EcVlvG1bHzjalilGcH0doqM16qSba7OL6n+3P0IONcFnPhzQy2lP8AfYOUqdSPVXk5QfmnFqz6tSXRmY3U1G4zU0iVG1fx5iqR/ZcWRNTOhqRhtppWvDrUjVEZXn5aOCcU/FNIzXnzplp9xORRx/kUY9fzoBzWDgUJjFGCaXFAGBU8rEAHIpWOKQmgCiwvUctC01uRj8acvC1vCNwHLyadt5pFGB/s9a9F+HXwLm1qGO91jzbW1cBo4F+WaYep/uL+p9uCftOE+EMxz7FLCZdT5nu3tGK7yeyX4vZJvQ8TPM9wWVYf6zjZ8senVt9kur/Ld2Rw2kaLd63d/Z7K2nu5sZ2RIWKj1OOg9zxXfeF/2fb24kjm1aaG1hBBa3Q+ZI4/ukggLn2JNeo6Po9n4bsFtbG3itbdedsY6n1J6k+5yanJz3r+ruFfAXKsGo1c2m60+sVeML9v5pet4p9Yn4JxB4wY6u3TyyCpR/mes/8A5FelpeohPt06Cmk5NDcU3OTX9ARjY/GJSu7sCN1NK/lTjzQRVGR8Y/8ABT//AII6eC/+CgWg3Otactj4X+JEcf7vVPLK2+qELhUuwoJzwAJlBYDghwFC/gH+1z+wf8SP2LvHsug+N/Dd/pM3L28rKHgu4wceZFIuUkX3UkA8HBBFf1kEcZrmPi78GvCnx78DXPhnxp4f0vxLoV0dz2d9D5iq2CA6H70bgEgOhDDJwRmq5k/iM+Vx1h93+Xb+ttz+Pk8H3pK/cX9sn/g178P+Mp7zVvg54q/sO4kJddE17c8A7kR3Ualh6BZIznvIOtfm1+0d/wAEeP2gv2ZLqY658OfEF1p8bFRqGlwf2lZuMgA+dBvVd2VwHKsc4wCCAcr6B7aK+LT1/wA9vuZ8xRTNbyrJGzRuvIZTgg10ei/FfV9GCqZluEHaUc/mP65rHvfDl9p8rLNazxspwflziqrW0iH5o5F+q1hWoU6qtUimepl+bYzAz58JVlB+Ta+9bP5np2kftDBFH2m1mjb1Rg/88Gugsvj/AKW6/NcNGccho24/SvEBA7dEY/hV3RvCupeIdRhs7Cxu7y7uG2RQQxF5JG9FUck+wryqnD+DqPRNej/zuffYHxc4hw0bSqRnb+Zf5NHuCfHrSUGfty+v3T/hVS+/aJ0uCPEcsszf3Ujb+uBXpv7NH/BCT9pn9pu5s5LL4eXvhXSbsqf7T8USDSbdEY4D7JP37r3/AHUTnGOORn9hv+CdH/Box8J/hNe6f4n+NniK8+KmqW+2VNCtI203Q0cc/vSG8+5AOMDdEhwQ6ODgZx4Vwid53+dvytc7Kvjnn84ctFQv3Sb/AB5rfm/I/KP/AIJ+/sMfHL/gqd4+bS/hb4X+yeH7ORU1XxXrJaDSdJBPO9wD5kuORDFvkOM7QuWH9JH/AAS6/wCCRXw4/wCCYHgCSLQWk8VePtWgEOueMdRgWO+v1yrGCFASLa13KpEKE7iil2kZQw+lvAngDQ/hl4S0/wAP+G9G0nw9oOlRCCy03TbSO1tLOP8AuxxRgIo9gBW4q162GwWGwyth4W8+r/y9F+J8FnXFOcZxJSzOu5paqK0ivkrJtd2vSwRpipFGDSKOaeB8tdB4QY+akIwaXtSNyKTVyos8w/al+Etx8VPA8Daf9jTUtKkeWJ7hnAKMBvUbc8nanJB6dq+J/Guga14auvJ1OGa33HCn/lm/0ZeD9M5FfpFMgkRlYZU9fevDPjh4Cj0zUJGaCOaxvgd0bqGQn0IPFflXHHhZgc/qSxkZOnXaSvvF2VlzLfayunoujsfo/CPiBiMngsNUgqlK+20ld3dntbrZrfqj4skHBqu5ya9V+JPwP+zRSX2hxyOi8yWWSzAdzGTyf905PoT0ryyRa/j/AIw4PzDIsV9Wx8LX2ktYyXeL/NaNdUj+leH+IcFm+H+s4KV11T0cX2a6fk+jZCfvUwcVLItRsK/P61M+giRH5SaRjgU6Tk+tea/H39pjw/8AAPTf9Ol+3axMm+20yFx5svoznkRp/tMMnB2hiDV5Xk+MzLFRwWApupUlsl+b6JLq3ZJat2M8bjsPhKLxOKmowju3/Wr7JavobHxo+MelfBHwNca1qjb9v7u2tlbEl5MR8sa/zJ/hAJ7c/nf8WvjLrnxe8S3Gpa1eSXDSPuitw7fZ7QdljQnCgA4z1PJJJJNTfGv45678bfEralrV0reWCtvbRZW3tEP8KLk9cDJOSSOTwAOCnn3H/wCvX9w+FfhbR4bw31jFWnip/FLdRX8sX/6U9LvySP5l4646qZvW9jh7xoR2X8z7v9F09WTS3rN3qs917/rUMkvHWoXuFA+8tfskaSR+azrNkzTknrUbSVCZx/eU05IJJvuxyN9FJraMDnlUY4y5qMyVL/Zd3jP2W6/79N/hUEqPD99TH/vDb/OtFExcx2+ml81Xm1G2g/1l1aJ/vTov8zUMniHT4+t/Y/hOh/ka0jEzci7vwKVW4rLfxXpqH/j+tyfY7v5U3/hNNLT/AJfIz9Ec/wBK1ijOUj1D4E+Hm1TWda1R1/0fw5pUt4xxx5kjJbRD6+ZOrf8AADX0L+yDzZ+I1/6aW5+n+trzf4NWOlRfsGa/4msL6K61DxH47tdBuYPKdJLW3tLGS6XlgAVkknU4HQwCvQ/2QXxJ4hX+8ID+W/8Axr9D8MJW4mwr/wAf/puR+P8AjtHm4Fx68qb+6tTZ7hA+RirUXB/SqcXX8atQNzX9eVEf5qTL9s2fp7V7no3jCP4uaCkzsP7fsogLxD1uQMDzx6543ejHsCK8HhbB/StfQNbudD1OG8s5mt7q3bdHIvUH3B4IOcEHggkHg1+OeMXhTgOO8leXYp8lWF5Uqn8krde8ZaKS8k1qkfsvgN43Zn4Z8RLNsIvaUKlo1qW3PBPddpxu3BvTVp6SZ6fNE0bkEc9KhdMHpWppOt2XxJ037Raqltqsa5urPPXA5kj9UPJxyV6HPDNRntzG+1gVYHoa/wAbeOuA814azOplWbUnCpB/JrpKL2lF9Gvzuj/ergLj7JOMMnpZ5kNdVaNRbreL6xkt4yjs4vVFVlqMr/8AWq00eaiZMGvzevhbH28ZEJHFJjNSMlNIwK8yphy1IjxSbKkIyaQrmuKdEq5HtYf56Um7mn4x/wDXoIzWEqTK5hu72oJzTttGMDpUezHdDVXFPUZpKcoya6aNPUlnTfCGzS/+JOkxyKsieY7lWGQSsbOP1UH8K+gJH3H1+teG/AiBZfiNasf+WUUzj2Pllf5Ma9wf71f299HvCqHDtWpbWVWX3KELfjc/mTxmruWcUqfRU197lP8ARIbSdaCcU2v3qKPx0Q0UUVRMmHWjoKMUUEgwpNlKaKAG7f50Rs0TblZlPqDTs0UAcj8R/gL4F+MgH/CYeCfB/itlIIbWdEtr9lIzggyoxGNzdD/EfU157qv/AATS/Z71uJkuPgn8McOMExaBbwN+BRVI/A17gOTTttX7Sa2b+8x+r0nvFfcjwfw5/wAEvv2dPC1w0tr8E/hvI7DB+16NHer+CzbwPwGa9c+H/wAL/DPwps1t/Cvhvw74Xtwix+Vo+mQWCbVGFXEKqMAEgDtk1vAVpeH9Ck1i9SNFY84PFLmltcv2cL3svuNb4ceF5Nb1iNmUsqnJJr3vSrBbK0SNeAorA8A+D49BsF+UbyOa6qMYFSWOUcVIBTUFSKOaAHLwKKBwKO1AAaG60DmgjigCM9aw/HnhePxT4fmtmX5gCUPoRW63Bpki0mjQ+X7+zk0y8khkUrJE20ivEfj14Sh0LxFFfW67Y9UDPIgHyrIpG4jt824H67jX1d8evCH2DUI9ThTEc52SYHRq+ef2irXf4Ps5sfNHehfoGjf/AOJFfl3i7lFLG8M15TV5U7Ti+zTV/vi2vx6H6J4Y5nUwufUoRfu1Lxku+ja+6SX5dTxeQVCwyP1qxIuahcc1/BeIpan9aRZn+IWuE0W8a1jeS6WBzCiOI2d9p2gMwIUk45IIHpX5qeLv2u/BuralPe/8Kd0+8urtvMkn1Txbqd3JIx7sVaMk/jX6bsNhz/dr8hv2pPA3/Cu/j54v0dVZI7PVZzCrg7hC7GSLr1/duvPfrX9DfR3xUI4jGYRpczUZJ2V7JtSV97XcdNrn4/4v4WToYfEXfKnJNXdrtJp22vZPU0NS/ar00HNr8J/hzBjp5kmrTY/76vcfpWFf/tT6hID9n8H/AA3sfTZoPnY/7/SSfrXnl0p3VSlXBr+sqaZ/PdWx215+0r4omGI4/C1rn/nh4Y06PH/kGsu8+PPiy5P/ACFlgPrbWNtbn/yHGtcqw5qJxXVGBxykbd38WPFF8NsviPXGX0+2yAD8jWbeeLtWvV2z6pqcw9JLqRs/mapMMU0jito0znlMSWRpz+8ZpP8AeOaj8tR/CtO70beK09mZuQ3pRml25FIF5quUnmBOlOzQF5pyLmtIxM5SPp79m7WN37F2rabu/wBX8QIbrH+9pjp/7JXu/wCyCn73xCfaAfq/+FfMP7NF/wD8We8RWeflGv2Fxj/t2vF/wr6u/ZL0drbw/rV8fu3VxHCo/wBxSx/9GCv0HwxoSnxLh3FbczfkuSX62Px/x3xVOlwNjed6y9ml5t1Yafdd+iZ65EeM1Zh6fjVWMfLViPrX9bzP82ZlyBs7atQtg/TpVOI5H41agfH/AOuuWpE45mlp97JaXEc0ckkMsLB45EbayMOQQRyCPUV6H4b+I1tr8aW2slYLrol4q4R/TzAOnpuAx0yBy1eaRHaatQPjivznxA8N8h4wwDwGd0VK3wzWk4N9YStp5p3i7LmTP0jwt8YuJ/D3NFmfDmIcL256crulUS6ThdX8pK043fLJXZ6rf6TJZMNw3IwDI6Hcrg8gg9weuaqMlcr4Z8bXvhxdkMiy27HLW8w3Rt0zx1UnA5Ugn1rrNN8R6X4hG3d/Zt1/zzmYeW5/2X4Hrw2OwGTX+bfih9FHiTh/nxeUr65hlreC/eRX96nq3bvBy7tR2P8AXPwb+m7wVxeqeAzuSy/GOy5akv3U3/cq6JX6RqKDu7R5tyApTSlaN9pc1lJtkjZW+nWqpi9K/kzFZZODcZKzR/adOtGcVKLuiqY/wpNlTmOmtHgfzxXkVMGzVSISKaV5qYpmm7K4p4UrmI8YpMc08pQa5nh2VzDcU4UYpQK0p0bMTZ3v7PMPmeOZ2/552MjA4/24x/WvYz1ryj9nKHOvanJ/dtVXP1cH/wBlr1Y81/dXgfR9nwrTl/NKb/G36H8qeLVXm4gnH+WMV+F/1E/zzTCOad0/z0pp4FfsS0Py9h1o6GlI5pKCAJzQKXGKB1oATFFOAwaNtADQMmnKtOpduaAEA4pQtTW9lJcPtVW3V1XhX4cXGqSq0ilVz3FAGFonh6bVp1VEJ9TivXvh58PU0aFZJFG/rzWl4Y8EW+jRL8i7h7V0cMexcUAPiTYoqZeMU2MYNPHWgB46VIvSo+9SL0oAOtHaiigAFHajNAoAa3WmN92pGHWmN0oKiYvjnw4vinw1dWbD5mTKH0YdK+R/jzp7DwBeKy7WtZ4mYHt8+z/2avtDbk/QV8+/thfDn7F4M1jULeP/AEaeISSYHCssit/MCvmeMsP7fIsZS6ulUt68rt+J9FwnX9jnOFn/ANPIfc5JP8D45lXn61AyfnVudOagda/zzxVHU/tSMtCBk5/xr85f+Cqfgf8AsL9oqLVI4yI/EGlQXDtx80sZaFh68IkXJ9cdq/R5o8mvHP2sv2QbH9qmy0VbjWLjRbrQzOIZY7YXCyCXy9wZSy9DGp4Pr619t4YZ9QyPPoYvFy5aUoyjJ2bsmrrRJt+8o7I+X42yWrmmVSw+HV6ialFaLVOz1ei0bPyau7XJqjLbc9K+5vEH/BH3Wkf/AIlvjTR7rI/5etPltv8A0F5K4bXv+CTnxQ01N0DeFdSJ7W2pOpH/AH9iSv66wHiVwzX+DGQX+K8f/Skj+d8ZwFntL4sNL5Wl/wCktnyU9vULw4r6E8Qf8E6fjBoas0ngi8mVWwGtbu1ud3uFjlLYPuBXC+JP2X/iD4YEjah4F8YWscX35X0W58of8D2bT9QcV9lgc8yvFf7tiac/8M4v8mfJ43Isyw/8bDzj6wkvzR5g8eaY0OP8K6LVPBmo6Q4W6sby1Zl3Ks0LRkjsQGAOKz30qQH7jflX00cLLqj5mVdbmWYuaaY+K0H09lNNNkQar6uzP2yKBj4pfLyauG0K037Jz/8AWpewYe1RVCf5xT1TBqf7MRTkt8GqjRZLqHqf7Nd7t0nXLX/npcWs4H+6lwP/AGavvn4N6B/wjfwv0mHaRJNF9qk9zIdw/wDHSo/Cvgr9lLRn13x22mx/fv2hjHtmTb/7NX6NmNII/LjXbHGoVB6KOAPyr9s8G8rvjMRjpL4YqK9ZO7+7lX3n8r/Sgz7ky3BZTB/xJyqP0guVX8m5t+sQh6VYi6VVi7VatxuP6V/QFQ/iuZYi+7+FWYjinWlurnlRWrZaVDLjMf5E1xVKyjuZ/VpS2KMbbF/pVqN8mta28MW1wf8Alov0b/GtC3+H0Nx/q7iaMnplQ2P5V59TGUluH9k4ifwpP5/5mDG/H61aicjit5fhbdOR5N5bt/10Vk/xpG+FutQ/6u3jnUd45V/kcGuWWOw7+2vnp+ZhUybHx19k36K/5XItF8VX2jxiOG4byRn9zJ88fJGeD0zjqMGuhsfF9jqZxdQtYyMeHiy8Wc9x94Af8CNcteeHdQ0kbrqxvLdR/E8LKv54xUMT7q/MuNfCHhHiyLnmmEjKo/8Al5D3an/gUfit0UuZeR+r+HH0hvELw/nGlkmOnGjH/lzVvOlbsoS+DzdNwk+53w037VEZLaSO6jChiY3DbAfUDkH2PNVZLdlOGDA+4rlba5aCRXRmR1OQynBB+oratPGl5Gm2YxXa8/65ctz33DBJ+pNfyJxh9C2vG9XhzGqa6Qqrlf8A4HFNN+sIrzP738P/ANpFltblocZ5ZKk9nUw75437unNxlFek6j8i48WaaY+f6VJF4g0+5B3x3Fq2QBgiRffJ4P5A1Zjt4br/AI97mGfJ2qoO1ifZTg/pX8wcUeBPGWRtvHZfU5V9qC9pG3dyhzJfNr7z+0eCfpIeGvFXLHJ84ouctoTl7Ko/JQq8kn8k152sUDHx2/CmlOP8avT6dLExEkbrjqMVCYcH0r8krZXOLtJH7dGqpK6ZXKZNKF5qZosGm+XiuX6m09jTmPS/2b4T/wATuTpgW6g/9/Sf6V6ZniuB/Z4h2aDqknHz3KL9cLn/ANmrvyefxr+5vCbD+y4UwkPKb++pN/qfyL4mVvacSYl9nFfdCK/MaVyKQj/Ip3egLX6QfAyG7eaMYFSLbs/RalTT5X/hNBJW2/jTtuKvR6BcSH7rVct/Bd1OwGxvyoAxguackLP/AAmu00n4YPKN0nHtXR6Z8M7eHG4bqAPMrTRJ7uQKsbflXSaJ8Mri8YNIrKDXo+m+ErWzxiNePatq3tUiHyqB+FAHM+HPhlb6dtZ1Bb6V1lhp8dmgVFC/QU+MYqZBQBJGMYqWOo0qVaAJEPFPTrTV4FOUc9aAHAZqRRmo84qRR8tAB0ooo60AHaijoKUcigBj02nuc03oaAEzxXM/HPQ18RfBTxZaFdzNpVw0Yx/GsbMv6gV0wFF5YLq2l3VqW2rcwvET1xuBH9a5sZh/b0J0X9pNferHXg8R7GvCt/K0/udz8v7hct7Gq7px/wDWq6yZRfXaM+1RC3aRgqrlmOAAOtf58VsDKU9Ef3LGpZFUx5FHlZqaaSG3P7yaOPkAgt8w6duvcdqqya7awj5VlmbvgbV6dc9evtX6Nwz4H8Y5408vy+o4vaUo8kP/AAOfLF/Js/HuNPpEeHHCiks6zihCcd4Rn7WovWnS55r5xSJRBkdBTvsmI/MbasecbnO1c/U8VmT+ILh12r5cK9DhdxP59/piqNzcyXErPLJJIxPJY5Jr+luEvoX4+o41OIMbGkusaSc5ejlLljF+aU16n8aceftJsgwqlQ4QyypiJbKpWkqUPVRjzzkvJum/Q1bjW7W3OFDTcDhflH5n0+lZl54kumP7uT7OMf8ALLg5xg/N15z9Kpu+BVeQ/wCNf1hwV4E8F8M8tTBYNVKq/wCXlX95O/dXXLF+cIxP4O8SfpZeJvGvNRzDMZUKEr/ucPejCz6NxftJryqTmht1I1zG0ch82Nhyr/Mp/A1y+ufCTwn4hKnUPCvhm+K5AM+lQSMv0JTI/CulPP5VBIfmr9glh6VRWqRTXmrn4BgcwxWFfNhakoP+62vyaPL9c/Y2+FuuDE/grSl53Zt3mtz3/wCebr+XSuN1/wD4JxfC3V/M8mw1jTd53A2t/nZ7DzFf9c17456/WoJDiuOpw3ldX48PD/wFJ/etT7TAeJXFmFt7HMq9uzqzkvuk2vwPlnXf+CWHhG68z+z/ABHr1mWHyefDFcbT77fLz+GK5DWv+CUtxEx/s/xjZzLjj7RYPDz/AMBd+Pf9K+zpTj8KruMflXDU4ByOq7uhb0lJfrY+1wPj1xzh1b67zLtKnTf48nN+J8E6t/wTF8dWH/Hvf+G77r/qrqRcf99xrXK6v+wV8TNHBJ8Om4UHGbe7gmz74VyfzFfoy5wtVpT/ACrz6nhXlFTWEpx9Gv1iz7LA/SY4rp6VqdGovOEk/wDyWaX4Hxt+xJ+zp4o8EfGiTUPEGhahpdnp9m5ElzCY1llJUIFJ4bGSflJxivrmQ/yzViU8H6VXn/pX2PC/DlHJsNLD0JOXNJybe+yX5I/P+PuPMZxZmEMfi4KDhBQUYttaNyb16ty+5LsNi/nxV6yXpWfFVq3naI8fX619HUR8PJam5Ypk1t6fHwPyrA03UYwyh/k9+1dJp6hwpByrDOR3rxcVdbnbhoqWxrabHuxW/p0fA4rI02LpW/p0X3a+dxUj6LCUjX0yPkf5zXQaamax9Mi+7XQabFnHpXzmKkfVYGibGmIV/wDrVan8DaR4hX/TdMsZ2bq7RAP/AN9DDfrTdNizitzT484r5+tWlB80G0/I+uw+Dp1o8laKkuzSa+5nH6l+zFoGrKzWkt9psmOAr+dGP+At8x/76rl9e/ZQ8RaerNps1nq0a9ED+RMfwb5f/HzXulhHjaK3bCLArKPE2PoPSfMu0tfx3/EnEeGOQZgveo+zl3g+X8NY/wDkp8aa/wCFdU8IXIh1TT7zT5G+6J4igf3Unhh9M1SVty192LYQ39m1vcQxXFvIMPFKgeNx6FTwa4jxn+yF4T8Yq8lnHNoF4/Iks/mhJ9TExxj2QpXqYTjyg3y4uDj5rVfduvlc+HzrwDzCMXUyeuqn92fuy9FLWLfryI+VbPW7qwVViuJERTkITlM8/wAJ47+lW08VzlW8yG3nJ6MU2kfTbgfp3rufiL+yV4u8CpJcWtquvaenJmsAWkQf7UX3x6kqGA7mvMB1/nW+YcJ8KcSQdXGYSjiL7ycIuS/7etzJ/NM+Vy7jzxH4CrRwmDx2KwVtoKpNU2u6jd05LzSaN+PxBYzt+8t7iHjqjCTJ/Hbj9ael3ZTJ8t0qljja6MD+eMfrXPA04NmvyfOvoq8A49uVGjUw7f8Az7qP8qiqL7kfvXDP0+vFnK0o4uvRxiX/AD+opP76Lou/m7+dz6E+A2lvH8Pri6Xy5YZb+Qb0YMARHFwcd+hx7iuztbFp24FW/wBnTRo4f2ONNmaNfMvNVuZQ3c/PsP8A6APyrc0nT0iUcV+df6t4fIG8mwknKnQbgnK13ZvV2sr+iP7YyHjLF8V5Zh+JMfTjTq4qEakoxvypyinZXu7W2u36mZZ+FmlPI+talr4MVm+ate3jAHSr0K4oPUM+08IwoB8orStvDVug+6KswrirUIoAZbaNDH/Av5VegsY1P3R+VJEOasRCgCWGMCrMK4FRRDirEfAoAkjXip4xgVFH1qaPpQBLGM4qVOtRoMNUqcCgCReFqVajX7tSL0oAkWnR/wCeaavA/wA8U5BQA4CpAOPrUdSL0oAM0dKWk7UAFGcUd6KABxxUfSpG6GmHg0AItT2h+Zag71LanDj601qB+YHxF1a40Xx7rllDFDbrY6ncwICmWUJM4AIPHAGOnaubutSuLsbZJpGXOdoOF7dhx2H5V2X7Sultov7QvjaFm3btauZ8+nmyGQD8N+Pwrhc5r+neFeDeHstw9PEZZgqVKUop80YRUndX1lbme/Vn+TfiZ4ocaZzmWKwGeZpiK1OFSceSdWbprlk1ZU78i26IAMUdBTS+KaTu/wAK+2SPyHmYrv8ALxUDtkfypzncajkNaRiEWRy1GxwTT3ONxqJj8v1raJpEjPSoX+81Sufl/WoH6GtoHTEjdqryHj8aml4qu5wa6InTEhlOc1XdvvVPIcmoHPy/WuiB1Q7EMvAP0xVWXkmrEjZxVeQ84rpiddMrynr9RVeY4/Gp5OcVXmO3+ddMDtpjYjnH0xViLnHuKqRnOatIf0q5oqZahOR9avaXqk2nSBoXK9yp5U/UVnxNtNWIzgfSuSpFSVmcrk4vmjod54b8aW1yypc4t5P7x/1Z/Ht+P513Glx7lVhyGGRjvXicR+at3wv41vvC8g8l/Mgzkwycofp6H3H618/jsrclei9ezPcy3P8A2UlHEq67rf5r/I9w02PpW/psWf5VxXgHx9p/isrFHJ9nvD/ywkI3Mf8AZPRv5+1d9psXSvg8dGdOThUVmfqmUzpYiCqUZKS7r+vwNbT4/u1vadD0rK06HpW9p8WK+ZxMz7rA0TT06LkVt2UXSs3T4uK2LFMgV8/iJH2WBomlZJwK1LRcjNUbOPpWraRcV4laR9jg6RatY8bfzrlvib+zn4V+MCSSalYfZ9RfpqFpiK5z/tHBEnT+ME46Eda7C2TJ+tXYR8ufauOljK2Hqe2oScZLqnb+vQ9XGZLgsywzwmYUo1ab3jJJr112a6Naroz4h+M/7JfiX4RRTX0K/wBuaJECzXtrGQ0C+ssfJT/eBZRxlgTivLgc1+mQ+VgRwR6V4l8d/wBi/SfiB52peG/s+h603zPABts7w+6j/VMf7yjae65JYfpeQeISk1QzNWf862/7eS29Vp5Lc/l/xA+jnKkpY7hZuS3dGTu/+4cnv/hk79pN2Rq/BqFrL9jXwPEw2mR7uXHqGupWH6MK0LFcqPpVy28OXXgz4CeBdHvojb3lnYL58RIJRzyRkHB5zyDg+tQWScV+J57XjWzHEVYvSU5tfOTZ/dHAOBng+GcuwlVNSp0KMWmrNONOKaa6PTUu261ch5qrAvNXIq8s+q5SxCOlWoR+VV4atQ8UEliIdKsRVBFxVmLkUATxcYqeLmoYulTIORQBMnIqwhyRUCcVOnWgCRKmSoUPFSqOKAJVOVqQcCo14WpEPFAEi0qnJpiGndaAJM04Go0bmnZGaAJBRTd2adnmgAxQBQRRQAOOKj705+lIetACZ21JC21qjPWnRcNVRBn55/t02P2D9qnxXhNiTG1lX/a3WsOT/wB9Bq8jr37/AIKSab9h/aNhmzu+26Nbz49MSTR/+068AzgV/WfCtb2mTYWX/TuK+5Jfof5A+LmDeG40zSl/0/qy+UpOS/BjGOT+lBOBR3/Gmu3avo0fnJG3So3bFSP1qFzk/rVxKiNk4X61C5yakc5NQscGrjsbRQyQ4/pUEhqWU8/0qCQ5JroidMCOQ8VXlOQfyqaQ8/54qu54roidNNEUrZz9MVBIcCppDmq8pzk10QR10yGU4NV5TU0pycetV5DXRE66aIZDz9BVaU4/Kp3bhqryHmuqB2UyOI/4VaibJ/SqcZ/xqxE2GrSSKmW4jwKsRHNVI2wf1qxGf8a5ZHLURbjOf5VYjbFVIzk/WrEbZ/nXPNHHNFqB9rAjqDwc9K9O+G/x8uNEljtdaEl5a8AXC8zxfX++Pr83ueBXl0bZNWI2ry8dgaOJhyVlf816M6MvzbFZfW9thZWfVdH5Ndfz7H2H4W1O08QadDeWNxHdWsv3JIzkH29QR3BwR3FdNYJwK+OfAPxG1T4dar9p02faGx5sEmWhnA7Mv9RgjnBFfUHwc+L+k/FK1225+y6lCu6aykb51HdkPG9fccjuBkZ/K+IMhr4NOrH3qffqvX/Pb0P6G4I42wWbNYapanW/le0v8L6+j1Xmk2ehWMWBW1YxYxWbYx/pW1ZRdK/P8TM/bsDR2L1nHitS1jwKq6faNJIqqrMzHAUDJb6Cuu0XwDcTL5l0VtY8Z+bl8fTt+NeBjMVTpK83Y+2yvLa9d8tGLf8AXV7GXbRdKthcDvVLxL8UvAfgp2juNZ+2Trx5Ns/nNn0JQbQfYkVxur/tb+H7VmGm6DNN6PczYP8A3yM/+hV+ZZx4qcM5e3HEYqLkukfefzUb2+dj9Ryvw1z3FRTp0Xbu9PzSuegZpyxNKdqqWb0AzXjOpftf6nIP9EsdNtPQx24J/Ns1hat+1L4pvk+XUJoh28o+X/6Divz/AB30ishpaYelUn/4DFfm3+B9fhfBXN6mtWcY/ez6f8X+ELXxL4atbW5/dywqvlSj78bYHbuPUd/Y4I8wv/Dk/h+8a3m27l5BXo69Aw9j/Qivn7VvF2reLbtpLzUL2bdyxed2wPxNXPDuvXPhnUo7qzfbJHxhuVkXurDuD/geuDXw/wDxMRh5YmMZ4Rqm3q+e7S6tLlSb8r+Vz9Cj4YzpULOunJLRcul/W/6HusMZzVmAYFZnhHxPaeM9KF1a5Vkws0LHLQsex9QecHv7EEDXjTFf0Dl+Y4fHYeGKws1OE1dNbNf1ut09Hqfm+MwdXD1XRqq0o6NE0Y4qzEKgQVYi4r0UcUkWI+n4VYjqulWIhzQQWI6mTtUMYqePjFAE8fSpk61DGOKmTrQBKnNSpwP6VClSp0oAlXkU5Tg0xelLu2CgCTdisfxF4uh0SL5mXdVPxT42h0aBvm+avHvF/jCbW7xjuO3PrQB63bfFS1kjy0gq1a/Emznl2+YvP4V8/wD22RRje3506PU5om+WRvzoA+krXxZa3DhVkXJ961I5d67l5r5nsfFl1aTq3mH5TXq3gD4qR6hGkM7fNwMmgD0YNmgdKr29ytym5W3AjsamU0AOY5qOnE8U2gBKevBppoj4NXHYUtj43/4Ki6N5PxG8K6jtbN3pslvu7N5cu7H1Hm/qK+YSNy19gf8ABUvTWm0XwPfbvlgnvICPeRYWH/os18f1/T/h/W9pkGHv05l90pJfhY/yq+kVg/q/iBmCS0k6cv8AwKlBv8bkff8AGo2bJp0jY/Oo3NfbRPxEa7c1C7Y5p7nmo3bNaI0iMc/LUTninu3P8qhkPH1raOrOiKI3bg1C7Yz7VJIfmqGVq3idEURyN+tV5TkVJI2P5VDI2B9K3ijqpojlOCaryNipZD/jUErdq6Yo6oIhc4/Cq8jYFSyHj61BIcmumKOumiGZuKrTHNTStVdzk/rXTA64IZE2PwqxE2BVSFv1qxCeBVyRpURbQ4FWI2qrE2anjb/CuWaOWSLUZxVmM4/OqcTc1YiOB/OueSOOcS2jY/nU8Z5qrG3H+7U6HBrnkjlmizG1XtK1S40e/hu7Sea2ubdhJFLExV4yO4I6VnxPU0T4rnqRUlZ7HPzOMlKLs0fWP7Ov7TFv49e30fXHitddbCQzYCQ6gewA6LIf7vRj93BIWvofwf4YuPEV75UK4VeZJCPljHqf6Dv+tfmlA3yivqH4Gft3alY/D4eEdZmW3u5CY4Nf3YkwcYWY/wB7t52cgYzzlx+HeIvDmJwOBrZnlFF1XFOTpx1lor+4uv8Ah37X2X9YeCfifgsdj6OScU11S5moxrS0i7tJRqP7P+N6NfE0/ef0v8Qvjp4f+CULafp0S6prKja4VgBGf+mj9v8AcHPrjOa8C+IXxt8R/El5F1DUJEtWzi1t/wB3AB6bf4vqxJ965/VrWa1vGE27dnOf71Uj0r/KbjbxCzrOa044mbhTu/cTaXpLrJ+unZI/2E4Z4NyvKqEPq8FKSXxNfl0Xy17tiE03P5UMaax4NfllSqz7SKAnbRZ20l/dRwwo0kszBEVerE01hlvetnRb630XQ7lo1ZtUuiYFcj5beHHzEH++2dvsufWsaUoyn+8lZJNvvp0Xm9l970uyK1Rwj7qu/wCtX5Lr+Gox447M+TEyyCP7zjpI3cj27D257mhTkccGoEkx/npUqN81cEqrlLmOfltua3hbxPdeFNXjvLVtrr8roT8sq91b2P6HB7V7p4Y8R2ni7SUvbNiVJ2vG33oX7q3+Pcc188ocPXZ/BI6g3jWMWTbbcoWvMjKGIev+1kjb3BPpmv27wd45xuW5hDKuV1KNaSXKtXGT05o+X8y2sr9D4njHIaGLw0sS2ozgr37pdH+nn6ns8QqaOogcmp0r+1Yn4PLcnj5FTx1BFViM1ZkTx9KnQ81BGeasJw1AEsdTqMmoU6VMg5oAkQ8VKnSoo6mX7tAEi9KZdAtbtinL0pe1AHifxNsrqHUHZt2zPFcWefrX0N4s8JRa7bMGUbseleNeNPB0mhXTfKduetAHNZzRTnXa1N6CgBQxFWLK+kspVeNipB7Gq1Oj4NAHqXw2+KUnnR287dTgE161BN50SsP4hmvmPw9J5WrwEcfOK+k9Ck83Srdv9gUAXM5//VSGndab0NAAaEPzUh60o61cdhPY+e/+CmtiJ/gXolxtZnt9djUsP4Va3nz+oWvh1vl/Cv0G/wCCgOljUf2WdYmJH/EvurScZHrOkf8A7Ur895GwP0r+i/C6tz5Ny/yzkvwT/U/zV+lbg3R42VT/AJ+Uacvuc4f+2kLnBqGRuP5VJKcE+9RSNxiv0xH81DGOBUbNgU5m3fT61G7ZFaRRpFDWNQyNmnSNgVDIcfhW8UbxQx2yaglfj+VTOcZqvIcf8BreKOmKI5GqCQ8frUkjZNQSN3963gjphEjkbJqvI361LI2B+gqvK2P5V0xOuCGStVZz1qWVsD6VXlbbXRBHXTiQytVeVuTU0pqvI36V1RR100RxHP41YjaqcZxViNuf1q5I1qRLkR4qxG2fxqnE/P1qxE+f6VzzRyTRcibmp4m6flVSJuKnjeuaSOSpEtxNj+tTo2D/ACqrE3Sp42/SueUTklEtRtU0T4H86qxn8qnifFc8kcs4l23fH86tRSbB/nms+J/0q1E+a5akTE9L+F/xgbQYk0zVvMutJPyxv96SyPqvcp6r2HT0PpMsCvbx3FvItxaTDdHKh3Kwr50ikwa674e/Ey68FzNGP9IsJjma2c8Z/vL6N+h78gEfyJ48fRrwnFKqZ1w+lSx28o7QrPz6RqP+baT+PV8y/uL6Nn0uMZwg6fDvFcpVsv2hPWVSgui6udJfy/FBfBdJQPVm6URQNcNhR90bjzwo9TVvw/Bp/i/T21K31COPTY13SDG6dW/55hP731wAOc4IzBqGqLcL5VvF9ntVOVj3bmY/3nb+JvyA7AV/l9nnDuMyvETwuY03TqQbThJWkmt7p7Lze/S6vb/XTJ86wWa4Snjsrqxq0aiUozi04tPVNNaO/l87DPljPy/N2LetKH3VACTUicV8jUpu563LZFhOtSK3aq6vg/4VYhTzhlfvDkr6+4/wqYUnJ6GM9CeENIwVQzMxwABnJ9q96+G3gtfBHh1YXVft11iS6YHo3ZM+i5I9ySe9cJ8CvBX228OtXSfubVttqCPvyd3+i9v9o/7NerK+41/W3gbwL9Vof29i4+/NWpp9I9Zestl/dv0kfkHH2fc0v7OovRay9ei+W78/QsJ8xqaLpVeMYFWI6/o6J+VN9SxHz+dTR8VDGanj/rVGZYSp061DF+lTJ1oAmj5FTR9ahj5qaP73rQBLHUiHiokqZeFoAkSnLTRTo6AHY4rB8XeEotdtW+Ubq6BRmjZxQB89eNPBsugXDfKdufSucZdpr6K8Z+Eo9dsnG35sV414p8B3GjzMdjFQfSgDmOlOQc094jG2GGD70iJubAoA2PBmkSarrEKqpOGBr6K0W3NtpsUZ/hUCvOfgn4V8uH7RInPbivUEXA+lADgAabjFOx/KkPWgBDxQtB/zxTUXaatAcB+15pA1z9mHxnCVLeXY/acDt5TrLn8Nmfwr81nPP/1q/Ur4yaXJrnwV8YWMf+svNEvIV/3mgcD9TX5Y798an1FfvXhHVvgq9LtNP74pfof5/wD0wMGo55gMVb4qTjf/AAzb/wDb/wASOQ8/zqFzipJWqCSTvX6/E/kNIY7f/XqNmwKcxqKRsnFbRRpFDXbv+VRO1Oduahkb/wCvW8UdEYjJWqCRqfI/P8qgkf8AxreKOinEbI1QSPT5G7/lUMj4reMTqhEjlfn9KryNUjt+lV5G/wAa6Yo6qcSOU1XlfmpZDxVaVv8AGuiMTspxI5T/AI1XkOKmlaq8hrpijqpojibAqeJ+f1qpE9Txn9ORWsom04luJsj+VWIXqnE+KsI3/wBauaUTknEuI2fxqeJs1UifcKnjbp+RrmlE5ZxLcb//AF6sRtzVONv/AK9WI3rnlE5JRLSNU6P/APXqpE2anjb3+tc8onLKJbjk/wA+tWIZMfzqlG2R+oqeNsjHrWMkc8ol5HzViGUrVGKTP1qwkma5ZxMtmdF4R8ZXnhLUlubOTa3SSNuY5V9GHcdeeo7EV7B4e1yw8fWclxp37m6hG+ezZgZIhxlh/eXJxu9xkDgV4HE+OK0tE1240TUYbq0mkt7mA5SRDhh2P4EEgg8EEg8V+E+Mfgbk3HeEc6iVLFxVoVUtf8M19qP4x3i90/6O8BPpIZ/4bY1UYt18vm71KDe1950m/gn3Xwz2kr2lH25flJB47UoOPWqXgjx1afEpVt5Fjs9c7RDiO8HrH6N6p+IzyF3PhrpNv8SPF15pNrdNJJp9q13cGFd6qodE27um4mQeuNpzzxX+XedeBvF+Bzirk88FNzpq7klenyXsp8+keR9G2tfdspJpf7E8M+N3BWe5Ph86wePpqFd8kYyklU9pa7p+z+LnitXFJ+77yvFqThsbObUrpILeGSeaThUjUszfgK9I8FfA7Y0dxrUxXaQwtYH/APQnH8l/76rofCGjWfhyz8qzt1h3f6xhy8n+83U/yFdBC9fq/BvgbgMBy4nOGq1Ra8q/hp+ezn87Lo4vc8vPvEKtXvSwC5I/zP4n6dF+L80W7SKO0t44YY0hhhG1EQYVR9KsxHBqrDViI8V+80qUYRUIKyWmnY/M6lSU3zSd2y3FViKq0ZqzH0rYxkTx8D8asR9f8Kgj4qxFQSTx/wBanjGTUMdTJ1oAmj/zxU0fWoYuKmQc0ASJ0qYDioUqZeFoAkUnFSJ0qNelPXgYoAeh5p2Kahp3egAK5rP1fw7DqsLK6j5q0lHH+eKdjFAHkXjX4TFC0kKe/SuW8O+DJ7rXFhZGwG5yK+gpbZZ02sN31qjb+Fre3v8AzlVQ1ADvDejrpGmpGq/dFagpFXApcUAJimt1p5ppPJoAb1pB1pe1JnmqiBI1nHqNrNbzLuinjaNx6qRgj8q/Ix0aBPLdWWRPlZT1UjqK/XazPzivyl+Lul/2F8VPFNjx/oOsXlvx0+Sd1/pX7R4P1bVMVS7qD+7mX6o/iv6YWD5sNleK/llWj/4EqbX/AKSzm5WqFzzUkz4qu7c/Sv3aMT+G4xEdsD3qF24pWbHNRMeK3jE2jESRsfhULtTpHyKhlf8AWt4o3jEZI/FQyNz/ADp0jc/55qGRuP51tGJ0xiMlfNQyPzTpXqCR66IxOqMRkrY/rVeQ4/rUkjYqvK2FrogjqhEZK/P61Xc5NSytn+dVpDmuiKOqERkrbqru3Ge/rUkjZ/4FVeZ66Yo7KcSONqsRtxVOJsCp43rWUTacS3G2DViNv8+lVI2/xqeNq5pLU5JxLkbfrU8b8/zqnG3ep4mrCUTknEuRPipo3xVRGqeN65ZROWcS5G2amR+f6VUif9anjbFYyic0olqNv/rVNE2aqxnmpo3/ADHWueUTmlEtxvn+dWY5M1RV8VYibj3rGUTGUS5G+RU0cnNU435qaN+K5ZRMWXI5+MNyK+oP+Cblkr3vj68Kgrb6VDDn0Lu5H/oH6V8sRPg19Z/8E44mt/h58TLr/lnIthCp9Sv2gn/0MV8L4iS5OH8Q115V984n7P8AR5w/tfEHL0+jqP7qNRr8bHpNi2WY/wC0T9Oa1YDxWTpv3R71q29fyvY/1NvcuQHpVuLpVSDirUIxQBai/rVmLtVeKrEfFBmWI+KsRcVXi7VYiFAE6VPH1qGOpoxQBNHxipk4qFO1TJ1oAkQ5FSr0qJOlTJytAEi9Kev3aYPu09DxQA9KcKanFPHJoAevQUYoFA4NADgOKdsxSClxzQAEYFFHaigAJprcU7FNb/PtQA0nig8GjtTTzVRAnt2+dfrX5iftZaSuhftK+OIF+UNq0txj3lxKT+b1+nUBw1fnT/wUJ02TT/2rvEkjY23sNncJj0+zRx/zjNfq3hHWtmtWl3pt/NSj+jZ/K30tMEqnC+GxCWsK6XylTqX/ABSPE3fCmoJW5qSQ5NV52zzX9GQR/nvGIx25qF5Pyp0j5FQu3HsK6IxNYxB34qu7f/Xpzv781C71tGJ0RiI7Y5qCSTinO9QSSZrojE6IxEkbJ+tV5Gp8jdqgketoo6oRGyN+lV5Xp8r1BK3NdMYnVTiMkeoJG/WnO1QSt/8AXroijqpxGO/FV5G/wqSVuKryN/8AWrpjE7KcSNH5qePiq0fNTxnitJG0olpD/wDWqeM5/GqsfOOtWEOR+vWueSOWUSzG+fxqeNgP5VVjqxExDD/Oa55I5ZxLUbfpU0Z/+tUMfJqdK5ZHNKJMhJ7VPGTn/PNQR/eWpl6VjI5pRLEfNTp9f/r1XVsVNG5H/wCqueRzygWI/lGanRsiqkb96mRuK55I55QLSNn61Ij45qurZPvUiNn61nKJhKJaV8ivsj9ga0Nr+zN4yveAt1rC24OeuyGJj/6Mr4ziOf8APSvtj9i6zOmfsbahK2f+Jh4hmlH0EUUf/slfmfinPkyOS7yivxv+h/QP0YsLz8c052+CnUfppy/+3HWaZwi1rQVl6cPkWtSEYxX8wn+laRcgOBVqCqsIwP8A61W4qBlmGrEI4FV4TmrMdBPKTxfw1Yj5qGMVPF1oDlJ4+lTR9ahQ8VMlArEyDtUycmoY6mQfNQIkSpl+7UUfFSp0oAkXpTkpiDinpQBKhpwPNMU5/wD107NAEgNApqdKcKAHqcilpoanA0AGM0tJRmgA7U1jQTxSHrQAhPFNHNK7baaTk0ASwnFfBf8AwVEsFsv2i7CZE2/bNAgkc/3mE1wn/oKrX3nCfmr4w/4Kx6V9n8YeCb75cXVldQZ7ny3ibn/v7/Ov0Xwvrcmf04/zRkv/ACXm/Q/AfpL4N1uBa9Rf8u50pffNQ/8Abj5Hlfj2qGR6dK2w1A5yK/qSKP8ANNRGOefX3qGRuKkc81C7/rW6NowI5XqGRsVI7cVC7VtE6IwI5XzUEj1M5yPr1qGQ4P8AniuiJ0xgQSHJqF2/Op5RjvVaVs/41tE6YRIpG/w+tQStinyD+VQSZrqijqhEjkaoJG4/nUsh/nUEnOa3ijqjEikPPFV5G5NTP3+lV5K6YnVCI2NuP92p4mP9aijTAqeOPPaqk0dUqZLG3P1qeNqiSPA5wKuadYyajcrDbq9xM5+WOJS7N9AOa5akkldnO6LbslqEVWIhgf54rptG+BvjTWolks/CPii5jY4EiaVOY8/723H611mkfsb/ABK1Q/u/Cd5Ht6/aLm3t/wD0ZItfJZhxpw/grrG46jTt/PVhH85I9rCcE5/jP9zwNap/hpTl+UWebRHAqeN+a9k0n9gz4gXSg3EOh6f6i41ONiv/AH73j8q3rT/gnx4hjmAuvFPg2GMdWhnuJWH4GFf518RjvHDgHDfxM3oP/DUjP/0hyPpML4Icd4pXpZVX/wC3oOP/AKVY8FibirEK5/GvozTv2ArNd3274g2MOOnkaS02fzlStKx/Yf8AB9nF/pnjjU7ph0Nvp0cK/kzv/Ovj8d9J7w0w+jzNSf8Adp1n+Kp2/E+iwv0XvEvEWayyUV3dSkvw57/gfM8S4Hepo1w3+eK+mv8AhkD4ewJ/yM3iR2x12QYP4bf61BN+y54HhTbHrWrP/tPEM/owFfO1/pbeG8NsVOXpSn+qR9Bhvob+I9f4qFOH+Kp/8ipHziiDFTrHx0/Cvfrn9nLwtFDth1J93QM9pI38rgCsu8/Z3tdjLb6/ZxAn5SdC8xgPq1wa8up9MDw7W1Wr/wCCn/me5R+gz4g1LOVXDL/t+q3/AOmbfieMpFn1qQJtPb8a9E1H9mvWI0IsvGmmr6CXw0jfr5xrltW/Zz8eWrM1v40tVB5zBou39BMK4Z/TC4F+xOXzjJf+2s9vDfQH4xq/Hi6K9Lv/ANK5TJi5P8q+6/2abRdN/Yh8MsG+bUL68mIz3FzLH/JRXwDq3wN+IRmG7x9EjDpv0t1Zfp+9r7Y/Zrl1jRf2dfBfh3Vr5dSudMtJDLcqpUTtJNJJuwSSPvgc+leLm/jtkXGmH/s3Kb80Gpv4tknHZxXWS69Nj9P8O/oq5x4cZm89zPERqKcJUklFKzk4yvdTlfSDVrLffTX0fT14WtGBaqWMXT/CtCBOK+X5z9s9mWIRVqEYx/nFQQpVqJcUcwuQmhWrMYyKgiXFWo1o5hcpJGKsIKiiWp40o5g5WTRipkHFRoM1Kop8wuVki8nrUqVGg4qVOlPmFYkj6U9KYop6tincTRIhwaep5qIHaaer0yXoSg1IpqFWxTg3NAiReKeGqLfTgeaAJKUNmow2RS7+KAJC9DNio99BfmgB2c0Zwab5hFNL/wCRQApbcaSmmXApplxQBYibLCvlP/grLo6y+DfBOpYO61vbm2B7YkjVj/6KH5V9Txv81eXftoaR4d8QfDDTrXxDaw3yR6nHcQ2r3EkLuwSRSw8tlYgK5zzjn1xXoZXxVheG8THO8dd0qN3JRs5Waa0TaTeuzaPkePOCMXxdkOI4dwLiqtdRUXO6ipRlGau0pNL3eiZ+ZckZbtUEkOT/APWr6xTwd8K7VgV8E27N/t6jeP8Ao0pqZbH4c267Y/Aui/8AA1eT9WY170/ppcEx+DD4l/8AblJf+5mfzHh/oIcfyf7yth16TqP/ANxI+Q2gJ7nHpionhwP/AK1fYMUvgW1OY/Afhk/79ksn6NmpW8Q+EQm1fAXgv/gWhWzfqUrhqfTb4Uj8GDrv15F/7cz2sP8AQJ4wa/e4yivTnf8A7aj4zlQD0H1qvIy56r+Yr7Ri8UeHbRibfwb4Rgb1j0a3U/olTj4mW8I2w6Lo0Q9FsYlH/oNcNT6cmRRXuZdUfrOK/RnsYb6AfEb/AIuY0o+kJP8A9uR8RSMo/iX8xUMjqQfmT/voV9zQ/F+5sj/o9raW/p5cKp/Ie36VLJ8dtcdcfaZNvTG6uGp9O7L4/wAPKJP1rpf+4me3h/2f+ZW/e5vFPyoN/wDuVHwZK6kfeXHfDVBIAw4ZT+Ir7wvPizf6om28Ed1H3EyCQH8D9azLvXNK1Ubbzw7oF0O4m06Fx+q12YT6d2UP+PlU4+lWMvzhEjE/QFziH+75rCXrSlH8qkj4clhIzVaZdv8AKvt280jwbqMXlzeCfCiqe8WlQxH80UH9ayrv4R/DXVH3XHg6zXviG5uIB/5DkWvqMF9ObgyX+84PER/wqlL86kTwcV9BXjKn/u2Lw8vV1I/lCR8XuMH8KgkBr7F1D9mz4Y6ix26RqNnkY/c6hK2P++y1Yt9+xh4BvYv9F1jxRayZzmSWCVMemBEp/Mmvssv+mV4cV3+9qVaX+Kk3/wCkOZ8zjPoa+IuG/h06VT/DU/8Ak4wPk2UmoJM19N337BGmzh2s/G7J/cjn0rP5sJR+i1zWrfsDeJot7afrfhm/VSNqmaWGVvwMZUf99V+h5T9JTw0x7tQzamv8aqU/xqQij43MPo3+I+AXNXyqbX9xwqfhCcn+B6bbf8E+vBnhORoda8Sa/qdwmP8Ajzjhs4zj1VhKcH2YfWui0r9nD4V6BtK+GZL+RDw93fzyfmocIfxWu3+JE2fEc3XrXPmT5fev8ls9+kp4jZlOX1jN60b/APPuXsl91JQR/p9w/wDR/wDD/BUYTp5XSk7L44+0f31OZl/TNN8KeHCn9m+D/DNm0Y2rJHpkPmfi+3cfxNbS/FG/t7dYYGW3hQYVIxsVfoBwK5ffgdKTfivynM+Ms3zB82PxNSq/785S/Ns/UMv4TyfAx5cFhoU1/dio/kkb8/xB1K6J3XD/AJ1Vl8WX0vWeT86yTJk9aPMzXhyzKo/tHsRwVGPwwX3F2fWbqdcG4kH0aue1jR768Zmj1K6P+y7mtPzMGkLjP+NZ/X59zsoXpO8EvuRxl1DrGmt/rLvHqrkiov7f1aE/666/EZ/nXb5yKQ9P4aTx8nuelHME179NM40eNNSj/wCWnt80YqeDxnqcrfKkb8/8866loY36oh/4DQsSKeET8hWcsZcHjKD/AOXS/r5FPRNWur1f38Sp7hTWpv8A85qEHt/SjOKyeKbPPqWlK8VYk3f5zQTTO1Hap+sMz5RJYVnXa6pIvoRmul8LfESTwza21t9it5re1jEaAOUbaOnPI/SuaPBoJxXtZFxVmWT1nXy2q6cmrO1ndb2aaaf3HJjstw+Mp+xxUeaO9n376HqOnfHixCj7Rpt1H6+VKsn8wta9n8d/D8n301OH/fgU/wAnNeLhv8ntTg+K/RMN458TU1adSE/WC/8AbeU+aq8B5TPaDj6Sf63PeIPjV4Xc/NqE0f8AvWsh/kprQtfi74Xl6azCP96GVP5oK+dy5zR5lexR+kFnq+OjSf8A27NP/wBOW/A4Z+HOWvaU184//In0tB8UPDT/APMc08f7zlf5ir1v8RPDr9Ne0f8A4Fdxr/M18t+bTvOyf/r16FP6QmZfbw1P5OS/VnPLw1wXSpL8P8j6sh8d+H26eINBb2/tCH/4qrkXi3RX+7rWkNn0vov/AIqvkcS4o8zmuqH0hsV9rCR/8Cf+TMX4aYbpVl9yPsCPxLpJH/IV0v8AC7j/AMasJ4i0v/oJab/4FR/418b+b7Ub/l6D8RWy+kNW64OP/gb/APkSP+IZ0f8An+//AAFf5n2cuv6bx/xMdP8A/AlP8akXxDppP/IS0/8A8CU/xr4sMmP4R+VI0qqP/rVovpC1f+gNf+Bv/wCRF/xDGk/+X7/8BX+Z9qnxJpqjnUdP/wDAlP8AGor7xpo2l2zTXWsaVbQrwXmvI0UfiWFfE5m3/wAIxXxn/wAFRPjmsbWPgmzkX5QLu+UAdTkID+BP4Fs9q+s4N8XsVn+Zwy+lhFFWblLnb5Yrrbl7tJa7tHk55wFh8vwksTOu21olyrVvpv8AN+SP2On+OPgqzz53jLwjDgZPma1bLgfi9VZf2lPh3bn958QvAcfGfm8RWa/+1K/mfub5VP3I/wDvkVVfUhn7q/lX7pGpc/M50rH9MFx+1t8K7FN03xQ+G8K9cv4osVH6y1my/t2fBG3LB/jN8JVZDtZT4w07II4PHnV/NadW9MflTW1xx/Ea0TuY8p/STcf8FDPgTaff+M3wxPP8HiW0f/0GQ1lah/wVC/Z70ttsvxg8Evxn9xdtOPzjVhX85R1pv71MOst/e/Wgk/oivv8Agrz+zfpwy/xY0V/+uVlezf8AoEBrFuf+C2n7MtsG/wCLlSSMpIwnhnVzk+xNqB+Oa/n2OstjrSHV2J+9QB+9er/8F5v2dNNP7nXvFGod823h64XHt+92Vzmsf8HD3wJ0z/UaT8TNR5x/o+kWifj+9u0r8NW1dietNOqnPU0AftFr3/ByL8MbUf8AEt+H/wAQbz0+1PZWv/oM0tcfrv8Awcu6fGf+JX8HLy4HreeKlgI/BbR8/mK/IttTOPvUw6iaAP098Sf8HJ3jm6Z/7I+GvguwU/dF5f3V4V+pQw5/DFcbef8ABxH8cLyTcul/DW0XuLfR7r9PMun/AK1+eTagQfvUhv8AH9KzqU1OPK7/ACbT+9WZtTlyvmSXzSf5n6CXf/Be/wCLGsxbb6HTW9fsU81mD+EZrIX/AILE6reXEk2oeDrO8nkOXkGrSK7n1JaNifzr4S/tA/3qd/aJ9a+PzPgPJcwd8bSdT/FUqP8A9vPqMDxZmGFVqElH0hBf+2n3tb/8Ff4i487wDhe5j13JH4G3H860oP8AgrpoEg/feD9WQ452X0TY/wDHRX57/wBpN6tR/aR/vV87U8H+FpbYdr0qVP1kz2qfH2bLeon/ANux/RI/Ryz/AOCs3gmSP/SPDviqJvSNbaT+cq1oWf8AwVU+HNw+JNO8X2/u9nbsv/js5P6V+ao1VvWlGqt6mvPqeCvDkvhjNek3+tzqj4iZkt+X7j9PYP8Agpt8LpyN11rkf+/pzcfkTWpb/wDBRf4SzIC3iS4hz2fSrvj/AL5jNfliNXI/ipRrLD+KuGp4F5DLadVeko/rBnXHxIx63hB/J/8AyR+rth+3r8JdQPyeMrVD/wBNbK6h/wDQohWlbftl/C+6YKvjjQV3dN8pjH/jwFfkiNbYfxc07+3W/vVw1PAXKPsYiqvVwf8A7Yjoj4lYn7VOP4/5s/X6D9p/4c3AG3x54N+YZ+bWIE/PLitKx+N/g3VButfFvhe4HYxatbvnv2c1+OP9vsn8f60f8JBj7zCuGp4B4T7GLmvWKf8AkdMfEqd/eor73/kftBZ+PdF1F9tvq+lzt6R3kbH9DWpFdLP9xlf6HNfiV/wkagcsn6Uq+I1U/Lt9Rha5J+AP8mOa9ad//ciNo+JcLa4f/wAm/wDtT9tvMZezfiKPOx1H6V+Ldh8R9asgFtL3VIh2EVw6fyNbGmfGvxxp3/Hrr/ia1/656pPH+PD1yT8A8WvgxqfrTa/9vZ0R8SMK/iov71/kfsZ9px/FUltftHOmHYc+tfkPZ/tE/E6Ejb468XRe39u3LD8t9dBo/wC1X8Ube4jVviB4gxuHW4Mn/oQzXLLwKzZfw8TB+qkv0ZtHxGy9r36cvwf6o/XT4lTMviSb5u+OawRcMT/e/Ct74n5Hieb6mucB/wBqv5orVnzs+4y+K+rQfkidbhie/wCdOFz+H41XDAU4Nk9Kw9szqcETfaf84p3n1CM+1GCf51PtmS4om87/AHfzpfMbH3R+dRD9acrYpe3ZNkOEpP8ADQZSP4SPoKM5oWp+sCsHmnPRvyoMx/2vyqQcD7uKKX1gV0R+b/tN+tHnAfx1NjP+etAXFL6wLmRXMikfepd6/wB79asiPcOaXyFx90flS+sIPaIqb1/vU4sP7wqybdG/hH5Uot48/dX8qPrKD2iKu/J+9+tBbH8Q9KtfZIf7q/lTvsMOPuL+VP60he0iVFbijfirX2CHH+rWk/s+HH+rX86f1pB7SJVD4704S/7VWv7Lh/55j86U6ZCf+WY/Oq+uRJ9rEp+Zn/69G/HpVsaZB/zzH5mnf2bD/wA8x+ZqljIh7WJS3YPX9aUtVz+y4Sf9X+tH9l25H+r/AFNH1yIe1gUWkx3/ACqGWXdWmdKtz/yz/U006Vbj/lnj8TVLGIqNaHmc14x8Xaf8PfBura9qchi03RLR7y5YHnavAUf7TsVRR3ZhX5I/F74kX3xQ8earr2oPuu9UuGndQfljBPyoPZRgD2Ffol/wVji/4Rr9lLwTDZs0cXijXrv+0QCf34tY0MKf7oaVmx3YKf4RX5o6nptuzN+7H5mv7O8FuG4YDKFj5a1MQlJvtG14r7nd+btrZH5DxvmzxVf2MbqMLr5p2b+9WXl6mHdXVUprvLda07jTbfP+qX8zVOXTbfd/qUr92pn5jW3KT3m7+L9aY12D/F+tWn0y1P8Aywj/ACpv9n24/wCWMY/CuiJyMqG9GfvD86adQXP31/OrpsbcH/Ux/wDfNH2K3/54x/8AfNUZFJr1cfeH5003yj+Javiytx/yxj/74py28IP+rj/75FAGWdTjHWRfzoOqRkferW2R/wB2P/vkU4Ko/hX8hQBinU0P8VL9uB/vH8K2Q2OmKd5hHegDD+2E/wDLOU/8ANH2qRh/qZj/AMBNbnmGjzDQVzGIJrhuBbXB/wCAU9Vuv+fW4/Tj9a2N9BfFK1ykzLFtdN/y7t+JFOFheH/lkuPdxWkJKdv5pcpXMzNXTLwn7sK/8CoXR7tj/rIFH4/4VpeZxSmTIpcpXtGZw0O6I5uIx/wE1Ivh+Q9bpseyVe34o30uQr2jKieHV/iuJm/ACpV8OwAfNJO3/A8fyqcSUvmZo5Q9qyNNCtAPuu31c1IulWa/8u8fHrk0GTdS+bS5B+0ZLHbW8R4hiH/ARUySLH91VX6DGKqiWjzPzo5UHtC4LrjrThdVTElHmmjlD2heFzgVLZXf+lx8/wAQrOEuamspsXcf+8KfKHtWfuZ8Vfk8UTD/AGjXN7q6b4uDb4sm/wB41y6LX+WFaXvs/q/Lf91p+iHg4p3mUzGaeABWHMd1hQc08Cmng/Sl3cVPMRYd0pwXJpvU0pOKlyIkPFOBxTQaUipuSPDf5zR2pnRaeDU8xDiKDin9f/rU0dKcBgUcwrIO1OU80g60/wDxqXIz9AHSnYopOtK4AODT1ORTQgantS5iLgBxRxSheacExRzC5iMHH8VOU46VJigjNHMTzEfmYHb8KfnFKeaNtHMGgm7FIWx1p2KTFHMITfgf/XprNvpTHj/69NbpVJlKx8+f8Fghj9lX4Unt/burf+i4a/NHVD8zV+mH/BYD/k0v4U/9jBqv/ouKvzO1TgtX+hnhm/8AjHcF/wBeqf8A6RE/EuIl/tNT/FP/ANLkZVyapzNmrVzyapzGv0ynsfF1iNnqNjg5pzmo2PNdUdziluLvxSb6bnFBPNUZvcdv4o8zNNzmjOaBDt+DShqZRQBJuzQDmmZo3UASBuKXdUYbjrS7qAHh/wDPpQZKbuzRQA8NRvFMpaCuYfuozTN3FAPNAcw/NKGpgO3/AAoDUD5iTzKA+BTSeDRnmgLj92B/nmlDc1HRigLokDUoNRZpwbFAXQ/ecUu/mmBqXNAXRIHzU1m3+lRf7wqr/npU1k3+lx/7woC6P3c+MK48YTf7xrletdd8aRt8ZXH+8fwrka/ypr/xGf1rlT/2Om/JB0pwOKaTkU4VhI9AcBmg9aVelB61BPUeh4FAXNCjFOjHNJsiQ5BxTqM0ZqCAxnj1pyjB4pqjLfSng80Eseo5o70KaAMNSZEthy8U4c03P8utOFQQFOHJpopyjmmSxwGBS9aQUE5FIkeDg4/Sl7UwNg0/oaCWLml6U3oaWgkXqKM80hpaBADRRSH5aAFqOXkU/tTH6UFRPn3/AILADH7Jfwq/7GDVOv8A1yjr8zdU+81fpn/wWAGP2SfhV/2MGqf+io6/M3VDy1f6H+Gb/wCMdwX/AF6p/wDpET8W4i/3ip/in/6XIxrrpVSZquXX3jVKTk1+m0z4qsQtTD8pp79KjaumO5xSGk/hRnmg8mm44qzJ7ig0ZyaSgGgQ6nbsUz9KXPNADhQeKQcUvftQAdaOlGaOlAC7qXoaaOKM4oAfn0pc8U0HP+FGc0APzSUZ4ozQAdBRmiigBaUnFN60uc0AOB4pc00c0ucmgBRR0oUZoPSgAFKDk0nWjvQBIrZFS2n/AB9R/wC8KgHFTWR/0qP/AHhQB+8nxvGPG1wP9o1x+Mmu3+ONlI3ji4xHIRu7CuM+xTD/AJZP+Vf5U4j+LL1P60yea+pUtfsojUYFPHNPFlN/zxk/KnCym/55SflXO07npc0e40cCm1MLKY/8spPyoWwmDf6mT8qmzM+ePcaowv8AWnryKeLCZv8Alk/5U5bCdT/qZPypSuTKce42gnAqQWM//PGT8qDYXB6QyflU2ZPNHuMUf5xTwcCpP7Pnx/qZP++acthcL/yxk/KlqR7SPcj6Cgdam/s+fP8AqZPyoGnT/wDPGT/vmk0yHUj3IunX1pw5H8uKl/s+f/njJ/3zSjT5z/yxk/75qbMnnj3Isc04HHH/AOupBp1wf+WMn5U4afOP+WMn/fNMl1I9yOlFSjT7g/8ALGT8qUadcD/ljJ+VTZk88e5EoyMetKBinnTrgf8ALGT8qcNPnP8Ayxk/KizJc49yMHmlFS/YJ/8AnjJ/3zQbCY/8sZP++aLE80e5FSipfsEw/wCWMn/fNH9nT4/1Mn/fNAc0e5F0NHapv7PuP+eMn5UfYJ/+eMn/AHzQHNHuQd6ZJVn+z58/6mT/AL5NMawuMf6mT/vmizCM49z55/4LA/8AJpPwq/7GDVM8f9Mo6/MvU+rV+nX/AAV8sJ5f2SfhaiwyMy+INTJAXp+6jr8z9V0i63N/o83/AHzX+h3hn/yTuC/69U//AEiJ+M8Rf7xU/wAU/wD0uRzt31qnL/StW60i6Of9Hm/75qlNpF0f+Xeb/vmv06nsfFVihJUbnirr6Rdf8+83/fNRvpF1j/j3m/75rpW5xSKZFFWjo91n/j3m/wC+aT+yLr/n3m/75qzJ7lajvVn+yLv/AJ95v++aP7Huv+feb/vmgRWHSnA5Hf8ACrA0e6H/AC7y/wDfNH9j3X/PvN/3zQBXByP607PNTf2TdH/l3m/75pf7Juv+feb/AL5oAg7UVYGkXWf+Peb/AL5o/si6/wCfeb/vmgCuKO9WP7Huv+feb/vml/si6z/x7zf980AV/wDGl7f1qf8Ase6/54S/980v9lXXe3l/75oAhBz/AJ60dqnOlXP/ADwk/wC+aDptwf8AlhJ+VAEB60VOdNuAf9TJ+VIdPnH/ACxk/wC+aAIaO1TfYJ/+eMn/AHzR9gnx/qpPyoAhxTuoqT7DN/zzf8qPsU2f9XJ+VAEYNOp32OXP+rb8qcLSXP8Aq3/KgBmKQ8VILSX/AJ5P+VBtJf8Anm/5UARg4qxZ83Mf+8KYLOX/AJ5v+XWprKzmF1H+7b7w7UAf/9k=",t.texturesPixi={},t.texturesThree={},t.sounds={},t.json={},t.models={},Ym.add({name:"AppleIcon",path:u.assets+"/imagesPixi/appleIcon.png"}),Ym.add({name:"barre",path:u.assets+"/imagesPixi/barre.png"}),Ym.add({name:"BarrelIcon",path:u.assets+"/imagesPixi/barrelicon.png"}),Ym.add({name:"blueButton",path:u.assets+"/imagesPixi/bluebutton.png"}),Ym.add({name:"greyButton",path:u.assets+"/imagesPixi/greybutton.png"}),Ym.add({name:"BottleIcon",path:u.assets+"/imagesPixi/bottleicon.png"}),Ym.add({name:"buttonSkin",path:u.assets+"/imagesPixi/buttonskin.png"}),Ym.add({name:"cadre",path:u.assets+"/imagesPixi/cadre.png"}),Ym.add({name:"ChestIcon",path:u.assets+"/imagesPixi/chestIcon.png"}),Ym.add({name:"coinBackground",path:u.assets+"/imagesPixi/coinbackground.png"}),Ym.add({name:"coins1",path:u.assets+"/imagesPixi/coins1.png"}),Ym.add({name:"coins2",path:u.assets+"/imagesPixi/coins2.png"}),Ym.add({name:"coins3",path:u.assets+"/imagesPixi/coins3.png"}),Ym.add({name:"coinsGold",path:u.assets+"/imagesPixi/coinsgold.png"}),Ym.add({name:"alertIcon",path:u.assets+"/imagesPixi/alertIcon.png"}),Ym.add({name:"BasketballIcon",path:u.assets+"/imagesPixi/basketballicon.png"}),Ym.add({name:"BeachballIcon",path:u.assets+"/imagesPixi/beachballicon.png"}),Ym.add({name:"ChickenBucketIcon",path:u.assets+"/imagesPixi/chickenbucketicon.png"}),Ym.add({name:"DinoEggIcon",path:u.assets+"/imagesPixi/dinoeggicon.png"}),Ym.add({name:"HumanEyeIcon",path:u.assets+"/imagesPixi/humaneyeicon.png"}),Ym.add({name:"FootballIcon",path:u.assets+"/imagesPixi/footballicon.png"}),Ym.add({name:"LegoHeadIcon",path:u.assets+"/imagesPixi/legoheadicon.png"}),Ym.add({name:"ShieldIcon",path:u.assets+"/imagesPixi/shieldicon.png"}),Ym.add({name:"BaseballIcon",path:u.assets+"/imagesPixi/baseballicon.png"}),Ym.add({name:"CubeIcon",path:u.assets+"/imagesPixi/cubeicon.png"}),Ym.add({name:"GyroscopeIcon",path:u.assets+"/imagesPixi/gyroscopeicon.png"}),Ym.add({name:"MandalorianIcon",path:u.assets+"/imagesPixi/mandalorianicon.png"}),Ym.add({name:"MinionIcon",path:u.assets+"/imagesPixi/minionicon.png"}),Ym.add({name:"MushroomIcon",path:u.assets+"/imagesPixi/mushroomicon.png"}),Ym.add({name:"PowerballIcon",path:u.assets+"/imagesPixi/powerballicon.png"}),Ym.add({name:"PacmanIcon",path:u.assets+"/imagesPixi/pacmanicon.png"}),Ym.add({name:"PokeballIcon",path:u.assets+"/imagesPixi/pokeballicon.png"}),Ym.add({name:"PumpkinIcon",path:u.assets+"/imagesPixi/pumpkinicon.png"}),Ym.add({name:"FishIcon",path:u.assets+"/imagesPixi/fishicon.png"}),Ym.add({name:"GemIcon",path:u.assets+"/imagesPixi/gemicon.png"}),Ym.add({name:"greenButton",path:u.assets+"/imagesPixi/greenbutton.png"}),Ym.add({name:"holeBackground",path:u.assets+"/imagesPixi/holebackground.png"}),Ym.add({name:"icongear",path:u.assets+"/imagesPixi/icongear.png"}),Ym.add({name:"iconmute",path:u.assets+"/imagesPixi/iconmute.png"}),Ym.add({name:"iconnovibrations",path:u.assets+"/imagesPixi/iconnovibrations.png"}),Ym.add({name:"iconsound",path:u.assets+"/imagesPixi/iconsound.png"}),Ym.add({name:"iconvibrations",path:u.assets+"/imagesPixi/iconvibrations.png"}),Ym.add({name:"leftButton",path:u.assets+"/imagesPixi/leftbutton.png"}),Ym.add({name:"orangeButton",path:u.assets+"/imagesPixi/orangebutton.png"}),Ym.add({name:"PlanetIcon",path:u.assets+"/imagesPixi/planeticon.png"}),Ym.add({name:"playIcon",path:u.assets+"/imagesPixi/playicon.png"}),Ym.add({name:"progressBar",path:u.assets+"/imagesPixi/progressbar.png"}),Ym.add({name:"rarityBackground",path:u.assets+"/imagesPixi/raritybackground.png"}),Ym.add({name:"rightButton",path:u.assets+"/imagesPixi/rightbutton.png"}),Ym.add({name:"RubberDuckIcon",path:u.assets+"/imagesPixi/rubberduckicon.png"}),Ym.add({name:"score",path:u.assets+"/imagesPixi/score.png"}),Ym.add({name:"skinLock",path:u.assets+"/imagesPixi/skinlock.png"}),Ym.add({name:"skinShopBackground",path:u.assets+"/imagesPixi/skinshopbackground.png"}),Ym.add({name:"skinShopClose",path:u.assets+"/imagesPixi/skinshopclose.png"}),Ym.add({name:"SmileyIcon",path:u.assets+"/imagesPixi/smileyicon.png"}),Ym.add({name:"transbubble",path:u.assets+"/imagesPixi/transbubble.png"}),Ym.add({name:"you",path:u.assets+"/imagesPixi/you.png"}),Ym.add({name:"BoostCircle",path:u.assets+"/imagesThree/boostcircle.png"}),Ym.add({name:"cloud",path:u.assets+"/imagesThree/cloud.png"}),Ym.add({name:"confetti",path:u.assets+"/imagesThree/confetti.png"}),Ym.add({name:"ParticleCircle",path:u.assets+"/imagesThree/particlecircle.png"}),Ym.add({name:"ParticleEffect0",path:u.assets+"/imagesThree/particleeffect0.png"}),Ym.add({name:"ParticleEffect1",path:u.assets+"/imagesThree/particleeffect1.png"}),Ym.add({name:"ParticleEffect2",path:u.assets+"/imagesThree/particleeffect2.png"}),Ym.add({name:"ParticleEffect3",path:u.assets+"/imagesThree/particleeffect3.png"}),Ym.add({name:"ParticleSquare",path:u.assets+"/imagesThree/particlesquare.jpg"}),Ym.add({name:"points",path:u.assets+"/imagesThree/points.png"}),Ym.add({name:"splash_0",path:u.assets+"/imagesThree/splash_0.png"}),Ym.add({name:"splash_1",path:u.assets+"/imagesThree/splash_1.png"}),Ym.add({name:"splash_2",path:u.assets+"/imagesThree/splash_2.png"}),Ym.add({name:"shieldHallo",path:u.assets+"/imagesThree/shieldhallo.png"}),Ym.add({name:"Platform",path:u.assets+"/sounds/Platform.mp3"}),Ym.add({name:"Splash",path:u.assets+"/sounds/Splash.mp3"}),Ym.add({name:"challengerBackground",path:u.assets+"/imagesPixi/challengerbackground.png"}),Ym.add({name:"challengeCap",path:u.assets+"/imagesPixi/challengecap.png"}),Ym.add({name:"challengeCheckMark",path:u.assets+"/imagesPixi/challengecheckmark.png"}),Ym.add({name:"challengeBackground",path:u.assets+"/imagesPixi/challengebackground.png"}),Ym.add({name:"challengeSphere",path:u.assets+"/imagesPixi/challengesphere.png"}),Ym.add({name:"arrow_btn",path:u.assets+"/imagesPixi/arrow_btn.png"}),Ym.add({name:"shield_btn",path:u.assets+"/imagesPixi/shield_btn.png"}),Ym.add({name:"booster_rv",path:u.assets+"/imagesPixi/booster_rv.png"}),Ym.add({name:"circle",path:u.assets+"/imagesPixi/circle.png"}),Ym.add({name:"arrow",path:u.assets+"/imagesPixi/arrow.png"}),Ym.add({name:"shield",path:u.assets+"/imagesPixi/shield.png"}),Ym.add({name:"banner",path:u.assets+"/imagesPixi/banner.png"}),Ym.add({name:"coupe",path:u.assets+"/imagesPixi/coupe.png"}),Ym.add({name:"BoostArrow",path:u.assets+"/models/boostarrow.glb"}),Ym.add({name:"PieMin",path:u.assets+"/models/piemin.glb"}),Ym.add({name:"yellow_bg",path:u.assets+"/imagesPixi/yellow_bg.png"}),Ym.add({name:"basic_white_bg",path:u.assets+"/imagesPixi/basic_white_bg.png"}),Ym.add({name:"friends_picto",path:u.assets+"/imagesPixi/friends_picto.png"}),Ym.add({name:"gradient",path:u.assets+"/imagesPixi/gradient.png"}),Ym.add({name:"basic_inter",path:u.assets+"/imagesPixi/basic_inter.png"}),Ym.addEventListener("complete",t.onLoad),Ym.addEventListener("progress",t.onProgress),t}return s(n,[{key:"resetProfiles",value:function(t){var e=this;this.players=[],this.manager.getProfiles(this.numProfiles,this.minScore,this.maxScore,this.step).then((function(n){for(var i=[],r=0;r<n.length;r++){var a={};for(var o in n[r])a[o]=n[r][o];i.push(a)}console.log("Profiles from manager:",i),u.resetProfilesDelayCall=gM.delayedCall(.2,(function(){console.log("1");for(var i=0;i<n.length;i++)"added1"==n[i].id&&(n[i].id=""),"added2"==n[i].id&&(n[i].id=""),console.log("2"),n[i].color=null,n[i].invite=null,n[i].leaderColor=null,n[i].rank=null,"you"==n[i].name&&n.splice(i,1);e.players=n,t&&t(e.players)}))}))}},{key:"onProgress",value:function(t){var e=t.percent>=1?.99:t.percent;this.dispatchEvent({type:"onProgress",progress:parseInt(100*e)})}},{key:"onLoad",value:function(t){var e=this;console.log("assets loaded"),this.texturesPixi.barre=new G_.from(t.assets.barre),this.texturesPixi.blueButton=new G_.from(t.assets.blueButton),this.texturesPixi.greyButton=new G_.from(t.assets.greyButton),this.texturesPixi.buttonSkin=new G_.from(t.assets.buttonSkin),this.texturesPixi.cadre=new G_.from(t.assets.cadre),this.texturesPixi.coinBackground=new G_.from(t.assets.coinBackground),this.texturesPixi.coins1=new G_.from(t.assets.coins1),this.texturesPixi.coins2=new G_.from(t.assets.coins2),this.texturesPixi.coins3=new G_.from(t.assets.coins3),this.texturesPixi.coinsGold=new G_.from(t.assets.coinsGold),this.texturesPixi.alertIcon=new G_.from(t.assets.alertIcon),this.texturesPixi.BarrelIcon=new G_.from(t.assets.BarrelIcon),this.texturesPixi.BasketballIcon=new G_.from(t.assets.BasketballIcon),this.texturesPixi.BeachballIcon=new G_.from(t.assets.BeachballIcon),this.texturesPixi.ChickenBucketIcon=new G_.from(t.assets.ChickenBucketIcon),this.texturesPixi.DinoEggIcon=new G_.from(t.assets.DinoEggIcon),this.texturesPixi.HumanEyeIcon=new G_.from(t.assets.HumanEyeIcon),this.texturesPixi.FootballIcon=new G_.from(t.assets.FootballIcon),this.texturesPixi.LegoHeadIcon=new G_.from(t.assets.LegoHeadIcon),this.texturesPixi.ShieldIcon=new G_.from(t.assets.ShieldIcon),this.texturesPixi.BaseballIcon=new G_.from(t.assets.BaseballIcon),this.texturesPixi.CubeIcon=new G_.from(t.assets.CubeIcon),this.texturesPixi.GyroscopeIcon=new G_.from(t.assets.GyroscopeIcon),this.texturesPixi.MandalorianIcon=new G_.from(t.assets.MandalorianIcon),this.texturesPixi.MinionIcon=new G_.from(t.assets.MinionIcon),this.texturesPixi.MushroomIcon=new G_.from(t.assets.MushroomIcon),this.texturesPixi.PowerballIcon=new G_.from(t.assets.PowerballIcon),this.texturesPixi.SmileyIcon=new G_.from(t.assets.SmileyIcon),this.texturesPixi.PlanetIcon=new G_.from(t.assets.PlanetIcon),this.texturesPixi.AppleIcon=new G_.from(t.assets.AppleIcon),this.texturesPixi.BottleIcon=new G_.from(t.assets.BottleIcon),this.texturesPixi.ChestIcon=new G_.from(t.assets.ChestIcon),this.texturesPixi.RubberDuckIcon=new G_.from(t.assets.RubberDuckIcon),this.texturesPixi.FishIcon=new G_.from(t.assets.FishIcon),this.texturesPixi.GemIcon=new G_.from(t.assets.GemIcon),this.texturesPixi.PacmanIcon=new G_.from(t.assets.PacmanIcon),this.texturesPixi.PokeballIcon=new G_.from(t.assets.PokeballIcon),this.texturesPixi.PumpkinIcon=new G_.from(t.assets.PumpkinIcon),this.texturesPixi.greenButton=new G_.from(t.assets.greenButton),this.texturesPixi.holeBackground=new G_.from(t.assets.holeBackground),this.texturesPixi.icongear=new G_.from(t.assets.icongear),this.texturesPixi.iconmute=new G_.from(t.assets.iconmute),this.texturesPixi.iconnovibrations=new G_.from(t.assets.iconnovibrations),this.texturesPixi.iconsound=new G_.from(t.assets.iconsound),this.texturesPixi.iconvibrations=new G_.from(t.assets.iconvibrations),this.texturesPixi.leftButton=new G_.from(t.assets.leftButton),this.texturesPixi.orangeButton=new G_.from(t.assets.orangeButton),this.texturesPixi.playIcon=new G_.from(t.assets.playIcon),this.texturesPixi.progressBar=new G_.from(t.assets.progressBar),this.texturesPixi.rarityBackground=new G_.from(t.assets.rarityBackground),this.texturesPixi.rightButton=new G_.from(t.assets.rightButton),this.texturesPixi.score=new G_.from(t.assets.score),this.texturesPixi.skinLock=new G_.from(t.assets.skinLock),this.texturesPixi.skinShopBackground=new G_.from(t.assets.skinShopBackground),this.texturesPixi.skinShopClose=new G_.from(t.assets.skinShopClose),this.texturesPixi.transbubble=new G_.from(t.assets.transbubble),this.texturesPixi.you=new G_.from(t.assets.you),this.texturesPixi.yellowBg=new G_.from(t.assets.yellow_bg),this.texturesPixi.basicWhiteBg=new G_.from(t.assets.basic_white_bg),this.texturesPixi.friendsPicto=new G_.from(t.assets.friends_picto),this.texturesPixi.gradient=new G_.from(t.assets.gradient),this.texturesPixi.basicInter=new G_.from(t.assets.basic_inter),this.texturesPixi.challengerBackground=new G_.from(t.assets.challengerBackground),this.texturesPixi.challengeBackground=new G_.from(t.assets.challengeBackground),this.texturesPixi.challengeCap=new G_.from(t.assets.challengeCap),this.texturesPixi.challengeCheckMark=new G_.from(t.assets.challengeCheckMark),this.texturesPixi.challengeSphere=new G_.from(t.assets.challengeSphere),this.texturesPixi.arrowBtn=new G_.from(t.assets.arrow_btn),this.texturesPixi.shieldBtn=new G_.from(t.assets.shield_btn),this.texturesPixi.boosterRv=new G_.from(t.assets.booster_rv),this.texturesPixi.circle=new G_.from(t.assets.circle),this.texturesPixi.arrow=new G_.from(t.assets.arrow),this.texturesPixi.shield=new G_.from(t.assets.shield),this.texturesPixi.banner=new G_.from(t.assets.banner),this.texturesPixi.coupe=new G_.from(t.assets.coupe),this.texturesThree.BoostCircle=new xe(t.assets.BoostCircle),this.texturesThree.BoostCircle.needsUpdate=!0,this.texturesThree.shieldHallo=new xe(t.assets.shieldHallo),this.texturesThree.shieldHallo.needsUpdate=!0,this.texturesThree.cloudh=new xe(t.assets.cloudh),this.texturesThree.cloudh.needsUpdate=!0,this.texturesThree.confettih=new xe(t.assets.confettih),this.texturesThree.confettih.needsUpdate=!0,this.texturesThree.ParticleCircle=new xe(t.assets.ParticleCircle),this.texturesThree.ParticleCircle.needsUpdate=!0,this.texturesThree.ParticleEffect0=new xe(t.assets.ParticleEffect0),this.texturesThree.ParticleEffect0.needsUpdate=!0,this.texturesThree.ParticleEffect1=new xe(t.assets.ParticleEffect1),this.texturesThree.ParticleEffect1.needsUpdate=!0,this.texturesThree.ParticleEffect2=new xe(t.assets.ParticleEffect2),this.texturesThree.ParticleEffect2.needsUpdate=!0,this.texturesThree.ParticleEffect3=new xe(t.assets.ParticleEffect3),this.texturesThree.ParticleEffect3.needsUpdate=!0,this.texturesThree.ParticleSquare=new xe(t.assets.ParticleSquare),this.texturesThree.ParticleSquare.needsUpdate=!0,this.texturesThree.points=new xe(t.assets.pointsh),this.texturesThree.points.needsUpdate=!0,this.texturesThree.splash_0=new xe(t.assets.splash_0),this.texturesThree.splash_0.needsUpdate=!0,this.texturesThree.splash_1=new xe(t.assets.splash_1),this.texturesThree.splash_1.needsUpdate=!0,this.texturesThree.splash_2=new xe(t.assets.splash_2),this.texturesThree.splash_2.needsUpdate=!0,this.sounds.Platform=t.assets.Platform,this.sounds.Splash=t.assets.Splash,this.models.Barrel=t.assets.Barrel,this.models.Basketball=t.assets.Basketball,this.models.Beachball=t.assets.Beachball,this.models.ChickenBucket=t.assets.ChickenBucket,this.models.DinoEgg=t.assets.DinoEgg,this.models.HumanEye=t.assets.HumanEye,this.models.Football=t.assets.Football,this.models.LegoHead=t.assets.LegoHead,this.models.Shield=t.assets.Shield,this.models.Baseball=t.assets.Baseball,this.models.Cube=t.assets.Cube,this.models.Gyroscope=t.assets.Gyroscope,this.models.Mandalorian=t.assets.Mandalorian,this.models.Minion=t.assets.Minion,this.models.Mushroom=t.assets.Mushroom,this.models.Powerball=t.assets.Powerball,this.models.Smiley=t.assets.Smiley,this.models.Planet=t.assets.Planet,this.models.Apple=t.assets.Apple,this.models.Bottle=t.assets.Bottle,this.models.Chest=t.assets.Chest,this.models.RubberDuck=t.assets.RubberDuck,this.models.Fish=t.assets.Fish,this.models.Gem=t.assets.Gem,this.models.Pacman=t.assets.Pacman,this.models.Pokeball=t.assets.Pokeball,this.models.Pumpkin=t.assets.Pumpkin,this.models.BoostArrow=t.assets.BoostArrow,this.models.PieMin=t.assets.PieMin,this.manager=JM.H5SDK.getProfileModule(),this.numProfiles=50,this.minScore=200,this.maxScore=2e3,this.step=30,kM.init((function(){e.dispatchEvent({type:"ready",progress:1})}))}},{key:"getModelByName",value:function(t){return new Promise((function(e,n){var i=t.toLowerCase();Ym.loadGlb(i,u.assets+"/models/"+i+".glb",e,n)}))}},{key:"load",value:function(){Wv.loadFont(["Junegull-Regular, voodoo_casual-bold"],(function(){console.log("Fonts loaded"),Ym.verbose=!1,Ym.load()}))}}]),n}(Ut),$M=new QM,tE=document.querySelector(".loading-screen"),eE=function(){function t(){a(this,t),Wv.autobind(this),this.initSdk=!1,this.loaded=!1,this.userDataReady=!1,JM.H5SDK.addEventListener("reconnected",(function(t){var e=t.getPayload().reconnected;e&&(u.resetProfilesDelayCall&&u.resetProfilesDelayCall.kill(),JM.pixiManager.header.initPlayers((function(){console.log("ready to change challenger")}))),u.reconnected=e,console.log("reconnected:",u.reconnected)})),JM.H5SDK.addEventListener("onLoadingStart",this.loadingGameHandler,1),JM.H5SDK.addEventListener("onUserData",this.onUserDataReady,1),JM.H5SDK.addEventListener("onPlatformInit",this.onPlatformInit,1),JM.H5SDK.addEventListener("onConfigData",this.onConfigDataHandler),JM.H5SDK.getPlatform().init(),this.init()}return s(t,[{key:"onPlatformInit",value:function(){JM.H5SDK.addEventListener("pause",this.pause),JM.H5SDK.addEventListener("resume",this.resume),window.addEventListener("resize",this.resize)}},{key:"loadingGameHandler",value:function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:console.log("loadingGameHandler"),this.initSdk=!0,this.onInitAndLoadingHandler();case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"init",value:function(){var t=this;$M.addEventListener("onProgress",(function(t){console.log(t.progress+"%"),JM.H5SDK.getPlatform().notifyLoadingProgress(t.progress,!0)})),$M.addEventListener("ready",r(e().mark((function n(){return e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.globalAssetsTime=Wv.timeToSec((new Date).getTime()-t.globalAssetsTime),console.log("inGame_globalAssets:",t.globalAssetsTime),JM.H5SDK.getAnalyticsModule().onCustomEvent("inGame_globalAssets",t.globalAssetsTime),console.log("GameManager.H5SDK.getPlatform().getPlayerInfo():",JM.H5SDK.getPlatform().getPlayerInfo()),t.loaded=!0,t.onInitAndLoadingHandler();case 6:case"end":return e.stop()}}),n)})))),this.globalAssetsTime=(new Date).getTime(),this.notifyLoadingCompleteTime=(new Date).getTime(),$M.load()}},{key:"onInitAndLoadingHandler",value:function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:!0===this.initSdk&&!0===this.loaded&&!0===this.userDataReady&&(console.log("100%"),JM.H5SDK.getPlatform().notifyLoadingProgress("100",!0),JM.H5SDK.getPlatform().notifyLoadingComplete(),tE.classList.add("hidden"),JM.setup(),JM.setDatas(),this.resize());case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"onUserDataReady",value:function(){var t=r(e().mark((function t(){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("onUserDataReady"),t.next=3,JM.H5SDK.getStoreModule().get(["coin","currentSkin","purchasedSkins","dailyChallengeData","arrowBooster","shieldBooster"]);case 3:return u.savedData=t.sent,t.next=6,JM.H5SDK.getScoreModule().getBestScore();case 6:u.bestScore=t.sent,this.userDataReady=!0,this.onInitAndLoadingHandler();case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"resize",value:function(){JM.resize()}},{key:"pause",value:function(){JM.pause()}},{key:"resume",value:function(){JM.resume()}}]),t}();new eE}()}();
//# sourceMappingURL=main.557d7186.js.map